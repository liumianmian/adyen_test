Date.prototype.getWeek=function(e){var d=(typeof e!=="undefined")?e:false;var a=new Date(this.getTime());a.setHours(0,0,0,0);
a.setDate(a.getDate()+1);a.setDate(a.getDate()+3-(a.getDay()+6)%7);var c=new Date(a.getFullYear(),0,4);var b=1+Math.round(((a.getTime()-c.getTime())/86400000-3+(c.getDay()+6)%7)/7);
if(d){b=Date.padded2(b);}return b;};Date.padded2=function(a){var b=parseInt(a,10);if(a<10){b="0"+b;}return b;};Date.prototype.getPaddedMinutes=function(){return Date.padded2(this.getMinutes());
};Date.prototype.toFormattedString=function(b){var a;var c=this.getFullYear()+"-"+Date.padded2(this.getMonth()+1)+"-"+Date.padded2(this.getDate());
if(b){a=Date.padded2(this.getHours());c+=" "+a+":"+this.getPaddedMinutes();}return c;};Date.prototype.toFormattedTimeString=function(b){var a;
var c=this.getFullYear()+"-"+Date.padded2(this.getMonth()+1)+"-"+Date.padded2(this.getDate());a=Date.padded2(this.getHours());
c+="T"+a+":"+this.getPaddedMinutes();c+=":00";if(b){c+=".000Z";}return c;};Date.parseFormattedString=function(b){var c="([0-9]{4})(-([0-9]{1,2})(-([0-9]{1,2})( ([0-9]{1,2}):([0-9]{2})?)?)?)?";
var f=b.match(new RegExp(c,"i"));if(f===null){return Date.parse(b);}var e=0;var a=new Date(f[1],0,1);if(f[3]){a.setMonth(f[3]-1);
}if(f[5]){a.setDate(f[5]);}if(f[7]){a.setHours(f[7]);}if(f[8]){a.setMinutes(f[8]);}if(f[0]){a.setSeconds(f[0]);}if(f[2]){a.setMilliseconds(Number("0."+f[2]));
}if(f[4]){e=(Number(f[6]))+Number(f[8]);e=((f[5]=="-")?1:-1);}return a;};define("chartutil/dateUtils_CET",["jquery","d3","underscore"],function(f,d,c){var b=60000;
var h=3600000;var e=86400000;var a=e*7;var g={};g.__DAYS_SHORT=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];g.__MONTHS_SHORT=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
g.__FWD="fwd";g.__BACK="back";g.getNumDays=function(k,j){if(typeof k==="undefined"||typeof j==="undefined"){console.error("DATE NOT SPECIFIED in getNumDays()");
}var i=(k-j)/e;return(i<0)?i*-1:i;};g.getDSTAdjustment=function(k,j){var m=k.getTimezoneOffset();var l=j.getTimezoneOffset();
var i=0;if(k>j){i=(l-m);}else{i=(m-l);}return i;};g.getNumHours=function(l,j){if(typeof l==="undefined"||typeof j==="undefined"){console.error("DATE NOT SPECIFIED in getNumHours()");
}var i=g.getDSTAdjustment(l,j);var k=(l-j)/h;return(k<0)?(k*-1)+i:k+i;};g.getNumMinutes=function(k,j,m){if(typeof k==="undefined"||typeof j==="undefined"){console.error("DATE NOT SPECIFIED in getNumMinutes()");
}var i=(m===true)?0:g.getDSTAdjustment(k,j);var l=(k-j)/b;return(l<0)?(l*-1)+i:l+i;};g.getDateOfISOWeek=function(i,j,k){var m=new Date(j,0,1),l=m.getTimezoneOffset();
if(k&&window.console&&console.log){console.log("### dateUtils_CET::getDateOfISOWeek:: d=",m);}m.setDate(m.getDate()+4-(m.getDay()||7));
m.setTime(m.getTime()+a*(i+(j===m.getFullYear()?-1:0)));m.setTime(m.getTime()+(m.getTimezoneOffset()-l)*60*1000);m.setDate(m.getDate()-4);
if(k&&window.console&&window.console.log){window.console.log("### dateUtils_CET::getDateOfISOWeek:: week:",i," =",m);}return m;
};g.roundToMinute=function(j,k){var i=(typeof k!=="undefined")?k:false;var l=d.time.minute.floor(j);return l;};g.roundToHour=function(i,j){var k=d.time.hour.floor(i);
return k;};g.roundToDay=function(j,k){var i=(typeof k!=="undefined")?k:false;var m=j.getHours();var l=j;if(i){l=new Date(j.getFullYear(),j.getMonth(),j.getDate(),j.getHours()-m);
}else{l.setHours(l.getHours()-m);}return l;};g.trueRoundToDay=function(j,k){var i=(typeof k!=="undefined")?k:false;var l;
if(j.getHours()>=12){if(i){l=new Date(d.time.day.ceil(j));}else{l=d.time.day.ceil(j);}}else{if(i){l=new Date(d.time.day.floor(j));
}else{l=d.time.day.floor(j);}}return l;};g.roundToWeek=function(k,l,j){var n=(typeof j!=="undefined"&&typeof j==="number")?j:0;
var i=(typeof l!=="undefined")?l:false;var o=k.getDay();var m=k;if(i){m=new Date(k.getFullYear(),k.getMonth(),k.getDate()-(o-n));
}else{m.setDate(m.getDate()-(o-n));}return m;};g.trueRoundToWeek=function(k,l,j){var n=(typeof j!=="undefined"&&typeof j==="number")?j:0;
var i=(typeof l!=="undefined")?l:false;var o=k.getDay();var m=k;if(o<3){if(i){m=new Date(k.getFullYear(),k.getMonth(),k.getDate()-(o-n));
}else{m.setDate(m.getDate()-(o-n));}}else{if(i){m=new Date(k.getFullYear(),k.getMonth(),k.getDate()+(7-(o-n)));}else{m.setDate(m.getDate()+(7-(o-n)));
}}return m;};g.roundToMonth=function(j,k){var i=(typeof k!=="undefined")?k:false;var m=j.getDate()-1;var l=j;if(i){l=new Date(j.getFullYear(),j.getMonth(),j.getDate()-m);
}else{l.setDate(l.getDate()-m);}return l;};g.convertToUTC=function(i){return new Date(g.viewAsUTC(i));};g.viewAsUTC=function(i){return i.toUTCString();
};g.convertToUTC2=function(k){var j=k.toUTCString();var l=j.split(" ");var i=l[4].split(":");return new Date(l[3],c.indexOf(g.__MONTHS_SHORT,l[2]),l[1],i[0],i[1],i[2]);
};g.convertToOffset=function(i,l){var j=g.convertToUTC(i);var k=l*60*1000;j.setTime(j.getTime()+k);return j;};g.adjustTime=function(j,l){var k=j.getTime();
var i=new Date();i.setTime(k+l);return i;};g.getSummerDSTDate=function(i){var j=Math.ceil(31-((((5*i.getFullYear())/4)+4)%7));
return j;};g.getAmsterdamDSTSummerBoundary=function(j){var k=Math.ceil(31-((((5*j.getFullYear())/4)+4)%7));var i=Date.UTC(j.getFullYear(),2,k,1,0);
return i;};g.getWinterDSTDate=function(j){var i=Math.ceil(31-((((5*j.getFullYear())/4)+1)%7));return i;};g.getAmsterdamDSTWinterBoundary=function(j){var k=Math.ceil(31-((((5*j.getFullYear())/4)+1)%7));
var i=Date.UTC(j.getFullYear(),9,k,1,0);return i;};g.isWinterDSTBoundary=function(i,j){var k=g.getWinterDSTDate(i);if(window.console&&window.console.log&&j){window.console.log("\n### DETECTING WINTER DST BOUNDARY dstDate=",k);
window.console.log("### DETECTING DST BOUNDARY startDate.getUTCMonth()=",i.getUTCMonth());window.console.log("### DETECTING DST BOUNDARY startDate.getUTCDate()=",i.getUTCDate());
window.console.log("### DETECTING DST BOUNDARY startDate.getUTCHours()=",i.getUTCHours());}if(i.getUTCMonth()===9&&i.getUTCDate()===k&&i.getUTCHours()===0){if(window.console&&window.console.log&&j){window.console.log("### DETECTED WINTER DST BOUNDARY DATE!!!!!!!!\n");
}return true;}else{if(window.console&&window.console.log&&j){window.console.log("### NOT A BOUNDARY DATE!!!!!!!!\n");}return false;
}};g.isSummerDSTBoundary=function(i,j){var k=g.getSummerDSTDate(i);if(window.console&&window.console.log&&j){window.console.log("\n### DETECTING SUMMER DST BOUNDARY dstDate=",k);
window.console.log("### DETECTING DST BOUNDARY startDate.getUTCMonth()=",i.getUTCMonth());window.console.log("### DETECTING DST BOUNDARY startDate.getUTCDate()=",i.getUTCDate());
window.console.log("### DETECTING DST BOUNDARY startDate.getUTCHours()=",i.getUTCHours());}if(i.getUTCMonth()===2&&i.getUTCDate()===k&&i.getUTCHours()===0){if(window.console&&window.console.log&&j){window.console.log("### DETECTED SUMMER DST BOUNDARY DATE!!!!!!!!\n");
}return true;}else{if(window.console&&window.console.log&&j){window.console.log("### NOT A BOUNDARY DATE!!!!!!!!\n");}return false;
}};g.sameTzOffset=function(k,j,l){var i=k.getTimezoneOffset();var m=j.getTimezoneOffset();if(window.console&&window.console.log&&l){window.console.log("\n### sameTzOffset::startTz=",i);
window.console.log("### sameTzOffset::endTz=",m,"\n");}if(i===m){return true;}return false;};g.getTzOffsetDiff=function(k,j,l){var i=k.getTimezoneOffset();
var n=j.getTimezoneOffset();var m=n-i;if(window.console&&window.console.log&&l){window.console.log("\n### DateUtils::getTzOffsetDiff::startTz=",i);
window.console.log("### DateUtils::getTzOffsetDiff::endTz=",n);window.console.log("### DateUtils::getTzOffsetDiff::diff=",m,"\n");
}return m;};g.convertDateToAMS=function(i){var k=g.getAmsterdamDSTOffsetTime(i,true);var j=g.timezoneShiftDate(i,g.__BACK,k,"startDate",0,0);
return j;};g.getAmsterdamDSTOffset=function(k,m,l){var j=g.getAmsterdamDSTSummerBoundary(k);var i=g.getAmsterdamDSTWinterBoundary(k);
if(k.getTime()>j&&k.getTime()<i){return 120;}return 60;};g.getAmsterdamDSTOffset_minusTZ=function(k,m){if(window.console&&window.console.log&&m){window.console.log("###");
window.console.log("### getAmsterdamDSTOffset_minusTZ:: date =",k);window.console.log("### utc str=",k.toUTCString());}var j=g.getAmsterdamDSTSummerBoundary(k);
var i=g.getAmsterdamDSTWinterBoundary(k);var l=k.getTime();if(window.console&&window.console.log&&m){window.console.log("### orig millis = ",l);
window.console.log("### utc millis = ",(l+(k.getTimezoneOffset()*60000)));}l=l-(k.getTimezoneOffset()*60000);if(window.console&&window.console.log&&m){window.console.log("### final millis = ",l);
window.console.log("### millis as date = ",new Date(l));window.console.log("### millis as utc date = ",new Date(l).toUTCString());
window.console.log("### summerTime = ",j);window.console.log("### winterTime = ",i);window.console.log("### end getAmsterdamDSTOffset_minusTZ");
}if(l>j&&l<i){return -120;}return -60;};g.getAmsterdamDSTOffsetTime=function(p,i,k){if(window.console&&window.console.log&&k){window.console.log("\n\n### getAmsterdamDSTOffsetTime:: date =",p);
window.console.log("### utc str=",p.toUTCString());}var o=(typeof i!=="undefined")?i:false;var q=g.getAmsterdamDSTSummerBoundary(p);
var l=g.getAmsterdamDSTWinterBoundary(p);var m=p.getTime();var n=m+(p.getTimezoneOffset()*60000);if(window.console&&window.console.log&&k){window.console.log("### utcMillis   = ",n);
window.console.log("### localMillis = ",m);}var j=n;if(o===true){j=m;}if(window.console&&window.console.log&&k){window.console.log("### compareMillis as date = ",new Date(j).toUTCString());
window.console.log("### end getAmsterdamDSTOffsetTime\n");}if(j>=q&&j<l){return -120;}return -60;};g.assessDates=function(k,r,l){var m=g.getAmsterdamDSTOffsetTime(k,true);
var j=g.getAmsterdamDSTOffsetTime(r,true);var n=j-m;if(window.console&&window.console.log&&l){window.console.log("\n###----------------------------");
window.console.log("### DateUtils.assessDates pStartDate=",k," ***");window.console.log("### DateUtils.assessDates pEndDate  =",r," ***");
window.console.log("### DateUtils.assessDates startDstOffset (local)=",m);window.console.log("### DateUtils.assessDates endDstOffset (local)=",j);
window.console.log("### DateUtils.assessDates startDstOffset (utc)=",g.getAmsterdamDSTOffsetTime(k,false));window.console.log("### DateUtils.assessDates endDstOffset (utc)  =",g.getAmsterdamDSTOffsetTime(r,false));
window.console.log("### DateUtils.assessDates dstOffsetDiff  =",n);}var s=g.getTzOffsetDiff(k,r,l);var i=g.isSummerDSTBoundary(k,false);
var p=g.isWinterDSTBoundary(k,false);var q=Math.round(g.getNumMinutes(k,r));var o=Math.round(g.getNumMinutes(k,r,true));if(window.console&&window.console.log&&l){window.console.log("### DateUtils.assessDates pStartDate isSummerDST =",i);
window.console.log("### DateUtils.assessDates pStartDate isWinterDST =",p);window.console.log("### DateUtils.assessDates numMinutes diff      (with tz)    =",q);
window.console.log("### DateUtils.assessDates numMinutes diff (disregard tz)    =",o);window.console.log("###----------------------------\n");
}return{startDstOffset:m,endDstOffset:j,dstOffsetDiff:n,tzOffsetDiff:s,isSummerDST:i,isWinterDST:p,numMinutesTz:q,numMinutesNoTz:o};
};g.convertMinutesToUnit=function(k,i){var j;switch(i){case"month":j=k/60/24/7+" weeks";break;case"week":case"day":j=k/60/24+" days";
break;case"hour":j=k/60+" hours";break;case"minute":j=k+" minutes";break;}return j;};g.timezoneShiftDate=function(u,i,n,l,p,m){var t,r,k,j,o,s;
var q=(i===g.__FWD)?1:-1;t=u.getTimezoneOffset();r=t-n;r*=q;k=new Date(u.getTime());j=(k.getTime()+(k.getTimezoneOffset()*60000));
o=k.getTimezoneOffset();if(window.console&&window.console.log&&p<m){window.console.log("\n## timezoneShiftDate:: now=",k,"offset=",o);
window.console.log("### formatting ",l," date.utc=",u.toUTCString());}k.setTime(j-((k.getTimezoneOffset()+r)*60000));if(window.console&&window.console.log&&p<m){window.console.log("### now -1=",k,"offset=",k.getTimezoneOffset());
window.console.log("### re-assessed amsOffset = ",g.getAmsterdamDSTOffset_minusTZ(k));}if(k.getTimezoneOffset()!==o){s=k.getTimezoneOffset()-o;
s*=q;if(window.console&&window.console.log&&p<m){window.console.log("### -----------------------------------reappliedOffset=",s);
}j=(k.getTime()+(k.getTimezoneOffset()*60000));k.setTime(j-((k.getTimezoneOffset()-s)*60000));if(window.console&&window.console.log&&p<m){window.console.log("### nowagain=",k,"offset=",k.getTimezoneOffset());
}}if(window.console&&window.console.log&&p<m){window.console.log("### formatting localOffset=",t);window.console.log("### formatting amsOffset=",n);
window.console.log("### formatting applied offset=",r);window.console.log("### formatting direction=",q);window.console.log("### end timezoneShiftDate \n");
}return k;};g.timezoneShiftPseudoDate=function(n,x,i,j,o){if(window.console&&window.console.log&&o){window.console.log("\n### timezoneShiftPseudoDate:");
window.console.log(j," ### pDate=",n,"offset=",n.getTimezoneOffset());window.console.log(j," ### date utc = ",n.toUTCString());
window.console.log(j," ### pAmsOffset = ",x);window.console.log(j," ### pIsoOutput = ",i);}var k=g.getUTCValues(n,i);k.utcHours=parseInt(k.hours,10);
var q=parseInt(k.hours,10)-(x/60);if(q>23){q-=24;}q=Date.padded2(q);k.hours=q;var r=n.getTime()+(n.getTimezoneOffset()*60000);
var t=n.getTimezoneOffset()-x;var s=r-((n.getTimezoneOffset()-t)*60000);var l=new Date(s);var p=l.getFullYear();var u=l.getMonth();
var z=l.getDate();var w=g.__DAYS_SHORT[l.getDay()];var A=g.__MONTHS_SHORT[u];k.date=(k.date!==z)?z:k.date;if(k.month!==u){k.month=u;
if(i===true){k.month+=1;}}else{k.month=k.month;}k.year=(k.year!==p)?p:k.year;k.namedDay=(k.namedDay!==w)?w:k.namedDay;k.namedMonth=(k.namedMonth!==A)?A:k.namedMonth;
if(window.console&&window.console.log&&o){window.console.log(j," ### psDateObj=",k);window.console.log(j," ### amsDate=",l);
window.console.log(j," ### amsDate day,date,y= ",w," ",z," ",p);}var v=" ";var B=k.namedDay+v+k.namedMonth+v+k.date+v+k.year+v+k.hours+":"+k.minutes;
if(window.console&&window.console.log&&o){window.console.log(j," ### pseudoDateStr=",B);}return k;};g.getUTCValues=function(p,s){var l=(typeof s!=="undefined")?s:false;
var i=p.toUTCString();var r=i.split(" ");var o=p.getUTCMonth();if(l){o+=1;}var j=r[0];j=j.substring(0,j.length-1);var n=r[2];
var k=p.toString().split(" ");var m=k[5]+" "+k[6];var q={};q.year=p.getUTCFullYear();q.month=o;q.date=p.getUTCDate();q.hours=Date.padded2(p.getUTCHours());
q.minutes=Date.padded2(p.getUTCMinutes());q.seconds="00";q.namedDay=j;q.namedMonth=n;q.tz=m;return q;};g.formatPseudoDate=function(x,v){v=v+"";
var z="";var o=0;var s="";var k="";var t=x.year+"";var j=x.month;var p=x.namedMonth;var r=x.date;var i=x.namedDay;var w=x.hours;
var q=x.minutes;var n=x.seconds;var l=x.tz;var u={};u.y="'"+t.substring(2,4);u.yyyy=t;u.yy=t.substring(2,4);u.m=j;u.mm=Date.padded2(j);
u.N=p;u.d=r;u.dd=Date.padded2(r);u.D=i;u.H=w;u.M=q;u.S=n;u.T=l;while(o<v.length){s=v.charAt(o);k="";while((v.charAt(o)==s)&&(o<v.length)){k+=v.charAt(o++);
}if(u[k]!=null){z=z+u[k];}else{z=z+k;}}return z;};g.convertUTCTimestampToAMSDate=function(k){var j=new Date(k);var l=g.convertToUTC(j);
var i=g.getAmsterdamDSTOffset(l);j=g.convertToOffset(j,i);return j;};g.convertToAmsterdamTimezone=function(i){var l=moment(i);
var j=l.isDST();if(!j){l.add(1,"hour");}var k=moment.tz(l.format(),"Europe/Amsterdam");return moment(k).valueOf();};g.getUserFriendlyDate=function(o,n,m){var p="th",i,q,r;
var l=new Date(o);if(n){l.setDate(l.getDate()-1);}i=l.getDate();var k=m||"%B %e";r=d.time.format(k)(l);q=c.last(String(i));
if(q==="1"&&i!==11){p="st";}if(q==="2"&&i!==12){p="nd";}if(q==="3"&&i!==13){p="rd";}var j=r+p;return j;};return g;});define("chartutil/object2csv",["lodash","json"],function(a,c){var b={convert:function(h,i){var f=typeof i==="function";try{b.checkParams(h);
}catch(e){if(f){setTimeout(function(){i(e);},100);}else{throw e;}}var g=b.createColumnTitles(h);var d=b.createColumnContent(h,g);
if(f){setTimeout(function(){i(null,d);},100);}else{return d;}},checkParams:function(e){e.data=e.data||[];if(!Array.isArray(e.data)){e.data=[e.data];
}if(!e.fields&&(e.data.length===0||typeof e.data[0]!=="object")){throw new Error('params should include "fields" and/or non-empty "data" array of objects');
}if(!e.fields){var d=e.data.map(function(f){return Object.keys(f);});d=a.flatten(d);e.fields=a.uniq(d);}if(e.fieldNames&&e.fieldNames.length!==e.fields.length){throw new Error("fieldNames and fields should be of the same length, if fieldNames is provided.");
}e.fieldNames=e.fields.map(function(g,f){if(e.fieldNames&&typeof g==="string"){return e.fieldNames[f];}return(typeof g==="string")?g:(g.label||g.value);
});e.del=e.del||",";e.eol=e.eol||"";e.quotes=typeof e.quotes==="string"?e.quotes:'"';e.doubleQuotes=typeof e.doubleQuotes==="string"?e.doubleQuotes:[].join(e.quotes);
e.defaultValue=e.defaultValue;e.hasCSVColumnTitle=e.hasCSVColumnTitle!==false;e.includeEmptyRows=e.includeEmptyRows||false;
},createColumnTitles:function(e){var d="";if(e.hasCSVColumnTitle){e.fieldNames.forEach(function(f){if(d!==""){d+=e.del;}d+=c.stringify(f).replace(/\"/g,e.quotes);
});}return d;},replaceQuotationMarks:function(g,d){var e=g.length-1;if(g[0]==='"'&&g[e]==='"'){var f=g.split("");f[0]=d;f[e]=d;
g=f.join("");}return g;},createColumnContent:function(e,d){e.data.forEach(function(f){if(f&&(Object.getOwnPropertyNames(f).length>0||e.includeEmptyRows)){var g="";
var h=e.newLine||"\n";e.fields.forEach(function(j){var m;var i=e.defaultValue;if(typeof j==="object"&&"default" in j){i=j["default"];
}if(j&&(typeof j==="string"||typeof j.value==="string")){var k=(typeof j==="string")?j:j.value;m=a.get(f,k,i);}else{if(j&&typeof j.value==="function"){m=j.value(f);
}}if(m===null||m===undefined){m=i;}if(m!==undefined){var l=c.stringify(m);if(typeof m==="object"){l=c.stringify(l);}if(e.quotes!=='"'){l=b.replaceQuotationMarks(l,e.quotes);
}l=l.replace(/\\\\/g,"\\");if(e.excelStrings&&typeof m==="string"){l='"="'+l+'""';}g+=l;}g+=e.del;});g=g.substring(0,g.length-1);
g=g.split("\\\\").map(function(i){return i.replace(/\\"/g,e.doubleQuotes);}).join("\\\\");g=g.replace(/\\\\/g,"\\");if(d!==""){d+=h+g+e.eol;
}else{d=g+e.eol;}}});return d;}};return b;});define("chartutil/stringutils",[],function(){var a={};a.capitalSeparator=function(c){var e=c.match(/[A-Z][a-z]*/g);if(window.console&&console.log){console.log("### stringutils::capitalSeparator:: capitals=",e);
}if(e[e.length-1].length<2){return c;}var b=e.join(" ").toLowerCase();var d=b.charAt(0).toUpperCase()+b.slice(1);return d;
};a.camelToDash=function(c){var b=c.replace(/\W+/g,"-").replace(/([a-z\d])([A-Z])/g,"$1-$2");return b.toLowerCase();};a.camelToDash2=function(c){function b(d){return"-"+d.toLowerCase();
}return c.replace(/[A-Z]/g,b);};a.capitaliseFirstLetter=function(b){return b.charAt(0).toUpperCase()+b.slice(1);};a.lowercaseFirstLetter=function(b){return b.charAt(0).toLowerCase()+b.slice(1);
};a.capitaliseAllFirstLetters=function(f){var c=f.toLowerCase();var e=c.split(" ");for(var d=0,b=e.length;d<b;d++){e[d]=a.capitaliseFirstLetter(e[d]);
}return e.join(" ");};a.camelCase=function(c){var b=a.capitaliseAllFirstLetters(c);b=a.replaceSpace(b);b=a.lowercaseFirstLetter(b);
return b;};a.wordWrap=function(f,e,c){c=c||"\n";e=e||75;if(!f){return f;}if(f.length<=e){return f;}var d="(.{1,"+e+"})[a-z](?=[A-Z]\\S)|\\S+?(\\s|$)";
var b=f.match(new RegExp(d,"g"));return b.join(c);};a.testWhite=function(b){var c=new RegExp(/^\s$/);return c.test(b.charAt(0));
};a.testCapital=function(b){var c=new RegExp(/[A-Z]/);return c.test(b.charAt(0));};a.testUnderscore=function(b){var c=new RegExp(/\_/);
return c.test(b.charAt(0));};a.getUrlParameter=function(b){var e=window.location.search.substring(1);var d=e.split("&");for(var c=0;
c<d.length;c++){var f=d[c].split("=");if(f[0]===b){return f[1];}}};a.classNameFormatter=function(d){var c=(d).match(/[^\s]+/)[0].toLowerCase();
var e=new RegExp(/(.*)(by)(.*)/);var b=c.match(e);if(b===null){return c;}var f=a.capitaliseFirstLetter(b[3]);return b[1]+f;
};a.lowerCaseReplaceSpace=function(d,b){var c=b||"";return String(d).toLowerCase().replace(/\s/g,c);};a.replaceSpace=function(d,b){var c=b||"";
return String(d).replace(/\s/g,c);};return a;});define("chart/widgetFramework/core/constants/WidgetConstants",["jquery"],function(b){var a={HORIZONTAL:"horizontal",VERTICAL:"vertical",STACKED_HORIZONTAL:"stackHorizonta;",STACKED_VERTICAL:"stackVertical",FULL_HORIZONTAL:"fullHorizontal",FULL_VERTICAL:"fullVertical"};
a.getNamespaced=function(d,c){if(typeof d!=="string"){return d;}return d.split(/\s+/g).join("."+c+" ")+"."+c;};return a;});
define("chartutil/domUtils",["jquery","lodash","chartutil/object2csv"],function(g,e,c){var b=["font-family","font-size","font-weight","font-style","color","text-transform","text-decoration","letter-spacing","word-spacing","line-height","text-align","vertical-align","direction","background-color","background-image","background-repeat","background-position","background-attachment","opacity","width","height","top","right","bottom","left","margin-top","margin-right","margin-bottom","margin-left","padding-top","padding-right","padding-bottom","padding-left","border-top-width","border-right-width","border-bottom-width","border-left-width","border-top-color","border-right-color","border-bottom-color","border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style","position","display","visibility","z-index","overflow-x","overflow-y","white-space","clip","float","clear","cursor","list-style-image","list-style-position","list-style-type","marker-offset"];
var f={};var d=document.body;var a=document.documentElement;f.getComputedProperties=function(k){if(typeof(k)==="undefined"){return;
}var j={},m=b.length,l=g(k).parent(),n=k;if(l.length>0){g.each(g(k).parents(),function(i,o){if(g(o).is("body")){return false;
}if(g(o).parent().length<1){n=o;g(n).hide();g("body").append(n);return false;}});}for(var h=0;h<m;h++){j[b[h]]=g(k).css(b[h]);
}j.computedWidth=g(k).width();j.computedHeight=g(k).height();if(l.length<=0||n!==k){g(n).detach();}g(n).show();return j;};
f.cloneNode=function(h,j){var i,k;if(typeof h==="object"){if(h instanceof g){i=h[0];}else{i=h;}}else{if(typeof h==="string"){i=g(h)[0];
}}k=i.cloneNode(true);k.id=j;return k;};f.applyStylesAsInline=function(n,l){var m=[];var i,h;var k=function(r,q){i=r;h=e.find(document.styleSheets,function(s){if(s.href&&s.href.indexOf(i)>-1){return s;
}});m.push(h);};l.forEach(k);var o,p;var j=function(s){o=s.cssRules;p=o.length;var t=function(u,v){v.style.cssText+=o[q].style.cssText;
};for(var q=0;q<p;q++){if(o[q].selectorText&&o[q].selectorText.indexOf(":hover")>-1||o[q].selectorText&&o[q].selectorText.indexOf(":after")>-1||o[q].selectorText&&o[q].selectorText.indexOf(":before")>-1||o[q].selectorText&&o[q].selectorText.indexOf(":first-letter")>-1){continue;
}var r=(o[q].selectorText)?o[q].selectorText.substring(1):"";if(g(n).hasClass(r)){n.style.cssText+=o[q].style.cssText;}g(n).find(o[q].selectorText).each(t);
}};m.forEach(j);};f.nodeToString=function(i){var h=new XMLSerializer();var j=h.serializeToString(i);return j;};f.nodeToBlob=function(j,i){var h=f.nodeToString(j);
return f.stringToBlobUrl(h,i);};f.stringToBlobUrl=function(l,h){var k=window.URL||window.webkitURL||window;var i=new Blob([l],{type:h});
var j=k.createObjectURL(i);return j;};f.createDownloadLink=function(k,i,j,l){var h=document.getElementById("drawAnchor")||document.createElement("a");
g(h).attr("id","drawAnchor");g(h).css("display","none");document.body.appendChild(h);h.download=i+j;h.href=k;if(l){h.click();
}return h;};f.createCSV=function(l,o,j,h){var n={data:l,fields:o,fieldNames:j,quotes:""};var i=c.convert(n);var k=f.stringToBlobUrl(i,"text/html");
var m=f.createDownloadLink(k,h,".csv",true);};f.getScrollTop=function(){if(typeof pageYOffset!=="undefined"){return pageYOffset;
}return a.clientHeight?a.scrollTop:d.scrollTop;};f.getScrollLeft=function(){if(typeof pageXOffset!=="undefined"){return pageXOffset;
}else{return a.clientWidth?a.scrollLeft:d.scrollLeft;}};f.removeDataAtrributes=function(r,h){var p,m=g(r),k=[],l=m.get(0).attributes,n=l.length;
for(p=0;p<n;p++){if(h){for(var o=0,q=h.length;o<q;o++){if(l[p].name===("data-"+h[o])){k.push(l[p].name);}}}else{if(l[p].name.substring(0,5)==="data-"){k.push(l[p].name);
}}}g.each(k,function(i,j){m.removeAttr(j);});};return f;});define("chart/widgetFramework/core/mixins/widgetScales",["d3","underscore","util/Functional","chartutil/dateUtils_CET"],function(c,a,b,e){var d={};
d.getOrdinalXScale=function(f){return function(){this.scales[f]=c.scale.ordinal().rangeBands([0,this.width],this.options.barPadding,this.options.outerPadding);
};};d.getLinearXScale=function(f){return function(){this.scales[f]=c.scale.linear().rangeRound([0,this.width]);};};d.getTimeXScale=function(f){return function(){this.scales[f]=c.time.scale().range([0,this.width]);
};};d.getCalibrateOrdinalXScale=function(f){return function(){this.scales[f].domain(a.pluck(this.data,f));if(this.options.barWidth!==null){this.scales[f].rangeBands([0,this.width],this.options.barPadding,this.options.outerPadding);
}};};d.getCalibrateLinearXScale=function(f,g){return function(){var h=d.getDomainFromDataExtremes(this.data,f,g.nestedXAttr);
if(b.falsy(g.allowFullLinearRange)){h[0]=0;}else{if(h[0]>0){h[0]=0;}else{if(h[0]<0&&h[1]<0){h[1]=0;}}}if(this.maxXScale){h[1]=this.maxXScale;
}this.scales[f].domain(h);if(g.niceScale){if(b.notFalsy(g.ticks)){this.scales[f].nice(g.ticks);}else{this.scales[f].nice();
}}};};d.getCalibrateTimeXScale=function(f,g){return function(){var i=d.getDomainFromDataExtremes(this.data,f,g.nestedXAttr);
this.scales[f].domain(i);if(!a.isDate(i[0])&&!a.isDate(i[1])){return;}if(this.configData&&this.configData.granularity==="day"){var k=e.assessDates(i[0],i[1],false);
if(k.tzOffsetDiff<0){var h=this.scales[f].ticks(c.time[this.configData.granularity],1);var j=h[h.length-1].getHours();if(j!==0){var l=new Date(i[1].getFullYear(),i[1].getMonth(),i[1].getDate(),j);
i[1]=l;this.scales[f].domain(i);}}}};};d.getOrdinalYScale=function(f){return function(){this.scales[f]=c.scale.ordinal().rangeBands([this.height,0],this.options.barPadding,this.options.outerPadding);
};};d.getLinearYScale=function(f){return function(){this.scales[f]=c.scale.linear().rangeRound([this.height,0]);};};d.getCalibrateOrdinalYScale=function(f){return function(){this.scales[f].domain(a.pluck(this.data,f));
if(this.options.barHeight!==null){this.scales[f].rangeBands([this.height,0],this.options.barPadding,this.options.outerPadding);
}};};d.getCalibrateLinearYScale=function(f,g){return function(){var h=d.getDomainFromDataExtremes(this.data,f,g.nestedYAttr);
if(b.falsy(g.allowFullLinearRange)){h[0]=0;}else{if(h[0]>0){h[0]=0;}}this.scales[f].domain(h);if(g.niceScale){if(b.notFalsy(g.ticks)){this.scales[f].nice(g.ticks);
}else{this.scales[f].nice();}}};};d.getDomainFromDataExtremes=function(k,f,j){if(b.falsy(k)){return[0,0];}if(typeof j==="undefined"){j=null;
}var i=(j!==null)?j:f;if(!a.isArray(k)){k=[k];}var g=a.pluck(k,i);g=a.map(g,function(l){if(a.isArray(l)){return a.pluck(l,f);
}return l;});g=a.flatten(g);var h=[c.min(g),c.max(g)];return h;};return d;});define("chart/widgetFramework/core/constants/UIConstants",["jquery"],function(b){var a={CHART_INITIALISED:"chartInitialised",CHART_UPDATED:"chartUpdated",WIDGET_CREATED:"widgetCreated",OBSERVABLE_CREATED:"observableCreated",WIDGET_APP_STARTUP:"widgetAppStartup",CHART_FIRST_RENDER:"chartFirstRender",CHART_TO_VIEW_EVENT:"chartToWidgetEvent",CHART_RENDERED:"chartRendered"};
a.getNamespaced=function(d,c){if(typeof d!=="string"){return d;}return d.split(/\s+/g).join("."+c+" ")+"."+c;};return a;});
define("chartutil/d3utils",["jquery","underscore","d3","chartutil/dateUtils_CET","chartutil/stringutils"],function(e,a,c,g,f){var b={};
b.constants={};b.constants.MILLISECONDS_UNIT="ms";b.constants.granularityFormats=[];b.constants.granularityFormats.month=c.time.format.utc("%b");
b.constants.granularityFormats.week=function(h){return"wk "+h.getWeek();};b.constants.granularityFormats.day=c.time.format.utc("%e");
b.constants.granularityFormats.hour=function(i){var h=g.getAmsterdamDSTOffset(i);return new Date(i.getTime()+h*60*1000).getUTCHours();
};b.constants.granularityFormats.minute=c.time.format.utc("%_M");b.constants.granularityFormatsNonUTC={};b.constants.granularityFormatsNonUTC.minute=c.time.format("%M");
b.constants.granularityFormatsNonUTC.hour=c.time.format("%H");b.constants.granularityFormatsNonUTC.day=c.time.format("%d");
b.constants.granularityFormatsNonUTC.week=function(h){return"wk "+h.getWeek();};b.constants.granularityFormatsNonUTC.month=c.time.format.utc("%b");
b.thousandsFormatter=function(o,n,k){var l=k.ticks();var h=c.max(k.domain());var q=[{suffix:"M",value:1000000},{suffix:"K",value:1000},{suffix:"",value:1}];
var r=a.chain(q).find(function(i){return(h>=i.value);}).value();if(!r){r={suffix:"",value:1};}var j=a.chain(l).map(function(i){return(i/r.value);
}).value();var p=a.chain(j).filter(function(i){return(i%1!==0);}).value();var m=(o/r.value);if(n===0){return(String(m)+r.suffix);
}if(p.length>0){return m.toFixed(1);}return String(m);};b.numberFormatter=function(l,j){var i=[{suffix:"M",value:1000000},{suffix:"k",value:1000},{suffix:"",value:1}];
var k=c.formatPrefix(l).symbol;var h=a.filter(i,function(m){return m.suffix===k;});if(h.length){l=l/h[0].value;}else{k="";
}return(!j)?l+k:l;};b.percentageFormat=function(i){var h=i.selectAll("text");h.text(function(k,j){if(j<(h[0].length-1)){return this.textContent.replace("%","");
}return this.textContent;});};b.lastPercentageFormat=function(k,i){var l=i||5;var j=k.selectAll("text");var h;j.text(function(o,m){var n=this.textContent.replace("%","");
if(m===(j[0].length-1)){n+="%";h=c.select(this);}return n;});if(h){h.transition().duration(150).ease("linear").attr("x",l);
}};b.smartPercentageFormat=function(i){var j=true;var h=i.selectAll("text");h.each(function(n,l){var m=this.textContent.replace("%","");
var k=Number(m);if(k%1!==0){j=false;}});h.text(function(m,k){var l=this.textContent.replace("%","");if(j){if(l.indexOf(".")>-1){l=l.substring(0,l.indexOf("."));
}}if(k===h[0].length-1){l+="%";}return l;});};b.steppedLineInterpolator=function(m,q){var l=0,k=m.length,h=m[0],s=[h[0]-q,",",h[1]],j=0,r=0,o=0;
while(++l<k){j=h[0];h=m[l];r=h[0];o=h[1];s.push("H",j+q);s.push("L",r-q,",",o);}if(k>1){s.push("H",h[0]+q);}return s.join("");
};b.movingAverageInterpolator=function(h){return function(i){var j=i;i=i.map(function(o,k){var p=k+h-1;var n,m;if(p<i.length){n=j.slice(k,p+1);
m=a.reduce(n,function(r,q){return[r[0]+q[0],r[1]+q[1]];});var l=m.map(function(q){return[q[0],q[1]/h];});return l;}return undefined;
});i=i.filter(function(k){return typeof k!=="undefined";});return i.join("L");};};b.fillUTCScaleBuckets=function(j,m,l,i){var n;
switch(m){case"week":n=c.time.monday.utc.range;break;default:n=c.time[m].utc;break;}var h=c.time.scale.utc().range([0,1],0);
h.domain(j);var k=e.map(h.ticks(n,1),function(p,o){var q=g.convertToUTC(p);var r=a.find(l,function(v){var u=v.get("date");
var t=v.get("utcdate");switch(m){case"month":case"week":case"day":return u.getTime()===p.getTime();default:return t.getTime()===q.getTime();
}});if(r){return r;}else{var s=new i();s.set("date",p);s.set("utcdate",q);return s;}});return k;};b.fillTimeScaleBuckets=function(j,m,l,i){var n;
n=c.time[m];var h=c.time.scale().range([0,1],0);h.domain(j);var k=e.map(h.ticks(n,1),function(p,o){var q=g.convertToUTC(p);
var r=a.find(l,function(v){var u=v.get("date");var t=v.get("utcdate");g.roundToDay(u);return u.getTime()===p.getTime();});
if(r){return r;}else{var s=new i();s.set("date",p);s.set("utcdate",q);return s;}});return k;};b.fillTimeScaleBucketsNonBackbone=function(i,l,k){var m;
m=c.time[l];var h=c.time.scale().range([0,1],0);h.domain(i);var j=e.map(h.ticks(m,1),function(o,n){var p=g.convertToUTC(o);
var q=a.find(k,function(u){var t=u.date;var s=u.utcdate;g.roundToDay(t);return t.getTime()===o.getTime();});if(q){return q;
}else{var r={authorisations:0,total:0,abandoned:0,authRate:0,averageRate:null,averageTotal:null,rates:[]};r.date=o;r.utcdate=p;
return r;}});return j;};b.fillTimeScaleBucketsFromTemplate=function(o,j,i,k){var l;l=c.time[j];var n=c.time.format("%Y-%m-%d");
var m=c.time.scale().range([0,1],0);m.domain(o);var h=m.ticks(l,1);var p=e.map(h,function(r,q){var s=a.find(i,function(x){var v=x.date;
var w=g.trueRoundToDay(v,true);var y=g.trueRoundToDay(r,true);var u=w.getTime()===y.getTime();return u;});if(s){return s;
}else{var t=k.apply(null);t.date=r;t.dateStr=n(r);return t;}});return p;};b.spreadTimeAxisTicks=function(j){var i=j.xAxis.selectAll(".tick")[0].length,h=(j.width/i);
var k=j.xAxis.selectAll(".tick").attr("transform",function(m,l){return"translate("+((h*(l+1))-(h/2))+",0)";}).select("text").attr("transform",function(){return"translate(0,7)";
}).each(function(m,l){e(this).show();});};b.spreadXAxisTicks=function(l,k,j){if(k===0){k=7;}var i=j.selectAll(".tick")[0].length,h=(l.width/i);
var m=j.selectAll(".tick").attr("transform",function(o,n){return"translate("+((h*(n+1))-(h/2))+","+0+")";}).select("text").attr("transform",function(){return"translate(0,"+k+")";
}).each(function(o,n){e(this).show();});};b.spreadYAxisTicks=function(j,l,i){var h=i.selectAll(".tick")[0].length,m=(j.height/h);
var k=i.selectAll(".tick").attr("transform",function(o,n){return"translate("+0+","+((m*(n+1))-(m/2))+")";}).select("text").attr("transform",function(){return"translate("+l+","+0+")";
}).each(function(o,n){e(this).show();});};b.spreadTimeYAxisTicks=function(j){var h=j.yAxis.selectAll(".tick")[0].length,i=(j.height/h);
var k=j.yAxis.selectAll(".tick").attr("transform",function(m,l){return"translate(0,"+(j.height-((i*(l+1))-(i/2)))+")";}).select("text").each(function(m,l){e(this).show();
});};b.onAnimationsComplete=function(h,i){c.timer(function(){var j=0;h.$el.find("rect, line, g").each(function(k,l){if(typeof l.__transition__!=="undefined"){j++;
}});if(j===0){i.apply(h,[arguments]);return true;}});};b.closestPointOnLine=function(m,h){var l=Infinity,k=null,j=0;a.each(m.pathSegList,function(o,n){var p=i(o,h);
if(p<l){l=p;k=o;j=n;}});return{segment:k,index:j,distance:l};function i(q,p){var o=q.x-p[0],n=q.y-p[1];return o*o+n*n;}};
b.preventTickOverlap=function(k){var s=c.select(k).selectAll(".tick").style("visibility","hidden"),i=k.getBoundingClientRect().width,v=k.getBoundingClientRect().height,t=0,r=4,u=s[0].length,h=0,m=0,q=0;
var p=e(k).attr("class");if(p.indexOf("x axis")>-1){q="horizontal";}else{if(p.indexOf("y axis")){q="vertical";}}for(var l=0;
l<u;l++){var o=s[0][l],n=s[0][l+1];if(!o||!n||!o.getBoundingClientRect||!n.getBoundingClientRect){continue;}if(q==="vertical"){m=Math.max(m,o.getBoundingClientRect().height);
t=v;}else{if(q==="horizontal"){m=Math.max(m,o.getBoundingClientRect().width);t=i;}}}if(m>(t/u)){h=Math.floor(t/(m+r));var w=Math.ceil(u/h);
c.select(k).selectAll(".tick").filter(function(x,j){return(j%w)===0;}).style("visibility","visible");}else{c.select(k).selectAll(".tick").style("visibility","visible");
}};b.highlightCurrentDay=function(p,k,h){if(h){var m=new Date();var i=m.getDate();var o=m.getMonth();var l=m.getFullYear();
var q=a.first(h).date.getMonth();var n=a.first(h).date.getFullYear();var j=function(s,t){var u=document.createElementNS("http://www.w3.org/2000/svg",s);
for(var r in t){u.setAttribute(r,t[r]);}return u;};p.find("."+k+" .tick text").each(function(s){var r=e(this).text();if(s===0){r=r.replace(/\D/g,"");
}if(Number(r)===i&&q===o&&l===n){e(this).after(j("rect",{y:21,x:-6,height:3,width:12,fill:"#f1bf43"}));}});}};b.lineCreator=function(q,s,i,o,k,n){var w,m,r,v;
if(n){w=n.attr("d");}if(w){m=w.split(q);var l=s.length;r=m.length;if(l>r){k="mixin";}else{return w;}}var j=c.svg.line().interpolate("linear").x(i);
if(k==="enter"){j.y(function(x){return 0;});}else{if(k==="update"){j.y(o);}else{if(k==="mixin"){j.y(function(x){return 0;
});v=j(s);var u=v.split(q);var t=a.drop(u,r);var p=m.concat(t);var h=p.join(q);n.style("opacity",0.000001);return h;}}}v=j(s);
return v;};var d=0;b.checkLabelPos=function(h,k,l,o){var n=k.length;for(var m=0;m<n;m++){var j=k[m].targetY;var t=k[m].order;
var s=k[m].who;var q=Math.floor(j-h);if(d===0){if(q<0){d=1;}else{d=-1;}}var p=4*d;var r=q;if(r<0){r*=-1;}if(r<12){h+=p;return b.checkLabelPos(h,k,l,o);
}}d=0;k.push({targetY:h,order:l,who:o});return h;};b.getJoinAttrNoSpaces=function(k,h){var i=h||"";var l=this._getDatumValue(k,this.options.joinAttr);
var j=f.lowerCaseReplaceSpace(l,i);return j;};b.getCollectionSum=function(i,h){var j=a.reduce(i,function(k,l){return k+l[h];
},0);return j;};b.detectNestedArrays=function(h,j){var i=[];a.each(h,function(k){a.each(k,function(m,l){if(a.isArray(m)){if(j){i.push(l);
}else{i.push(m);}}});});if(j){i=a.uniq(i);}return i;};b.cloneSelection=function(i,h){i.each(function(){var j=h.node().appendChild(this.cloneNode(true));
j.setAttribute("data-clone","");});return h.selectAll("[data-clone]");};b.formatAmount=function(j,h){if(!a.isNumber(j)){return"";
}if(!a.isString(h)){return"";}var i=["IDR","JPY","KRW","VND","BYR","CVE","DJF","GHC","GNF","KMF","PYG","RWF","UGX","VUV","XAF","XOF","XPF"];
var k=a.indexOf(i,h.toUpperCase());if(k>=0){return j;}else{return c.format(",.2f")(j/100);}};b.formatAmountStringsAllowed=function(i,h){if(typeof i==="string"&&i.match(/^\d+(\.\d+)?$/)){return b.formatAmount(parseFloat(i),h);
}return b.formatAmount(Number(i),h);};b.getActualTickValues=function(h){var j=[];var i=h.selectAll("text");i.each(function(p,m){var n=/[^0-9\.]/gi;
var l=n.exec(this.textContent);var o=this.textContent.replace(/[^0-9\.]/gi,"");var k=Number(o);if(l){switch(l[0]){case"%":break;
case"k":k*=1000;break;case"M":k*=1000000;break;}}j.push(k);});return j;};return b;},function(a){if(window.console&&console.log){console.log("APP JS ERROR =",a);
}});define("chart/widgetFramework/core/constants/DataConstants",["jquery"],function(b){var a={TIMELINE:"timelineTimespanSet",TIME_INFO_SET:"timeInfoSet",DATA_FORMATTED:"dataFormatted",NEW_DATA_AVAILABLE:"newDataAvailable",DATA_LOADED:"datasetDataLoaded",FETCH_EXISTING_DATA:"fetchExistingData",FETCH_DATA_WITH_PARAMS:"fetchDataWithParams",DATA_FETCHER:"chart/widgetFramework/core/DataFetcher",RETRIEVED_DATA:"retrievedData",SORTED_DATA:"sortedData",REFORMATTED_DATA:"reformattedData",HALT_RENDER_PROCESS:"haltRenderProcess",FORMATTER_INFORM_WIDGET:"formatterToWidgetEvent",FETCH_DATA_SUCCESS:"fetchDataSuccess",FETCH_DATA_ERROR:"fetchDataError"};
a.getNamespaced=function(d,c){if(typeof d!=="string"){return d;}return d.split(/\s+/g).join("."+c+" ")+"."+c;};return a;});
define("chart/widgetFramework/core/mixins/barDrawingUtils",["jquery","d3","lodash","chartutil/d3utils","chartutil/stringutils","util/Functional"],function(f,e,b,d,g,c){var a={};
a.chartWidth=500;a.chartHeight=200;a.transitionTime=500;a.delayTime=0;a.delayStackedTime=500;a.barSelectorStr=".bar";a.barClassStr="bar";
a.offsetVerticalBars=true;a.offsetHorizontalBars=true;a.containerBarsHorizontal=function(k,i,p,h){var r=this.transitionTime;
var n=this.delayTime;var j;if(typeof p==="function"){j=p;}else{j=function(s){return s[p];};}var q=k.selectAll(this.barSelectorStr).data(i,j);
var l=q.transition().duration(r).delay(n).attr("transform",function(u,s){var t=h(u,s);return"translate(0,"+t+")";});var o=q.enter().append("g").attr("class",this.barClassStr).attr("transform",function(u,s){var t=h(u,s);
return"translate(0,"+t+")";});var m=q.exit();m.selectAll("rect").transition().duration(r).attr("width",0).style("opacity",0);
m.transition().duration(0).delay(r).remove();this.bars={bar:q,enter:o,update:l,exit:m};return this;};a.barHorizontal=function(n,k,i,j,l){var h=this.transitionTime;
var m=this.delayTime;if(!l){l=this.bars;}l.update.select("rect").each(function(o){e.select(this).classed({"--negative":(o[n]<0),"--positive":o[n]>=0});
}).transition().duration(h).delay(m).attr("x",function(o){return k(Math.min(0,o[n]));}).attr("height",i).attr("width",function(o){return Math.abs(k(o[n])-k(0));
});l.enter.append("rect").attr("class",function(o){if(j&&j!==""){return g.lowerCaseReplaceSpace(o[j],"-");}else{if(o.name){return g.lowerCaseReplaceSpace(o.name,"-");
}}}).each(function(o){e.select(this).classed({"--negative":(o[n]<0),"--positive":o[n]>=0});}).attr("x",function(o){return k(0);
}).attr("width",0).attr("height",i).transition().duration(h).delay(2*m).attr("x",function(o){return k(Math.min(0,o[n]));}).attr("width",function(o){return Math.abs(k(o[n])-k(0));
});l.exit.select("rect").transition().duration(h).attr("width",0).style("opacity",0).remove();};a.stackHorizontal=function(i,q,u,j,l,o){var t=this.transitionTime;
var s=this.delayStackedTime;var p=this.delayTime;var w;if(typeof i==="function"){w=i;}else{w=function(x){return x[i];};}var k;
if(typeof q==="function"){k=q;}else{k=function(x){return x[q];};}var m=(this.offsetHorizontalBars===true)?-j/2:0;if(!o){o=this.bars.bar;
}var r=o.selectAll("rect").data(w,k);var n=r.transition("resize").duration(t).delay(p).attr("height",j).attr("transform",function(){return"translate(0,"+m+")";
}).attr("x",function(x){return u(x.startX);}).attr("y",0).attr("width",function(x){return u(x.endX)-u(x.startX);});var v=r.enter().append("rect").attr("class",function(x){if(l&&l!==""){return"stack "+g.lowerCaseReplaceSpace(x[l],"-");
}else{if(x.name){return"stack "+g.lowerCaseReplaceSpace(x.name,"-");}else{return"stack";}}}).style("fill",function(x){return x.color;
}).attr("transform",function(){return"translate(0,"+m+")";}).attr("height",j).attr("x",function(x){return u(x.startX);}).attr("y",0).attr("width",0).transition().duration(t).delay(function(y,x){return 2*p+(x*s);
}).attr("width",function(x){return u(x.endX)-u(x.startX);});var h=r.exit().transition().duration(t).attr("width",0).style("opacity",0).remove();
this.stacks={stack:r,enter:v,update:n,exit:h};return this;};a.fullBarHorizontal=function(h,i,k){var j=this;if(!k){k=this.bars;
}k.update.select("rect").attr("height",h).attr("width",j.chartWidth);k.enter.append("rect").attr("data-id",function(l){if(typeof l[i]!=="undefined"){return g.lowerCaseReplaceSpace(l[i],"-");
}}).attr("height",h).attr("width",j.chartWidth);k.exit.select("rect").remove();return this;};a.containerBarsVertical=function(k,i,p,h){var r=this.transitionTime;
var n=this.delayTime;var j;if(typeof p==="function"){j=p;}else{j=function(s){return s[p];};}var q=k.selectAll(this.barSelectorStr).data(i,j);
var l=q.transition().duration(r).delay(n).attr("transform",function(t,s){var u=h(t,s);return"translate("+u+",0)";});var o=q.enter().append("g").attr("class",this.barClassStr).attr("transform",function(t,s){var u=h(t,s);
return"translate("+u+",0)";});var m=q.exit();m.selectAll("rect").transition().duration(r).attr("height",0).attr("y",this.chartHeight).style("opacity",0);
m.transition().duration(0).delay(r).remove();this.bars={bar:q,enter:o,update:l,exit:m};return this;};a.barVertical=function(o,h,p,i,k){var m=this;
var n=this.transitionTime;var l=this.delayTime;var j=(this.offsetVerticalBars===true)?-p/2:0;if(!k){k=this.bars;}k.update.select("rect").each(function(q){e.select(this).classed({"--negative":(q[o]<0),"--positive":q[o]>=0});
}).transition().duration(n).delay(l).attr("width",p).attr("transform","translate("+j+",0)").attr("y",function(q){return h(Math.max(0,q[o]));
}).attr("height",function(q){return Math.abs(h(q[o])-h(0));});k.enter.append("rect").attr("class",function(q){if(i&&i!==""){return g.lowerCaseReplaceSpace(q[i],"-");
}else{if(q.name){return g.lowerCaseReplaceSpace(q.name,"-");}}}).each(function(q){e.select(this).classed({"--negative":(q[o]<0),"--positive":q[o]>=0});
}).attr("width",p).attr("transform","translate("+j+",0)").attr("y",function(q){return h(0);}).attr("height",0).transition().duration(n).delay(2*l).attr("y",function(q){return h(Math.max(0,q[o]));
}).attr("height",function(q){return Math.abs(h(q[o])-h(0));});k.exit.select("rect").transition().duration(n).attr("height",0).attr("y",m.chartHeight).style("opacity",0).remove();
return this;};a.stackVertical=function(i,q,j,w,l,o){var t=this.transitionTime;var p=this.delayTime;var s=this.delayStackedTime;
var v;if(typeof i==="function"){v=i;}else{v=function(x){return x[i];};}var k;if(typeof q==="function"){k=q;}else{k=function(x){return x[q];
};}var m=(this.offsetVerticalBars===true)?-w/2:0;if(!o){o=this.bars.bar;}var r=o.selectAll("rect").data(v,k);var n=r.transition("resize").duration(t).delay(p).attr("width",w).attr("transform","translate("+m+",0)").attr("x",0).attr("y",function(x){return j(x.endY);
}).attr("height",function(x){return j(x.startY)-j(x.endY);});var u=r.enter().append("rect").attr("class",function(x){if(l&&l!==""){return"stack "+g.lowerCaseReplaceSpace(x[l],"-");
}else{if(x.name){return"stack "+g.lowerCaseReplaceSpace(x.name,"-");}else{return"stack";}}}).attr("transform","translate("+m+",0)").attr("width",w).attr("height",0).attr("x",0).attr("y",function(x){return j(x.startY);
}).transition().duration(t).delay(function(y,x){return 2*p+(x*s);}).attr("y",function(x){return j(x.endY);}).attr("height",function(x){return j(x.startY)-j(x.endY);
});var h=r.exit().transition().duration(t).attr("height",0).attr("x",0).attr("y",function(x){return j(x.startY);}).style("opacity",0).remove();
this.stacks={stack:r,enter:u,update:n,exit:h};return this;};a.multiBarVertical=function(i,q,j,x,l,o){var v=this.transitionTime,p=this.delayTime,u=this.delayStackedTime,r=this,m=(this.offsetVerticalBars===true)?-x/2:0;
var w;if(typeof i==="function"){w=i;}else{w=function(y){return y[i];};}var k;if(typeof q==="function"){k=q;}else{k=function(y){return y[q];
};}if(!o){o=this.bars.bar;}var n=o.selectAll(".multi-bar").data(w,k);var t=n.transition("move").duration(v).delay(p).attr("width",function(y){return y.barWidth*(1-l);
}).attr("transform",function(C,y){var z=C.barWidth;var A=(z-(z*(1-l)))/2;var B=(-(x/2)+A)+(y*z);return"translate("+B+",0)";
});n.transition("grow").duration(v).delay(function(z,y){return p+(y*u);}).attr("y",function(y){return j(y.value);}).attr("height",function(y){return r.chartHeight-j(y.value);
});var s=n.enter().append("rect").attr("class",function(y){return"multi-bar "+y.name;}).attr("transform",function(C,y){var z=C.barWidth;
var A=(z-(z*(1-l)))/2;var B=(-(x/2)+A)+(y*z);return"translate("+B+",0)";}).attr("width",function(y){return y.barWidth*(1-l);
}).attr("height",0).attr("y",r.chartHeight).transition().duration(v).delay(function(z,y){return 2*p+(y*u);}).attr("y",function(y){return j(y.value);
}).attr("height",function(y){return r.chartHeight-j(y.value);});var h=n.exit().transition().duration(v).attr("y",r.chartHeight).attr("height",0).style("opacity",0).remove();
this.multiBars={multiBars:n,enter:s,update:t,exit:h};return this;};a.fullBarVertical=function(j,i,m,l){var n=l||this.chartHeight;
var k=(this.offsetVerticalBars===true)?-j/2:0;if(!m){m=this.bars;}var h=(i&&typeof i!=="undefined"&&i!=="")?"rect."+i:"rect";
m.update.select(h).each(function(q){if(typeof q[i]!=="undefined"){var o=f(e.select(this).node());var p=g.lowerCaseReplaceSpace(q[i],"-");
o.attr("data-id",p);}}).attr("width",j).attr("height",n).attr("y",0).attr("transform","translate("+k+",0)");m.enter.append("rect").each(function(q){if(typeof q[i]!=="undefined"){var o=f(e.select(this).node());
var p=g.lowerCaseReplaceSpace(q[i],"-");o.attr("data-id",p);}}).attr("class",function(){return(i&&typeof i!=="undefined"&&i!=="")?i:null;
}).attr("width",j).attr("height",n).attr("y",0).attr("transform","translate("+k+",0)");m.exit.select("rect").remove();return this;
};a.barPosition=function(j,i,h,k){if(j){if(typeof i!=="number"){if(window.console&&console.log){console.error("### Renders::barPosition:: you are trying to center bars but haven't provided a value for bandWidth");
}return null;}this.offsetVerticalBars=true;this.offsetHorizontalBars=true;return function(m,l){return((i*l)+(i/2));};}else{if(typeof h!=="function"){if(window.console&&console.log){console.error("### Renders::barPosition:: you are trying to place bars along an axis but haven't provided a value for the scale");
}return null;}this.offsetHorizontalBars=false;this.offsetVerticalBars=false;return function(l){return h(l[k]);};}};a.setBarSelectorStr=function(i){this.barSelectorStr=i;
var h=/\./gi;this.barClassStr=i.substring(1).replace(h," ");};return function(){return Object.create(a);};});define("chart/widgetFramework/core/drivers/tooltipCode",["jquery","underscore","d3","util/Functional","chartutil/domUtils"],function(f,a,c,b,e){var d=function(g){g.setupTooltip=function(m,k){this.setTooltip(m,k,f("body"));
this.tooltipSelector=k.event.selector;this.tooltipEvent=k.event.type;var l=this.el.getBoundingClientRect();var j=document.body.scrollTop;
var h=document.body.scrollLeft;var i={top:l.top+j,left:l.left+h};this.getTooltip().setPosition(i);this.setTooltipsOnElements();
};g.setTooltipsOnElements=function(i){var k=(i===true)?g.width:g.horizBarSize;var h=g.height;var j=this.$el.find(this.tooltipSelector);
j.off(this.tooltipEvent);j.off("mouseout");j.on(this.tooltipEvent,function(y){var q=f(this);var v=this.getBoundingClientRect();
var z=e.getScrollTop();var r=e.getScrollLeft();var n=0;var p=0;if(f("html").hasClass("webkit")){var t=document.getElementsByTagName("html")[0];
var x=t.className;var A=x.indexOf("webkit");var s=x.lastIndexOf("webkit");var o=x.substring(A,s);var u=o.replace(/[^0-9]/gi,"");
if(u<601){n=100;p=100+(k/2);}}var m=g.positionTooltip(v,r,z,p,n,k,h);var l=a.cloneDeep(c.select(this).datum());g.tooltipOnMouseoverAction(l,q);
var w=function(){g.tooltip.hide();g.tooltipOnMouseoutAction(l,q);};q.on("mouseout",function(){var B=g.tooltip.$container.is(":hover");
if(!B){w();}});g.tooltip.$container.bind("mouseleave",function(){w();});g.enhanceTooltipData(l);g.getTooltip().render(m,l);
g.postRender(l);});};g.setTooltip=function(j,i,h){this.tooltip=new j(i,h);};g.getTooltip=function(){return this.tooltip;};
g.positionTooltip=function(l,n,k,m,h,i,o){var j=l.top+k-10-h;var p=((l.left+n)-m)+(i/2);return{top:j,left:p};};g.enhanceTooltipData=function(h){};
g.tooltipOnMouseoverAction=function(h){};g.tooltipOnMouseoutAction=function(h){};g.postRender=function(h){};return g;};return d;
});define("chart/widgetFramework/core/drivers/baseView",["jquery","underscore","d3","chart/widgetFramework/core/drivers/tooltipCode","util/Functional"],function(f,b,d,e,c){var a=function(k,h){var l={joinAttr:null,barPadding:0,margin:{top:0,right:0,bottom:0,left:0},xAttr:"x",xScale:"linear",yAttr:"y",yScale:"linear",textAnchor:"start"};
var m=500;var i=50;var j={};j.el=h;e(j);j.init=function(){b.bindAll(this,"render");this.options=b.defaults(k,l);this.$el=f(this.el);
this.id=this.options.type;if(!this.options.outerPadding){this.options.outerPadding=this.options.barPadding;}var p=this.options.margin;
if(b.keys(p).length===0){this.options.margin={top:0,right:0,bottom:0,left:0};}this.htmlObjects=(this.options.templateStyle==="html")?true:false;
var n=c.getValueOrDefault(this.options,m,"width");this.$el.width(n);var o=c.getValueOrDefault(this.options,i,"height");this.$el.height(o);
};j.feedData=function(n){var o;this.rawData=n;if(b.has(this.options,"dataSubset")){o=g(n,this.options.dataSubset);}else{o=g(n);
}this.data=o.chartData;this.extraData=o.extraData||{};this.configData=o.config||{};if(!c.existy(this.data)){this.hideCharts("no data to display");
return;}return o;};j.setBandSizes=function(){};j.initRender=function(){var n=(this.chartType)?"chartbase-svg "+this.chartType+" "+this.$el.attr("id"):"chartbase-svg "+this.$el.attr("id");
var o=this.options.margin;this.width=this.$el.width()-(o.left+o.right);this.height=this.$el.height()-(o.top+o.bottom);if(this.htmlObjects){this.topSVG=this.topSVG||d.select(this.el).append("div").attr("class","chartbase-svg");
this.mainGroup=this.mainGroup||this.topSVG.append("div").attr("class","main-group").style("transform","translate("+o.left+"px,"+o.top+"px)");
this.chartGroup=this.mainGroup.append("div").attr("class","chart-elements-holder");}else{this.topSVG=this.topSVG||d.select(this.el).append("svg").attr("class",n);
this.mainGroup=this.mainGroup||this.topSVG.append("g").attr("class","main-group").attr("transform","translate("+o.left+","+o.top+")");
this.chartGroup=this.mainGroup.append("g").attr("class","chart-elements-holder");}};j.render=function(){this.chartHeight=this.$el.height();
this.chartWidth=this.$el.width();if(this.htmlObjects){this.topSVG.style("width",this.chartWidth+"px").style("height",this.chartHeight+"px");
}else{this.topSVG.attr("width",this.chartWidth+"px").attr("height",this.chartHeight+"px");}this.showCharts();this.update();
return this;};j.update=function(){this.setBandSizes();this.renderData();};j.renderData=function(){if(!c.existy(this.data)){return;
}};j.hideCharts=function(n){this.$el.find(".no-data-text").remove();var p=c.existy(n)?n:"no data to display";var r=this.height/2;
var q=this.width/2;var o=f('<div class="no-data-text"><text style="color: #ccc; font-size: 14px; position: relative; top:'+r+"px; left:"+q+'px;">'+p+"</text></div>");
this.$el.not(this.$el.has(".no-data-text")).prepend(o);this.$el.children().not(".no-data-text").hide();o.show();};j.showCharts=function(){this.$el.find(".no-data-text").remove();
this.$el.children().not(".no-data-text").show();};j.getData=function(){return function(){return j.data;};};j.getPrimaryDataJoin=function(){var n=this.options.joinAttr;
return this.getDataJoin(n);};j.getDataJoin=function(n){return function(p,o){if(n&&b(p).has(n)){return p[n];}else{return o;
}};};j.getXAttrVal=function(n){return this._getDatumValue(n,this.options.xAttr);};j.getYAttrVal=function(n){return this._getDatumValue(n,this.options.yAttr);
};j._getDatumValue=function(o,n){return o?o[n]:null;};var g=function(p,q){var o=b.cloneDeep(p);var n={};if(o.config){n.config=o.config;
}if(o.chartData){n.chartData=(q)?o.chartData[q]:o.chartData;}if(o.extraData){n.extraData=o.extraData;}if(b.keys(n)){return n;
}return(q)?o[q]:o;};return j;};return a;});define("chart/widgetFramework/chartTypes/rollover",["jqueryExtended","underscore","d3","chart/widgetFramework/core/mixins/barDrawingUtils","chart/widgetFramework/core/mixins/widgetScales","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/WidgetConstants","util/ObjectSuper","chart/widgetFramework/core/drivers/baseView"],function(b,i,k,d,j,a,f,c,h,g){var e=function(n,q,s,r){var p;
var l={};var t=i.defaults(n,l);p=g(t,q);var m=h(p);var o=false;p.init=function(){m.init();this.barUtils=d();this.barUtils.barSelectorStr=".bar.rollover";
this.barUtils.barClassStr="bar rollover";this.bandSize=0;this.barSize=0;};p.setBandSizes=function(){if(a.notFalsy(this.data)){var u,v=this.getData();
if(typeof v==="function"){u=v().length;}else{u=v.length;}if(this.options.variation===c.VERTICAL){this.bandSize=(this.width/u);
this.barSize=this.horizBarSize=(this.bandSize*(1-this.options.barPadding));}else{this.bandSize=(this.height/u);this.barSize=this.vertBarSize=(this.bandSize*(1-this.options.barPadding));
}}};p.initRender=function(){m.initRender();this.$el.find(".chartbase-svg").css("background-color","rgba(0,0,0,0)");};p.renderData=function(){if(a.falsy(this.data)&&!o){return;
}var u=this.options.centerBars;this.barUtils.chartWidth=this.width;this.barUtils.chartHeight=this.height;var v;if(this.options.variation===c.VERTICAL){v=this.barUtils.barPosition(u,this.bandSize,this.getXScale(),this.options.joinAttr);
this.barUtils.containerBarsVertical(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),v).fullBarVertical(this.barSize,this.getBarId());
}else{v=this.barUtils.barPosition(u,this.bandSize,this.getYScale(),this.options.joinAttr);this.barUtils.containerBarsHorizontal(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),v).fullBarHorizontal(this.barSize,this.getBarId());
}o=true;};p.getBarId=function(){return null;};p.getXScale=function(){return null;};p.getYScale=function(){return null;};p.setTooltipsOnElements=function(u){m.setTooltipsOnElements(u);
};p.positionTooltip=function(v,x,A,u,z,w,y){return m.positionTooltip(v,x,A,u,z,w,y);};p.enhanceTooltipData=function(u){};
p.tooltipOnMouseoverAction=function(){};p.tooltipOnMouseoutAction=function(u){};p.hideCharts=function(u){};return p;};return e;
});define("chart/widgetFramework/composed/chargebackReport/rollovers/atvRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/chartTypes/rollover"],function(c,i,j,a,f,h,g,e,d){var b=function(o,k){var m;
var n={};var l=i.defaults(n,o);m=d(l,k);var p=g(m);m.init=function(){p.init();this.barUtils.setBarSelectorStr(".bar.atv-rollover");
};m.renderData=function(){var q=this.options.centerBars;this.barUtils.chartWidth=this.width;this.barUtils.chartHeight=this.height;
var r;r=this.barUtils.barPosition(q,this.bandSize,this.getXScale(),this.options.joinAttr);this.barUtils.containerBarsVertical(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),r).fullBarVertical(2,"thin-bar").fullBarVertical(this.barSize,"dateStr");
};m.tooltipOnMouseoverAction=function(r,q){this.sharedMouseAction(q,0.25,1);};m.tooltipOnMouseoutAction=function(r,q){this.sharedMouseAction(q,0,0);
};m.sharedMouseAction=function(x,v,y){var s=x.find(".dateStr");var u=s.attr("data-id");var w=x.find(".thin-bar");j.select(w[0]).style("opacity",v);
var t=["authorized","chargeback","notifications-of-fraud"],r,q;i.each(t,function(z){r=".atv-chart ."+z+' .line-holder-dot[data-id*="'+u+'"]';
q=j.select(r).style("fill-opacity",y).style("stroke-opacity",y);});};m.positionTooltip=function(u,w,t,v,q,r,x){var s=u.top+t-q;
var y=((u.left+w+10)-v)+(r/2);return{top:s,left:y};};m.enhanceTooltipData=function(s){var q=j.format(".2f");var r=new Date(s.date);
var t=j.time.format("%Y-%m-%d");s.authorised=q(s.avgAuthorisedAmt);s.chargeback=q(s.avgChargebackAmt);s.nof=q(s.avgNofAmt);
s.dateStr=t(r);};return m;};return b;});define("chart/widgetFramework/composed/retryreport/drivers/sankey-overlap-ranked",["jquery","underscore","d3"],function(d,b,c){function a(){var r={},n=24,i=8,q=[1,1],g=[],o=[];
r.nodeWidth=function(s){if(!arguments.length){return n;}n=+s;return r;};r.nodePadding=function(s){if(!arguments.length){return i;
}i=+s;return r;};r.nodes=function(s){if(!arguments.length){return g;}g=s;return r;};r.links=function(s){if(!arguments.length){return o;
}o=s;return r;};r.size=function(s){if(!arguments.length){return q;}q=s;return r;};r.layout=function(s){f();k();j();p(s);e();
return r;};r.relayout=function(){e();return r;};r.link=function(){var t=0.5;function s(z){var w=z.source.x+z.source.dx,v=z.target.x,x=c.interpolateNumber(w,v),y=x(t),u=x(1-t),D=z.source.y+z.sy,C=z.target.y+z.ty,B=z.target.y+z.ty+Math.max(1,z.dy),A=z.source.y+z.sy+Math.max(1,z.dy);
return"M"+w+","+D+"C"+y+","+D+" "+u+","+C+" "+v+","+C+"L"+v+","+B+"C"+u+","+B+" "+y+","+A+" "+w+","+A+"Z";}s.curvature=function(u){if(!arguments.length){return t;
}t=+u;return s;};return s;};function f(){g.forEach(function(s){s.sourceLinks=[];s.targetLinks=[];});o.forEach(function(s){var t=s.source,u=s.target;
if(typeof t==="number"){t=s.source=g[s.source];}if(typeof u==="number"){u=s.target=g[s.target];}t.sourceLinks.push(s);u.targetLinks.push(s);
});}function k(){g.forEach(function(s){s.value=Math.max(c.sum(s.sourceLinks,m),c.sum(s.targetLinks,m));});}function j(){var t=g,w,s=0;
while(t.length){w=[];for(var v=0;v<t.length;v++){t[v].x=s;t[v].dx=n;for(var u=0;u<t[v].sourceLinks.length;u++){w.push(t[v].sourceLinks[u].target);
}}t=w;++s;}l(s);h((q[0]-n)/(s-1));}function l(s){g.forEach(function(t){if(!t.sourceLinks.length){t.x=s-1;}});}function h(s){g.forEach(function(t){t.x*=s;
});}function p(){var s=c.nest().key(function(w){return w.x;}).sortKeys(c.ascending).entries(g).map(function(w){return w.values;
});t();function t(){var x=c.min(s,function(y){return(q[1]-(y.length-1)*i)/c.sum(y,m);});var w=s.length;s.forEach(function(z,B){if(B===(w-1)){z.sort(v);
}else{z.sort(u);}var A=0;z.forEach(function(C){A+=C.value*x;});A=A+(z.length-1)*i;var y=(q[1]-A)/2;z.forEach(function(C){C.dy=C.value*x;
C.y=y;y=y+C.dy+i;});});o.forEach(function(y){y.dy=y.value*x;});}function u(x,w){return w.value-x.value;}function v(x,w){if(x.name<w.name){return 1;
}if(x.name>w.name){return -1;}return 0;}}function e(){g.forEach(function(u){u.sourceLinks.sort(s);u.targetLinks.sort(t);});
g.forEach(function(v){var w=0,u=0;v.sourceLinks.forEach(function(x){x.sy=w;w+=x.dy;});v.targetLinks.forEach(function(x){x.ty=u;
u+=x.dy;});});function s(v,u){if(v.target.y<u.target.y){return -1;}if(v.target.y>u.target.y){return 1;}if(v.type<u.type){return 1;
}if(v.type>u.type){return -1;}}function t(v,u){if(v.source.y<u.source.y){return -1;}if(v.source.y>u.source.y){return 1;}if(v.type<u.type){return 1;
}if(v.type>u.type){return -1;}}}function m(s){return s.value;}return r;}return a;});define("chart/widgetFramework/composed/retryreport/acquirerSankey",["jquery","underscore","d3","hogan","util/Functional","chart/widgetFramework/core/constants/WidgetConstants","chart/widgetFramework/core/constants/UIConstants","chartutil/domUtils","util/ObjectSuper","chart/widgetFramework/chartTypes/rollover","chart/widgetFramework/composed/retryreport/drivers/sankey-overlap-ranked"],function(c,i,l,e,b,d,h,f,g,j,k){function a(q,m){var o;
var p={};var n=i.defaults(p,q);o=j(n,m);var r=g(o);o.initRender=function(){r.initRender();this.$el.find(".chartbase-svg").css("background-color","#ffffff");
};o.setBandSizes=function(){};o.renderData=function(){var u=this.options.variation;if(b.falsy(this.data.nodes)){l.select("#"+u+"AcquirerSankeyPanel").style("display","none");
return;}else{l.select("#"+u+"AcquirerSankeyPanel").style("display",null);}var E=this.options.width-this.options.margin.left-this.options.margin.right,B=this.options.height-this.options.margin.top-this.options.margin.bottom,C=this.chartGroup;
var y=l.format(",.0f"),I="tx",L;L=function(Q){return y(Q)+" "+I;};o.sankey=k().nodeWidth(10).nodePadding(30).size([E,B]);
o.path=this.sankey.link();var P=[{titleText:u==="original"?"Original acquirer":"Original acquirer(s)",xLoc:-6,anchor:"middle",className:u==="original"?"green":"grey"},{titleText:"Original response code",xLoc:E/3-6,anchor:"middle",className:"grey"},{titleText:u==="original"?"Retry acquirer(s)":"Retry acquirer",xLoc:E*2/3+6+o.sankey.nodeWidth(),anchor:"middle",className:u==="original"?"grey":"green"},{titleText:"Final result",xLoc:E+32+o.sankey.nodeWidth(),anchor:"middle",className:"grey"}];
if(typeof o.titleWrapper==="undefined"){o.titleWrapper=C.append("g").attr("class","titleWrapper");o.titleWrapper.append("text").attr("class","sectionTitlesAcquirer "+u).attr("x",u==="original"?-6:E*2/3+6+o.sankey.nodeWidth()).attr("y",-45).attr("text-anchor","middle");
}o.titleWrapper.selectAll(".sectionTitles").data(P).enter().append("text").attr("class",function(Q){return"sectionTitles "+Q.className;
}).attr("x",function(Q){return Q.xLoc;}).attr("y",-25).attr("text-anchor",function(Q){return Q.anchor;}).text(function(Q){return Q.titleText;
});if(typeof o.linkWrapper==="undefined"){o.linkWrapper=C.append("g").attr("class","linkWrapper");}if(typeof o.nodeWrapper==="undefined"){o.nodeWrapper=C.append("g").attr("class","nodeWrapper");
}l.select(".sectionTitlesAcquirer."+this.options.variation).text(o.data.chosenAcquirer);o.sankey.nodes(o.data.nodes).links(o.data.links).layout(32);
var s=this.data.nodeNames;var A=s.filter(function(Q){return/^Adyen/.test(Q);});A.sort();var K=[];if(A.length>0){var H=l.scale.linear().range(["#004E00","#007100","#1C9516","#6AB466","#A1D3A1"].reverse()).domain(l.range(0,1,1/(5-1)).concat(1));
var t=l.scale.ordinal().domain(A).range(l.range(0,1,1/(A.length-1)).concat(1));A.forEach(function(R,Q){K[Q]=H(t(R));});}var w=s.filter(function(Q){return !(/^Adyen/.test(Q));
});w.sort();var O=[];if(w.length>0){var N=l.scale.linear().range(["#02324C","#0D4F74","#2D6E98","#508EB6","#75AFCE"].reverse()).domain(l.range(0,1,1/(5-1)).concat(1));
var G=l.scale.ordinal().domain(w).range(l.range(0,1,1/(w.length-1)).concat(1));w.forEach(function(R,Q){O[Q]=N(G(R));});}var J=l.scale.ordinal().domain(["Success","Refused"].concat(A,w)).range(["#4FAA5D","#823333"].concat(K,O));
var x=this.linkWrapper.selectAll(".link").data(this.data.links,function(Q){return Q.source.name+Q.target.name+Q.type;});x.style("fill-opacity",function(Q){if(/_O$/.test(Q.source.name)||/_R$/.test(Q.source.name)){if(Q.type==="success"){Q.fill_opacity=0.15;
}else{Q.fill_opacity=0.05;}}else{if(Q.type==="success"){Q.fill_opacity=0.4;}else{Q.fill_opacity=0.2;}}return Q.fill_opacity;
}).transition().duration(750).attr("d",o.path);var M=x.enter().append("path").attr("class",function(Q){return"link "+Q.type+" "+Q.target.name.replace(/\s+/g,"_");
}).attr("d",o.path).style("fill-opacity",function(Q){if(/_O$/.test(Q.source.name)||/_R$/.test(Q.source.name)){if(Q.type==="success"){Q.fill_opacity=0.15;
}else{Q.fill_opacity=0.05;}}else{if(Q.type==="success"){Q.fill_opacity=0.4;}else{Q.fill_opacity=0.2;}}return Q.fill_opacity;
}).style("opacity",0).on("mouseover",function(R){var Q=l.select(this);if(R.type==="success"){Q.style("fill-opacity",0.8);
}else{Q.style("fill-opacity",0.4);}}).on("mouseout",function(){l.selectAll(".link").style("fill-opacity",function(Q){return Q.fill_opacity;
});});M.transition().duration(750).style("opacity",1);x.exit().transition().duration(750).style("opacity",0.000001).remove();
x.sort(function(R,Q){return Q.dy-R.dy;});var F=o.nodeWrapper.selectAll(".node").data(this.data.nodes,function(Q){return Q.name;
});F.transition().duration(750).attr("transform",function(Q){return"translate("+Q.x+","+Q.y+")";});var z=F.enter().append("g").attr("class",function(Q){return"node "+Q.name.replace(/\s+/g,"_");
}).attr("transform",function(Q){return"translate("+Q.x+","+Q.y+")";}).style("opacity",0).call(l.behavior.drag().origin(function(Q){return Q;
}).on("dragstart",function(){this.parentNode.appendChild(this);}).on("drag",o.dragmove));z.transition().duration(750).style("opacity",1);
F.exit().transition().duration(750).style("opacity",0.000001).remove();F.select(".nodeRects").transition().duration(750).attr("height",function(Q){return Q.dy+2;
}).style("fill",function(Q){Q.color=J.domain().indexOf(Q.name.replace(/_O$|_R$/,""))>-1?J(Q.name.replace(/_O$|_R$/,"")):"#a5a5a5";
return Q.color;});z.append("rect").attr("class","nodeRects").attr("height",function(Q){return Q.dy+2;}).attr("width",o.sankey.nodeWidth()).attr("y",-1).style("fill",function(Q){Q.color=J.domain().indexOf(Q.name.replace(/_O$|_R$/,""))>-1?J(Q.name.replace(/_O$|_R$/,"")):"#a5a5a5";
return Q.color;}).style("stroke","white");var D=F.select(".nodeLabelGroup").transition().duration(750).attr("transform",function(R){var Q;
if(R.x===0){Q=-6;}else{if(R.x>0&&R.x<(E-o.sankey.nodeWidth())){Q=6+o.sankey.nodeWidth();}else{Q=40+o.sankey.nodeWidth();}}return"translate("+Q+","+(R.dy/2)+")";
}).style("text-anchor",function(Q){if(Q.x===0){return"end";}else{if(Q.x>0&&Q.x<(E-o.sankey.nodeWidth())){return"start";}else{return"middle";
}}});D.select(".value").text(function(Q){return L(Q.value);});var v=z.append("g").attr("class","nodeLabelGroup").attr("transform",function(R){var Q;
if(R.x===0){Q=-6;}else{if(R.x>0&&R.x<(E-o.sankey.nodeWidth())){Q=6+o.sankey.nodeWidth();}else{Q=40+o.sankey.nodeWidth();}}return"translate("+Q+","+(R.dy/2)+")";
}).style("text-anchor",function(Q){if(Q.x===0){return"end";}else{if(Q.x>0&&Q.x<(E-o.sankey.nodeWidth())){return"start";}else{return"middle";
}}});v.filter(function(Q){return Q.name==="Refused"||Q.name==="Success";}).append("rect").attr("class","labelBox").attr("width",70).attr("x",-35).attr("height",40).attr("y",-20).style("fill",function(Q){Q.color=J(Q.name);
return Q.color;});v.append("text").attr("class","label").attr("dy","-0.2em").text(function(Q){return Q.name.replace(/_O$|_R$/,"");
});v.append("text").attr("class","value").attr("dy","1.0em").text(function(Q){return L(Q.value);});};o.dragmove=function(t){var s=o.options.height-o.options.margin.top-o.options.margin.bottom;
l.select(this).attr("transform","translate("+t.x+","+(t.y=Math.max(0,Math.min(s-t.dy,l.event.y)))+")");o.sankey.relayout();
l.selectAll(".link").attr("d",o.path);};o.setTooltipsOnElements=function(){r.setTooltipsOnElements(true);};o.enhanceTooltipData=function(s){var t=l.format(",.0f");
s.valueTT=t(s.value);s.sourceName=s.source.name.replace(/_.$/,"");s.targetName=s.target.name.replace(/_.$/,"");};o.positionTooltip=function(t,v,y,s,x){var w=t.top+y-x-5;
var u=((t.left+v)-s)+(t.width/2);return{top:w,left:u};};return o;}return a;});define("chart/widgetFramework/core/drivers/basicChartDriver",["jquery","underscore","d3","chart/widgetFramework/core/drivers/tooltipCode","util/Functional"],function(e,a,c,d,b){var f=function(o,h){var l;
var j={joinAttr:null,barHeight:null,barPadding:0,margin:{top:0,right:0,bottom:0,left:0},xAttr:"x",xScale:"linear",yAttr:"y",yScale:"linear",textAnchor:"start"};
var k=500;var g=50;l={};l.el=h;d(l);l.init=function(){a.bindAll(this,"render");this.options=a.defaults(o,j);if(!this.options.outerPadding){this.options.outerPadding=this.options.barPadding;
}this.htmlObjects=(this.options.templateStyle==="html")?true:false;this.id=this.options.type;this.$el=e(this.el);if(b.truthy(this.options.width)&&this.options.width<=0){this.options.width=null;
}if(b.truthy(this.options.height)&&this.options.height<=0){this.options.height=null;}var p=m(this.options);this.$el.width(p);
var q=n(this.options);this.$el.height(q);};l.feedData=function(p){this.rawData=p;if(a.has(this.options,"dataSubset")){this.data=i(p,this.options.dataSubset);
}else{this.data=i(p);}if(!b.existy(this.data)){this.hideCharts("no data to display");return;}return this.data;};var i=function(r,s){var q=a.cloneDeep(r);
var p={};if(q.config){p.config=q.config;}if(q.chartData){p.chartData=(s)?q.chartData[s]:q.chartData;}if(q.extraData){p.extraData=q.extraData;
}if(a.keys(p)){return p;}return(s)?q[s]:q;};l.setBandSizes=function(){};l.initRender=function(){var p=this.options.margin;
if(a.keys(p).length===0){p={top:0,right:0,bottom:0,left:0};}this.width=this.$el.width()-(p.left+p.right);this.height=this.$el.height()-(p.top+p.bottom);
if(this.htmlObjects){this.topSVG=this.topSVG||c.select(this.el).append("div").attr("class","chartbase-svg");this.topSVG.style("width",this.$el.width()+"px").style("height",this.$el.height()+"px");
this.mainGroup=this.mainGroup||this.topSVG.append("div").attr("class","main-group").style("transform","translate("+p.left+"px,"+p.top+"px)");
this.chartGroup=this.mainGroup.append("div").attr("class","chart-elements-holder");}else{this.topSVG=this.topSVG||c.select(this.el).append("svg").attr("class","chartbase-svg");
this.topSVG.attr("width",this.$el.width()+"px").attr("height",this.$el.height()+"px");this.mainGroup=this.mainGroup||this.topSVG.append("g").attr("class","main-group").attr("transform","translate("+p.left+","+p.top+")");
this.chartGroup=this.mainGroup.append("g").attr("class","chart-elements-holder");}};l.render=function(){this.topSVG.attr("width",this.$el.width()+"px").attr("height",this.$el.height()+"px");
this.showCharts();this.update();return this;};l.update=function(){this.setBandSizes();this.renderData();};l.renderData=function(){if(!b.existy(this.data)){return;
}};l.setupUiComponents=function(s){for(var r=0;r<s.length;r++){if(s[r]&&s[r].type==="tooltip"){var q=s[r].module;var p=s[r].options;
this.setupTooltip(q,p);}}};l.hideCharts=function(p){this.$el.find(".no-data-text").remove();var r=b.existy(p)?p:"no data to display";
var t=this.height/2;var s=this.width/2;var q=e('<div class="no-data-text"><text style="color: #ccc; font-size: 14px; position: relative; top:'+t+"px; left:"+s+'px;">'+r+"</text></div>");
this.$el.not(this.$el.has(".no-data-text")).prepend(q);this.$el.children().not(".no-data-text").hide();q.show();};l.showCharts=function(){this.$el.find(".no-data-text").remove();
this.$el.children().not(".no-data-text").show();};l.getData=function(){return function(){return l.data;};};l.getPrimaryDataJoin=function(){var p=this.options.joinAttr;
return this.getDataJoin(p);};l.getDataJoin=function(p){return function(r,q){if(p&&a(r).has(p)){return r[p];}else{return q;
}};};l.getX=function(p){return this._getDatumValue(p,this.options.xAttr);};l.getY=function(p){return this._getDatumValue(p,this.options.yAttr);
};l._getDatumValue=function(q,p){return q?q[p]:null;};var m=function(p){var q=b.defaults({width:k});return q(p,"width");};
var n=function(p){var q=b.defaults({height:g});return q(p,"height");};return l;};return f;});define("chart/widgetFramework/chartTypes/bundleLayout",["jquery","underscore","backbone","d3","chart/widgetFramework/core/drivers/basicChartDriver","ui/UIConstants","util/ObjectSuper","text!chart/widgetFramework/chartTypes/css/bundleLayout.css","util/Css"],function(e,i,h,j,b,g,f,c,a){function d(l){var k=b(l);
k.init=function(n,m){k.options=i.defaults(n,{autoSizing:true,extraTotalAndStatusNodePadding:20,height:900,labelCutOffPercentage:0.5,leftGroup:undefined,margin:{top:300,right:300,bottom:300,left:300},startNodePadding:2,statusNodeRadius:12,textRotation:false,totalNodeMaxSize:20,totalNodeOffset:0,version:"auto",width:900});
k.el=m;k.startNodeOffset=k.getOption("totalNodeOffset")+k.getOption("totalNodeMaxSize")+k.getOption("extraTotalAndStatusNodePadding");
k.version=k.getOption("version");k.width=k.getOption("width");k.height=k.getOption("height");a.addStyle(c);};k.getOption=function(n){var m=this.options||{};
if(typeof m[n]!=="undefined"){return m[n];}};k.getOffset=function(m,p,n,o){if(m==="big"){return -5;}else{return p*(n+o);}};
k.getVersion=function(m,n){return"small";if(m&&m!=="auto"){return m;}else{if(n>=80){return"big";}else{if(n<80){return"small";
}}}};k.getCategoryClassName=function(m){return i.chain(this.styles.identifierStyles).filter(function(n){return n.type===m;
}).pluck("className").first().value();};k.getOffsetAngle=function(n){var p=0;if(i.isString(n)){var m=i.pluck(this.hierarchies.children,"key");
p=m.indexOf(n);if(p===-1){return 0;}}else{if(i.isNumber(n)){p=n;}else{return 0;}}var o=this.chord.groups()[p];return(o.endAngle-o.startAngle)/2+o.startAngle;
};k.feedData=function(m){this.rawData=m;};k.getData=function(){return this.rawData;};k.render=function(){var m=this.view;
return this.updateView(m);};k.initRender=function(){var n=this;this.$el=e(this.el);this.$el.html("");var s=this.getData();
this.styles=s.styles;this.statusCollection=this.styles.status;this.rawData=s;this.hierarchies=s.hierarchies;this.linkingIdentifiersMap=s.linkingIdentifiersMap;
this.cardMapping=s.cardMapping;this.matrix=s.matrix;this.locked=undefined;this.lockedFromTable=undefined;this.numStatuses=this.styles.status.length;
if(this.getOption("autoSizing")!==true){this.width=this.getOption("width")?this.getOption("width"):e(this.el).width();this.height=this.getOption("height")?this.getOption("height"):e(document).height();
var r=this.getOption("width")-this.getOption("margin").left-this.getOption("margin").right;var t=this.getOption("height")-this.getOption("margin").top-this.getOption("margin").bottom;
this.diameter=Math.min(r,t);this.radius=this.diameter/2;}else{var q=i.flatten(i.pluck(this.hierarchies.children,"children"));
var o=q.length;var p=2*o*2*this.options.statusNodeRadius*0.7/(2*Math.PI);p=Math.round(Math.max(180,p));this.diameter=Math.round(Math.min(900,p));
this.radius=this.diameter/2;this.width=this.diameter+this.options.margin.left+this.options.margin.right;this.height=this.diameter+this.options.margin.top+this.options.margin.bottom;
}this.$el.width(this.width).height(this.height);var m=j.select(this.el).append("svg").classed(this.css_constants.CHARTTYPE,true).attr("width",this.diameter+this.options.margin.left+this.options.margin.right).attr("height",this.diameter+this.options.margin.top+this.options.margin.bottom).on("click",function(){i.bind(n.unlock,n)();
n.$el.trigger("bundleLayoutBodyClicked",null);}).append("g").classed(this.css_constants.CHARTWRAPPER,true).attr("transform","translate("+(this.options.margin.left)+","+(this.options.margin.top)+")").attr("pointer-events","all");
this.cluster=j.layout.cluster().size([360,this.radius]);this.bundle=j.layout.bundle();this.chord=j.layout.chord().padding(0.15);
this.line=j.svg.line.radial().interpolate("bundle").tension(0.75).radius(function(u){return u.y-5;}).angle(function(u){if(typeof u.angle!=="undefined"){return u.angle;
}else{return u.x/180*Math.PI;}});this.view={container:this.$el,svg:m,margin:this.options.margin};};k.updateView=function(t){var u=this;
var r=t.container;this.svg=t.svg;this.$el.find("."+this.css_constants.CHARTWRAPPER).empty();this.lines=this.svg.append("g").attr("class","links").attr("transform","translate("+this.radius+","+this.radius+")");
this.nodes=this.svg.append("g").attr("class","nodes").attr("transform","translate("+this.radius+","+this.radius+")");this.arcs=this.svg.append("g").attr("class","arcs").attr("transform","translate("+this.radius+","+this.radius+")");
this.legend=this.svg.append("g").attr("class","legend").attr("transform","translate("+(-this.options.margin.left+30)+","+(-this.options.margin.top+30)+")");
this.chord.matrix(this.matrix);this.offsetAngle=this.getOffsetAngle(this.options.leftGroup);i.each(this.chord.groups(),function(v){v.startAngle=v.startAngle-u.offsetAngle-Math.PI/2;
v.endAngle=v.endAngle-u.offsetAngle-Math.PI/2;});var o=this.cluster.nodes(this.hierarchies);o=o.filter(function(v){if(v.name===""){return false;
}else{if(v.depth<2){return false;}}return true;});this.addStatusInfo(o,this.linkingIdentifiersMap,this.statusCollection,this.rawData.data);
o.sort(function(w,v){return v.status.total-w.status.total;});this.legendNodeData=o;this.nodeKey=i.pluck(i.flatten(o),"key");
this.nodeParentKey=i.pluck(i.flatten(o),"parent.key");var s=this.createLinks(o);s=this.bundle(s);s=i.map(s,function(v){return v.filter(function(w){if(isNaN(w.x)){w.x=0;
}return w.depth!==1;});});this.version=this.getVersion(this.version,o.length);this.extraOffset=this.getOffset(this.version,this.numStatuses,this.options.statusNodeRadius,this.options.startNodePadding);
this.totalNodeScale=j.scale.sqrt().range([u.options.statusNodeRadius/2,u.options.totalNodeMaxSize]).domain([1,j.max(o,function(v){return v.status.total;
})]);var n=j.svg.arc().startAngle(function(v){return v.startAngle;}).endAngle(function(v){return v.endAngle;}).innerRadius(Math.round(this.radius+this.startNodeOffset*0.6)-1).outerRadius(Math.round(this.radius+this.startNodeOffset*0.6));
this.arcs.selectAll(u.css_constants.SEPARATIONARC).data(this.chord.groups).enter().append("path").attr("class",function(w,v){return u.css_constants.SEPARATIONARC+" "+u.getCategoryClassName(u.hierarchies.children[v].key);
}).style("stroke","none").attr("d",n);var m=this.nodes.selectAll("."+this.css_constants.NODE).data(o).enter().append("g").attr("class",function(v){return u.getCategoryClassName(v.parent.key);
}).classed(this.css_constants.NODE,true).attr("transform",function(w,v){w.nodeID=v;return u.nodeAngleFromChord(w,v,u.offsetAngle);
}).on("click",function(v){i.bind(u.onNodeClicked,u,v)();u.$el.trigger("nodeClickedOnBundleLayout",{data:v});}).on("mouseover",i.bind(u.onNodeMouseOver,u)).on("mouseout",i.bind(u.onNodeMouseOut,u));
m.append("circle").classed(this.css_constants.NODECIRCLEBACKGROUND,true).attr("cx",u.options.totalNodeOffset).attr("r",function(w){var v=u.totalNodeScale(w.status.total);
return v>0?v:0;});m.append("circle").classed(this.css_constants.NODECIRCLE,true).attr("cx",u.options.totalNodeOffset).style("opacity",0.9).attr("r",function(w){var v=u.totalNodeScale(w.status.total);
return v>0?v:0;});m.filter(function(v){var w=true;if(i.has(v,["parent","key"])&&v.parent.key==="pspref"){w=false;}return w;
}).append("line").classed(this.css_constants.NODESTATUSCONNECTINGLINE,true).attr("x1",u.startNodeOffset).attr("x2",u.startNodeOffset+(this.statusCollection.length-1)*(u.options.statusNodeRadius+u.options.startNodePadding)).style("opacity",this.version==="big"?0:1);
this.nodes.selectAll("."+this.css_constants.NODETOTALTEXT).data(o).enter().append("g").classed(this.css_constants.NODETOTALTEXT,true).classed(this.css_constants.NODE,true).attr("transform",function(w,v){return u.nodeAngleFromChord(w,v,u.offsetAngle);
}).append("text").classed(this.css_constants.NODETEXT,true).attr("transform",function(v){if(u.options.textRotation){return"rotate("+v.rotate+")";
}else{return"rotate("+-(v.angle*(180/Math.PI)-90)+")";}}).attr("x",u.options.totalNodeOffset).attr("y",".4em").style("pointer-events","none").style("opacity",function(v){if(u.version==="small"){v.showText=1;
}else{v.showText=u.totalNodeScale(v.status.total)<Math.max(1,u.options.statusNodeRadius/2*1.2)?0:1;}return v.showText;}).text(function(v){return v.status.total;
});i.each(this.statusCollection,function(w,v){var x=m.append("g").attr("transform",function(y){if(i.has(y,["parent","key"])&&y.parent.key==="pspref"){return"translate("+u.startNodeOffset+",0)";
}return"translate("+(u.startNodeOffset+v*(u.options.statusNodeRadius+u.options.startNodePadding))+",0)";}).classed(u.css_constants.NODESTATUS,true).style("opacity",function(y){return u.version==="big"||y.status[v].count===0?0:1;
});x.append("rect").attr("class",function(y){return y.status[v].name;}).classed(u.css_constants.NODESTATUSRECT,true).attr("width",u.options.statusNodeRadius).attr("height",u.options.statusNodeRadius).attr("x",-u.options.statusNodeRadius/2).attr("y",-u.options.statusNodeRadius/2);
x.append("text").classed(u.css_constants.NODESTATUSTEXT,true).attr("transform",function(y){if(u.options.textRotation){return"rotate("+y.rotate+")";
}else{return"rotate("+-(y.angle*(180/Math.PI)-90)+")";}}).attr("y",".4em").text(function(y){return y.status[v].count;});});
m.append("text").classed(this.css_constants.NODELABEL,true).attr("dy",".4em").attr("transform",function(w){var v=(u.version!=="big"&&i.has(w,["parent","key"])&&w.parent.key==="pspref")?50:0;
return"translate("+(u.startNodeOffset+u.extraOffset-v)+",0)rotate("+w.rotate+")";}).style("text-anchor",function(v){return v.rotate===180?"end":"start";
}).style("opacity",1).text(function(v){return u.calculateText(v,"defaultText");}).transition().duration(1000).delay(1000).style("opacity",function(v){if(u.version==="small"||i.has(v,["parent","key"])&&v.parent.key==="pspref"){v.showText=1;
}else{v.showText=u.totalNodeScale(v.status.total)<Math.max(1,u.options.statusNodeRadius/2*1.2)?0:1;}return v.showText;});
var p=0;j.selectAll("."+this.css_constants.NODELABEL).each(function(){if(p<this.getComputedTextLength()){p=this.getComputedTextLength();
}});var q=j.svg.arc().innerRadius(this.radius).outerRadius(this.radius+u.startNodeOffset+u.extraOffset+p).startAngle(function(v){return v.startAngle+Math.PI/2;
}).endAngle(function(v){return v.endAngle+Math.PI/2;});m.append("path").classed(this.css_constants.ARCINVISIBLE,true).attr("d",q).attr("transform","translate("+-this.radius+", 0)");
this.lines.selectAll(this.css_constants.LINK).data(s).enter().append("path").classed(this.css_constants.PSPREF,function(w){var v=false;
i.each(w,function(x){if(i.has(x,["parent","key"])&&x.parent.key==="pspref"){v=true;}});return v;}).classed(this.css_constants.LINK,true).each(function(v){v.source=v[0];
v.target=v[v.length-1];}).attr("d",this.line);return r;};k.createLinks=function(n){var p={};var m=[];var o={};n.forEach(function(q){p[q.name]=q;
});n.forEach(function(q){if(q.childNodes){q.childNodes.forEach(function(r){if(q.name!==r.childNode.name){if(!((o[r.childNode.name])&&(o[r.childNode.name][q.name]))){if(!(o[q.name])){o[q.name]={};
}o[q.name][r.childNode.name]=true;m.push({source:p[q.name],target:r.childNode});}}});}});return m;};k.addStatusInfo=function(n,m,o,p){i.each(n,function(s){var r=e.extend(true,{},o);
var q=s.parent.key;var t=s.key;var u=m[q][t];i.each(u,function(w){var y=p[w];var v=y.laststatus;var x=i.find(r,function(z){return i.contains(z.journaltypes,v);
});if(x){x.count++;}});s.status=r;s.status.total=i.sum(s.status,function(v){return v.count;});});};k.nodeAngleFromChord=function(s){var m=this.chord.groups()[s.parent.matrixIndex-1];
var n=m.startAngle;var p=m.endAngle;var v=s.parent.children.length;var q=s.order;var u=p-n;s.angle=n+((u/(v+1))*(q+1));var r=Math.PI;
if(s.angle>-4*r&&s.angle<-3*r||s.angle>-2*r&&s.angle<-1*r||s.angle>0&&s.angle<r||s.angle>2*r&&s.angle<3*r||s.angle>4*r&&s.angle<5*r){s.rotate=0;
}else{s.rotate=180;}var t=u/(v+1);s.startAngle=-t/2;s.endAngle=t/2;var o=s.angle*(180/Math.PI);return"rotate("+(o-90)+")translate("+(s.y)+",0)";
};k.onNodeClicked=function(o){j.event.stopPropagation();this.locked=o;var p=i.pluck(this.locked.childNodes,"childNode");this.svg.selectAll("."+this.css_constants.NODE).classed(this.css_constants.NODEINACTIVE,false).filter(function(q){return !(i.contains(p,q));
}).classed(this.css_constants.NODEINACTIVE,true);var n=i.chain(this.rawData.data).flatten().pluck("eventidentifiers").pluck(o.parent.key).value();
var m=this.getAllIndexes(n,o.key);this.newLockedNodes=i.bind(this.addStatusInfoHover,this,m)();};k.onNodeMouseOver=function(s){var n=this;
var r=this.svg.selectAll("."+this.css_constants.NODE);var q=this.svg.selectAll("."+this.css_constants.LINK);var p=i.chain(this.rawData.data).flatten().pluck("eventidentifiers").pluck(s.parent.key).value();
var m=this.getAllIndexes(p,s.key);var o=i.bind(this.addStatusInfoHover,this,m)();r.selectAll("."+this.css_constants.NODETEXT).text(function(t){return o[t.nodeID].total;
}).style("opacity",function(u){var t=o[u.nodeID].total;return t>0?1:0;});r.selectAll("."+this.css_constants.NODECIRCLE).attr("r",function(u){var t=o[u.nodeID].total;
return t>0?n.totalNodeScale(t):0;});r.selectAll("."+this.css_constants.NODESTATUSTEXT).text(function(u,t){return o[u.nodeID][t].count;
});r.classed(this.css_constants.NODEHIDDEN,true).each(function(t){t.selected=false;});q.classed(this.css_constants.LINKHIDDEN,function(t){return(t.source!==s)&&(t.target!==s);
}).classed(this.css_constants.LINKSELECTED,function(t){if(t.target===s||t.source===s){t.source.selected=true;t.target.selected=true;
return true;}});q.filter(function(t){return(t.target===s||t.source===s);}).each(function(){this.parentNode.appendChild(this);
});r.classed(this.css_constants.NODEHIDDEN,function(t){return !(t.selected);});r.selectAll("."+this.css_constants.NODESTATUSCONNECTINGLINE).style("opacity",function(t){return(t.selected)&&o[t.nodeID].total>0?1:0;
});if(this.version==="big"){r.selectAll("."+this.css_constants.NODELABEL).attr("transform",function(w){var u=(i.has(w,["parent","key"])&&w.parent.key==="pspref");
var t=u?(5+(n.options.statusNodeRadius/2+n.options.startNodePadding)):(5+n.numStatuses*(n.options.statusNodeRadius+n.options.startNodePadding));
var v=(n.version!=="big"&&i.has(w,["parent","key"])&&w.parent.key==="pspref")?50:0;return"translate("+(n.startNodeOffset+t+n.extraOffset-v)+",0)rotate("+w.rotate+")";
}).style("opacity",function(t){return(t.selected)&&o[t.nodeID].total>0?1:0;});this.svg.selectAll("."+this.css_constants.NODE).selectAll("."+this.css_constants.NODESTATUS).style("opacity",function(u,t){return(u.selected)&&o[u.nodeID][t].count>0?1:0;
});}else{r.selectAll("."+this.css_constants.NODELABEL).style("opacity",function(t){return o[t.nodeID].total>0?1:0;});this.svg.selectAll("."+this.css_constants.NODE).selectAll("."+this.css_constants.NODESTATUS).style("opacity",function(u,t){return o[u.nodeID][t].count===0?0:1;
});}};k.onNodeMouseOut=function(){var m=this;var o=this.svg.selectAll("."+this.css_constants.NODE),n=this.svg.selectAll("."+this.css_constants.LINK);
if(this.locked){o.selectAll("."+this.css_constants.NODETEXT).text(function(q){return m.newLockedNodes[q.nodeID].total;}).style("opacity",function(r){var q=m.newLockedNodes[r.nodeID].total;
return q>0?1:0;});o.selectAll("."+this.css_constants.NODECIRCLE).attr("r",function(r){var q=m.newLockedNodes[r.nodeID].total;
return q>0?m.totalNodeScale(q):0;});o.selectAll("."+this.css_constants.NODESTATUSTEXT).text(function(r,q){return m.newLockedNodes[r.nodeID][q].count;
});o.selectAll("."+this.css_constants.NODESTATUS).style("opacity",function(r,q){return m.newLockedNodes[r.nodeID][q].count===0?0:1;
});o.selectAll("."+this.css_constants.NODELABEL).style("opacity",function(q){return m.newLockedNodes[q.nodeID].total>0?1:0;
});o.selectAll("."+this.css_constants.NODESTATUSCONNECTINGLINE).style("opacity",function(q){return m.newLockedNodes[q.nodeID].total>0?1:0;
});n.classed(this.css_constants.LINKLOCKED,false).classed(this.css_constants.LINKHIDDEN,true).classed(this.css_constants.LINKSELECTED,false);
n.filter(function(q){return(q.source===m.locked)||(q.target===m.locked);}).classed(this.css_constants.LINKLOCKED,true).classed(this.css_constants.LINKHIDDEN,false);
o.classed(this.css_constants.NODELOCKED,false).classed(this.css_constants.NODEHIDDEN,true);var p=i.pluck(this.locked.childNodes,"childNode");
o.filter(function(q){return i.contains(p,q);}).classed(this.css_constants.NODELOCKED,true).classed(this.css_constants.NODEHIDDEN,false);
}else{o.selectAll("."+this.css_constants.NODETEXT).text(function(q){return q.status.total;}).style("opacity",function(q){return q.showText;
});o.selectAll("."+this.css_constants.NODECIRCLE).attr("r",function(r){var q=m.totalNodeScale(r.status.total);return q>0?q:0;
});o.selectAll("."+this.css_constants.NODESTATUSTEXT).text(function(r,q){return r.status[q].count;});o.selectAll("."+this.css_constants.NODESTATUS).style("opacity",function(r,q){return(m.version==="big"||r.status[q].count===0)?0:1;
});o.selectAll("."+this.css_constants.NODESTATUSCONNECTINGLINE).style("opacity",this.version==="big"?0:1);if(this.version==="big"){o.selectAll("."+this.css_constants.NODELABEL).attr("transform",function(r){var q=(m.version!=="big"&&i.has(r,["parent","key"])&&r.parent.key==="pspref")?50:0;
return"translate("+(m.startNodeOffset+m.extraOffset-q)+",0)rotate("+r.rotate+")";}).style("opacity",function(q){return q.showText;
});}else{o.selectAll("."+this.css_constants.NODELABEL).style("opacity",1);}n.classed(this.css_constants.LINKHIDDEN,false).classed(this.css_constants.LINKLOCKED,false).classed(this.css_constants.LINKSELECTED,false);
o.classed(this.css_constants.NODEHIDDEN,false).classed(this.css_constants.NODELOCKED,false).classed(this.css_constants.NODEINACTIVE,false);
}};k.getAllIndexes=function(m,q){var n=this;var o=[],p;for(p=0;p<m.length;p++){if(i.isObject(m[p])){m[p]=n.parseObject(m[p],"|");
}if(m[p]===q){o.push(p);}}return o;};k.parseObject=function(s,r){var q=[];for(var o in s){if(s.hasOwnProperty(o)){q=q.concat(s[o]);
}}var p="["+r+"]";var n=new RegExp(p,"g");for(var m=0;m<q.length;m++){if(q[m]){q[m]=q[m].replace(n,"");}}q.reverse();return q.join(" "+r+" ");
};k.addStatusInfoHover=function(o){var n=[];var m=this;i.each(this.nodeKey,function(s,p){var r=e.extend(true,{},m.statusCollection);
var q=m.nodeParentKey[p];var t=m.linkingIdentifiersMap[q][s];t=i.filter(t,function(u){return i.indexOf(o,u)>-1;});i.each(t,function(v){var x=m.rawData.data[v];
var u=x.laststatus;var w=i.find(r,function(y){return i.contains(y.journaltypes,u);});if(w){w.count++;}});r.total=i.sum(r,function(u){return u.count;
});n.push(r);});return n;};k.calculateText=function(m){return m.name;};k.unlock=function(){this.locked=undefined;this.onNodeMouseOut();
};k.getPsprefsFromIdentifier=function(m){var o=[];var n=i.get(k,"rawData.data",false);if(n){o=i.chain(n).reduce(function(q,p){i.each(p.eventidentifiers,function(r){if(m.hasOwnProperty("key")&&r===m.key){q.push(p.pspreference);
}});return q;},[]).value();}return o;};k.css_constants={CHARTTYPE:"bundle-layout",CHARTWRAPPER:"bundle-layout-wrapper",LINK:"bundle-layout-link",LINKSELECTED:"bundle-layout-link--selected",LINKHIDDEN:"bundle-layout-link--hidden",LINKLOCKED:"bundle-layout-link--locked",NODE:"bundle-layout-node",NODEHIDDEN:"bundle-layout-node--hidden",NODELOCKED:"bundle-layout-node--locked",NODEINACTIVE:"bundle-layout-node--inactive",NODECIRCLEBACKGROUND:"bundle-layout-node-background-circle",NODECIRCLE:"bundle-layout-node-circle",NODETEXT:"bundle-layout-node-text",NODESTATUSCONNECTINGLINE:"bundle-layout-status-node-connecting-line",NODESTATUS:"bundle-layout-status-node",NODESTATUSRECT:"bundle-layout-status-node-circle",NODESTATUSTEXT:"bundle-layout-status-node-text",NODELABEL:"bundle-layout-node-label",NODETOTALTEXT:"bundle-layout-node-total-text",ARCINVISIBLE:"bundle-layout-invisible-arc",SEPARATIONARC:"bundle-layout-separation-arc",PSPREF:"bundle-layout-pspref"};
return k;}return d;});define("chart/widgetFramework/composed/harpViewer/AggregateDataFormatter",["jqueryExtended","underscore","d3","chartutil/dateUtils_CET","chart/widgetFramework/core/constants/DataConstants","chartutil/d3utils"],function(g,a,c,f,e,b){function d(i,h){this.data=i;
this.options=h;this.formattedData={};this.ticks=this.data.ticks;this.baselineData=this.data.baselineData;this.comparator=this.compareFunction;
this.reverseDirection=false;this.sortKey=null;}d.prototype.formatData=function(){if(!this.ticks){this.aggregatedData=[];return this.aggregatedData;
}this.aggregatedData=this.createAggregateData();var i=a.max(this.aggregatedData,function(j){return j.tx;});var h=i.tx;this.aggregatedData.forEach(function(k){var j=0;
g.each(k.barArray,function(m,o){if(k.monthFmt){o.monthFmt=k.monthFmt;}o.startX=k.total>0?j:0;var l=k.total>0?Math.max(0,o.value)/k.total:0;
var n=h*l;o.endX=o.startX+n;j+=n;});});if(this.sortKey){this.reverseDirection=!this.reverseDirection;this.sortData(this.sortKey,true);
}return{chartData:this.aggregatedData};};d.prototype.createAggregateData=function(){var k=["authorised","abandoned"];var h=[];
var i=this;this.ticks.each(function(o,r){o=f.trueRoundToDay(o);var u=o.toFormattedString();var q=u.substring(0,u.lastIndexOf("-"));
var p=i.getTotalsByMonth(q);var n=i.getAuthsByMonth(q);var v=i.getRatesByMonth(q);var s=(r===0)?"%b '%y":"%b";var m=c.format("0,000");
var l={};l.tx=m(p);l.auths=m(n);l.authRate=Number(c.format(".1f")(v));l.monthFmt=c.time.format("%b")(o);var t={};t.date=o;
t.auths=n;t.tx=p;t.authRate=Number(c.format(".1f")(v));t.monthFmt=c.time.format(s)(o);t.monthName=c.time.format("%b")(o);
t.totalsArray=[];t.totalsArray.push(l);t.barArray=[];k.forEach(function(x){var w={};w.name=x;if(x==="authorised"){w.value=n;
}else{if(x==="abandoned"){w.value=p-n;}}t.barArray.push(w);});h.push(t);});var j=a.max(a.pluck(h,"tx"));h.forEach(function(l){l.barArray.push({name:"rest",value:j-l.tx});
l.total=j;});return h;};d.prototype.getTotalsByMonth=function(i){var h=this.getAmountByMonth(i,"total");return h;};d.prototype.getAuthsByMonth=function(i){var h=this.getAmountByMonth(i,"authorisations");
return h;};d.prototype.getRatesByMonth=function(h){var i=(this.getAuthsByMonth(h)/this.getTotalsByMonth(h))||0;return i*100;
};d.prototype.getAmountByMonth=function(j,k){var i=a.map(this.baselineData,function(l){if(l.date.toFormattedString().indexOf(j)>-1){return l[k];
}return false;});var h=a.reduceRight(i,function(l,m){return l+m;},0);return h;};d.prototype.sortData=function(h,j){this.sortKey=h;
this.reverseDirection=!this.reverseDirection;var i=a.sortBy(this.aggregatedData,h);if(this.reverseDirection){i.reverse();
}this.aggregatedData=i;if(j===true){return;}this.$el.trigger(e.FORMATTER_INFORM_WIDGET,{type:e.SORTED_DATA,data:{chartData:this.aggregatedData}});
};d.prototype.compareFunction=function(h){return h[this.sortKey];};d.prototype.getData=function(){return(this.aggregatedData)?this.aggregatedData:this.formatData();
};d.prototype.setRawData=function(h){this.data=h;this.ticks=this.data.ticks;this.baselineData=this.data.baselineData;};d.prototype.setOptions=function(h){this.options=h;
};return d;});define("chart/widgetFramework/composed/riskReport/formatters/stackedHistogramFormatter",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chartutil/stringutils","chartutil/dateUtils_CET","chartutil/d3utils"],function(a,g,h,b,f,c,d,i){var e=function(m,j,l){var k={};
k.data=m;k.options=j;k.formattedData={};k.comparator=null;k.reverseDirection=false;k.sortKey=null;k.timeline=l;k.formatData=function(){if(b.falsy(this.data.fraudScoreDistribution)){return[];
}var r=this.data.fraudScoreDistribution;var u=[];var o=this.options.range[0];var p=this.options.range[1];var t=(p-o)/this.options.numBins;
g.each(r,function(x){var w=x[k.options.accessor];if(w>=o&&w<=p){var v={dx:1,x:w,y:0};g.each(k.options.stacks,function(y){v[y]=x[y];
});u.push(v);}});var n=h.range(o,p,t);var s=h.layout.histogram().range(k.options.range).bins(k.options.numBins)(n);var q=[];
g.each(s,function(x){var v={x:x.x,dx:x.dx,y:0};g.each(k.options.stacks,function(z){v[z]=0;});var y=x.x+x.dx;var w=x.x;g.each(u,function(z){if(z.x<y&&z.x>=w){g.each(k.options.stacks,function(A){v[A]+=z[A];
});}});q.push(v);});g.each(q,function(w){w.stacksArray=[];var v=0;g.each(k.options.stacks,function(z){var x=c.camelToDash(z);
var y={name:x,x:w.x};y.frequency=w[z];if(x!=="authorised-count"){w.y+=y.frequency;}y.startY=v;y.endY=(x!=="authorised-count")?v+y.frequency:v;
v=y.endY;w.stacksArray.push(y);});});this.formattedData=q;if(window.console&&console.log){console.log("\n### riskReportStackedHistogramFormatter::formatData:: this.formattedData=",this.formattedData);
}return{chartData:this.formattedData};};k.sortData=function(n){this.sortKey=n;this.reverseDirection=!this.reverseDirection;
var o=g.sortBy(this.formattedData,n);if(this.reverseDirection){o.reverse();}this.formattedData=o;return{chartData:this.formattedData};
};k.compareFunction=function(n){return n[this.sortKey];};k.downloadCSV=function(){var p=this.createObjectForCSV();var n=["fraudScore","authorised-count","totalRefused","refused-by-risk-count","refused-by-bank-count"];
var o=["Fraud score","Accepted transactions","Total refused transactions","Refused by RevenueProtect tx","Refused by bank tx"];
f.createCSV(p,n,o,"FraudScoreDistributionOfTransactions");};k.createObjectForCSV=function(){var n=g.map(this.formattedData,function(o){var p={totalRefused:o.y};
p.fraudScore=String(o.x)+" to "+String(o.x+(o.dx-1));g.each(o.stacksArray,function(q){p[q.name]=q.frequency;});return p;});
return n;};k.getData=function(){return(this.data)?this.data:this.formatData();};k.setRawData=function(n){this.data=n;};k.retrieveData=function(n){return this.data[n];
};return k;};return e;});define("chart/widgetFramework/core/mixins/formats",["d3","jquery","chartutil/d3utils"],function(c,d,b){var a={};a.defaultNoOp=function(e){if(e==="getInfo"){return"returns unformatted value - useful for testing";
}return function(f){return f;};};a.defaultLinearFormat=function(e){if(e==="getInfo"){return"Adds SI Prefix to 1st tick. Compares tick to see if any have decimal values";
}return function(g,f){return b.thousandsFormatter(g,f,this.scales[e]);};};a.linearFormatSmartRounding=function(e){if(e==="getInfo"){return"0 < Ticks < 10 that have a form like 2.0 are rounded, other ticks are rounded to 2 significant digits";
}return function(g){var f=Math.abs(g);if(g%1===0&&f<10){return c.format(",.0f")(g);}else{if(f<1){return c.format(",.1r")(g);
}else{return c.format(",.2r")(g);}}};};a.linearFormatSmartRoundingSI=function(e){if(e==="getInfo"){return"Numbers rounded to 2 significant digits. SI suffix added";
}return function(h){var f=Math.abs(h);if(h%1===0&&f<10){return c.format(",.0f")(h);}else{if(f<1){return c.format(",.1r")(h);
}else{var g=Number(c.format(",.2r")(h).replace(/[,\.]/g,""));return b.numberFormatter(g);}}};};a.thousandsLinearFormat=function(e){if(e==="getInfo"){return"Adds SI Prefix to all ticks";
}return function(f){return b.numberFormatter(f);};};a.roundNumberFormat=function(e){if(e==="getInfo"){return"Rounds, no decimal places";
}return function(f){return c.format(".0f")(f);};};a.integerFormat=function(e){if(e==="getInfo"){return"Rounds, no decimal places";
}return function(f){return c.format(",d")(f);};};a.firstNumberOnlyFormat=function(e){if(e==="getInfo"){return"Only returns first value, unformatted. Other ticks are hidden";
}return function(g,f){return(f===0)?g:"";};};a.defaultPercentNoSymbol=function(e){if(e==="getInfo"){return"Value *= 100. Rounds result. No % symbol";
}return function(f){return Math.round(f*100);};};a.defaultPercentFormat=function(e){if(e==="getInfo"){return"Value *= 100. Suffix with '%'";
}return function(f){return c.format("%")(f);};};a.percentFormat=function(e){if(e==="getInfo"){return"Don't *= 100. Ticks to 1 decimal place with % symbol";
}return function(f){return c.format(".1f")(f)+"%";};};a.percentFormatSmartRounding=function(e){if(e==="getInfo"){return"Don't *= 100. 0 < Ticks < 10 that have a form like 2.0 are rounded, other ticks are rounded to 2 significant digits. With % symbol at the end";
}return function(g){var f=Math.abs(g);if(g%1===0&&f<10){return c.format(",.0f")(g)+"%";}else{if(f<1){return c.format(",.1r")(g)+"%";
}else{return c.format(",.2r")(g)+"%";}}};};a.percentFormatSmartRounding2=function(e){if(e==="getInfo"){return"Don't *= 100. Detects whole number or 1 dec place or 2 dec places. % symbol at the end";
}return function(j){var g=j%1;if(g===0){return c.format(",.0f")(j)+"%";}else{var h=g.toFixed(2);var i=h.indexOf(".");var f=h.substr(i+1);
if(f.charAt(1)==="0"){return c.format(",.1f")(j)+"%";}else{return c.format(",.2f")(j)+"%";}}};};a.percentFormat_2dec=function(e){if(e==="getInfo"){return"Don't *= 100. Ticks to 2 decimal places with % symbol";
}return function(f){return c.format(".2f")(f)+"%";};};a.firstPercentFormat=function(e){if(e==="getInfo"){return"Don't *= 100. Ticks to 1 decimal place. '%' only on 1st tick";
}return function(g,f){return(f>0)?g:c.format(".1f")(g)+"%";};};a.firstPercentOnlyFormat=function(e){if(e==="getInfo"){return"Don't *= 100. 1st tick to 1 decimal place with '%'. Other ticks hidden";
}return function(g,f){return(f===0)?c.format(".1f")(g)+"%":"";};};a.defaultTimeFormat=function(f,e){if(f==="getInfo"){return"Expects date. Return formatted day|week|month (%d|wk + num|%b)";
}return function(g){return b.constants.granularityFormatsNonUTC[e](g);};};a.timeSimple=function(e){if(e==="getInfo"){return"Returns tick index + 1";
}return function(g,f){return parseInt((f+1).toString());};};a.timeMonthFormat=function(e){if(e==="getInfo"){return"Show short month name";
}var f=c.time.format("%d");return function(g){return f(g);};};a.firstTimeFormatWidget=function(e){if(e==="getInfo"){return"Returns formatted date. First tick has extra info e.g. day + month";
}return function(k,f){var j=(this.configData&&this.configData.granularity)?this.configData.granularity:"day";var g=c.time.format("%d");
if(j==="week"||j==="monday"){return(f>0)?"wk "+k.getWeek(true):k.getFullYear()+" wk "+k.getWeek(true);}var h;if(f>0){h=(this.granularityFormats)?this.granularityFormats[j]:g;
}else{if(this.granularityFormats){h=(this.granularityFormats[j+"_start"])?this.granularityFormats[j+"_start"]:this.granularityFormats[j];
}else{h=g;}}return h(k);};};a.defaultOrdinalFormat=function(e){if(e==="getInfo"){return"Expects string: if more than 14 chars reduce to 11 & add '...'";
}return function(f){return(f.length>14)?d.trim(f).substring(0,11).trim(this)+"...":f;};};a.fullOrdinalFormat=function(e){if(e==="getInfo"){return"Expects string: Returns full, untruncated string";
}return function(f){return f;};};a.ordinalRemoveLabel=function(){return function(e){return(e.toLowerCase().indexOf(this.stripLabel)>-1)?"":e;
};};a.euroFormat=function(e){if(e==="getInfo"){return"Forces numbers to two decimal places. Adds euro symbol";}return function(f){return"\u20AC "+c.format(".2f")(f);
};};a.euroFormatSmartRounding=function(e){if(e==="getInfo"){return"Forces numbers to be rounded to 2 significant digits for better overall rounding (but round numbers between 0 and 9 are rounded). Adds euro symbol to front";
}return function(g){var f=Math.abs(g);if(g%1===0&&f<10){return"\u20AC "+c.format(",.0f")(g);}else{if(f<1){return"\u20AC "+c.format(",.1r")(g);
}else{return"\u20AC "+c.format(",.2r")(g);}}};};a.euroFormatSmartRoundingSI=function(e){if(e==="getInfo"){return"Numbers rounded to 2 significant digits. Adds euro symbol to front. SI suffix to rear";
}return function(h){var f=Math.abs(h);if(h%1===0&&f<10){return"\u20AC "+c.format(",.0f")(h);}else{if(f<1){return"\u20AC "+c.format(",.1r")(h);
}else{var g=Number(c.format(",.2r")(h).replace(/[,\.]/g,""));return"\u20AC "+b.numberFormatter(g);}}};};a.lastTickFormat=function(e,i,h){var g=[];
var f=6;e.dimensionsYArray.forEach(function(l){var k=e.yAxesHolders[l].selectAll("text");var j;k.each(function(p,n){var o=this.textContent.replace(/[^0-9\.]/gi,"");
var m=Number(o);if(h){m=c.format(h)(m);}g.push(m);if(n===(k[0].length-1)){j=c.select(this);}});if(i){b.smartPercentageFormat(e.yAxesHolders[l]);
}else{k.text(function(n,m){if(m<g.length-1){return g[m];}else{return this.textContent;}});}if(j){if(j.text().indexOf("k")>-1){f=3;
}if(j.text().indexOf("M")===-1&&j.text().indexOf("k")===-1&&j.text().indexOf("%")===-1){f=j.attr("x");}j.transition().duration(150).ease("linear").attr("x",f);
}});};return a;});define("chart/widgetFramework/core/mixins/lineDrawingUtils",["jquery","underscore","d3"],function(e,a,b){var d={};d.defined=function(f){return true;
};d.lineCreator=function(o,v,q,g,m,i,l){var u,k,p,t;if(!v){v="linear";}if(l){u=l.attr("d");}if(u){k=u.split(o);var j=q.length;
p=k.length;if(j>p){if(i!=="end"){i="mixin";}}else{return u;}}var h=b.svg.line().interpolate(v).defined(this.defined).x(g);
if(i==="enter"||i==="end"){h.y(function(w){return 0;});}else{if(i==="update"){h.y(m);}else{if(i==="mixin"){h.y(function(w){return 0;
});t=h(q);var s=t.split(o);var r=a.drop(s,p);var n=k.concat(r);var f=n.join(o);l.style("opacity",0.000001);return f;}}}t=h(q);
return t;};var c=0;d.checkLabelPos=function(f,h,j,m){var l=h.length;for(var k=0;k<l;k++){var g=h[k].targetY;var r=h[k].order;
var q=h[k].who;var o=Math.floor(g-f);if(c===0){if(o<0){c=1;}else{c=-1;}}var n=4*c;var p=o;if(p<0){p*=-1;}if(p<12){f+=n;return d.checkLabelPos(f,h,j,m);
}}c=0;h.push({targetY:f,order:j,who:m});return f;};return function(){return Object.create(d);};},function(a){if(window.console&&console.log){console.log("APP JS ERROR =",a);
}});define("chart/widgetFramework/core/drivers/axisBaseView",["jquery","underscore","d3","util/Functional","util/ObjectSuper","chart/widgetFramework/core/drivers/baseView","chart/widgetFramework/core/mixins/barDrawingUtils","chart/widgetFramework/core/mixins/lineDrawingUtils","chartutil/d3utils","chart/widgetFramework/core/constants/WidgetConstants","chart/widgetFramework/core/mixins/formats"],function(d,i,l,b,h,f,g,a,k,e,c){var j=function(q,m){var p={barHeight:null,barWidth:null};
var n=i.defaults(q,p);var o=f(n,m);var r=h(o);o.isBarChart=true;o.hasXAxis=true;o.hasYAxis=true;o.init=function(){r.init();
this.createDimensionStorageObjects();if(this.isBarChart){this.barUtils=g();}else{this.lineUtils=a();}this.barPositioningFn=null;
this.bandSize=0;this.barSize=0;this.granularityFormats={};this.granularityFormats.day=l.time.format("%d");this.granularityFormats.day_start=l.time.format("%b %d");
this.granularityFormats.month=l.time.format("%b");this.granularityFormats.month_start=l.time.format("%b '%y");};o.setBandSizes=function(){if(b.notFalsy(this.data)){var s,t=this.getData();
if(typeof t==="function"){s=t().length;}else{s=t.length;}if(this.options.variation===e.VERTICAL){this.bandSize=(this.width/s);
this.barSize=this.horizBarSize=(this.bandSize*(1-this.options.barPadding));}else{this.bandSize=(this.height/s);this.barSize=this.vertBarSize=(this.bandSize*(1-this.options.barPadding));
}}};o.setNestedAttr=function(v,u,x){if(b.falsy(v)){return;}var w=(u===true||u===false)?u:null;var t=(x===true||x===false)?x:null;
if(typeof this.options.nestedAttr!=="undefined"&&typeof this.options.nestedAttr==="string"){v=this.options.nestedAttr;}if((typeof v!=="undefined"&&typeof v==="string")){this.nestedAttr=v;
if(w){this.options.nestedXAttr=v;if(t===null||t){this.options.nestedYAttr=v;}}if(t){this.options.nestedYAttr=v;}return;}var y=k.detectNestedArrays(v,true);
var s=y.length;if(s===1){this.nestedAttr=y[0];if(w){this.options.nestedXAttr=y[0];if(t===null||t){this.options.nestedYAttr=y[0];
}}if(t){this.options.nestedYAttr=y[0];}}else{if(s===0){if(window.console&&console.log){console.error("### baseAxisView::setNestedAttr:: I can find no nested data to use to set nestedAttr!");
}}else{if(window.console&&console.log){console.error("### baseAxisView::feedData:: I'm confused over what the nestedAttr should be: ",y);
}}}};o.initRender=function(){r.initRender();this.renderTickDelay=this.options.yAxisTranTime+50;this.axisGroup=this.mainGroup.insert("g",".chart-elements-holder").attr("class","axis-elements-holder");
if(!b.falsy(this.dimensionsXArray)){i.each(this.dimensionsXArray,function(t){var s=o.axisGroup.append("g").attr("class",("x axis "+t)).attr("opacity",0.000001).attr("transform","translate(0,0)");
o.xAxesHolders[t]=s;});if(this.dimensionsXArray.length===1){this.options.xAttr=this.dimensionsXArray[0];}}else{this.xAxis=this.axisGroup.append("g").attr("class",("x axis")).attr("opacity",0.000001).attr("transform","translate(0,0)");
}if(!b.falsy(this.dimensionsYArray)){i.each(this.dimensionsYArray,function(t){var s=o.axisGroup.append("g").attr("class",("y axis "+t)).attr("opacity",0.000001);
o.yAxesHolders[t]=s;});if(this.dimensionsYArray.length===1){this.options.yAttr=this.dimensionsYArray[0];}}else{this.yAxis=this.axisGroup.append("g").attr("class",("y axis")).attr("opacity",0.000001);
}this.setScales();this.setAxes();};o.render=function(){this.chartHeight=this.$el.height();this.chartWidth=this.$el.width();
if(this.options.barHeight!==null&&b.notFalsy(this.data)){this.height=(this.data.length*this.options.barHeight);this.chartHeight=this.height+this.options.margin.top+this.options.margin.bottom;
this.$el.css("height",this.chartHeight+"px");}if(this.options.barWidth!==null&&b.notFalsy(this.data)){this.width=(this.data.length*this.options.barWidth);
this.chartWidth=this.width+this.options.margin.left+this.options.margin.right;this.$el.css("width",this.chartWidth+"px");
}this.topSVG.attr("width",this.chartWidth+"px").attr("height",this.chartHeight+"px");this.showCharts();this.update();return this;
};o.update=function(){this.calibrateScales();this.renderXAxis();this.renderYAxis();this.setBandSizes();if(this.isBarChart){this.barUtils.chartWidth=this.width;
this.barUtils.chartHeight=this.height;if(this.options.variation===e.VERTICAL){if(this.dimensionsXArray.length===1||!this.hasXAxis){this.barPositioningFn=this.barUtils.barPosition(this.options.centerBars,this.bandSize,this.getXScale(),this.options.xAttr);
}}else{if(this.dimensionsYArray.length===1||!this.hasYAxis){this.barPositioningFn=this.barUtils.barPosition(this.options.centerBars,this.bandSize,this.getYScale(),this.options.yAttr);
}}}this.renderData();};o.createDimensionStorageObjects=function(u){var t=true,s=true;if(u){if(u.indexOf("x")===-1){t=false;
}if(u.indexOf("y")===-1){s=false;}}if(t){this.dimensionsXArray=[];this.xScaleCreationFns={};this.xAxisCreationFns={};this.calibrateXScaleFns={};
this.formatXAxisFns={};this.renderXAxisFns={};this.xAxesHolders={};}if(s){this.dimensionsYArray=[];this.yScaleCreationFns={};
this.yAxisCreationFns={};this.calibrateYScaleFns={};this.formatYAxisFns={};this.renderYAxisFns={};this.yAxesHolders={};}};
o.setScales=function(){this.scales={};this.setXScale();this.setYScale();};o.calibrateScales=function(){this.calibrateXScale();
this.calibrateYScale();};o.setAxes=function(){this.axes={};this.setXAxis();this.setYAxis();};o.setXScale=function(){this.callFunctionsByKey(this.dimensionsXArray,this.xScaleCreationFns);
};o.setYScale=function(){this.callFunctionsByKey(this.dimensionsYArray,this.yScaleCreationFns);};o.setXAxis=function(){this.callFunctionsByKey(this.dimensionsXArray,this.xAxisCreationFns);
};o.setYAxis=function(){this.callFunctionsByKey(this.dimensionsYArray,this.yAxisCreationFns);};o.formatXAxis=function(){this.callFunctionsByKey(this.dimensionsXArray,this.formatXAxisFns);
};o.formatYAxis=function(){this.callFunctionsByKey(this.dimensionsYArray,this.formatYAxisFns);};o.calibrateXScale=function(){this.callFunctionsByKey(this.dimensionsXArray,this.calibrateXScaleFns);
};o.calibrateYScale=function(){this.callFunctionsByKey(this.dimensionsYArray,this.calibrateYScaleFns);};o.renderXAxis=function(){this.formatXAxis();
this.callFunctionsByKey(this.dimensionsXArray,this.renderXAxisFns);};o.renderYAxis=function(){this.formatYAxis();this.callFunctionsByKey(this.dimensionsYArray,this.renderYAxisFns);
if(this.options.suffixLastYTickOnly){c.lastTickFormat(this,this.options.yAxisIsPercent);setTimeout(function(){c.lastTickFormat(o,o.options.yAxisIsPercent);
},o.renderTickDelay);}};o.callFunctionsByKey=function(t,s){i.each(t,function(u){s[u].apply(o);});};o.getXScale=function(){return this.scales[this.options.xAttr]||null;
};o.getYScale=function(){return this.scales[this.options.yAttr]||null;};o.showCharts=function(){this.$el.find(".no-data-text").remove();
var s=this.$el.children().not(".no-data-text");s.each(function(){var t=d(this)[0].className.baseVal;if(t&&t.indexOf(o.chartType)>-1){d(this).show();
}});};o.createOptions=function(s){i.assign(this.options,s);};o.reset=function(){this.$el.width(this.options.width);this.$el.height(this.options.height);
var u=this.options.margin;this.width=this.$el.width()-(u.left+u.right);this.height=this.$el.height()-(u.top+u.bottom);this.mainGroup.attr("transform","translate("+u.left+","+u.top+")");
var w=this.options.xAttr;this.options.xAttr=this.dimensionsXArray[0];var v=this.axisGroup.select(".x.axis."+w).attr("class",("x axis "+this.options.xAttr)).attr("opacity",0.000001).attr("transform","translate(0,0)");
o.xAxesHolders[this.options.xAttr]=v;var t=this.options.yAttr;this.options.yAttr=this.dimensionsYArray[0];var s=this.axisGroup.select(".y.axis."+t).attr("class",("y axis "+this.options.yAttr)).attr("opacity",0.000001);
o.yAxesHolders[this.options.yAttr]=s;this.setScales();this.setAxes();};return o;};return j;});define("chart/widgetFramework/chartTypes/stackedBar",["jquery","underscore","d3","hogan","util/Functional","util/ObjectSuper","chart/widgetFramework/core/drivers/axisBaseView","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/core/constants/WidgetConstants","chartutil/d3utils"],function(c,h,k,e,b,f,i,g,d,j){var a=function(n,p,s,r){var o;
var l={};var q="";var t=h.defaults(n,l);o=i(t,p);var m=f(o);o.timeline=s;o.init=function(){m.init();};o.feedData=function(u){var v=m.feedData(u);
if(this.timeline){this.configData.granularity=this.timeline.getGranularity();}if(b.falsy(this.data)){return;}this.setNestedAttr(this.data);
return v;};o.getStackData=function(){return function(u){return u[o.nestedAttr];};};o.getSecondaryDataJoin=function(){return this.getDataJoin("name");
};o.renderData=function(){if(b.falsy(this.data)){this.hideCharts("no data to display");return;}var w=this,y=this.scales[this.options.xAttr],x=this.scales[this.options.yAttr],u=this.options.centerBars;
var v;if(this.options.variation===d.VERTICAL){v=this.barUtils.containerBarsVertical(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),this.barPositioningFn,true).stackVertical(this.getStackData(),this.getSecondaryDataJoin(),x,this.barSize);
}else{v=this.barUtils.containerBarsHorizontal(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),this.barPositioningFn,true).stackHorizontal(this.getStackData(),this.getSecondaryDataJoin(),y,this.barSize);
}this.addLabels();return v;};o.addLabels=function(){};return o;};return a;});define("chart/widgetFramework/composed/harpViewer/baselineStackedChart",["jquery","underscore","d3","hogan","util/Functional","util/ObjectSuper","chart/widgetFramework/chartTypes/stackedBar","chart/widgetFramework/core/constants/UIConstants"],function(c,h,i,e,b,f,d,g){var a=function(l,n,q,p){var m;
var j={};var o="";var r=h.defaults(j,l);m=d(r,n);var k=f(m);m.el=n;m.setBandSizes=function(){k.setBandSizes();this.barSize*=0.5;
};m.formatXAxis=function(s){this.baselineFormatTimeXAxis(this.options.xAttr);};m.baselineFormatTimeXAxis=function(w){var u=this,t=this.axes[w],v=this.configData.granularity,x="wk ",s=this.scales[w].ticks(i.time[v],1).length;
if(s>40){v="month";}this.axisGranularity=v;t.ticks(i.time[v],1).tickFormat(function(A,y){var z;if(y>0){z=u.granularityFormats[v];
}else{if(s>25&&v==="day"){z=u.granularityFormats[v];}else{z=u.granularityFormats[v+"_start"];}}return z(A);});};m.renderXAxis=function(){k.renderXAxis();
if(this.axisGranularity==="month"){var t=this.dimensionsXArray[0];var s=this.xAxesHolders[t].selectAll(".tick");this.$el.trigger(g.CHART_TO_VIEW_EVENT,{type:"aggregateData",data:{ticks:s,baselineData:this.data}});
}else{this.$el.trigger(g.CHART_TO_VIEW_EVENT,{type:"aggregateData",data:{ticks:null,baselineData:null}});}};return m;};return a;
});define("chart/widgetFramework/chartTypes/lineChart",["jquery","underscore","d3","hogan","util/Functional","chartutil/d3utils","chartutil/stringutils","util/ObjectSuper","chart/widgetFramework/core/drivers/axisBaseView"],function(c,f,i,d,a,j,b,e,g){var h=function(o,q,s,r){var k="Default Line Name";
var p;var m={};var t=f.defaults(o,m);p=g(t,q);var n=e(p);p.isBarChart=false;p.timeline=s;p.tranTime=500;p.toggleLineChar="\u2716";
p.defaultLineClass="line-holder";var l=true;p.init=function(){n.init();this.$resetBtn=this.$el.find(".reset-line-icon");setTimeout(function(){p.$resetBtn.css("display","none");
},10);this.$resetBtn.on("click",function(){p.data=p.masterData;p.render();p.$resetBtn.css("display","none");});};p.initRender=function(){n.initRender();
this.$resetBtn.css("left",(this.$el.width()-(20))+"px");};p.feedData=function(u){var v=n.feedData(u);this.masterData=this.data;
if(this.timeline){this.configData.granularity=this.timeline.getGranularity();}if(a.falsy(this.data)){if(l){l=false;var w=a.notFalsy(this.options.nestedAttr)?this.options.nestedAttr:"lineValues";
this.setNestedAttr(w,true);}return;}this.setNestedAttr(this.data,true);return v;};p.setBandSizes=function(){if(a.notFalsy(this.data)){this.maxLinePoints=0;
f.each(this.data,function(v){var u=v[p.nestedAttr].length;if(u>p.maxLinePoints){p.maxLinePoints=u;}});this.bandSize=(this.width/this.maxLinePoints);
this.barSize=this.horizBarSize=(this.bandSize*(1-this.options.barPadding));}};p.xAccessor=function(w){var u=this.scales[this.options.xAttr],v=this.options.centerPoints;
if(v){return function(y,x){return((p.bandSize*x)+(p.bandSize/2));};}else{return function(x){return u(p.getXAttrVal(x));};
}};p.yAccessor=function(u){var v=this.scales[this.options.yAttr];return function(w){return v(p.getYAttrVal(w));};};p.getLineData=function(u){return u[this.nestedAttr];
};p.renderData=function(){this.dropEmptyData();if(a.falsy(this.data)){this.hideCharts("no data to display");return;}var K=this.scales[this.options.xAttr],H=this.scales[this.options.yAttr],J=this.tranTime,w=this.options.centerPoints,u=this.options.lineDataProp||this.options.joinAttr||"",F=this.options.interpolate||"linear",v=[],G,E,I=[];
var D=this.chartGroup.selectAll("."+this.defaultLineClass).data(this.getData(),this.getPrimaryDataJoin());var C=D.enter().append("g").attr("class",this.defaultLineClass).append("path").attr("class","line");
if(this.options.allowToggleLine){var L=D.transition().duration(J).ease("exp-in-out").style("opacity",1);}D.attr("class",function(x){return p.getClassName("",x[u]);
});D.select(".line").attr("d",function(x){return p.lineUtils.lineCreator("L",F,p.getLineData(x),p.xAccessor(x),p.yAccessor(x),"enter",i.select(this));
}).transition().duration(J).ease("exp-in-out").style("opacity",1).attr("d",function(x){return p.lineUtils.lineCreator("L",F,p.getLineData(x),p.xAccessor(x),p.yAccessor(x),"update");
});p.performLineExit(D,F,J);if(this.options.hasDots){G=D.selectAll("."+this.defaultLineClass+"-dot").data(function(x){return p.getLineData(x);
});var M=G.enter().append("circle").attr("class",p.defaultLineClass+"-dot").attr("cx",function(y,x){if(w){return((p.bandSize*x)+(p.bandSize/2));
}else{return K(p.getXAttrVal(y));}}).attr("cy",function(x){return 0;}).attr("r",3);G.attr("class",function(x){return p.getClassName("-dot",x[u]);
});G.transition().duration(J).ease("exp-in-out").each(function(O){var y=c(i.select(this).node());var x=O[u];if(!x){x=k;}var N=b.lowerCaseReplaceSpace(x,"-");
if(N.length&&N!=="undefined"){y.attr("data-id",N);}}).attr("cx",function(y,x){if(w){return((p.bandSize*x)+(p.bandSize/2));
}else{return K(p.getXAttrVal(y));}}).attr("cy",function(x){return H(x[p.options.yAttr]);}).style("opacity",1);var A=G.exit().transition().duration(J).attr("cy",function(x){return p.height+10;
}).style("opacity",0).remove();}else{G=D.selectAll("."+this.defaultLineClass+"-dot").transition().duration(J).attr("cy",function(x){return p.height+10;
}).style("opacity",0).remove();}if(this.options.hasLabels){var B;E=this.chartGroup.selectAll("."+this.defaultLineClass+"-label").data(this.getData(),this.getPrimaryDataJoin());
E.enter().append("text").attr("class",function(x){this.masterD=x;return p.defaultLineClass+"-label";}).style("cursor",function(x){if(p.options.allowToggleLine){c(this).attr("data-col",c(this).css("fill"));
return"pointer";}else{return"auto";}}).attr("dy",".35em").attr("y",0).on("mousedown",function(x){if(p.options.allowToggleLine){p.hideLine(this.masterD,this);
p.$resetBtn.css("display","inline");}else{return null;}});E.attr("class",function(x){return p.getClassName("-label",x[u]);
}).datum(function(O){var y=O[p.nestedAttr];if(a.falsy(y)){O.labelPosValue=-1;return O;}var N=f.findLast(y,function(P){return P[p.options.yAttr]!==null;
});var x=N[p.options.yAttr];O.labelPosValue=x;return O;}).sort(function(y,x){return y.labelPosValue<x.labelPosValue;}).transition().duration(J).attr("x",this.width+10).attr("y",function(y){var x=p.lineUtils.checkLabelPos(H(y.labelPosValue),v,y.labelPosValue,y[p.options.lineDataProp]);
y.yPos=x;return x;}).text(function(x){if(x.labelPosValue===-1){return"";}if(p.options.allowToggleLine){B=p.getLabelName(x);
return B+" "+p.toggleLineChar;}else{B=p.getLabelName(x);return B;}});if(this.options.allowToggleLine){E.style("opacity",1).style("cursor","pointer");
}else{E.style("cursor","initial");}var z=E.exit().transition().duration(J).attr("y",function(){if(p.options.allowToggleLine){return -5;
}return p.height+10;}).style("opacity",function(x){if(p.options.allowToggleLine){return 0.2;}return 0;}).style("cursor","default").each(function(){if(p.data.length===p.masterData.length){i.select(this).remove();
}});}else{E=this.chartGroup.selectAll("."+this.defaultLineClass+"-label").transition().duration(J).attr("y",function(x){return p.height+10;
}).style("opacity",0).remove();}};p.dropEmptyData=function(){if(this.data){var v=this.data.length;for(var u=v-1;u>-1;u--){if(a.falsy(this.data[u][this.nestedAttr])){this.data.splice(u,1);
}}}};p.performLineExit=function(w,v,u){};p.getClassName=function(u,w){if(!w){w=k;}var v=b.lowerCaseReplaceSpace(w,"-");if(w&&v.length){return this.defaultLineClass+u+" "+v;
}else{return this.defaultLineClass+u;}};p.getLabelName=function(w){var u=this.options.lineDataProp||this.options.joinAttr||"";
var v=w[u];if(!v){v=k;}return b.lowerCaseReplaceSpace(v,"-");};p.hideLine=function(A,y){var x=c(y).attr("class");var v=x.match(/\s(.*)/)[1];
var u="."+this.defaultLineClass+".";var w=v.replace(/\s+/g,".");if(v.length){var z=this.$el.find(u+w);z.fadeTo(250,0);this.filterData(A);
}};p.filterData=function(v){var u=this.options.lineDataProp||this.options.joinAttr;var w=f.filter(this.data,function(x){return x[u]!==v[u];
});this.data=w;this.render();};return p;};return h;});define("chart/widgetFramework/composed/chargebackReport/cfnLineChart",["jquery","underscore","chart/widgetFramework/core/mixins/formats","util/ObjectSuper","chart/widgetFramework/chartTypes/lineChart"],function(f,c,e,d,b){var a=function(l,g,j){var i;
var k={};var h=c.defaults(k,l);i=b(h,g,j);var m=d(i);i.renderYAxis=function(){m.renderYAxis();};i.getLabelName=function(n){return n[this.options.joinAttr];
};return i;};return a;});define("chart/widgetFramework/chartTypes/axisRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/core/constants/WidgetConstants","chart/widgetFramework/core/drivers/axisBaseView"],function(c,j,k,a,g,i,h,f,e,d){function b(q,l){var n;
var p={};var m=j.defaults(p,q);n=d(m,l);var r=h(n);var o=false;n.init=function(){r.init();this.barUtils.setBarSelectorStr(".bar.rollover");
};n.initRender=function(){r.initRender();n.topSVG.style("background-color","rgba(0, 0, 0, 0)");n.axisGroup.remove();};n.renderData=function(){if(a.falsy(this.data)&&!o){return;
}if(this.options.variation===e.VERTICAL){if(this.dimensionsYArray.length===0){this.barUtils.containerBarsVertical(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),this.barPositioningFn,true).fullBarVertical(this.barSize);
}else{this.barUtils.containerBarsVertical(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),this.barPositioningFn,true).barVertical(this.options.yAttr,this.getYScale(),this.barSize);
}}else{if(this.dimensionsXArray.length===0){this.barUtils.containerBarsHorizontal(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),this.barPositioningFn,true).fullBarHorizontal(this.barSize);
}else{this.barUtils.containerBarsHorizontal(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),this.barPositioningFn,true).barHorizontal(this.options.xAttr,this.getXScale(),this.barSize);
}}o=true;};n.setTooltipsOnElements=function(s){r.setTooltipsOnElements(s);};n.positionTooltip=function(t,v,y,s,x,u,w){return r.positionTooltip(t,v,y,s,x,u,w);
};n.enhanceTooltipData=function(s){};n.tooltipOnMouseoverAction=function(){};n.tooltipOnMouseoutAction=function(s){};n.hideCharts=function(s){};
return n;}return b;});define("chart/widgetFramework/composed/transactionsDashboard/rollovers/authTxStackRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/chartTypes/axisRollover"],function(c,i,j,a,f,h,g,e,d){function b(o,k){var m;
var n={};var l=i.defaults(n,o);m=d(l,k);var p=g(m);m.init=function(){p.init();this.barUtils.setBarSelectorStr(".bar.auth-tx-rollover");
this.hasXAxis=!this.options.centerBars;};m.positionTooltip=function(r,t,x,q,w,s,v){var u=p.positionTooltip(r,t,x,q,w,s,v);
u.top-=5;return u;};m.enhanceTooltipData=function(q){q.authorisedCountTT=j.format("0,000")(q.authorizedCount);q.refusedCountTT=j.format("0,000")(q.refusedCount);
};return m;}return b;});define("chartutil/cssutils",["jquery"],function(b){var a={};a.rotateElement=function(e,f,d,c){var f=(typeof f==="undefined")?180:f,d=d||0,c=c||0;
b(e).css({transform:"rotate("+f+"deg) translateX("+d+"px) translateY(-"+c+"px)"});return e;};a.rotateElement2=function(f,e,h,g){var i=(typeof e==="undefined")?180:e,d=h||0,c=g||0;
b(f).css({transform:"rotate("+i+"deg) translateX("+d+"px) translateY("+c+"px)"});return f;};return a;});define("chart/widgetFramework/core/BasicMediator",["jqueryExtended","lodash","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/core/constants/DataConstants","util/Functional","chartutil/domUtils"],function(a,j,h,f,d,g){var c=false;
var k="color:darkblue;font-size:1em";var b=false;var e="color:darkgreen;font-size:1em";var i=function(o,m){var p={};p.init=function(){j.bindAll(this,"onNotifiedFormatter","onNotifiedViewCreator","onNotifiedFetcher");
this.actionCommanderExclusionArray=["actioncommander","dataformatter","viewcreator","timeline","snapshot","basicmediator"];
this.chartInstances=[];this.fetcherInstances=[];this.formatterInstances=[];this.allInstances=[];this.$el=o.getNode();this.parameters=this.getParameters(o);
this.id=this.$el.attr("id");this.eventOptions=this.parameters.events;this.hasSetupOwnEvents=false;if(typeof this.eventOptions==="string"&&this.eventOptions.length>0){console.error("## BasicMediator - mediator's data-actions have not parsed correctly: check markup to make sure there isn't a problem with the JSON string");
}this.$allFetchers=this.$el.find("[data-widget*=DataFetcher]");this.$allFormatters=this.$el.find("[data-widget*=DataFormatter]");
this.$allCharts=this.$el.find("[data-widget*=ViewCreator]");this.totalDomElements=this.$allFetchers.length+this.$allFormatters.length+this.$allCharts.length;
this.getAdditionalDOMElements();setTimeout(function(){if(!p.hasSetupOwnEvents&&this.totalDomElements>0){console.error("### BasicMediator: hasSetupOwnEvents has not run - check that all observables and widgets have called back");
console.error("### BasicMediator: hasSetupOwnEvents has not run - this.totalDomElements=",p.totalDomElements);console.error("### BasicMediator: hasSetupOwnEvents has not run - this.allInstances.length=",p.allInstances.length);
j.each(p.allInstances,function(q){if(window.console&&console.log){console.log("### BasicMediator::all instances:: pInst=",q);
}});}},2000);this.acCount=0;this.getObservables();this.getWidgets();};p.getAdditionalDOMElements=function(){this.actionCommanderInstances=[];
this.$actionCommanders=o.__$node.find("[data-widget*=ActionCommander]");this.totalDomElements+=this.$actionCommanders.length;
};p.getObservables=function(){this.getObservableInstances(this.$allFetchers,"onNotifiedFetcher",this.fetcherInstances,"Fetchers");
this.getObservableInstances(this.$allFormatters,"onNotifiedFormatter",this.formatterInstances,"Formatters");this.getObservableInstances(this.$allCharts,"onNotifiedViewCreator",this.chartInstances,"VizComps");
};p.getWidgets=function(){if(this.$actionCommanders.length){this.getWidgetInstances(this.$actionCommanders,this.actionCommanderInstances,"ActionCommander");
}};p.getObservableInstances=function(r,t,s,q){j.each(r,function(u){if(window.console&&console.log&&c){console.log("\n### BasicMediator2::getObservableInstances:: getting ",u.id," promise----");
}a(u).widget().then(function(v){var x=v.instance;if(window.console&&console.log&&c){console.log("%c\n################",k);
console.log("%c### INIT STAGE :: BasicMediator::"+p.id+'::WIDGET PROMISE RESOLVED: pFn="'+t,k);console.log("%c### INIT STAGE :: BasicMediator::",p.id,"::WIDGET PROMISE RESOLVED: - widgetRef= ",v);
console.log("%c### INIT STAGE :: BasicMediator::",p.id,"::WIDGET PROMISE RESOLVED: - widgetRef.instance= ",x);console.log("%c### INIT STAGE :: BasicMediator::",p.id,"::WIDGET PROMISE RESOLVED:  - widgetRef.instance.id= ",x.id);
console.log("%c################",k);}n(x,p,t);l(s,x,p);var w=p.checkInstancesReady(s,r,q);if(w){p.setUpOwnEvents();}});});
};p.getWidgetInstances=function(r,s,q){j.each(r,function(t){a(t).widget().then(function(u){l(s,u.instance,p);var v=p.checkInstancesReady(s,r,q);
if(v){p.setUpOwnEvents();}});});};p.setUpOwnEvents=function(){var q=this.allInstances;if(q.length!==this.totalDomElements){if(window.console&&console.log&&c){console.log("%c\n################",k);
console.log("%c### INIT STAGE :: BasicMediator::"+this.id+"::setUpOwnEvents:: NOT EVERYTHING INSTANTIATED YET",k);console.log("%c################",k);
}return false;}if(window.console&&console.log&&c){console.log("%c\n################",k);console.log("%c### INIT STAGE :: BasicMediator::"+this.id+"::setUpOwnEvents:: EVERYTHING READY",k);
console.log("%c################",k);}q.push(this);this.hasSetupOwnEvents=true;if(this.actionCommanderInstances.length>0){j.each(this.actionCommanderInstances,function(r){var t=p.filterAllInstances(p.actionCommanderExclusionArray);
var s=r.pushAllInstances(t);s.done(function(){p.mediatorReady();});});}else{this.acCount=-1;this.mediatorReady();}return true;
};p.mediatorReady=function(){this.acCount++;if(this.acCount!==this.actionCommanderInstances.length){return;}if(window.console&&console.log){console.log("%c\n################",k);
console.log("%c### INIT STAGE :: BasicMediator::"+this.id+"::WIDGET_APP_STARTUP!!!!!!!!!!!!!!",k);console.log("%c################",k);
}this.$el.trigger(h.WIDGET_APP_STARTUP);};p.onNotifiedFetcher=function(r,q){if(window.console&&console.log&&b){console.log("%c\n################",e);
console.log("%c### START STAGE :: BasicMediator::"+this.id+"::onNotifiedFetcher :: pId="+q+" pData.type= "+r.changeObject.type,e);
console.log("%c################",e);}};p.onNotifiedFormatter=function(r,q){if(window.console&&console.log&&b){console.log("%c\n################",e);
console.log("%c### START STAGE :: BasicMediator::"+this.id+"::onNotifiedFormatter :: pId="+q+" pData.type= "+r.changeObject.type,e);
console.log("%c################",e);}};p.onNotifiedViewCreator=function(r,q){if(window.console&&console.log&&b){console.log("%c\n################",e);
console.log("%c### START STAGE :: BasicMediator::"+this.id+"::onNotifiedViewCreator :: pId="+q+" pData.type= "+r.changeObject.type,e);
console.log("%c################",e);}};function n(r,q,s){if(window.console&&console.log&&c){console.log("\n### BasicMediator2::registerObserver:: pWidget=",r);
}r.registerObserver(q[s],false,q.id,true);}function l(s,r,q){s.push(r);q.allInstances.push(r);}p.checkInstancesReady=function(t,s,r){var q=this.compareInstanceArrays(t,s);
if(q){if(window.console&&console.log&&c){console.log("%c\n################",k);console.log("%c### INIT STAGE :: BasicMediator::"+this.id+":: all "+r+" AreReady:: !!!!!!!!!!!!!!!!",k);
console.log("%c################",k);}return true;}if(window.console&&console.log&&c){console.log("%c\n################",k);
console.log("%c### INIT STAGE :: BasicMediator::"+this.id+":: all "+r+" not yet ready:: :-(:-(:-(:-(:-(:-(:-(",k);console.log("%c################",k);
}return false;};p.filterAllInstances=function(q){var r=this.allInstances;j.each(q,function(s){r=j.filter(r,function(u){var t=u.$el.data().widget.toLowerCase();
if(t.indexOf(s)===-1){return u;}});});return r;};p.getInstanceByDomContainer=function(r){var q=j.find(this.allInstances,function(s){return s.$el[0]===r[0];
});return q;};p.getInstanceById=function(r,t){var u=t||this.allInstances;var s=r.replace(/#/,"");var q=j.find(u,function(v){return v.id===s;
});return q;};p.getParameters=function(q){var t=q.getNode().data();var r=(j.keys(t).length)?t:q.parameters;var s={};if(j.keys(r).length){s.events=r.events;
s.dataFetcherEvents=r.datafetcherEvents;}else{throw"The parameters are not well defined"+r;}return s;};p.compareInstanceArrays=function(s,r){var q=j.map(s,function(t){return t.$el[0];
});if(j.isEmpty(j.difference(q,r))&&j.isEmpty(j.difference(r,q))){return true;}return false;};p.getInstance=function(){return this;
};if(!m){p.init();if(window.console&&console.log&&c){console.log("\n### BasicMediator2::constructor:: calling pWidgetApi.ready()");
}o.ready();}return p;};return i;});define("chart/widgetFramework/composed/settlementBatchOverview/settlementBatchMediator2",["jqueryExtended","lodash","chart/widgetFramework/core/BasicMediator","util/ObjectSuper","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/core/constants/DataConstants","util/Functional","chartutil/cssutils"],function(a,j,i,g,h,f,c,k){var b=false;
var e=false;var d=function(l){var m;m=i(l,true);var n=g(m);m.init=function(){n.init();this.firstDataFlag=true;var o=new Date();
this.currentYear=o.getFullYear();this.startYear=this.currentYear;this.minYear=this.currentYear-4;this.currentMonth=11;this.enableButtons("nextYear",false,["#prevYearBtn","#nextYearBtn"]);
this.actionCommanderExclusionArray=["actioncommander","dataformatter","timeline"];};m.getAdditionalDOMElements=function(){n.getAdditionalDOMElements();
this.timelineInstances=[];this.$allTimelines=this.$el.find("[data-widget*=Timeline]");this.totalDomElements+=this.$allTimelines.length;
};m.getWidgets=function(){n.getWidgets();this.getWidgetInstances(this.$allTimelines,this.timelineInstances,"Timelines");};
m.onNotifiedFetcher=function(p,o){n.onNotifiedFetcher(p,o);};m.onNotifiedFormatter=function(q,p){n.onNotifiedFormatter(q,p);
this.$el.find("#processIndicator").fadeOut("fast");var o=q.changeObject.data;if(p==="settlementBatchDataFormatterYear"){a(".chart-year").text(o.year);
a(".total-year-currency").text(o.currency);a(".total-year-value").text(o.yearTotal);}if(p==="monthBatchDataFormatter"||p==="settlementBatchWidgeFormatter"){a(".chart-month").text(o.month);
a(".total-month-currency").text(o.currency);a(".total-month-value").text(o.total);}};m.onNotifiedViewCreator=function(s,q){n.onNotifiedViewCreator(s,q);
var o,t;var r=s.changeObject.data;if(q==="settlementBatchYearRollover"&&s.changeObject.type==="requestMonthData"){var p=this.getInstanceById("settlementBatchOverviewYear",this.chartInstances);
if(p&&p.chart){this.$el.trigger("settlementBatch_passMonth",r.monthNum);}o=this.getInstanceById(q,this.chartInstances);t=o.$el;
t.trigger(f.FETCH_EXISTING_DATA,r.monthData);}if(q==="settlementBatchOverviewYear"&&s.changeObject.type==="requestMonthData"){o=this.getInstanceById(q,this.chartInstances);
t=o.$el;t.trigger(f.FETCH_EXISTING_DATA,r.monthData);}};m.mediatorReady=function(){n.mediatorReady();var p=String(this.currentMonth+1);
if(p.length===1){p="0"+p;}var o=this.currentYear+"-"+p+"-01";this.$el.trigger(f.TIME_INFO_SET,[o]);};m.onYearChange=function(o){this.$el.find("#processIndicator").fadeIn("fast");
var p;if(o==="minus"){this.currentYear--;p=this.currentYear+"-12-01";if(this.currentYear<=this.minYear){this.currentYear=this.minYear;
this.enableButtons("prevYear",false);}if(this.currentYear!==this.startYear){this.enableButtons("nextYear",true);}}if(o==="plus"){this.currentYear++;
p=this.currentYear+"-12-01";if(this.currentYear>=this.startYear){this.currentYear=this.startYear;this.enableButtons("nextYear",false);
p=this.currentYear+"-"+(this.currentMonth+1)+"-01";}if(this.currentYear!==this.minYear){this.enableButtons("prevYear",true);
}}this.$el.trigger(f.TIME_INFO_SET,[p]);};m.enableButtons=function(p,r){var q=this.$el.find("#prevYearBtn");var o=this.$el.find("#nextYearBtn");
switch(p){case"prevYear":q.css("pointer-events",(r===false)?"none":"auto");q.css("opacity",(r===false)?0.3:1);break;case"nextYear":o.css("pointer-events",(r===false)?"none":"auto");
o.css("opacity",(r===false)?0.3:1);break;default:q.css("pointer-events","auto");q.css("opacity",1);o.css("pointer-events","auto");
o.css("opacity",1);break;}};m.getInstance=function(){return this;};m.init();l.ready();return m;};return d;});define("chart/widgetFramework/composed/retryreport/formatters/masterDataFormatter",["jqueryExtended","underscore","d3"],function(d,b,c){function a(i,p,n,f){var j={};
j.data=i;j.options=p;j.formattedData={};j.comparator=null;j.timeline=n;j.id=f;j.formatData=function(){var y=(this.data&&this.data.report)?this.data.report:{};
y=b.filter(y,function(B){return typeof B.retryacquirer!=="undefined"&&B.retryacquirer!=="null"&&!b.isNull(B.retryacquirer);
});b.each(y,function(B){if(B.response==="ERROR"){B.response="ACQUIRER_ERROR";}else{if(B.response==="INVALID_CARD"){B.response="INVALID_CARD_NUMBER";
}else{if(B.response==="REFUSED"){B.response="REFUSED_CARD";}}}});if(b.isEmpty(y)){c.selectAll("#dateWarning, #allRetriesWrapper, #retryAcquirerWrapper, #originalAcquirerWrapper").style("display","none");
c.select("#noRetriesWarning").style("display","block");return{allRetriesSankeyData:[],allRetriesBarData:[],originalAcquirers:[],originalAcquirerSankeyData:[],originalBarData:[],retryAcquirers:[],retryAcquirerSankeyData:[],retryBarData:[]};
}else{c.selectAll("#dateWarning, #allRetriesWrapper, #retryAcquirerWrapper, #originalAcquirerWrapper").style("display",null);
c.select("#noRetriesWarning").style("display","none");var w=this.timeline.getDates()[0];if(w>=new Date("2016-04-04")){c.select("#dateWarning").style("display","none");
}else{c.select("#dateWarning").style("display","auto");}}var t=o(y);var q=e.sum(y,["response"]);var A=h(y,"previousacquirer");
var u=l(y,"original");var s;var v=(u.length<=0);if(v){c.select("#originalAcquirerWrapper").style("display","none");s=[];}else{c.select("#originalAcquirerWrapper").style("display",null);
s=e.sum(y,["previousacquirer","response"]);s=k(s,"previousacquirer","acquirer");}var x=h(y,"retryacquirer");var z=l(y,"retry");
var r=e.sum(y,["retryacquirer","response"]);r=k(r,"retryacquirer","acquirer");this.formattedData={allRetriesSankeyData:t,allRetriesBarData:q,originalAcquirers:A,originalAcquirerSankeyData:u,originalBarData:s,retryAcquirers:x,retryAcquirerSankeyData:z,retryBarData:r};
return this.formattedData;};var h=function(q,r){var s=b.uniq(b.pluck(q,r));s=b.filter(s,function(t){return typeof t!=="undefined"&&t!=="null"&&!b.isNull(t);
});s=s.sort();return s;};var o=function(q){var v=e.sum(q,["previousacquirer","retryacquirer","retryattempt"]);var t=[],s=[],u=[],r=[],w=false;
v.forEach(function(z){if(z.previousacquirer){u.push(z.previousacquirer+"_"+z.retryattempt);r.push(z.retryacquirer+"_"+(+z.retryattempt+1));
if(z.success>0){t.push({source:z.previousacquirer+"_"+z.retryattempt,target:z.retryacquirer+"_"+(+z.retryattempt+1),type:"success",value:z.success});
}if(z.refused>0){t.push({source:z.previousacquirer+"_"+z.retryattempt,target:z.retryacquirer+"_"+(+z.retryattempt+1),type:"refused",value:z.refused});
}if(z.success>0){s.push({source:z.retryacquirer+"_"+(+z.retryattempt+1),target:"Success",type:"success",value:z.success});
}if(z.refused>0){s.push({source:z.retryacquirer+"_"+(+z.retryattempt+1),target:"Refused",type:"refused",value:z.refused});
}}else{w=true;}});if(w){return[];}t=e.sumValue(t,["source","target","type"]);t=g(t);s=e.sumValue(s,["source","target","type"]);
s=g(s);var y=b.intersection(u,r);if(y.length>0){y.forEach(function(z){var A=b.sum(b.pluck(b.filter(t,function(C){return C.source===z;
}),"value"));var B=b.filter(s,function(C){return C.source===z&&C.target==="Refused";});B.forEach(function(C){C.value=C.value-A;
});});}var x=t.concat(s);x=b.filter(x,function(z){return z.value>0;});return x;};var l=function(t,s){var v=c.nest().key(function(w){return s==="original"?w.previousacquirer:w.retryacquirer;
}).entries(t);var q=b.findIndex(v,function(w){return w.key==="undefined"||w.key==="null"||b.isNull(w.key);});if(q>=0){v.splice(q,1);
return[];}var u=[],r=false;v.forEach(function(y){var B=y.key;var C=y.values;var z=[],x=[],w=[];C.forEach(function(E){if(E.previousacquirer){var D=m(E.response);
if(E.success>0){z.push({acquirer:B,source:E.previousacquirer+"_O",target:D,type:"success",value:E.success});}if(E.refused>0){z.push({acquirer:B,source:E.previousacquirer+"_O",target:D,type:"refused",value:E.refused});
}if(E.success>0){x.push({acquirer:B,source:D,target:E.retryacquirer+"_R",type:"success",value:E.success});}if(E.refused>0){x.push({acquirer:B,source:D,target:E.retryacquirer+"_R",type:"refused",value:E.refused});
}if(E.success>0){w.push({acquirer:B,source:E.retryacquirer+"_R",target:"Success",type:"success",value:E.success});}if(E.refused>0){w.push({acquirer:B,source:E.retryacquirer+"_R",target:"Refused",type:"refused",value:E.refused});
}}else{r=true;}});if(r){return[];}z=e.sumValue(z,["acquirer","source","target","type"]);z=g(z);x=e.sumValue(x,["acquirer","source","target","type"]);
x=g(x);w=e.sumValue(w,["acquirer","source","target","type"]);w=g(w);var A=z.concat(x,w);u=u.concat(A);});return u;};var m=function(r){var q=r.toLowerCase();
q=q.charAt(0).toUpperCase()+q.slice(1);return q.replace(/_/g," ");};var k=function(t,r,q){for(var s=0;s<t.length;s++){t[s][q]=t[s][r];
delete t[s][r];}return t;};var g=function(q){return b(q).chain().sortBy(function(r){return r.type;}).reverse().sortBy(function(r){return r.target;
}).sortBy(function(r){return r.source;}).value();};var e=(function(){var q=function(u,t){return b.any(u,function(v){return b.isEqual(v,t);
});};var r=function(t,u){return b.reduce(t,function(v,x){var w=b.pick(x,u);if(!q(v,w)){v.push(w);}return v;},[]);};var s=function(u,v){var t=r(u,v);
return b.map(t,function(w){return{key:w,vals:b.map(b.where(u,w),function(x){return b.omit(x,v);})};});};s.register=function(t,u){s[t]=function(v,w){return b.map(s(v,w),u);
};return s[t];};return s;}());e.register("sum",function(q){return b.extend({},q.key,{retriescount:b.reduce(q.vals,function(r,s){return r+s.retriescount;
},0),success:b.reduce(q.vals,function(r,s){return r+s.success;},0),refused:b.reduce(q.vals,function(r,s){return r+s.refused;
},0),successfuleuramount:b.reduce(q.vals,function(r,s){return r+s.successfuleuramount;},0)});});e.register("sumValue",function(q){return b.extend({},q.key,{value:b.reduce(q.vals,function(r,s){return r+s.value;
},0)});});j.compareFunction=function(q){return q[this.sortKey];};j.getData=function(){return(this.data)?this.data:this.formatData();
};j.setRawData=function(q){this.data=q;};j.retrieveData=function(q){return this.data[q];};return j;}return a;});define("chart/widgetFramework/composed/revenueProtect/rollover",["jqueryExtended","underscore","d3","chart/widgetFramework/core/mixins/widgetScales","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/WidgetConstants","util/ObjectSuper","chart/widgetFramework/chartTypes/rollover"],function(b,h,j,i,a,e,c,f,g){var d=function(q,k,o,m){var n;
var p={};var l=h.defaults(p,q);n=g(l,k);n.positionTooltip=function(v,x,u,w,r,s,y){var t=v.top+u-10-r+(y/2);var z=((v.left+x+10)-w)+(s);
return{top:t,left:z};};return n;};return d;});define("chart/widgetFramework/composed/riskReport/formatters/histogramFormatter",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils"],function(f,b,d,c,e){var a=function(j,g,i){var h={};
h.data=j;h.options=g;h.formattedData={};h.comparator=null;h.reverseDirection=false;h.sortKey=null;h.timeline=i;h.formatData=function(){if(c.falsy(this.data.fraudScoreDistribution)){return[];
}var q=this.data.fraudScoreDistribution;var s=[];var n=this.options.range[0];var l=this.options.range[1];var k=(l-n)/this.options.numBins;
var p=this.options.count;b.each(q,function(v){var u=v[h.options.accessor];if(u>=n&&u<=l){var t={dx:1,x:u,y:v[p]};s.push(t);
}});var o=d.range(n,l,k);var m=d.layout.histogram().range(h.options.range).bins(h.options.numBins)(o);var r=[];b.each(m,function(v){var t={x:v.x,dx:v.dx,y:0};
var w=v.x+v.dx;var u=v.x;b.each(s,function(x){if(x.x<w&&x.x>=u){t.y+=x.y;}});r.push(t);});this.formattedData=r;if(window.console&&console.log){console.log("### histogramFormatter::formatData:: this.formattedData=",this.formattedData);
}return{chartData:this.formattedData};};h.sortData=function(k){this.sortKey=k;this.reverseDirection=!this.reverseDirection;
var l=b.sortBy(this.formattedData,k);if(this.reverseDirection){l.reverse();}this.formattedData=l;return{chartData:this.formattedData};
};h.compareFunction=function(k){return k[this.sortKey];};h.downloadCSV=function(){var m=this.createObjectForCSV();var k=["fraudScore","chargebacks"];
var l=["Fraud score","Chargebacks (tx)"];e.createCSV(m,k,l,"FraudScoreDistributionOfChargebacks");};h.createObjectForCSV=function(){var k=b.map(this.formattedData,function(l){var m={chargebacks:l.y};
m.fraudScore=String(l.x)+" to "+String(l.x+(l.dx-1));return m;});return k;};h.getData=function(){return(this.data)?this.data:this.formatData();
};h.setRawData=function(k){this.data=k;};h.retrieveData=function(k){return this.data[k];};return h;};return a;});define("chart/widgetFramework/chartTypes/multiBar",["jquery","underscore","d3","hogan","util/Functional","util/ObjectSuper","chart/widgetFramework/core/drivers/axisBaseView","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/core/constants/WidgetConstants","chart/widgetFramework/core/mixins/formats","chartutil/d3utils"],function(d,i,l,f,b,g,j,h,e,c,k){var a=function(s,m,q,o){var p;
var r={};var n=i.defaults(s,r);p=j(n,m);var t=g(p);p.timeline=q;p.subPadding=0;p.init=function(){t.init();if(b.notFalsy(p.options.subBarPadding)){this.subPadding=p.options.subBarPadding;
}};p.feedData=function(u){var v=t.feedData(u);if(this.timeline){this.configData.granularity=this.timeline.getGranularity();
}if(b.falsy(this.data)){this.setNestedAttr("multi-bars",false,true);return;}this.setNestedAttr(this.data,false,true);return v;
};p.renderYAxis=function(){t.renderYAxis();};p.getMultiBarData=function(){return function(v){var u=v[p.nestedAttr];u=i.map(u,function(w){w.barWidth=(p.barSize/u.length);
return w;});return u;};};p.getSecondaryDataJoin=function(){return this.getDataJoin("name");};p.renderData=function(){if(b.falsy(this.data)){this.hideCharts("no data to display");
return;}var w=this.scales[this.options.xAttr],v=this.scales[this.options.yAttr];var u;if(this.options.variation===e.VERTICAL){u=this.barUtils.containerBarsVertical(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),this.barPositioningFn,true).multiBarVertical(this.getMultiBarData(),this.getSecondaryDataJoin(),v,this.barSize,this.subPadding);
}else{u=this.barUtils.containerBarsHorizontal(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),this.barPositioningFn,true).stackHorizontal(this.getStackData(),this.getSecondaryDataJoin(),w,this.barSize);
}};return p;};return a;});define("chart/widgetFramework/composed/chargebackReport/cfnBarChart",["jquery","underscore","chart/widgetFramework/core/mixins/formats","util/ObjectSuper","chart/widgetFramework/chartTypes/multiBar"],function(f,c,e,d,a){var b=function(l,g,j){var i;
var k={};var h=c.defaults(k,l);i=a(h,g,j);var m=d(i);i.getLabelName=function(n){return n[this.options.joinAttr];};return i;
};return b;});define("chart/widgetFramework/chartTypes/sparkline",["d3","jquery","underscore","backbone","hogan","chart/widgetFramework/core/drivers/basicChartDriver","util/ObjectSuper","Constants"],function(i,c,h,g,d,a,e,b){var f=function(k,j){var l=h.defaults(k,{height:20,width:100,template:"",templateStyle:"",dataProperty:"close",highlightEnd:true,startLine:false});
var m=a(l);var n=e(m);m.init=function(p,o){n.init(p,o);m.el=o;m.$el=c(m.el);m.selections={};m.settings=l;m.data=[];};m.feedData=function(o){m.data=o;
};m.initRender=function(){var q=m.selections;var o=m.settings.height;var p=m.settings.width;var r=m.settings.margin;q.svg=i.select(m.el).append("svg").attr("width",(p+r.left+r.right)).attr("height",(o+r.top+r.bottom)).attr("pointer-events","all");
q.offsetGroup=q.svg.append("g").attr("width",p).attr("height",o).attr("transform","translate("+r.left+","+r.top+")");m.x=i.scale.linear().range([0,p]);
m.y=i.scale.linear().range([o,0]);m.line=i.svg.line().x(function(s){return m.x(s.date);}).y(function(s){return m.y(h.get(s,m.settings.dataProperty));
});q.text=q.offsetGroup.append("text").attr("x",m.settings.width).attr("y",m.settings.margin.top).attr("text-anchor","end").attr("class","sparktext");
};m.render=function(){m.renderSparkline(m.data);};m.renderSparkline=function(q){var p=m.selections;var o=(m.settings.width/q.length);
q=h.sortBy(q,"date").reverse();m.firstData=q[0];m.x.domain(i.extent(q,function(r){return r.date;}));m.y.domain(i.extent(q,function(r){return h.get(r,m.settings.dataProperty);
}));if(m.settings.startLine){p.offsetGroup.append("rect").attr("class","sparkavg").attr("height",1).attr("width",m.settings.width).attr("opacity",0.075).attr("x",0).attr("y",m.y(h.get(q[q.length-1],m.settings.dataProperty))).attr("r",2);
}p.offsetGroup.append("path").datum(q).classed("sparkline",true).attr("d",m.line);p.offsetGroup.selectAll(".sparkbar").data(q).enter().append("rect").attr("height",m.settings.height).attr("width",function(){return o;
}).attr("x",function(r){return m.x(r.date)-(o/2);}).attr("y",0).attr("opacity",0).on("mouseover",function(r){i.event.stopPropagation();
m.placeDot(r);m.showData(r);}).on("mouseout",function(){m.placeDot(m.firstData);m.showData(m.firstData);}).classed("sparkbar",true);
m.placeDot(m.firstData);m.showData(m.firstData);};m.placeDot=function(p){var o=m.selections;o.svg.select(".sparkcircle").remove();
o.offsetGroup.append("circle").attr("class","sparkcircle").attr("cx",m.x(p.date)).attr("cy",m.y(h.get(p,m.settings.dataProperty))).attr("r",2);
};m.showData=function(q){var o=m.selections;var p=h.get(q,m.settings.dataProperty);o.text.text(p);};return m;};return f;});
define("chart/widgetFramework/composed/riskReport/views/chargebackRateLineView",["jquery","underscore","chart/widgetFramework/core/mixins/formats","util/ObjectSuper","chart/widgetFramework/chartTypes/lineChart"],function(f,b,e,c,a){var d=function(l,g,j){var i;
var k={};var h=b.defaults(k,l);i=a(h,g,j);var m=c(i);i.renderYAxis=function(){m.renderYAxis();};i.getLabelName=function(n){return n[this.options.joinAttr];
};return i;};return d;});define("chart/widgetFramework/composed/transactionsDashboard/formatters/monthlyAuthsFormatter",["jqueryExtended","underscore","d3","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/core/mixins/formats","chartutil/d3utils"],function(g,b,d,e,f,c){function a(k,h,j,m){var i={};
i.data=k;i.options=h;i.formattedData={};i.comparator=null;i.reverseDirection=false;i.sortKey=null;i.timeline=j;i.id=m;i.formatData=function(){this.formattedData=l(this.data);
if(this.sortKey){this.reverseDirection=!this.reverseDirection;this.sortData(this.sortKey,true);}if(window.console&&console.log){console.log("### monthlyAuthsFormatter::"+this.id+" formatData:: this.formattedData=",this.formattedData);
}return{chartData:this.formattedData};};var l=function(E){var o=[],v,q,B,C,w,A,u,p,z,x;var s=d.format("0,000");var n=d.format(",.1f");
var r=d.format(",.2f");var D=f.linearFormatSmartRoundingSI();var y=f.percentFormatSmartRounding();var t=f.euroFormatSmartRoundingSI();
b.each(E,function(G,F){A=G.formattedTimespan.split("'");w=A[0]+"'"+(Number(A[1])-1);v=G.authRate*100;B=G.authRateDifference*100;
q=G.refusedCount;C=(B>0)?"+"+r(B):r(B);if(C==="-0"){C="0";}u=G.authCountDifferencePercentage*100;p=r(u)+"%";z=G.authAmountDifferencePercentage*100;
x=r(z)+"%";o.push({date:G.date,dateStr:G.formattedTimespan,prevDateStr:w,authRate:v,authRatesArr:[{name:"authorized",value:v,startX:0,endX:v},{name:"refused",value:100-v,startX:v,endX:(G.receivedCount!==0)?100:0}],authRateLabel:n(v)+"%",authRateTT:r(v),authRateDifference:B,authRateDifferenceLabel:C,authRateDifferenceLabelTT:r(B),previousYearAuthRate:r(G.previousYearAuthRate*100),totalPerc:100,receivedCount:G.receivedCount,authorizedCount:G.authorizedCount,refusedCount:q,authTxArray:[{name:"authorized",value:G.authorizedCount,startX:0,endX:G.authorizedCount},{name:"refused",value:q,startX:G.authorizedCount,endX:(G.receivedCount>=G.authorizedCount)?G.receivedCount:G.authorizedCount}],authTxLabel:D(G.authorizedCount),authTxLabelTT:s(G.authorizedCount),authCountDifferencePercentage:u,authCountDifferencePercentageLabel:p,authCountDifferencePercentageLabelTT:r(u)+" %",previousYearAuthorizedCount:s(G.previousYearAuthorizedCount),authorizedAmount:G.authorizedAmount/100,authorizedAmountTT:s(G.authorizedAmount/100),authAmountLabel:t(G.authorizedAmount/100),authAmountDifferencePercentage:z,authAmountDifferencePercentageLabel:x,authAmountDifferencePercentageLabelTT:r(z)+" %",previousYearAuthorizedAmount:s(G.previousYearAuthorizedAmount/100)});
});return o;};i.sortData=function(n,p){if(window.console&&console.log){console.log("### monthlyAuthsFormatter::sortData:: pSortKey=",n);
}this.sortKey=n;this.reverseDirection=!this.reverseDirection;var o=b.sortBy(this.formattedData,n);if(this.reverseDirection){o.reverse();
}this.formattedData=o;if(p===true){return;}this.$el.trigger(e.FORMATTER_INFORM_WIDGET,{type:e.SORTED_DATA,data:{chartData:this.formattedData}});
};i.compareFunction=function(n){return n[this.sortKey];};i.getData=function(){return(this.data)?this.data:this.formatData();
};i.setRawData=function(n){this.data=n;};i.retrieveData=function(n){return this.data[n];};return i;}return a;});define("chart/widgetFramework/composed/microBundle/microBundleLayout",["d3","jquery","underscore","backbone","hogan","chart/widgetFramework/core/drivers/basicChartDriver","util/ObjectSuper","text!chart/widgetFramework/composed/microBundle/microBundle.css","text!chart/widgetFramework/composed/microBundle/microBundleLegend.html","util/Css"],function(k,f,j,i,g,b,h,d,c,a){var e=function(m,l){var n=j.defaults(m,{minNodeSize:2,maxNodeSize:8,nodeOffset:42,maxBarWidth:34,barOffset:5,nodeOpacity:0.66,barHeight:4});
n.totalBarOffset=n.nodeOffset+n.maxNodeSize+n.barOffset;n.chartWidth=(n.totalBarOffset+n.maxBarWidth)*2;n.chartHeight=(n.totalBarOffset+n.maxBarWidth)*2;
var o=b(n);var p=h(o);o.init=function(r,q){p.init(r,q);o.el=q;o.$el=f(o.el);o.selections={};o.settings=n;o.data=[];a.addStyle(d);
};o.feedData=function(q){o.data=q;};o.initRender=function(){var t=o.selections;var q=o.settings.chartHeight;var r=o.settings.chartWidth;
t.svg=k.select(o.el).append("svg").attr("width",r).attr("height",q);t.linkGroup=t.svg.append("g");t.container=t.svg.append("g").attr("transform",function(){return"translate("+(r/2)+","+(q/2)+")";
});t.correction=t.container.append("g");};o.render=function(){var E=o.selections;var x=(360/o.data.linkingIdentifiers.length);
var r=o.settings.totalBarOffset+o.settings.maxBarWidth;var z=0;var q=o.calcOppositeSide(x,r);var C=g.compile(c);var y=C.render(o.data.legend);
document.getElementById("microBundleLegend").innerHTML=y;var D=false;E.angleGroup=E.correction.selectAll("g").data(o.data.linkingIdentifiers).enter().append("g").attr("class",function(s){if(s.categoryClass){return"identifier identifier-"+s.categoryClass.toLowerCase();
}return false;}).classed("currentPsp",function(s){if(s.currentPsp){D=true;}return s.currentPsp;}).style("pointer-events",function(s){if(!s.paymentsAmount){return"none";
}}).style("opacity",function(s){if(!s.paymentsAmount){return 0;}}).attr("transform",function(F,s){if(F.currentPsp){z=0-((s*x)-180);
}return"rotate("+(s*x)+")";}).on("mouseover",function(G){var s=(G.category==="pspref")?"PSPReference":G.category.split(".")[0];
var F='<span class="pg-label">'+s+'</span> <span class="pg-value">'+G.value+"</span>";document.getElementById("microBundleHeader").innerHTML=s+": "+G.value;
}).on("mouseout",function(){document.getElementById("microBundleHeader").innerHTML="Transactions";});E.correction.attr("transform",function(){return"rotate("+z+")";
});E.angleGroup.append("polygon").attr("points",function(){var G=[0,0].join(",");var F=[r,q].join(",");var s=[r,-q].join(",");
return[G,F,s].join(" ");}).style("fill","transparent");E.node=E.angleGroup.append("circle").style("opacity",o.settings.nodeOpacity).attr("cx",o.settings.nodeOffset).attr("r",function(s){return o.calcSize(s.paymentsAmount,o.data.maxPaymentsAmount,o.settings.minNodeSize,o.settings.maxNodeSize);
});E.barGroup=E.angleGroup.append("g");E.barGroup.selectAll("rect").data(function(s){return s.payments;}).enter().append("rect").attr({height:o.settings.barHeight,y:-(o.settings.barHeight/2),width:20}).attr("width",function(s){return o.calcSize(s.count,o.data.maxPaymentsAmount,2,o.settings.maxBarWidth);
}).attr("class",function(s){return"status status-"+s.name.toLowerCase();}).attr("x",function(s){return o.calcSize(s.x,o.data.maxPaymentsAmount,0,o.settings.maxBarWidth)+o.settings.totalBarOffset;
});if(D){var t=[];var v=E.svg[0][0].getBoundingClientRect();var u=k.select(".identifier-pspref.currentPsp circle")[0][0].getBoundingClientRect();
j.each(k.selectAll(":not(.identifier-pspref).currentPsp circle")[0],function(s){t.push(s.getBoundingClientRect());});var B={y:(u.top-v.top)+(u.width/2),x:(u.left-v.left)+(u.width/2)};
var A={y:(v.width/2),x:(v.width/2)};t=j.map(t,function(F){var s={y:(F.top-v.top)+(F.width/2),x:(F.left-v.left)+(F.width/2)};
return[B,A,s];});var w=k.svg.line().x(function(s){return s.x;}).y(function(s){return s.y;}).interpolate("bundle");E.linkGroup.selectAll("path").data(t).enter().append("path").attr({stroke:"#bbb","stroke-width":"1",fill:"none"}).attr("d",w);
}};o.calcSize=function(t,r,q,s){s-=q;return Math.round(q+((s/r)*t));};o.calcOppositeSide=function(s,q){var r=s*Math.PI/180;
return Math.tan(r/2)*q;};return o;};return e;});define("chartutil/numberutils",["jqueryExtended"],function(b){var a={};a.decimalFormatter=function(e,c){c=typeof c!=="undefined"?c:1;
return(e.toFixed(c)%1)!==0?e.toFixed(c):Math.round(e);};a.zeroPad=function(c){var d=(typeof c==="number")?c:parseInt(c,10);
if(isNaN(d)){return c;}if(d>=10){return""+c;}if(d===0){return"00";}return"0"+c;};a.animateValue=function(h,m,j,g){var f=h.text(),e;
e=Number(f.replace(/[^0-9\-\.]/gi,""));var k={total:e};var l={total:m};var d;var c;c=function(){d=j(this.total);h.html(d);
};b(k).animate(l,{duration:1000,step:c,done:function(){d=j(l.total);h.html(d);}});};return a;},function(a){if(window.console&&typeof window.console.log==="function"){window.console.log("[Chart/Util/NumberUtils] Initialization error ",a);
}});define("chart/widgetFramework/composed/cardAcquirerAuthorizationReport/percentageBarChart",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/chartTypes/stackedBar"],function(d,g,j,c,e,b,f,i,h){function a(p,k,n){var m;
var o={};var l=g.defaults(o,p);m=h(l,k,n);var r=f(m);var q=false;m.init=function(){r.init();this.barUtils.delayStackedTime=0;
};m.initRender=function(){r.initRender();setTimeout(function(){if(!q&&m.options.ranked){m.chartGroup.classed("barchart-ranked",true);
}q=true;},100);};m.renderData=function(){r.renderData();if(b.falsy(this.data)){return;}var v=this.barUtils.bars;var s=this.barUtils.transitionTime;
var w=this.barUtils.delayTime;var t=j.format(",.2f");v.update.select(".bar-label").text(function(x){return t(x.authorizationRate)+"%";
}).style("opacity",0).transition().duration(s).delay(w).style("opacity",1);v.enter.append("text").attr("class","bar-label").attr("x",-8).attr("y","1.15em").style("text-anchor","end").style("opacity",0).text(function(x){return t(x.authorizationRate)+"%";
}).transition().duration(s).delay(2*w).style("opacity",1);v.exit.select(".bar-label").transition().duration(s).style("opacity",0).remove();
var u=this.data.length*this.options.barHeight+this.options.margin.top+this.options.margin.bottom;j.select("#"+this.$el[0].id).transition().duration(s).style("height",u+"px");
};return m;}return a;});define("chartutil/backbone/WhiteListModel",["underscore","backbone"],function(a,c){var b=c.Model.extend({set:function(e,f,d){if(e===null){return this;
}if(typeof e==="object"){e=a.pick(e,a.keys(this.defaults));}else{if(!a.contains(a.keys(this.defaults),e)){return false;}}return this._super(e,f,d);
}});return b;});define("chart/widgetFramework/composed/chargebackReport/chargebackActions",["jqueryExtended"],function(b){var c=b;var a={actions:[{source:"issuerCountry",event:"change",target:["fetcher","fetcherCountrybar","fetcherPaymentMethodBar"],callMethod:"fetchNewDataAction",getterMethod:function(d){c("#timeline1").find("#timelineLoader").css("display","block");
var e=d.val();return{countryFilter:e};}},{source:"paymentMethod",event:"change",target:["fetcher","fetcherCountrybar","fetcherPaymentMethodBar"],callMethod:"fetchNewDataAction",getterMethod:function(d){c("#timeline1").find("#timelineLoader").css("display","block");
var e=d.val();return{paymentMethod:e};}},{source:"shopperInteraction",event:"change",target:["fetcher","fetcherCountrybar","fetcherPaymentMethodBar"],callMethod:"fetchNewDataAction",getterMethod:function(d){c("#timeline1").find("#timelineLoader").css("display","block");
var e=d.val();return{shopperInteraction:e};}},{source:"transaction-toggle",event:"click",target:["fetcher","fetcherCountrybar","fetcherPaymentMethodBar"],callMethod:"fetchNewDataAction",getterMethod:function(){c("#timeline1").find("#timelineLoader").css("display","block");
c(".report-description h2 span").text("transaction");c('[data-toggle-id="chargeback"]').addClass("active");c('[data-toggle-id="transaction"]').removeClass("active");
return{chargebackDateParameter:"transaction"};}},{source:"chargeback-toggle",event:"click",target:["fetcher","fetcherCountrybar","fetcherPaymentMethodBar"],callMethod:"fetchNewDataAction",getterMethod:function(){c("#timeline1").find("#timelineLoader").css("display","block");
c(".report-description h2 span").text("Chargeback / Notifications of fraud");c('[data-toggle-id="transaction"]').addClass("active");
c('[data-toggle-id="chargeback"]').removeClass("active");return{chargebackDateParameter:"chargeback"};}},{source:"amountToggle",event:"click",target:["cfnBarFormatter","cfnLineFormatter","cfnRolloverFormatter","countryBarFormatter","paymentMethodBarFormatter","chargebackMediator"],callMethod:"reformatData",getterMethod:function(){c("#countAmountText").text("amount");
c(".cfn-header.count-amount").text("Amount");setTimeout(function(){c('[data-toggle-id="count"]').removeClass("active");c('[data-toggle-id="amount"]').addClass("active");
},10);c("#cfnBarChart")[0].__axisVertical.graphOptions.tickFormat="euroFormatSmartRoundingSI";return"amount";}},{source:"countToggle",event:"click",target:["cfnBarFormatter","cfnLineFormatter","cfnRolloverFormatter","countryBarFormatter","paymentMethodBarFormatter","chargebackMediator"],callMethod:"reformatData",getterMethod:function(){c("#countAmountText").text("count");
c(".cfn-header.count-amount").text("Count");setTimeout(function(){c('[data-toggle-id="amount"]').removeClass("active");c('[data-toggle-id="count"]').addClass("active");
},10);c("#cfnBarChart")[0].__axisVertical.graphOptions.tickFormat="thousandsLinearFormat";return"count";}},{source:["#chargebacksCountryToggle","#nofCountryToggle"],event:"click",target:["chargebackMediator","countryBarFormatter"],callMethod:"reformatDataChargebacksNof",toggle:"issuer-country-toggle",getterMethod:function(d){var e=d.attr("data-toggle-id");
return{type:e,source:"issuerCountry"};}},{source:["#chargebacksPMToggle","#nofPMToggle"],event:"click",target:["chargebackMediator","paymentMethodBarFormatter"],callMethod:"reformatDataChargebacksNof",toggle:"pm-country-toggle",getterMethod:function(d){var e=d.attr("data-toggle-id");
return{type:e,source:"paymentMethod"};}},{source:"chargebackFraudDownload",event:"click",target:"cfnRolloverFormatter",callMethod:"downloadCSV"},{source:"atvDownload",event:"click",target:"atvLineFormatter",callMethod:"downloadCSV"},{source:"countryBarDownload",event:"click",target:"countryBarFormatter",callMethod:"downloadCSV"},{source:"pmBarDownload",event:"click",target:"paymentMethodBarFormatter",callMethod:"downloadCSV"},{source:"countryBrushBarChart",event:"brushableBarChartData",target:["countryCountBarChart","countryAmountBarChart","countryRateBarChart","countryGroupedBarRollover"],callMethod:"updateScale"},{source:"paymentMethodBrushBarChart",event:"brushableBarChartData",target:["paymentMethodCountBarChart","paymentMethodAmountBarChart","paymentMethodRateBarChart","paymentMethodGroupedBarRollover"],callMethod:"updateScale"},{source:"countryCountTitle",event:"click",target:["chargebackMediator","countryBrushBarChart","countryBarFormatter"],callMethod:"sortData",data:"chargebackCount",toggle:"sort-toggle-country"},{source:"countryAmountTitle",event:"click",target:["chargebackMediator","countryBrushBarChart","countryBarFormatter"],callMethod:"sortData",data:"chargebackEurAmount",toggle:"sort-toggle-country"},{source:"countryRateTitle",event:"click",target:["chargebackMediator","countryBrushBarChart","countryBarFormatter"],callMethod:"sortData",data:"chargebackRate",toggle:"sort-toggle-country"},{source:"paymentMethodCountTitle",event:"click",target:["chargebackMediator","paymentMethodBarFormatter"],callMethod:"sortData",data:"chargebackCount",toggle:"sort-toggle-pm"},{source:"paymentMethodAmountTitle",event:"click",target:["chargebackMediator","paymentMethodBarFormatter"],callMethod:"sortData",data:"chargebackEurAmount",toggle:"sort-toggle-pm"},{source:"paymentMethodRateTitle",event:"click",target:["chargebackMediator","paymentMethodBarFormatter"],callMethod:"sortData",data:"chargebackRate",toggle:"sort-toggle-pm"},{source:"timeline1",event:"timelineTimespanSet",target:["fetcher","fetcherCountrybar","fetcherPaymentMethodBar","issuerCountriesFetcher","activePaymentMethodsFetcher","chargebackMediator"],callMethod:"onTimeData"}]};
return a;});define("chart/widgetFramework/composed/retryreport/retryMediator",["jqueryExtended","d3","lodash","chart/widgetFramework/core/BasicMediator","util/ObjectSuper","chartutil/numberutils"],function(g,f,c,d,e,a){function b(h){var i;
i=d(h,true);var j=e(i);i.init=function(){j.init();this.actionCommanderExclusionArray=["actioncommander","timeline"];};i.getAdditionalDOMElements=function(){j.getAdditionalDOMElements();
this.timelineInstances=[];this.$allTimelines=h.__$node.find("[data-widget*=Timeline]");this.totalDomElements+=this.$allTimelines.length;
this.snapshotInstances=[];this.$allSnapshots=this.$el.find("[data-widget*=Snapshot]");this.totalDomElements+=this.$allSnapshots.length;
};i.getWidgets=function(){j.getWidgets();this.getWidgetInstances(this.$allTimelines,this.timelineInstances,"Timelines");this.getWidgetInstances(this.$allSnapshots,this.snapshotInstances,"Snapshots");
};i.onNotifiedFetcher=function(l,k){j.onNotifiedFetcher(l,k);};i.onNotifiedFormatter=function(l,k){j.onNotifiedFormatter(l,k);
if(l.changeObject.data&&k==="allRetriesBarDataFormatter"){i.renderTotals(l.changeObject.data.chartData);}};i.onNotifiedViewCreator=function(l,k){j.onNotifiedViewCreator(l,k);
};i.setAcquirer=function(k){var l;l=c.findWhere(this.chartInstances,{id:k.type+"AcquirerButtons"});if(l&&l.chart){l.chart.chosenAcquirer=k.acquirer;
l.chart.renderData();}l=c.findWhere(this.formatterInstances,{id:k.type+"AcquirerSankeyDataFormatter"});if(l&&l.formatter){l.formatter.chosenAcquirer=k.acquirer;
l.formatData();}l=c.findWhere(this.formatterInstances,{id:k.type+"AcquirerBarDataFormatter"});if(l&&l.formatter){l.formatter.chosenAcquirer=k.acquirer;
l.formatData();}};i.renderTotals=function(m){var k=f.format(",.0f");var n=f.format(".2f");var l={retries:0,success:0,avgSuccessRate:0,successAmount:0};
c.each(m,function(o){l.retries+=o.retriesCount;l.success+=o.successCount;l.successAmount+=o.successEurAmount;});l.avgSuccessRate=l.success/l.retries*100;
a.animateValue(g("#retriesVol span"),l.retries,k);a.animateValue(g("#successVol span"),l.success,k);a.animateValue(g("#successRate span"),l.avgSuccessRate,n);
a.animateValue(g("#successAmt span"),l.successAmount,k);};i.getInstance=function(){return this;};i.init();h.ready();return i;
}return b;});define("chart/widgetFramework/composed/harpViewer/sessionsAggChart",["jquery","underscore","d3","hogan","util/ObjectSuper","util/Functional","chart/widgetFramework/chartTypes/stackedBar"],function(h,d,g,b,f,e,c){var a=function(k,m,p,o){var l;
var i={};var q=d.defaults(i,k);l=c(q,m);var j=f(l);l.setBandSizes=function(){j.setBandSizes();this.barSize=6;};l.setYScale=function(){j.setYScale();
this.scales[this.options.yAttr].rangeBands([0,this.height],this.options.barPadding);};l.renderData=function(){j.renderData();
if(e.falsy(this.data)){this.hideCharts("no data to display at this level of granularity");return;}var r=500;var u=this.barUtils.bars.bar.selectAll(".aggregate-texts").data(function(w){var v=w.totalsArray;
return v;},function(v){return v.monthFmt;});var t=u.transition().duration(r);t.select(".agg-text.agg-auths-text").attr("fill-opacity",1).text(function(v){return v.auths;
});t.select(".agg-text.agg-tx-text").attr("fill-opacity",1).text(function(v){return v.tx;});t.select(".agg-text.agg-authrate-text").attr("fill-opacity",1).text(function(v){return v.authRate;
});var s=u.enter().append("g").attr("class","aggregate-texts").attr("transform",function(w){var v=-7;return"translate("+0+","+(v)+")";
});s.append("text").attr("class","agg-text agg-auths-text").attr("fill-opacity",0.000001).transition().duration(r).attr("fill-opacity",1).text(function(v){return v.auths;
});s.append("text").attr("class","agg-text agg-tx-text").attr("x",this.width/2).attr("fill-opacity",0.000001).style("text-anchor","middle").transition().duration(r).attr("fill-opacity",1).text(function(v){return v.tx;
});s.append("text").attr("class","agg-text agg-authrate-text").attr("x",this.width).attr("fill-opacity",0.000001).style("text-anchor","end").transition().duration(r).attr("fill-opacity",1).text(function(v){return v.authRate;
});this.barUtils.bars.exit.selectAll("text").attr("fill-opacity",0);};var n=function(r){};return l;};return a;});define("chart/widgetFramework/composed/harpReportBuilder/HarpBuilderActions",["jqueryExtended","underscore","json","Constants","text!chart/widgetFramework/composed/harpReportBuilder/templates/harpGroupCard.html","text!chart/widgetFramework/composed/harpReportBuilder/templates/harpGroupCardEntry.html"],function(au,Y,n,G,v,Q){var k=au;
var i="tree-selected";var ah="dimension-selectbox";var z="dimension-values-list";var U="csr-panel-content-2";var X="csr-list-container-2";
var I="csr-list-2";var al="list-placeholder";var af="csr-list-extension-2";var V="list-extension-content";var aD="card-title-content";
var B="card-content-search-input";var aA="transitioning";var N="transitioned";var j="transitioned-";var av="button-container";
var d="add-group-button";var l="button-add-selection";var aj="csr-button-submit-2";var aE="remove-mode";var R="group-cards-container";
var ar="group-card";var f="group-card-transitioning";var F="group-card-opened";var P="group-card-header";var w="group-card-name";
var aw="group-card-content-list";var ak="group-card-color-";var A="csr-list-container-2--search-visible";var az="group-card-content--search-visible";
var aq="card-title-delete-button";var K="icon-search";var g="disabled";var H="show";var O="hidden";var an="selected";var p="error";
var ac=11;var ax="data-origin-index";var e="data-group-color-index";var q=240;var x={};var o=["D0E39E","A9D6A6","75Be9C","60A397","378888","37638D","04486C","152F47"];
var aC=[];var ae=function(aJ,aI){var aF=aI.parents("."+X).find("."+R);m(aF);var aH=a(aI,aF);var aG=S(aF);c(aH,aG);setTimeout(function(){u(aH);
},10);return aH;};var m=function(aF){var aG=parseInt(aF.css("width"))+q;aF.css("width",aG+"px");};var a=function(aI,aG){var aJ=aI.parents("."+ar);
var aH;if(!aJ.length){aG.prepend(v);aH=aG.children("."+ar+":nth-child(1)");}else{aJ.after(v);var aF=aJ.index()+2;aH=aG.children("."+ar+":nth-child("+aF+")");
}return aH;};var S=function(aI){var aG=aI.parents("."+X).find("."+z+":not(."+aw+")").attr("id");if(!(aG in aC)){aC[aG]=[];
}var aF={};var aK=null;var aJ=o.length;for(var aH=0;aH<aJ;aH++){if(typeof(aC[aG][aH])!=="number"||aC[aG][aH]===0||(aC[aG][aH]<aC[aG][(aH+1)]&&aH+1>=8)){aF.colorCode=o[aH];
aF.colorIndex=aH;break;}if(typeof(aK)!=="number"||aC[aG][aH]<aK){aF.colorCode=o[aH];aF.colorIndex=aH;aK=aC[aG][aH];}}if(typeof(aC[aG][aF.colorIndex])!=="number"){aC[aG][aF.colorIndex]=0;
}aC[aG][aF.colorIndex]+=1;return aF;};var c=function(aG,aF){aG.find("."+P).css("background-color","#"+aF.colorCode).attr(e,aF.colorIndex);
if(k("."+an+":not(."+g+")").length!==0){L(aG.find("."+l));}};var u=function(aF){aF.addClass(f+" "+F).one("webkitTransitionEnd transitionend",function(){aF.removeClass(f).find("ul").trigger("checkSize");
});};var s=function(aF){aF.children("li").removeClass(an).find("input").attr("checked",false);var aG=k("."+l);aG.removeClass(aj).removeClass(aE);
};var y=function(aL){var aG=aL.parents("."+ar);var aI=aG.find("li");var aK=aG.parents("."+X);var aH=aK.find("."+z+":not(."+aw+")");
var aJ=aG.find("."+P).attr(e);aI.each(function(){var aM=au(this);k(aH.children()[aM.attr(ax)]).removeClass(g+" "+an+" "+ak+aJ).find("input").prop("checked",false).prop("disabled",false);
});var aF=aG.parents("."+X).find("."+z+":not(."+aw+")").attr("id");aC[aF][aJ]-=1;aG.addClass(f).removeClass(F).one("webkitTransitionEnd transitionend",function(){aG.remove();
var aM=parseInt(aG.parent().css("width"))-q;aG.parent().css("width",aM+"px");});if(!aK.find("."+an+":not(."+g+")").length){aK.find("."+l).removeClass(aj);
}};var at=function(aK,aL,aH){if(aL.hasClass(g)){aH.preventDefault();return false;}aL.toggleClass(an);var aJ=aL.find("input");
aJ.attr("checked",!aJ.attr("checked"));var aG=aL.parents("."+X).find("."+z+" ."+an+":not( ."+g+" )");var aI=aG.parents("ul");
var aM=k("."+l);aM.removeClass(aE);if(aG.length){aM.addClass(aj);if(aI.length===1){if(aI.hasClass(aw)){var aF=aI.parents("."+ar).find("."+l);
aF.addClass(aE);}}}else{aM.removeClass(aj);}aL.toggleClass(an);aJ.attr("checked",!aJ.attr("checked"));};var L=function(aH){var aI=aH.parents("."+ar).find("."+aw);
var aL=aH.parents("."+ar);var aG=aH.parents("."+X);var aF=aG.find("."+z);var aJ=aF.index(aI);var aK=aL.find("."+P).attr(e);
T(aI,aG,aK);J(aH,aG,aI,aF,aJ);if(aH.hasClass(aE)){ad(aH,aG,aI,aK);}s(aI);setTimeout(function(){if(aI.parent().find("."+B).val()===""){aI.trigger("checkSize");
}},1500);};var T=function(aG,aF,aI){var aH=aF.find("."+I+":not(."+aw+") ."+an);aH.each(function(){var aJ=au(this);if(aJ.hasClass(g)){return true;
}aG.prepend(Q);var aK=aG.children("li:nth-child( 1 )");aK.addClass(j+"left").attr(ax,aJ.index()).append(aJ.html()).removeClass(O);
setTimeout(function(){aK.removeClass(N+" "+j+"left").one("webkitTransitionEnd transitionend",function(){aK.removeClass(aA);
});},50);aJ.addClass(g+" "+ak+aI).find("input").attr("disabled","disabled");});};var J=function(aH,aG,aI,aF,aK){var aJ=aH.parents("."+ar).siblings("."+ar).find("."+an);
aJ.each(function(){var aO=au(this);var aP=aF.index(aO.parents("."+aw));var aN=(aK-aP)/Math.abs(aK-aP);var aL=aN===-1?j+"left":j+"right";
var aT=aN===-1?j+"right":j+"left";var aS=aG.find("."+z+":not(."+aw+")");var aM=(aO.attr(ax)*1)+1;var aR=aS.find("li:nth-child("+aM+")");
var aQ=aI.parents("."+ar).find("."+P).attr(e);am(aO,aR,aQ,aL);D(aI,aO,aT);});};var am=function(aI,aF,aG,aH){aF.removeClass().addClass(an+" "+g+" "+ak+aG);
aI.addClass(aA);setTimeout(function(){aI.addClass(N+" "+aH).one("webkitTransitionEnd transitionend",function(){var aJ=aI.parent();
aI.remove();if(aJ.parent().find("."+B).val()===""){aJ.trigger("checkSize");}});},50);if(aI.hasClass(O)){aI.remove();}};var D=function(aG,aF,aH){aG.prepend(Q);
var aI=aG.children("li:nth-child( 1 )");aI.addClass(aH).attr(ax,aF.attr(ax)).append(aF.html()).removeClass(O);setTimeout(function(){aI.removeClass(N+" "+aH).one("webkitTransitionEnd transitionend",function(){aI.removeClass(aA);
});},50);};var ad=function(aI,aF,aJ,aK){var aH=aF.find("."+z).not("."+aw);var aG=aJ.find("."+an);aG.each(function(){var aL=au(this);
aL.addClass(aA);setTimeout(function(){aL.addClass(N+" "+j+"left").one("webkitTransitionEnd transitionend",function(){aL.remove();
});if(aL.hasClass("hidden")){aL.remove();}},50);k(aH.children()[aL.attr(ax)]).removeClass(g+" "+an+" "+ak+aK).find("input").prop("checked",false).removeAttr("disabled");
});aI.removeClass("remove-mode");};var ap=function(aG){var aF=C(aG.parents(".csr-list-container-2").find(".dimension-values-list:not(.group-card-content-list)").attr("name"));
aF=W(aF);r(aG,aF);h(aG,aF);ag(aG.parents(".csr-list-container-2").find(".dimension-values-list:not(.group-card-content-list)").attr("name"),aF);
};var C=function(aF){return x[aF];};var ag=function(aF,aG){x[aF]=aG;};var W=function(aF){aF={};aF.groups=[];aF.groupsContent={};
aF.groupsContent.indexes=[];aF.groupsContent.value=[];aF.isolatedSelection=[];return aF;};var r=function(aJ,aG){for(var aF=aJ.children().length;
aF>0;aF--){var aI=aJ.children("div:nth-child("+aF+")");var aH=aF-1;aG.groups[aH]=aI.find("."+w).val();aI.find("li").each(function(){aa(k(this),aG,aH);
});}};var h=function(aH,aG){var aF=aH.parents(".csr-list-container-2").find(".dimension-values-list:not(.group-card-content-list)");
aF.children("li").each(function(){var aI=k(this);if(!aI.hasClass(g)&&aI.find("input[type=checkbox]").attr("checked")==="checked"&&aI.hasClass(an)){aG.isolatedSelection.push(aI.find("input[type=checkbox]").val());
}});};var aa=function(aF,aG,aH){aG.groupsContent.value.push(aF.find("input").val());aG.groupsContent.indexes.push(aH);};var M=function(aG){var aI=aG.parents(".csr-list-container-2").find(".dimension-values-list");
var aL=x[aI.attr("name")];var aO=[];if(typeof(aL)==="undefined"){return false;}aI.find("li").each(function(){var aP=k(this);
var aR=aL.groupsContent.value.indexOf(aP.find("input").val());if(aR!==-1){var aQ=aL.groupsContent.indexes[aR];if(typeof(aO[aQ])==="undefined"){aO[aQ]=[];
}aO[aQ].push(aP);}});for(var aN=aO.length;aN>0;aN--){for(var aH=aO[aN-1].length;aH>0;aH--){var aM=aO[aN-1][aH-1].find("input[type=checkbox]");
aM.attr("checked","checked").parents("li").addClass("selected").change();}var aJ=aO[aN-1][0].parents(".csr-list-container-2").find(".add-group-button");
var aF=ae(null,k(aJ[aJ.length-1]));aF.find(".group-card-name").val(aL.groups[aN-1]);}for(var aK=aL.isolatedSelection.length;
aK>0;aK--){aI.find("li input[type=checkbox]").each(function(){var aP=k(this);if(aP.val()===aL.isolatedSelection[aK-1]){aP.attr("checked","checked").parents("li").addClass("selected").change();
}});}k("."+ah).trigger("forceEventRebind");};var Z=function(aI){var aG=aI.parent();var aK=aI.parents("."+X);var aF=aK.find("."+ar);
var aJ;var aH;aG.hide();aJ=aB(aI,aF,aK);aH=aK.find("."+an);if(!aH.length){aJ=true;aI.trigger("nothingSelected");aG.show();
}if(!aJ){aI.trigger("clickConfirmed");return true;}aG.show();};var aB=function(aG,aF,aJ){var aH=false;var aI=[aJ.find("."+V).find("."+aD).html()];
aF.each(function(){var aL=au(this);var aK=aL.find("."+w).removeClass(p).val();if(!aK.length){aL.find("."+w).addClass(p).focus();
aG.trigger("missingGroupName");aH=true;}else{if(aI.indexOf(aK)!==-1){aL.find("."+w).addClass(p).focus();aG.trigger("showDuplicateNameError");
aH=true;}else{aI.push(aK);}}});return aH;};var b=function(aH){var aF=aH.val().toLowerCase();var aG=aH.parents("."+ar);var aI;
if(!aG.length){aG=aH.parents("."+X);aI=aG.find("."+I+":not( ."+aw+" ) li");}else{aI=aG.find("."+aw+" li");}if(aF===""){aI.each(function(){k(this).removeClass(O);
});aG.find("ul").trigger("checkSize");return true;}aI.each(function(){var aK=k(this);var aJ=aK.find("input").val().toLowerCase();
if(aJ.indexOf(aF)===-1){aK.addClass(O);}else{aK.removeClass(O);}});};var ay=function(aG){var aF=aG.parents("."+ar);var aH;
if(!aF.length){aF=aG.parents("."+X);aH=aF.find("."+I+":not(."+aw+") li:not(."+O+",."+g+")");}else{aH=aF.find("."+aw+" li:not(."+O+" ."+g+")");
}aH.each(function(){var aI=k(this).toggleClass(an).find("label input");aI.attr("checked",!aI.attr("checked"));});k(aH[0]).trigger("change");
};var ai=function(aI){var aG={treeId:k("#treeId").val(),builderAction:"New Split",nodeId:aI.val(),dimension:k("#dimensions_"+aI.val()).val()};
var aH=[];var aJ=aI.parents("."+X);var aF=aJ.find("."+ar);ap(aF.parents("."+R));aH=aH.concat(ab(aF));aH=aH.concat(t(aJ));
aG.children=n.stringify(aH);return aG;};var ab=function(aF){var aG=[];aF.each(function(){var aM=au(this);var aL=aM.find("."+w).val();
var aH=[];var aJ=aM.find("li").find("input:checkbox");for(var aI=aJ.length;aI>0;aI--){var aK=k(aJ[aI-1]);aH.push(aK.val());
}if(aH.length!==0){aG.push({name:aL,values:aH});}});return aG;};var t=function(aG){var aF=[];aG.find("."+I+":not(."+aw+") li:not(."+g+") label input:checked").each(function(){var aH=k(this).val();
aF.push({name:aH,values:[aH]});});return aF;};var E=function(aG,aH){k(".pg-observed-input").removeClass("pg-observed-input");
k(".pg-observed-button").removeClass("pg-observed-button");aG.addClass("pg-observed-input");aH.addClass("pg-observed-button");
var aF={};aF.builderAction="Description Exists";aF.description=aG.val();return aF;};var ao={actions:[{source:"harpZoomIn",event:"click",target:"harpGraph",callMethod:"buttonZoomIn"},{source:"harpZoomIn",event:"click",target:"harpGraphSvg",callMethod:"buttonZoomIn"},{source:"harpZoomOut",event:"click",target:"harpGraph",callMethod:"buttonZoomOut"},{source:"harpZoomOut",event:"click",target:"harpGraphSvg",callMethod:"buttonZoomOut"},{source:"harpReset",event:"click",target:"harpGraph",callMethod:"resetZoomPan"},{source:"harpReset",event:"click",target:"harpGraphSvg",callMethod:"resetZoomPan"},{source:"harpSwitch",event:"click",target:"harpGraph",callMethod:"switchOrientation"},{source:"harpSwitch",event:"click",target:"harpGraphSvg",callMethod:"switchOrientation"},{source:"harpGraph",event:"treeLayout-drag-event",target:"harpGraphSvg",callMethod:"mirrorRedraw"},{source:"edit_tree_name",event:"click",callMethod:function(){k("#edit_controller").toggle("medium");
k("#newTreeName").val(k("#treeName").val());}},{source:"duplicate_controller_button",event:"click",callMethod:function(){k("#duplicate_controller").toggle("medium");
k("#newDuplicateTreeName").val(k("#treeName").val()).trigger("keyup");}},{source:"save_template_controller_button",event:"click",callMethod:function(){k("#template_controller").toggle("medium");
k("#templateName").val(k("#treeName").val()).trigger("keyup");}},{source:"harpTreePicker",event:"change",callMethod:function(aG,aF){k("#treeId").val(aF.val());
}},{source:"step2_toggle",event:"click",callMethod:function(){k("#step1_container").slideUp();k("#step2_container").slideDown();
k("#step3_container").slideUp();k("#step1_toggle").parent().addClass("harp-builder-step-uncollapsed");k("#step2_toggle").parent().removeClass("harp-builder-step-uncollapsed");
k("#step3_toggle").parent().addClass("harp-builder-step-uncollapsed");k(".dimension-selector, .icon-times").removeClass("inactive").addClass("active");
}},{source:"step1_toggle",event:"click",callMethod:function(aG,aF){aF.parent().removeClass("harp-builder-step-uncollapsed");
k("#harpTreePicker").val("-1");k("#step2_container").slideUp();k("#step3_container").slideUp();k("#step1_container").slideDown();
k("#step2_toggle").parent().addClass("harp-builder-step-uncollapsed");k("#step2_toggle").parent().addClass("harp-builder-step-uncollapsed");
k("#step3_toggle").parent().addClass("harp-builder-step-uncollapsed");k(".dimension-selector").removeClass("active").addClass("inactive");
k(".icon-times").hide().removeClass("active").addClass("inactive");}},{source:"step3_toggle",event:"click",callMethod:function(aG,aF){aF.parent().removeClass("harp-builder-step-uncollapsed");
k("#step1_container").slideUp();k("#step2_container").slideUp();k("#step3_container").slideDown();k("#step1_toggle").parent().addClass("harp-builder-step-uncollapsed");
k("#step2_toggle").parent().addClass("harp-builder-step-uncollapsed");}},{source:".cancel-button",event:"click",callMethod:function(){k("#harp-dialog-overlay").click();
}},{source:"showSchedulingDialog",event:"click",callMethod:function(){k("#schedulingWindow").prependTo(k("#harp-dialog-window")).show();
k("#schedulingWindow").show();k("[id^=dialogWindow]").hide();k(".explanationWindow").hide();k("#harp-dialog-overlay").show();
}},{source:"harp-dialog-overlay",event:"click",callMethod:function(aG,aF){aF.hide();}},{source:"#harpFullScreen",event:"click",callMethod:function(){k("."+U).toggleClass(i);
}},{source:"createNewTree",event:"click",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){var aF={};
aF.description=k("#treeName").val();aF.hasTemplate=k("#harpTemplatePicker").val();aF.builderAction="New Tree";aF.isTemplate="false";
return aF;}},{source:"saveNewName",event:"clickConfirmed",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){var aF={};
aF.description=k("#newTreeName").val();aF.treeId=k("#treeId").val();aF.builderAction="Update Tree";aF.isTemplate=false;return aF;
}},{source:"deleteTree",event:"click",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){k("#step1_toggle").click();
var aF={};aF.treeId=k("#treeId").val();aF.builderAction="Delete Tree";return aF;}},{source:"duplicateTree",event:"clickConfirmed",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){var aF={};
aF.description=k("#newDuplicateTreeName").val();aF.builderAction="New Tree";aF.duplicatedTreeId=k("#treeId").val();aF.isTemplate=false;
return aF;}},{source:"scheduleData",event:"click",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){var aF={};
aF.treeId=k("#treeId").val();aF.builderAction="Schedule Report";aF.startDate=k("#datepickStart").val();return aF;}},{source:"[id^=applyButton]",event:"clickConfirmed",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(aF){return ai(aF);
}},{source:"saveTemplate",event:"clickConfirmed",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){var aF={};
aF.treeId=k("#treeId").val();aF.description=k("#templateName").val();aF.builderAction="Update Tree";aF.isTemplate=true;aF.hasTemplate=k("#harpTemplatePicker").val();
return aF;}},{source:"harpTreePicker",event:"change",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){var aF={};
aF.treeId=k("#harpTreePicker").val();aF.builderAction="Get Tree";return aF;}},{source:"saveTemplate",event:"click",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){return E(k("#templateName"),k("#saveTemplate"));
}},{source:"duplicateTree",event:"click",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){return E(k("#newDuplicateTreeName"),k("#duplicateTree"));
}},{source:"saveNewName",event:"click",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){return E(k("#newTreeName"),k("#saveNewName"));
}},{source:"[id^=showDeleteSplitDialog]",event:"click",target:"harpGraph",callMethod:"showDestroyDimensionDialog",getterMethod:function(aG){var aF={};
aF.id=aG.attr("id").split("_")[1];return aF;}},{source:"[id^=deleteSplit]",event:"click",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(aG){var aF={};
aF.treeId=k("#treeId").val();aF.builderAction="Delete Nodechildren";aF.nodeId=aG.attr("id").split("_")[1];return aF;}},{source:"[id^=nodeExplanation]",event:"click",target:"harpGraph",callMethod:"showExplanationDialog",getterMethod:function(aG){var aF={};
aF.id=aG.attr("id").split("_")[1];return aF;}},{source:"[id^=textAreaConfirmButton]",event:"click",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(aG){var aF={};
aF.builderAction="Update Node";var aH=aF.nodeId=aG.attr("id").split("_")[1];aF.treeId=k("#treeId").val();aF.explanation=k("#textAreaExplanation_"+aH).val();
return aF;}},{source:"permissionSwitch",event:"click",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){var aF={};
aF.builderAction="Update Tree";aF.description=k("#treeName").val();aF.treeId=k("#treeId").val();aF.pspVisibleOnly=(k("#permissionSwitch").attr("checked"))?true:false;
return aF;}},{source:"mediator",event:"deleteNodeChildren",target:["harpGraph","harpGraphSvg"],callMethod:"deleteNodeChildren"},{source:"."+al,event:"click",callMethod:function(aJ,aI){var aH=aI.parent();
var aF=!aH.hasClass("show");var aG=k("."+X);aG.children("."+I).hide();aG.children("."+af).hide();aG.children("."+av).hide();
aG.removeClass(H);if(aF){aH.addClass(H).children().show();}}},{source:"."+ah,event:"change",callMethod:function(aH,aF){var aI=aF.attr("id").split("_")[1];
var aG=aF.val();aF.parent().find("."+X+"."+H+" ."+al).click();aF.parent().find("."+X).hide();k("#valueSelectorCarrier_"+aI+"_"+aG).attr("data-widget","ui/List");
k("#dummy_selector_"+aI).hide();k("#valueSelectorCarrier_"+aI+"_"+aG).on(G.EV_CONTENT_MERGED,function(){k(this).parent().show();
});k("#valueSelectorCarrier_"+aI+"_"+aG).trigger(G.EV_CONTENT_MERGED);}},{source:"."+ah,event:"forceEventRebind",target:"mediator",callMethod:"forceRebindGlobal"},{source:"."+d,event:"click",callMethod:function(aH,aF,aG){aG.stopPropagation();
ae(aH,aF);}},{source:"."+d,event:"click",target:"mediator",callMethod:"forceRebindGlobal"},{source:"[id^=applyButton]",event:"click",callMethod:function(aG,aF){Z(aF);
}},{source:"[id^=applyButton]",event:"nothingSelected",target:"mediator",callMethod:"showNotification",getterMethod:function(){var aF={};
aF.message="No item selected";aF.containerClass="error";return aF;}},{source:"[id^=applyButton]",event:"showDuplicateNameError",target:"mediator",callMethod:"showNotification",getterMethod:function(){var aF={};
aF.message="A group name is used at least twice";aF.containerClass="error";return aF;}},{source:"[id^=applyButton]",event:"missingGroupName",target:"mediator",callMethod:"showNotification",getterMethod:function(){var aF={};
aF.message="At least one group name is missing";aF.containerClass="error";return aF;}},{source:"."+aw,event:"wheel",callMethod:function(aH,aF,aG){aF.scrollTop(aF.scrollTop()+aG.originalEvent.deltaY);
}},{source:"."+al,event:"click",callMethod:function(aH,aG){var aF=aG.parent();if(aF.find("."+z+":not(."+aw+")").children().length>ac){aF.addClass(A);
}else{aF.removeClass(A);}}},{source:"."+l,event:"click",callMethod:function(aH,aF,aG){aG.stopPropagation();if(!aF.hasClass(aj)){return false;
}L(aF);}},{source:"."+l,event:"click",target:"mediator",callMethod:"forceRebindGlobal"},{source:"."+aq,event:"click",callMethod:function(aH,aF,aG){aG.stopPropagation();
y(aF);}},{source:"."+z,event:"checkSize",callMethod:function(aG,aF){if(aF.children().length>10){aF.parent().addClass(az);
}else{aF.parent().removeClass(az);}}},{source:"."+z+" li",event:"change",callMethod:function(aH,aF,aG){at(aH,aF,aG);}},{source:"."+w,event:"keyup",callMethod:function(aG,aF){aF.removeClass(p);
}},{source:"html",event:"click",callMethod:function(aH,aF,aG){aG.stopImmediatePropagation();}},{source:"."+B,event:"keyup",callMethod:function(aG,aF){b(aF);
}},{source:"."+K,event:"click",callMethod:function(aG,aF){ay(aF);}},{source:"input",event:"treeLayout-drag-event",callMethod:function(aH,aF,aG){aG.stopPropagation();
return false;}},{source:"[id^=deleteSplit]",event:"click",target:"harpGraph",callMethod:"deleteDimensionNode"},{source:".repeat-pattern-button",event:"click",callMethod:function(aH,aF,aG){aG.preventDefault();
M(aF);}},{source:"#newTreeName, #newDuplicateTreeName, #templateName",event:"keydown keyup",callMethod:function(aG,aF){aF.removeClass("pg-input-error").siblings("button").removeClass("rename-button--unavailable");
}}]};return ao;});define("chart/widgetFramework/composed/transactionsDashboard/views/labelledStackedBarChart",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/chartTypes/stackedBar"],function(d,g,j,c,e,b,f,i,h){function a(p,k,n){var m;
var o={};var l=g.defaults(o,p);m=h(l,k,n);var q=f(m);m.renderData=function(){q.renderData();if(b.falsy(this.data)){this.hideCharts("no data to display");
return;}};m.addLabels=function(){var s=this.barUtils.bars;var r=this.barUtils.transitionTime;var t=this.barUtils.delayTime;
s.update.select(".bar-label").text(function(u){return u[m.options.label];}).style("opacity",0).transition().duration(r).delay(t).attr("y",function(u){return Math.floor(m.barSize/2);
}).style("opacity",1);s.enter.append("text").attr("class","bar-label").attr("x",-8).attr("y",function(u){return Math.floor(m.barSize/2);
}).attr("dy",".35em").style("text-anchor","end").style("opacity",0).text(function(u){return u[m.options.label];}).transition().duration(r).delay(2*t).style("opacity",1);
s.exit.select(".bar-label").transition().duration(r).style("opacity",0).remove();};return m;}return a;});define("chart/widgetFramework/composed/transactionsDashboard/transactionsMediator",["jqueryExtended","d3","lodash","chart/widgetFramework/core/BasicMediator","util/ObjectSuper","chart/widgetFramework/core/constants/UIConstants","chartutil/dateUtils_CET","chartutil/numberutils","chartutil/cssutils"],function(a,j,g,f,d,e,b,h,i){function c(k){var l;
l=f(k,true);var m=d(l);l.txLinePeriod="hour";l.granularChartsGranularity="month";l.allowAutoUpdate=true;l.init=function(){m.init();
this.actionCommanderExclusionArray=["actioncommander","timeline"];};l.getAdditionalDOMElements=function(){m.getAdditionalDOMElements();
this.timelineInstances=[];this.$allTimelines=k.__$node.find("[data-widget*=Timeline]");this.totalDomElements+=this.$allTimelines.length;
};l.getWidgets=function(){m.getWidgets();this.getWidgetInstances(this.$allTimelines,this.timelineInstances,"Timelines");};
l.getInstance=function(){return this;};l.onNotifiedFetcher=function(o,n){m.onNotifiedFetcher(o,n);if(n==="txLineFetcher"){this.$el.trigger("txLineDataLoaded");
}};l.onNotifiedFormatter=function(n,t){m.onNotifiedFormatter(n,t);if(t==="masterFormatterGranular"&&n.changeObject.data){l.renderTotals(n.changeObject.data);
}if(t==="txLineFormatter"&&l.txLinePeriod==="minute"&&this.allowAutoUpdate){var o=n.changeObject.data.chartData.txLineValues[0];
this.latestMinuteInData=o.lineValues[o.lineValues.length-1].date.getMinutes();this.startMinuteTimer=true;}if(t==="granularAuthsLineFormatter"){var u=this.$el.find("#authRateInfoPanel");
if(n.changeObject.data.extraData.authRateOverHundred){u.show();}else{u.hide();}}var q,w,v,p,s,r;};l.onNotifiedViewCreator=function(q,o){m.onNotifiedViewCreator(q,o);
var n=q.changeObject;var p=n.type;if(o==="txLine"&&(p===e.CHART_INITIALISED||p===e.CHART_UPDATED)){setTimeout(function(){a("#txLineSpinner").hide();
},1000);if(this.startMinuteTimer){this.createMinuteTimer();}}if(o==="txHeatmap"&&(p===e.CHART_INITIALISED||p===e.CHART_UPDATED)){setTimeout(function(){a("#txHeatmapSpinner").hide();
},1000);}if(o==="authRateBar"&&p==="monthlyAuthRateChartHeight"){a("#monthlyAuthOverviewChart").height(n.data);a(".legend-wrapper").css("top",n.data-160);
}if(o==="authRateLine"&&(p===e.CHART_INITIALISED||p===e.CHART_UPDATED)){setTimeout(function(){a("#granChartSpinner").hide();
},1000);}};l.createMinuteTimer=function(){this.minuteTimer=setTimeout(function(){var n=new Date().getMinutes()-1;if(n===l.latestMinuteInData){clearTimeout(l.minuteTimer);
l.createMinuteTimer();}else{clearTimeout(l.minuteTimer);l.startMinuteTimer=false;l.$el.find("#minuteToggle").trigger("click");
}},10000);};l.renderTotals=function(p){var n=j.format(",.0f");var q=j.format(".2f");var o={receivedCount:0,authorizedCount:0,authorizedAmt:0,authorizedRate:0};
g.each(p,function(r){o.receivedCount+=r.receivedCount;o.authorizedCount+=r.authorizedCount;o.authorizedAmt+=r.authorizedAmount;
});o.authorizedAmt/=100;o.authorizedRate=(o.receivedCount>0||o.authorizedCount>0)?(o.authorizedCount/o.receivedCount)*100:0;
h.animateValue(a("#receivedCount span"),o.receivedCount,n);h.animateValue(a("#authorizedCount span"),o.authorizedCount,n);
h.animateValue(a("#authorizedRate span"),o.authorizedRate,q);h.animateValue(a("#authorizedAmount span"),o.authorizedAmt,n);
};l.fetchNewDataAction=function(p){var o=this.$el.find("#txLineText");var n;if(p.timespan.indexOf("120")>-1){o.text("120 minutes");
n="minute";}else{o.text("48 hours");n="hour";this.startMinuteTimer=false;clearTimeout(this.minuteTimer);}this.txLinePeriod=n;
a("#txLineSpinner").show();this.$el.trigger("setTxGranularity",n);};l.onCompareBtnClick=function(o){a('.grouped-bar-title[class*="change-title"]').removeClass("active");
a('.grouped-bar-chart[class*="change-bar"]').removeClass("active");a("#"+o+"Title").addClass("active");a("#"+o+"Bar").addClass("active");
var q,p;var n=[320,600,850];var r=[380,650,900];switch(o){case"authRateDifference":q=["authRateDifferenceTitle","authTxTitle","authAmountTitle"];
p=["authRateDifferenceBar","authTxBar","authAmountBar"];break;case"authCountDifference":q=["authTxTitle","authCountDifferenceTitle","authAmountTitle"];
p=["authTxBar","authCountDifferenceBar","authAmountBar"];break;case"authAmountDifference":q=["authTxTitle","authAmountTitle","authAmountDifferenceTitle"];
p=["authTxBar","authAmountBar","authAmountDifferenceBar"];break;}g.each(q,function(t,s){a("#"+t).css("left",r[s]+"px");});
g.each(p,function(t,s){a("#"+t).css("left",n[s]+"px");});};l.sortData=function(o,n){this.$sortButtonRef=n;};l.onTimeData=function(p){var n=p[2];
if(n!=="month"){a("#monthlyAuthOverviewChart").css("opacity",0.5);a("#monthlyAuthOverviewChart .extra-msg").text(" - not available at "+n+" granularity");
a("#monthlyAuthsBarContent").fadeTo(1000,0);a("#monthlyAuthsBarContent").css("pointer-events","none");a(".legend-wrapper").css("opacity",0);
}else{a("#monthlyAuthOverviewChart").css("opacity",1);a("#monthlyAuthOverviewChart .extra-msg").text("");a("#monthlyAuthsBarContent").fadeTo(1000,1);
a("#monthlyAuthsBarContent").css("pointer-events","all");a(".legend-wrapper").css("opacity",1);}this.setGranularityToggleState(n);
var o=this.checkForWeeks(this.granularChartsGranularity,p[0],p[1]);this.$el.trigger("fetchGranularData",o);};l.setGranularityToggleState=function(q){var p=this.$el.find("#monthToggle");
var o=this.$el.find("#weekToggle");var n=this.$el.find("#dayToggle");switch(q){case"month":p.removeClass("disabled");o.removeClass("disabled");
n.removeClass("disabled");break;case"week":p.removeClass("active");p.addClass("disabled");o.removeClass("disabled");n.removeClass("disabled");
if(this.granularChartsGranularity==="month"){o.addClass("active");this.granularChartsGranularity=q;this.setGranularityOnCharts();
}break;case"day":p.removeClass("active");p.addClass("disabled");o.removeClass("active");o.addClass("disabled");n.removeClass("disabled");
n.addClass("active");this.granularChartsGranularity=q;this.setGranularityOnCharts();break;}};l.setToggleGranularity=function(o){this.granularChartsGranularity=o.granularity;
var p=this.getInstanceById("timeline1",this.timelineInstances);var q=p.timeline.getDates();var n=this.checkForWeeks(this.granularChartsGranularity,q[0].toFormattedString(),q[1].toFormattedString());
this.$el.trigger("fetchGranularData",n);this.setGranularityOnCharts();a("#granChartSpinner").show();};l.setGranularityOnCharts=function(){var o,r;
var t=this.getInstanceById("authRateLine",this.chartInstances);r=t.getInstance();if(r){r.setGranularity(this.granularChartsGranularity);
}var n=this.getInstanceById("granularAuthsLineFormatter",this.formatterInstances);o=n.getInstance();if(o){o.setGranularity(this.granularChartsGranularity);
}var s=this.getInstanceById("authTxStacked",this.chartInstances);if(s){r=s.getInstance();if(r){r.setGranularity(this.granularChartsGranularity);
}}var p=this.getInstanceById("authAmtBar",this.chartInstances);if(p){r=p.getInstance();if(r){r.setGranularity(this.granularChartsGranularity);
}}var q=this.getInstanceById("granularAuthsFormatter",this.formatterInstances);if(q){o=q.getInstance();if(o){o.setGranularity(this.granularChartsGranularity);
}}};l.checkForWeeks=function(s,o,q){if(s==="week"){var t=j.time.format("%Y-%m-%d").parse(o);var p=j.time.format("%Y-%m-%d").parse(q);
var n=b.trueRoundToWeek(t,true,1);var r=b.trueRoundToWeek(p,true,1);return{startdate:n.toFormattedString(),enddate:r.toFormattedString(),granularity:s};
}else{return{startdate:o,enddate:q,granularity:s};}};l.init();k.ready();return l;}return c;});define("chart/widgetFramework/composed/posOverview/posOverviewDataFormatter",["jqueryExtended","underscore","d3","chartutil/dateUtils_CET","chart/widgetFramework/core/constants/DataConstants","chartutil/d3utils"],function(h,b,d,g,f,c){var e="09/01/2017";
var a=function(l,i,k,n){var j={};j.data=l;j.options=i;j.formattedData={};j.comparator=null;j.reverseDirection=false;j.sortKey=null;
j.timeline=k;j.id=n;j.formatData=function(){this.formattedData=m(this.data,this.options);if(this.sortKey){this.reverseDirection=!this.reverseDirection;
this.sortData(this.sortKey,true);}if(window.console&&console.log){console.log("### stackedDataFD::"+this.id+" formatData:: this.formattedData=",this.formattedData);
}return{chartData:this.formattedData};};var m=function(q,o){var p={};p.options=o;p.maxRange=0;b.each(q,function(r){if(r.totalEurQuantity>this.maxRange){this.maxRange=r.totalEurQuantity;
}},p);b.each(q,function(v){var s,t=false,u=d.format(",.0f");if(typeof(this.options.height)!=="undefined"){t=this.options.height;
}v.dateStr=v.date;v.totalEurQuantityFloored=Math.floor(v.totalEurQuantity/100);v.totalEurQuantityFormatted=u(v.totalEurQuantity/100);
v.authorisedEurQuantityFormatted=u(v.authorisedEurQuantity/100);v.cancelledEurQuantityFormatted=u(v.cancelledEurQuantity/100);
v.refusedEurQuantityFormatted=u(v.refusedEurQuantity/100);v.refundedEurQuantityFormatted=u(v.refundAuthorisedEurQuantity/100);
v.errorEurQuantityFormatted=u(v.errorEurQuantity/100);v.refusedByAcquirerEurQuantityFormatted=u(v.refusedByAcquirerEurQuantity/100);
s=new Date(v.dateStr);v.date=g.trueRoundToDay(s);if(t){var r=Math.floor(this.maxRange/t);if(v.authorisedEurQuantity<r&&v.authorisedEurQuantity>0){v.authorisedEurQuantity=r;
}if(v.refusedEurQuantity<r&&v.refusedEurQuantity>0){v.refusedEurQuantity=r;}if(v.refusedByAcquirerEurQuantity<r&&v.refusedByAcquirerEurQuantity>0){v.refusedByAcquirerEurQuantity=r;
}if(v.cancelledEurQuantity<r&&v.cancelledEurQuantity>0){v.cancelledEurQuantity=r;}if(v.refundAuthorisedEurQuantity<r&&v.refundAuthorisedEurQuantity>0){v.refundAuthorisedEurQuantity=r;
}if(v.errorEurQuantity<r&&v.errorEurQuantity>0){v.errorEurQuantity=r;}}v.rates=[{name:"authorized",value:Math.floor(v.authorisedEurQuantity/100),startY:0,endY:Math.floor(v.authorisedEurQuantity/100)},{name:"refused",value:Math.floor(v.errorEurQuantity/100),startY:Math.floor(v.authorisedEurQuantity/100),endY:Math.floor((v.authorisedEurQuantity+v.refusedEurQuantity)/100)},{name:"refused by acquirer",value:Math.floor(v.refusedByAcquirerEurQuantity/100),startY:Math.floor((v.authorisedEurQuantity+v.refusedEurQuantity)/100),endY:Math.floor((v.authorisedEurQuantity+v.refusedEurQuantity+v.refusedByAcquirerEurQuantity)/100)},{name:"cancelled",value:Math.floor(v.cancelledEurQuantity/100),startY:Math.floor((v.authorisedEurQuantity+v.refusedEurQuantity)/100),endY:Math.floor((v.authorisedEurQuantity+v.refusedEurQuantity+v.cancelledEurQuantity)/100)},{name:"refunded",value:Math.floor(v.refundAuthorisedEurQuantity/100),startY:Math.floor((v.authorisedEurQuantity+v.refusedEurQuantity+v.cancelledEurQuantity)/100),endY:Math.floor((v.authorisedEurQuantity+v.refusedEurQuantity+v.cancelledEurQuantity+v.refundAuthorisedEurQuantity)/100)},{name:"error",value:Math.floor(v.errorEurQuantity/100),startY:Math.floor((v.authorisedEurQuantity+v.refusedEurQuantity+v.cancelledEurQuantity+v.refundAuthorisedEurQuantity)/100),endY:Math.floor((v.authorisedEurQuantity+v.refusedEurQuantity+v.cancelledEurQuantity+v.errorEurQuantity+v.refundAuthorisedEurQuantity)/100)}];
},p);return q;};j.sortData=function(o,q){this.sortKey=o;this.reverseDirection=!this.reverseDirection;var p=b.sortBy(this.formattedData,o);
if(this.reverseDirection){p.reverse();}this.formattedData=p;if(q===true){return;}this.$el.trigger(f.FORMATTER_INFORM_WIDGET,{type:f.SORTED_DATA,data:{chartData:this.formattedData}});
};j.compareFunction=function(o){return o[this.sortKey];};j.getData=function(){return(this.data)?this.data:this.formatData();
};j.setRawData=function(o){this.data=o;};j.retrieveData=function(o){return this.data[o];};return j;};return a;});define("chartlib/chartBaseEvents",[],function(){var a={};a.BASE="chartlib:chartBaseEvents:";a.DATA_FAILED=a.BASE+"dataLoadError";
a.DATA_LOADED=a.BASE+"dataLoaded";a.CLEAR_ERRORS=a.BASE+"clearErrors";a.REGISTER_DEFERRED=a.BASE+"registerDeferred";a.RENDER_BUTTONS=a.BASE+"renderButtons";
a.HIDE_CHARTS=a.BASE+"hideCharts";return a;});define("chartlib/chartbase",["jquery","underscore","backbone","d3","d3tip","chartlib/chartBaseEvents","chartutil/domUtils"],function(f,b,h,c,a,g,e){var d=h.View.extend({chartDefaults:{joinAttr:null,barHeight:null,barPadding:0,margin:{top:0,right:0,bottom:0,left:0},xAttr:"x",xValid:b.isFinite,xScale:"linear",yAttr:"y",yValid:b.isFinite,yScale:"linear",tooltip:false,showTipFromText:false,isClickable:false,clickFromText:false},__DEFAULT_WIDTH:500,__DEFAULT_HEIGHT:50,initialize:function(){b.bindAll(this,"joinData","initTooltip");
this.options=b.defaults(this.options,b.defaults(this.defaults,this.chartDefaults));this._super(arguments);this.initRender();
if(this.collection){this.listenTo(this.collection,g.DATA_FAILED,this.dataLoadError);}},dataLoadError:function(){this.$el.find(".no-data-text").remove();
var k=this.height/2;var j=this.width/2;var i=f('<div class="no-data-text"><text style="color: #ccc; font-size: 14px; position: relative; top:'+k+"px; left:"+j+'px;">no data to display</text></div>');
this.$el.not(this.$el.has(".no-data-text")).prepend(i);this.$el.children().not(".no-data-text").hide();i.show();},initRender:function(){var j=this;
var k=this.options.margin;var i=e.getComputedProperties(this.$el);this.width=this.$el.width()>0?this.$el.width():i.computedWidth;
this.width-=(k.left+k.right);this.height=this.$el.height()>0?this.$el.height():i.computedHeight;this.height-=(k.top+k.bottom);
if(this.width<=0){this.width=this.__DEFAULT_WIDTH;}if(this.height<=0){if((this.$el.parent().height()-(k.top+k.bottom))>0){this.height=this.$el.parent().height()-(k.top+k.bottom);
this.$el.height(this.$el.parent().height());}else{this.height=this.__DEFAULT_HEIGHT;}}this.topSVG=this.topSVG||c.select(this.el).append("svg").attr("class","chartbase-svg");
this.svg=this.svg||this.topSVG.append("g").attr("class","chartbase-holder").attr("transform","translate("+k.left+","+k.top+")");
this.xAxis=this.xAxis||this.svg.append("g").attr("class","x axis").attr("transform","translate(0,0)");this.yAxis=this.yAxis||this.svg.append("g").attr("class","y axis");
this.setScales();this.setAxes();if(this.options.tooltip){this.$el.toggleClass("interactive-chart",true);this.initTooltip();
}},render:function(){if(this.collection.hasData===false){return;}var i=this.options.margin;if(this.options.barHeight!==null){this.height=(this.collection.length*this.options.barHeight);
}this.topSVG.attr("width",this.width+i.left+i.right+"px").attr("height",this.height+i.top+i.bottom+"px");this.$el.find(".no-data-text").remove();
this.$el.children().not(".no-data-text").show();this.update();return this;},update:function(){this.calibrateScales();this.renderXAxis();
this.renderYAxis();this.renderData();},initTooltip:function(){if(typeof d.prototype.tip==="undefined"){d.prototype.tip=c.tip().attr("class","d3-tip").offset([-10,0]);
this.svg.call(this.tip);}},setScales:function(){this.scales={};this.setXScale();this.setYScale();},calibrateScales:function(){this.calibrateXScale();
this.calibrateYScale();},setAxes:function(){this.axes={};this.setXAxis();this.setYAxis();this.formatXAxis();this.formatYAxis();
},getX:function(i){return this._getDatumValue(i,this.options.xAttr);},getY:function(i){return this._getDatumValue(i,this.options.yAttr);
},_getDatumValue:function(j,i){if(j instanceof h.Model){return j.get(i);}return j?j[i]:null;},joinData:function(l,k){var j=this.options.joinAttr;
if(j&&l instanceof h.Model){return l.get(j);}else{if(j&&b(l).has(j)){return l[j];}else{return k;}}},setXScale:function(){},setYScale:function(){},calibrateXScale:function(){},calibrateYScale:function(){},setXAxis:function(){},setYAxis:function(){},formatXAxis:function(){},formatYAxis:function(){},renderXAxis:function(){},renderYAxis:function(){},renderData:function(){}});
return d;});define("chart/widgetFramework/composed/cardAcquirerAuthorizationReport/formatters/issuerCountryBarFormatter",["jqueryExtended","underscore","d3","chart/widgetFramework/core/constants/DataConstants"],function(e,b,c,d){function a(i,f,h,k){var g={};
g.data=i;g.options=f;g.formattedData={};g.comparator=null;g.reverseDirection=false;g.sortKey="authorizationRate";g.timeline=h;
g.id=k;g.formatData=function(){var l=this.data.issuerCountryCode_aggregation?this.data.issuerCountryCode_aggregation:{};if(l.length===0){return[];
}this.formattedData=j(l);if(this.sortKey){this.reverseDirection=!this.reverseDirection;this.sortData(this.sortKey,true);}return{chartData:this.formattedData};
};var j=function(n){var m=[];n=b.filter(n,function(o){return typeof o.issuerCountryCode!=="undefined"&&!(b.isNull(o.issuerCountryCode));
});n=b.filter(n,function(o){return +o.authorisedCount>0&&+o.authRate>0;});var l=c.sum(n,function(o){return +o.authorisedCount;
});b.each(n,function(q){var p=+q.authRate*100,o=100-p;m.push({labelName:q.issuerCountryCode,authorizedCount:+q.authorisedCount,authorizedCountShare:l===0?0:+q.authorisedCount/l*100,authorizedEurAmount:+q.authorisedAmount/100,authorizationRate:p,authRate:[{name:"authorized",value:p,startX:0,endX:p},{name:"refused",value:o,startX:p,endX:100}],total:100,name:"authorized"});
});return m;};g.sortData=function(l,n){this.sortKey=l;if(this.sortKey===this.oldSortKey){this.reverseDirection=!this.reverseDirection;
}else{this.reverseDirection=false;}this.oldSortKey=this.sortKey;var m=b.sortBy(this.formattedData,l);if(this.reverseDirection){m.reverse();
}this.formattedData=m;if(n===true){return;}this.$el.trigger(d.FORMATTER_INFORM_WIDGET,{type:d.SORTED_DATA,data:{chartData:this.formattedData}});
};g.compareFunction=function(l){return l[this.sortKey];};g.getData=function(){return(this.data)?this.data:this.formatData();
};g.setRawData=function(l){this.data=l;};g.retrieveData=function(l){return this.data[l];};return g;}return a;});define("chart/widgetFramework/core/Dataset",["jqueryExtended","underscore","chart/widgetFramework/core/constants/DataConstants"],function(g,c,e){var d="color:darkolivegreen;font-size:1em";
var a=false;var b=false;var f=function(h){var i={};i.init=function(){this.url=h;this.loadCount=0;};i.fetchData=function(k){if(window.console&&console.log&&a){console.log("%c\n################",d);
console.log("%c### START STAGE :: Dataset::fetchData",d);console.log("### Dataset::fetchData:: urlParams=",k);console.log("%c################",d);
}this.loadCount++;var j=this.url;if(b&&this.loadCount>1){var m=j.split(".");j=m[0]+this.loadCount+"."+m[1];}if(k&&k.type&&k.type.toLowerCase()==="post"){var l="?cb=";
if(j.indexOf("?")>-1){l="&cb=";}j+=l+k.cb;}return g.ajax({type:(k&&k.type)||"GET",url:j,data:k});};i.init();return i;};return f;
});define("chart/widgetFramework/core/drivers/observableCode",["lodash"],function(a){var b=function(h,g){var c={};var i={};var e=[];
var d=false;var f="";h.getData=function(){return c;};h.setProperty=function(k,m,j){var l=this.getPendingChanges();if(c[k]!==m){l++;
i[k]=m;c[k]=m;}if(l===0){return false;}if(typeof j==="undefined"||j){this.notify();}return true;};h.setProperties=function(m,k){var l=this.getPendingChanges();
for(var j in m){if(m.hasOwnProperty(j)){if(this.setProperty(j,m[j],false)){l++;}}}if(l===0){return false;}if(typeof k==="undefined"||k){this.notify();
}return true;};h.getPendingChanges=function(){var j=0;for(var k in i){if(i.hasOwnProperty(k)){j++;}}return j;};h.invalidate=function(j){i.__invalidate=j;
this.notify();};h.getProperty=function(j){return c[j];};h.hasProperty=function(j){return(typeof c[j]!=="undefined");};h.registerObserver=function(o,q,l,r){if(r){f=l;
d=true;}var p;if(typeof o==="function"){p=o;o={notify:p,id:l};}else{console.warn("[Observable] You are trying to register something other than a function as an observer. This won't work");
return false;}if(this.deregisterObserver(p,true)){console.warn("[Observable] You are registering the same observer twice. We kindly removed the earlier observer, and re-registered it.");
}if(q){o.notify(c);}e.push(o);if(d){var k=-1;for(var m=0,n=e.length;m<n;m++){if(e[m].id&&e[m].id===f){k=m;break;}}if(k>0){var j=e.splice(k,1);
e.unshift(j[0]);}}return true;};h.deregisterObserver=function(k,j){for(var l=0,m=e.length;l<m;l++){if(e[l].notify===k){e.splice(l,1);
return true;}}if(!j){console.warn("You are trying deregistering an observer that hasn't been previously registered as an observer.");
}return false;};h.notify=function(){var k=i;i={};e.reverse();for(var j=e.length-1;j>-1;j--){if(typeof e[j]==="undefined"){continue;
}e[j].notify(k,h.id);}e.reverse();};return h;};return b;});define("chart/widgetFramework/core/DataFetcher",["jqueryExtended","underscore","chart/widgetFramework/core/drivers/observableCode","chart/widgetFramework/core/Dataset","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/core/constants/UIConstants","chartutil/domUtils"],function(a,n,b,e,i,l,k){var d=false;
var m="color:dodgerblue;font-size:1em";var c=false;var g="color:darkolivegreen;font-size:1em";var h=false;var j="color:darkorange;font-size:1em";
var f=false;var o=function(p){a("#devl-switch-button").parent().hide();a("#devl-container").hide();var s={};b(s,"fetcher");
s.init=function(){this.$el=p.getNode();this.id=this.$el.attr("id");var u=this.$el.attr("name");this.parameters=this.getParameters(p);
if(this.parameters.options){var v=n.keys(this.parameters.options);n.each(v,function(x){if(x.toLowerCase().indexOf("hash")>-1){s.parameters.options[x]=adyen[s.parameters.options[x]];
}});}if(this.parameters.options){this.parameters.options.cb=new Date().getTime();}var w=this.createDataset(this.parameters);
this.datasetObject={name:u,dataset:w,container:this.$el};k.removeDataAtrributes(this.$el,["options"]);};s.onDataLoaded=function(v,u){this.setProperty("changeObject",{type:i.NEW_DATA_AVAILABLE,data:u});
};s.getParameters=function(u){var x=u.getNode().data();var v;if(n.keys(x).length){v=x;}else{u.parameters.listensTo=a.parseJSON(u.parameters.listensTo);
u.parameters.options=a.parseJSON(u.parameters.options);v=u.parameters;}var w={};if(n.keys(v).length){w.src=v.src;w.listensTo=v.listensTo;
w.options=v.options;if(n.has(w.options,"granularity")){this.startGranularity=w.options.granularity;}else{if(n.has(w.options,"period")){this.startGranularity=w.options.period;
}}w.service=v.service;}else{throw"The parameters are not well defined"+v;}return w;};s.setData=function(u){if(window.console&&console.log&&d){console.log("%c\n################",g);
console.log("%c### START STAGE :: DataFetcher::setData  ::"+this.id+":: DEFERRED RESOLVED",g);console.log("%c################",g);
}this.data=u;this.onDataLoaded(null,u);};s.getData=function(){return this.data;};s.createDataset=function(v){if(v.service){return{fetchData:function(y){var x=new a.Deferred();
require([v.service],function(z){z.fetchData(v.options).then(function(A){x.resolve(A);},function(A){x.reject(A);});},function(){if(window.console&&console.warn){console.warn("DataFetcher:: Error loading dataService '"+v.service+"'",arguments);
}});return x.promise();}};}var u=adyen.config[v.src];if(typeof u==="undefined"){u=v.src;}var w=new e(u,this);return w;};s.getInstance=function(){return this;
};s.onPassThruData=function(u){this.setData(u);};s.onTimeData=function(w,x,v){var u;if(this.parameters.options){u=q(this.parameters.options,[w]);
}setTimeout(function(){r(u,v,s.datasetObject);},10);};s.fetchNewDataAction=function(){t(arguments[0],arguments[2]);};s.widgetAppStartup=function(x,u,w){var v=x||this.parameters.options;
this.basicDataFetch(v,u,w);};s.basicDataFetch=function(w,u,v){r(w,v,u);};var q=function(x,u){var v=u;v=n.flatten(v);var w=n.keys(x);
n.each(w,function(y){if(y.toLowerCase().indexOf("startdate")>-1||y.toLowerCase().indexOf("bdate")>-1){x[y]=v[0];}if(y.toLowerCase().indexOf("enddate")>-1||y.toLowerCase().indexOf("edate")>-1){x[y]=v[1];
}if(y.toLowerCase().indexOf("granularity")>-1||y.toLowerCase().indexOf("period")>-1){if(s.startGranularity===null){x[y]=v[2];
}}});return x;};var t=function(y,u,w){var x=s.parameters.options;var v=n.assign(x,y);r(v,u,w);};var r=function(v,u,w){if(window.console&&console.log&&d){console.log("### DataFetcher:: "+s.id+" fetchData (type: "+u+" ):: pParams=",v);
}s.datasetObject.dataset.fetchData(v).then(function(x){s.$el.trigger(i.FETCH_DATA_SUCCESS);s.setData(x);},function(z,x,y){s.$el.trigger(i.FETCH_DATA_ERROR,{error:x,exception:y});
if(window.console&&console.log){console.log("### DataFetcher:: "+s.id+" DATA LOAD (type: "+u+" ) ERROR!:: ",arguments);}});
};s.init();if(window.console&&console.log&&f){console.log("\n### DatFetcher2::constructor:: calling pWidgetApi.ready()");
}p.ready();return s;};return o;});define("chartlib/mixins/scales",["d3","underscore"],function(b,a){var c={};c.setOrdinalXScale=function(){this.scales.x=b.scale.ordinal().rangeRoundBands([0,this.width]);
};c.setLinearXScale=function(){this.scales.x=b.scale.linear().rangeRound([0,this.width],this.options.barPadding);};c.setLinearRangeXScale=function(){this.scales.x=b.scale.linear().rangeRound([0,this.width],this.options.barPadding);
};c.setTimeXScale=function(){this.scales.x=b.time.scale.utc().range([0,this.width],this.options.barPadding);};c.calibrateOrdinalXScale=function(){this.scales.x.domain(this.collection.pluck(this.options.xAttr));
};c.calibrateLinearXScale=function(){var d=this.collection.pluck(this.options.xAttr);d=a.map(d,function(e){if(a.isArray(e)){return a.pluck(e,"value");
}return e;});d=a.flatten(d);this.scales.x.domain([0,b.max(d)]);if(this.options.niceScales){this.scales.x.nice();}};c.calibrateLinearRangeXScale=function(){var e=this.collection.pluck(this.options.xAttr);
e=a.map(e,function(f){if(a.isArray(f)){return a.pluck(f,"value");}return f;});e=a.flatten(e);var d=this.collection.pluck(this.options.xAttrEnd);
d=a.map(d,function(f){if(a.isArray(f)){return a.pluck(f,"value");}return f;});d=a.flatten(d);this.scales.x.domain([b.min(e),b.max(d)]);
};c.calibrateLinearStackedXScale=function(){var d=this.collection.pluck(this.options.xAttr);d=a.map(d,function(f){if(a.isArray(f)){var e=a.reduceRight(a.pluck(f,"value"),function(g,h){return g+h;
},0);return e;}return f;});d=a.flatten(d);this.scales.x.domain([0,b.max(d)]);};c.calibrateTimeXScale=function(){var e=this;
var d=this.collection.getDateExtent();this.scales.x.domain(d);this.scales.x.ticks(this.collection.getIntervalFormat(),1);
};c.setOrdinalYScale=function(){this.scales.y=b.scale.ordinal().rangeRoundBands([this.height,0]);};c.setLinearYScale=function(){this.scales.y=b.scale.linear().range([this.height,0],this.options.barPadding);
};c.setTimeYScale=function(){this.scales.y=b.time.scale.utc().range([this.height,0],this.options.barPadding);};c.calibrateOrdinalYScale=function(){this.scales.y.domain(this.collection.pluck(this.options.yAttr));
};c.calibrateLinearYScale=function(){var d=this.collection.pluck(this.options.yAttr);d=a.map(d,function(e){if(a.isArray(e)){return a.pluck(e,"value");
}return e;});d=a.flatten(d);this.scales.y.domain([0,b.max(d)]);if(this.options.niceScales){this.scales.y.nice();}};c.calibrateLinearStackedYScale=function(){var d=this.collection.pluck(this.options.yAttr);
d=a.map(d,function(f){if(a.isArray(f)){var e=a.reduceRight(a.pluck(f,"value"),function(g,h){return g+h;},0);return e;}return f;
});d=a.flatten(d);this.scales.y.domain([0,b.max(d)]);};c.calibrateTimeYScale=function(){var e=this;var d=this.collection.getDateExtent();
this.scales.y.domain(d);this.scales.y.ticks(this.collection.getIntervalFormat(),1);};return c;});define("chart/widgetFramework/composed/revenueAccelerate/revenueAccelerateActions",["jqueryExtended","underscore"],function(c,a){var d=c;
var b={actions:[]};return b;});define("chart/widgetFramework/composed/ecpReport/programInfoPanel",["jquery","underscore","d3","hogan","util/Functional","chartutil/stringutils","chart/widgetFramework/core/constants/WidgetConstants","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/drivers/basicChartDriver"],function(c,j,k,g,a,b,f,i,h,d){var e=function(r,l,p,n){var o;
var q={};var m=j.defaults(r,q);o=d(m,l);var s=h(o);o.init=function(){s.init();this.template=g.compile(n);};o.feedData=function(v){var t=o.options.dataSubset;
var u=j.filter(v,function(x){return x.programName===t;});this.data=u[0];var w=t.replace(".","");this.programName=b.replaceSpace(w.toLowerCase(),"-");
this.programName+="-info";};o.renderData=function(){var t=this.template.render({programName:this.programName});this.$el.html(t);
};return o;};return e;});define("chartlib/basicChart",["jquery","underscore","chartlib/chartbase","d3"],function(e,a,d,c){var b=d.extend({defaults:{barPadding:0.2,yScale:"ordinal",textAnchor:"start"},IE_tooltip_timeout:null,initialize:function(){a.bindAll(this,"showTooltip","hideTooltip","showToolTip_fromText","hideToolTip_fromText","textClicked","render");
this.addListeners();this._super();},addListeners:function(){if(this.collection){this.listenTo(this.collection,"reset",this.render);
}},setXScale:function(){this.scales.x=c.scale[this.options.xScale]().range([0,this.width]);},calibrateXScale:function(){this.scales.x.domain([0,c.max(this.collection.pluck(this.options.xAttr))]);
},setYScale:function(){this.scales.y=c.scale[this.options.yScale]();},calibrateYScale:function(){this.scales.y.domain(this.collection.pluck(this.options.yAttr)).rangeRoundBands([this.height,0],this.options.barPadding);
},setXAxis:function(){this.axes.x=c.svg.axis().scale(this.scales.x).orient("bottom").tickSize(-this.height).tickFormat(c.format("1s"));
},formatXAxis:function(){},setYAxis:function(){this.axes.y=c.svg.axis().scale(this.scales.y).orient("left");},formatYAxis:function(){},renderXAxis:function(){var g=this.axes.x;
if(this.options.barHeight!==null){g.tickSize(-this.height);}var f=(this.options.delay)?this.options.delay:500;this.xAxis.attr("opacity",1).call(g).transition().duration(500).delay(f).ease("exp-in-out").attr("transform","translate(0,"+this.height+")");
this.xAxis.selectAll("line").each(function(h){if(typeof this.raphaelNode!=="undefined"){this.raphaelNode.toBack();}});},renderYAxis:function(){this.yAxis.transition().duration(500).ease("exp-in-out").call(this.axes.y);
if(this.options.showTipFromText){this.yAxis.selectAll(".tick text").classed("active",true).on("mouseover",this.showToolTip_fromText).on("mouseout",this.hideToolTip_fromText);
}if(this.options.isClickable&&this.options.clickFromText){this.yAxis.selectAll(".tick text").classed("hand-cursor active",true).on("click",this.textClicked);
}},renderData:function(){var l=this,n=this.options,f=this.scales.y,m=500;var k=this.svg.selectAll(".bar").data(this.collection.models,this.joinData);
var j=k.enter().append("g").attr("class","bar full").attr("transform",function(o){return"translate(0,"+f(l.getY(o))+")";});
j.append("text").attr("class","barless-chart-text").attr("x",function(o){return l.options.totalLabelOffset;}).attr("y",f.rangeBand()/2).attr("dy",".35em").text(function(o){return l.getX(o);
}).attr("font-size","12px").attr("text-anchor",l.options.textAnchor).attr("fill-opacity",0);var g=k.select(".barless-chart-text").text(function(o){return l.getX(o);
});var h=c.transition(k);h.select(".barless-chart-text").attr("y",f.rangeBand()/2).attr("fill-opacity",1);h.transition().duration(m).attr("transform",function(o){return"translate(0,"+f(l.getY(o))+")";
});var i=c.transition(k.exit()).transition().duration(m).attr("transform",function(o){return"translate(0,"+l.height+")";}).remove();
i.selectAll("text").attr("fill-opacity",0);if(this.options.tooltip){k.classed("active",true);j.on("mouseover",function(o){l.showTooltip(o,this,false);
}).on("mouseout",function(o){l.hideTooltip(false);});}if(this.options.isClickable){j.on("click",l.onBarClicked);k.classed({"hand-cursor active":true});
}},showTooltip:function(m,i,f){this.renderTooltipContent(m,i);if(typeof window.SVGElement==="undefined"){var g=e(i)[0].raphaelNode[0];
var h=e(g).offset().top;var l=e(g).offset().left+Number(g.clientWidth);var k=5;var j=e(".d3-tip");j.css({width:"auto","text-align":"center",display:"block",padding:"4px 6px",opacity:"1",left:(l+10)+"px",top:(h-k)+"px"});
j.addClass("on");this.tip.show(m,i);return;}if(f!==true){this.tip.show(m,i);}else{this.tip.show(m,i.node());}},showToolTip_fromText:function(f){var g=this.getElementFromAttrValue(".bar.full",this.options.yAttr,f);
this.showTooltip(g.datum(),g,true);return g;},hideTooltip:function(f){if(typeof window.SVGElement==="undefined"){var h=e(".d3-tip");
var g=this;if(f){window.clearTimeout(this.IE_tooltip_timeout);this.IE_tooltip_timeout=setTimeout(function(){h.css("display","none");
g.tip.hide();},1000);}else{h.css("display","none");g.tip.hide();}return;}this.tip.hide();},hideToolTip_fromText:function(f){var g=this.getElementFromAttrValue(".bar.full",this.options.yAttr,f);
this.hideTooltip(true);return g;},getElementFromAttrValue:function(h,k,g){var l=this.el.className;var i=l.replace(/\s+/g,".");
var f=c.selectAll("."+i+" "+h);var j=f.filter(function(n,m){return n.attributes[k]===g;});return j;},textClicked:function(f){var g=this.getElementFromAttrValue(".bar.full",this.options.yAttr,f);
g.on("click")(g.datum());},onBarClicked:function(){},renderTooltipContent:function(){}});return b;});define("chartlib/scatterChart",["jquery","underscore","chartlib/basicChart","d3","chartlib/chartBaseEvents"],function(d,b,a,c,e){var f=a.extend({defaults:{barPadding:0.2,margin:{top:5,right:10,bottom:20,left:40},tooltip:true},calibrateXScale:function(){var g=this.collection.pluck(this.options.xAttr);
this.scales.x.domain([c.min(g),c.max(g)]);},calibrateYScale:function(){var g=this.collection.pluck(this.options.yAttr);this.scales.y.domain([c.min(g),c.max(g)]);
},formatXAxis:function(){var g=this.axes.x;if(this.options.percentile){g.tickFormat(c.format("%"));}else{g.tickFormat(c.format(".0f"));
}},formatYAxis:function(){var g=this.axes.y;if(this.options.percentile){g.tickFormat(c.format("%"));}else{g.tickFormat(c.format(".0f"));
}},renderData:function(){var j=this,i=this.options,g=this.scales.x,l=this.scales.y;var h=this.collection.pluck(this.options.yAttr);
var k=this.renderBar(j,i,g,l);this.renderScatterBars(j,k,i,g,l,h);},renderBar:function(j,i,g,n){var k=this.svg.selectAll(".bar").data([j.collection.models],this.joinData);
var m=k.enter().append("g").attr("class","bar full").attr("transform",function(o){return"translate(0,0)";});var l=k.transition().duration(500).delay(500).attr("transform",function(o){return"translate(0,0)";
});var h=k.exit().transition().attr("transform",function(o){return"translate(0,"+j.height+")";});h.select("rect").transition().attr("height",0);
h.remove();if(i.isClickable){m.on("click",j.onBarClicked);k.classed({"hand-cursor active":true});}return k;},renderScatterBars:function(m,k,p,o,n,j){var h=k.selectAll(".scatter").data(function(q){return q;
},m.joinData);var l=h.enter().append("rect").attr("class","scatter").attr("x",0).attr("height",function(q){return m.height;
});var i=h.attr("width",2).transition().duration(500).delay(500).ease("cubic-in-out").attr("x",function(q){return o(m.getX(q))-1;
});var g=h.exit().transition().attr("transform",function(q){return"translate("+m.height+", 0)";});g.select("rect").transition().attr("width",0);
g.remove();if(p.tooltip){h.classed("active",true);l.on("mouseover",function(q){m.showTooltip(q,this,false);}).on("mouseout",function(q){m.hideTooltip(false);
});}if(p.isClickable){l.on("click",m.onBarClicked);h.classed({"hand-cursor active":true});}}});return f;});define("chart/widgetFramework/chartTypes/htmlTemplate",["jquery","hogan","chart/widgetFramework/core/drivers/basicChartDriver","util/ObjectSuper","Constants"],function(d,a,e,c,b){function f(i,g,k,h){i.templateStyle="html";
var j=e(i);var l=c(j);j.options=i;j.init=function(n,m){l.init(n,m);j.el=m;j.template=a.compile(h);};j.feedData=function(m){j.data=m;
};j.render=function(n){var m=j.template.render(n||j.data);d(j.el).html(m).trigger(b.EV_CONTENT_MERGED);};return j;}return f;
});define("chart/widgetFramework/components/Tooltip",["lodash","hogan"],function(b,a){var c=function(d){var e=this;e.init=function(){var f=e.getParameters(d);
e.$el=d.getNode();e.id=e.$el.attr("id");require(["text!chart/widgetFramework/"+f.templateName],function(g){e.template=a.compile(g);
});};e.getParameters=function(f){var h=f.getNode().data();var g=h.template;return{templateName:g};};e.getMouseCoordinates=function(){var f={left:event.pageX,top:event.pageY};
return f;};e.render=function(g){var h=g.data;var f=g.position;e.$el.html(e.template.render(h));if(!f){e.$el.css({display:"block"});
}else{e.$el.css({left:f.left,top:f.top,display:"block"});}};e.getInstance=function(){return e;};e.init();d.ready();return e;
};return c;});define("chart/widgetFramework/chartTypes/sparklineNew",["d3","jquery","underscore","backbone","hogan","chart/widgetFramework/core/drivers/baseView","util/ObjectSuper","Constants"],function(i,c,h,g,d,a,e,b){var f=function(n,j){var m={height:20,width:100,template:"",templateStyle:"",dataProperty:"close",highlightEnd:true,startLine:false};
var k=h.defaults(n,m);var l=a(k,j);var o=e(l);l.selections={};l.data=[];l.init=function(){o.init();if(!this.options.dataPropertyX||this.options.dataPropertyX===""){this.options.dataPropertyX="date";
}};l.initRender=function(){o.initRender();this.x=i.scale.linear().range([0,this.width]);this.y=i.scale.linear().range([this.height,0]);
this.line=i.svg.line().x(function(p){return l.x(p[l.options.dataPropertyX]);}).y(function(p){return l.y(p[l.options.dataPropertyY]);
});this.selections.text=this.chartGroup.append("text").attr("x",this.width).attr("y",this.options.margin.top).attr("text-anchor","end").attr("class","sparktext");
};l.render=function(){this.sparkline(this.data);};l.sparkline=function(q){var p=(this.width/q.length);q=h.sortBy(q,this.options.dataPropertyX).reverse();
this.firstData=q[0];this.x.domain(i.extent(q,function(r){return r[l.options.dataPropertyX];}));this.y.domain(i.extent(q,function(r){return r[l.options.dataPropertyY];
}));if(this.options.startLine){this.chartGroup.append("rect").attr("class","sparkavg").attr("height",1).attr("width",this.width).attr("opacity",0.075).attr("x",0).attr("y",this.y(q[q.length-1][this.options.dataPropertyY])).attr("r",2);
}this.chartGroup.append("path").datum(q).classed("sparkline",true).attr("d",this.line);this.chartGroup.selectAll(".sparkbar").data(q).enter().append("rect").attr("height",this.height).attr("width",function(){return p;
}).attr("x",function(r){return l.x(r[l.options.dataPropertyX])-(p/2);}).attr("y",0).attr("opacity",0).on("mouseover",function(r){i.event.stopPropagation();
l.placeDot(r);l.showData(r);}).on("mouseout",function(){l.placeDot(l.firstData);l.showData(l.firstData);}).classed("sparkbar",true);
this.placeDot(this.firstData);this.showData(this.firstData);};l.placeDot=function(p){this.topSVG.select(".sparkcircle").remove();
this.chartGroup.append("circle").attr("class","sparkcircle").attr("cx",l.x(p[this.options.dataPropertyX])).attr("cy",l.y(p[this.options.dataPropertyX])).attr("r",2);
};l.showData=function(q){var p=h.get(q,this.options.dataProperty);this.selections.text.text(p);};return l;};return f;});define("chart/widgetFramework/composed/transactionsDashboard/rollovers/txLineRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chartutil/numberutils","chartutil/dateUtils_CET","chart/widgetFramework/chartTypes/rollover"],function(d,k,l,a,h,j,i,g,f,c,e){function b(q,m){var o;
var p={};var n=k.defaults(p,q);o=e(n,m);var r=i(o);o.granularity="hour";o.removedAcquirersArr=[];o.allLinesAreRemoved=false;
o.init=function(){r.init();this.barUtils.setBarSelectorStr(".bar.tx-line-rollover");};o.feedData=function(s){r.feedData(s);
this.removedAcquirersArr=[];this.allLinesAreRemoved=false;};o.renderData=function(){var s=this.options.centerBars;this.barUtils.chartWidth=this.width;
this.barUtils.chartHeight=this.height;var t;t=this.barUtils.barPosition(s,this.bandSize,this.getXScale(),this.options.joinAttr);
this.barUtils.containerBarsVertical(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),t).fullBarVertical(3,"thin-bar").fullBarVertical(this.barSize,"dateStr");
};o.setGranularity=function(s){this.granularity=s;if(window.console&&console.log){console.log("### txLineRollover::setGranularity:: GRAN=",s);
}};o.tooltipOnMouseoverAction=function(t,s){this.sharedMouseAction(s,0.25,1);};o.tooltipOnMouseoutAction=function(t,s){this.sharedMouseAction(s,0,0);
};o.sharedMouseAction=function(z,x,A){var u=z.find(".dateStr");var w=u.attr("data-id");var y=z.find(".thin-bar");l.select(y[0]).style("opacity",x);
var v=["authorized","refused","error"],t,s;k.each(v,function(B){t="#txLine ."+B+' .line-holder-dot[data-id*="'+w+'"]';s=l.select(t).style("fill-opacity",A).style("stroke-opacity",A);
});};o.enhanceTooltipData=function(u){var t,y=u.date;if(this.granularity==="hour"){t=f.zeroPad(y.getHours())+":00 - "+f.zeroPad(y.getHours())+":59 on "+c.getUserFriendlyDate(u.dateStr);
}else{if(this.granularity==="minute"){var x=y.getMinutes();var w,v;if(x!==59){w=f.zeroPad(x+1);v=f.zeroPad(y.getHours());
}else{w="00";v=f.zeroPad(y.getHours()+1);}t="Between "+f.zeroPad(y.getHours())+":"+f.zeroPad(x)+" - "+v+":"+w;}}var s=l.format("0,000");
u.formattedTimespan=t;u.authorizedCountTT=s(u.authorizedCount);u.refusedCountTT=s(u.refusedCount);u.errorCountTT=s(u.errorCount);
k.each(k.keys(u),function(B){for(var A=0,z=o.removedAcquirersArr.length;A<z;A++){if(B.toLowerCase().indexOf(o.removedAcquirersArr[A])>-1){u[B+"TT"]=null;
}}});};o.positionTooltip=function(w,y,v,x,s,t,z){var u=w.top+v-s;var A=((w.left+y+10)-x)+(t/2);return{top:u,left:A};};o.removeTooltipElement=function(s){this.removedAcquirersArr.push(s.toLowerCase());
};o.restoreTooltipElement=function(s){k.remove(this.removedAcquirersArr,function(t){return s.toLowerCase()===t;});if(this.allLinesAreRemoved){this.setTooltipsOnElements();
this.allLinesAreRemoved=false;}};o.allLinesRemoved=function(){var s=this.$el.find(this.tooltipSelector);s.off(this.tooltipEvent);
s.off("mouseout");this.allLinesAreRemoved=true;};return o;}return b;});define("chart/widgetFramework/composed/chargebackReport/atvLineChart",["jquery","underscore","chart/widgetFramework/core/mixins/formats","util/ObjectSuper","chart/widgetFramework/chartTypes/lineChart"],function(f,c,e,d,a){var b=function(l,g,j){var i;
var k={};var h=c.defaults(k,l);i=a(h,g,j);var m=d(i);i.renderYAxis=function(){m.renderYAxis();};i.getLabelName=function(n){return n[this.options.joinAttr];
};return i;};return b;});define("chart/widgetFramework/composed/posOverview/posOverviewActions",["jqueryExtended"],function(d){var e=d;var b=function(f){e(".ca-chart-stat").addClass("ca-faded").filter(".ca-chart-stat__"+f).addClass("ca-faded__focused");
e(".stack."+f).attr("data-focused","true");e("#posOverview-chart-container").addClass("ca-chart__focused");};var a=function(){e(".ca-chart-stat").removeClass("ca-faded ca-faded__focused");
e(".stack").attr("data-focused","false");e("#posOverview-chart-container").removeClass("ca-chart__focused");};var c={actions:[{source:"paymentMethod",event:"change",target:"fetcher",callMethod:"fetchNewDataAction",getterMethod:function(f){var g=f.val();
return{paymentMethod:g};}},{source:"timeline1",event:"timelineTimespanSet",target:["fetcher","activePaymentMethodsFetcher"],callMethod:"onTimeData"},{source:".ca-chart-stat",event:"mouseenter",callMethod:function(g,f){if(f.hasClass("ca-chart-stat__authorized")){b("authorized");
}else{if(f.hasClass("ca-chart-stat__refused")){b("refused");}else{if(f.hasClass("ca-chart-stat__cancelled")){b("cancelled");
}else{if(f.hasClass("ca-chart-stat__error")){b("error");}else{if(f.hasClass("ca-chart-stat__refused-by-acquirer")){b("refused-by-acquirer");
}else{if(f.hasClass("ca-chart-stat__refunded")){b("refunded");}}}}}}}},{source:".ca-chart-stat",event:"mouseleave",callMethod:function(){a();
}},{source:".stack",event:"mouseleave",callMethod:function(){a();}}]};return c;});define("chartutil/svgutils",["jquery","underscore","chartutil/domUtils","util/Functional"],function(e,a,d,b){var c={};c.getTransform=function(h,g){var f=g.getCTM();
return{cx:f.e,cy:f.f};};c.getScale=function(h,g){var f=g.getCTM();return{cx:f.a,cy:f.d};};c.svgToJpg=function(i,f,h,g){c.svgToImageFile(i,f,h,g,"image/jpeg",".jpg");
};c.svgToPng=function(k,f,i,g,j,h){c.svgToImageFile(k,f,i,g,"image/png",".png",j,h);};c.svgToImageFile=function(z,N,q,M,y,h,K,R){var A=false;
var x=(typeof M!=="undefined")?M.split(".")[0]:"mySvgImage";var r=(typeof y!=="undefined")?y:"image/png";var Y=(typeof h!=="undefined")?h:".png";
var v=(typeof q!=="undefined")?q:"";var X=(b.notFalsy(K))?K:"";var Q=(b.notFalsy(R))?R:0;var V,p,f,g=20,B=10;if(typeof z==="object"){if(z instanceof e){V=z[0];
}else{V=z;}}else{if(typeof z==="string"){V=e(z)[0];}}p=e(e(V).find("svg")[0]).width()+B+Q;f=e(e(V).find("svg")[0]).height()+g;
if(v.length){f+=40;}var n=V.cloneNode(true);n.id="svgHolder2";document.body.appendChild(n);var O=e(V).find("svg").css("background-color");
var S=e(n).find("svg");S[0].style.cssText+=("background: "+O);if(v.length){S.attr("height",f);var E=S[0];var D=document.createElementNS("http://www.w3.org/2000/svg","text");
D.setAttribute("x","20");D.setAttribute("y",f-20);D.setAttribute("font-family",["Open Sans","sans-serif"]);D.setAttribute("font-size","14px");
D.setAttribute("font-weight","300");D.setAttribute("fill","#4d4d4f");D.textContent=v;E.appendChild(D);}var l=S.find("g")[0];
var H=c.getScale(S[0],l);var i=c.getTransform(S[0],l);var U=i.cx;var T=i.cy;var I=Number(T)+g;if(!A){document.body.removeChild(n);
}else{e(n).css("visibility","visible");}e(l).attr("transform","translate("+U+", "+I+") scale("+H.cx+", "+H.cy+")");S.attr("width",p);
d.applyStylesAsInline(n,N);var C=new XMLSerializer();var P=C.serializeToString(e(n).find("svg")[0]);if(X.length){var L='<foreignObject width="100%" height="100%">'+X+"</foreignObject>";
var t=P.indexOf(">");var G=P.substring(0,t+1);var F=P.substring(t+1);var s=G+L+F;P=s;}var J=window.URL||window.webkitURL||window;
var k=d.stringToBlobUrl(P,"image/svg+xml;charset=utf-8");var j=e("html")[0].className.toLowerCase();if(j.indexOf("chrome")>-1&&X.length){k="data:image/svg+xml,"+P;
}var W=document.createElement("canvas");W.width=p;W.height=f;var u=W.getContext("2d");var o=new Image();var m;var w=function(){var Z=W.toDataURL(r);
m=d.createDownloadLink(Z,x,Y,!A);};o.onload=function(){u.drawImage(o,0,0);J.revokeObjectURL(k);w();};o.onerror=function(Z){if(window.console&&console.log){console.log("### svgutils::onerror:: FIRST BLOB LOAD ERROR - the browser is probably Safari e=",Z);
}};o.src=k;};c.innerHTMLShim=function(l,m){var j,n,f,h,k,i,g;while(l.firstChild){l.firstChild.parentNode.removeChild(l.firstChild);
}var o="<svg id='wrapper' xmlns='http://www.w3.org/2000/svg'>"+m+"</svg>";j=document.createElement("div");j.innerHTML=o;f=j.querySelector("svg#wrapper");
i=f.childNodes;g=[];for(h=0,k=i.length;h<k;h++){n=i[h];if(n){g.push(l.appendChild(n));}}return g;};return c;});define("chart/widgetFramework/chartTypes/treeLayout",["jquery","underscore","d3","hogan","util/Functional","chart/widgetFramework/core/drivers/baseView","util/Number","Constants","chartutil/svgutils","chart/widgetFramework/core/constants/UIConstants","chartutil/d3utils","util/ObjectSuper"],function(d,i,m,f,b,j,e,a,l,h,k,g){var c=function(t,n,r,p){var q;
var s={};var o=i.defaults(t,s);q=j(o,n,r,p);var u=g(q);q.ALLOW_MOUSE_SCROLL=false;q.SCALE_MAX_LIMIT=1.8;q.SCALE_MIN_LIMIT=0.3;
q.SCALE_AMOUNT=0.1;q.ZOOM_LEFT=0;q.ZOOM_TOP=0;q.tree=null;q.root=null;q.rootCard=null;q.diagonal=null;q.zoom=null;q.cardCount=0;
q.cardWidth=200;q.cardHeight=140;q.headerHeight=23;q.tranDuration=750;q.canTransition=false;q.scale=1;q.cardPadding=10;q.cardChildrenCol="#DCFAD7";
q.cardBgCol="#FFF";q.startOrientation="horizontal";q.orientation="";q.depth=0;q.vertOffset=0;q.horizOffset=0;q.siblingSeparationVal=0;
q.nonSiblingSeparationVal=0;q.linkLinesSourceFn=null;q.linkLinesTargetFn=null;q.linkLinesProjectionFn=null;q.leftIcon="\u25C0";
q.rightIcon="\u25B6";q.upIcon="\u25B2";q.downIcon="\u25BC";q.init=function(){u.init();this.templateStyle=(t.templateStyle)?t.templateStyle:"svg";
this.cardHeight=(t.cardHeight)?t.cardHeight:this.cardHeight;this.exposed=(i.has(t,"exposed"))?t.exposed:false;this.ALLOW_MOUSE_SCROLL=(b.truthy(t.mouseScroll))?true:false;
this.collapseNodes=(typeof t.collapseNodes!=="undefined")?t.collapseNodes:true;this.template=f.compile(p);this.ZOOM_LEFT=this.options.margin.left*2.75;
this.ZOOM_TOP=this.options.margin.top*3;i.bindAll(this,"headerClick","collapse","redraw");this.$el.find(".chartbase-svg").css("opacity",0);
var v=this;d(v.$el).click(function(w){v.$el.css("cursor","default");});this.configureOrientation(this.startOrientation);this.createTree();
};q.initRender=function(){u.initRender();var v=[this.SCALE_MIN_LIMIT,this.SCALE_MAX_LIMIT];this.zoom=m.behavior.zoom().scaleExtent(v).center([this.width/2,this.height/2]).size([this.width,this.height]).on("zoom",this.redraw);
this.zoom.translate([this.options.margin.left,this.options.margin.top]);this.startZoom();this.$el.on("mousedown",function(){m.select(this).style("cursor","move");
q.startZoom();});};q.configureOrientation=function(v){this.orientation=v;if(this.orientation==="vertical"){this.depth=225;
this.vertOffset=30;this.horizOffset=450;this.siblingSeparationVal=1.05;this.nonSiblingSeparationVal=1.3;}else{this.depth=250;
this.vertOffset=200;this.horizOffset=0;this.siblingSeparationVal=1;this.nonSiblingSeparationVal=1;}};q.linkLinesSourceFn=function(x){var w=(q.orientation==="horizontal")?q.cardHeight:q.cardWidth;
var v=(q.orientation==="horizontal")?q.cardWidth:q.cardHeight;return{x:x.source.x+(w/2),y:x.source.y+v};};q.linkLinesTargetFn=function(v){return{x:v.target.x+((q.orientation==="vertical")?q.cardWidth:q.cardHeight)/2,y:v.target.y};
};q.linkLinesProjectionFn=function(v){return[(q.orientation==="vertical")?q.horizOffset+v.x:v.y,(q.orientation==="vertical")?v.y:q.vertOffset+v.x];
};q.createNodeEnterFn=function(v){if(this.orientation==="vertical"){return function(w){var x="translate("+v.x0+","+v.y0+")";
if(q.templateStyle==="html"){x=[v.x0,v.y0];}return x;};}else{return function(w){var x="translate("+v.y0+","+v.x0+")";if(q.templateStyle==="html"){x=[v.y0,v.x0];
}return x;};}};q.createNodeUpdateFn=function(){if(this.orientation==="vertical"){return function(v){var w="translate("+(q.horizOffset+v.x)+","+v.y+")";
if(q.templateStyle==="html"){w=[(q.horizOffset+v.x),v.y];}return w;};}else{return function(v){var w="translate("+v.y+","+(q.vertOffset+v.x)+")";
if(q.templateStyle==="html"){w=[v.y,(q.vertOffset+v.x)];}return w;};}};q.createNodeExitFn=function(v){if(this.orientation==="vertical"){return function(w){var x="translate("+(q.horizOffset+v.x)+","+v.y+")";
if(q.templateStyle==="html"){x=[(q.horizOffset+v.x),v.y];}return x;};}else{return function(w){var x="translate("+v.y+","+(q.vertOffset+v.x)+")";
if(q.templateStyle==="html"){x=[v.y,(q.vertOffset+v.x)];}return x;};}};q.linkEnterFn=function(v){if(this.orientation==="vertical"){return function(x){var w={x:v.x0-q.horizOffset,y:v.y0};
return q.diagonal({source:w,target:w});};}else{return function(x){var w={x:v.x0-q.vertOffset,y:v.y0};return q.diagonal({source:w,target:w});
};}};q.nodeStorageFn=function(v){if(this.orientation==="vertical"){return function(w){w.x0=q.horizOffset+w.x;w.y0=w.y;};}else{return function(w){w.x0=q.vertOffset+w.x;
w.y0=w.y;};}};q.createTree=function(){this.tree=m.layout.tree().separation(function(w,v){return w.parent===v.parent?q.siblingSeparationVal:q.nonSiblingSeparationVal;
}).nodeSize([this.cardWidth+10,this.cardHeight+10]);this.diagonal=m.svg.diagonal().source(this.linkLinesSourceFn).target(this.linkLinesTargetFn).projection(this.linkLinesProjectionFn);
};q.startZoom=function(){if(this.ALLOW_MOUSE_SCROLL){this.topSVG.call(this.zoom);}else{this.topSVG.call(this.zoom).on("wheel.zoom",null).on("mousewheel.zoom",null).on("DOMMouseScroll.zoom",null);
}};q.stopZoom=function(){this.topSVG.call(m.behavior.zoom().on("zoom",null));};q.buttonZoomIn=function(){var x=this.zoom.scale();
if(x===this.SCALE_MAX_LIMIT){return;}var y=e.roundToDecimals(x+this.SCALE_AMOUNT,1);if(y>=this.SCALE_MAX_LIMIT){y=this.SCALE_MAX_LIMIT;
this.enableZoomButtons("zoomIn",false);}this.enableZoomButtons("zoomOut",true);var w=this.zoom.translate();var v=[w[0]-this.ZOOM_LEFT,w[1]-this.ZOOM_TOP];
this.applyZoomValues(y,v);};q.buttonZoomOut=function(){var x=this.zoom.scale();if(x===this.SCALE_MIN_LIMIT){return;}var y=e.roundToDecimals(x-this.SCALE_AMOUNT,1);
if(y<=this.SCALE_MIN_LIMIT){y=this.SCALE_MIN_LIMIT;this.enableZoomButtons("zoomOut",false);}this.enableZoomButtons("zoomIn",true);
var w=this.zoom.translate();var v=[w[0]+this.ZOOM_LEFT,w[1]+this.ZOOM_TOP];this.applyZoomValues(y,v);};q.applyZoomValues=function(w,v){this.zoom.scale(w);
this.zoom.translate(v);if(this.templateStyle==="html"){this.$el.find(".main-group").css({transform:"translate("+v[0]+"px,"+v[1]+"px) scale("+w+")"});
}else{this.mainGroup.transition().duration(500).ease("cubic-in-out").attr("transform","translate("+v+") scale("+w+")");}};
q.enableZoomButtons=function(v,w){this.$el.trigger(h.CHART_TO_VIEW_EVENT,{type:"enableButtons",data:{who:v,enable:w}});};
q.redraw=function(){var x=this;if(m.event.sourceEvent){if(m.event.sourceEvent.type==="wheel"&&this.ALLOW_MOUSE_SCROLL){return;
}}var v=Math.round(m.event.translate[0]);var z=Math.round(m.event.translate[1]);var y=Number(m.event.scale.toFixed(2));if(y<1){x.$el.find(".card").css("shape-rendering","auto");
}else{x.$el.find(".card").css("shape-rendering","crispEdges");}var w=[v,z];this.zoom.translate(w);this.zoom.scale(y);this.scale=y;
if(this.templateStyle==="html"){this.$el.find(".main-group").css({transform:"translate("+w[0]+"px,"+w[1]+"px) scale("+y+")"});
}else{x.mainGroup.attr("transform","translate("+w+") scale("+y+")");}if(this.exposed){this.$el.trigger("treeLayout-drag-event",{data:{translation:w,scale:y}});
}this.currentDragPos=w;};q.mirrorRedraw=function(v){var x=v.translation;var w=v.scale;this.zoom.scale(w);this.zoom.translate(x);
if(this.templateStyle==="div"){this.$el.find(".main-group").css({transform:"translate("+x[0]+"px,"+x[1]+"px) scale("+this.scale+")"});
}else{this.mainGroup.attr("transform","translate("+x+"), scale("+w+")");}};q.resetZoomPan=function(){var v=[this.options.margin.left,this.options.margin.top];
if(window.console&&window.console.log){window.console.log("### harpChart::resetZoomPan:: this.zoom.translate()=",this.zoom.translate());
}this.zoom.scale(1);this.zoom.translate(v);if(this.templateStyle==="html"){this.$el.find(".main-group").css({transform:"translate("+v[0]+"px,"+v[1]+"px ) scale("+this.zoom.scale()+")"});
}else{this.mainGroup.transition().duration(500).attr("transform","translate("+v+") scale("+this.zoom.scale()+")");}this.$el.find(".card").css("shape-rendering","crispEdges");
this.enableZoomButtons();};q.renderData=function(v){var w=this;var x=((typeof v!=="undefined")?v:true);this.$el.find(".chartbase-svg").css("opacity",1);
this.root=this.data[0];if(!this.root){this.hideCharts("no data to display");return;}if(this.orientation==="vertical"){this.root.x0=(this.width/2)-(this.cardWidth/2)-10;
}else{this.root.x0=(this.height/2)-(this.cardHeight/2)-10;}this.root.y0=0;if(x&&this.root.children){this.root.children.forEach(this.collapse);
}this.updateTree(this.root);};q.updateTree=function(v){var z=this.tranDuration,y="cubic-in-out",C=this;var x=this.tree.nodes(this.root),F=this.tree.links(x);
x.forEach(function(G){G.y=G.depth*C.depth;});var w,A,B,E;var D;if(this.templateStyle==="html"){w=this.chartGroup.selectAll("div.harpnode").data(x,function(G){return G[C.options.joinAttr]||(G[C.options.joinAttr]=++C.cardCount);
});this.enterCard(w,v);B=w.transition().duration(z).ease(y).style("left",function(I){var G=C.createNodeUpdateFn();var H=G(I);
return H[0]+"px";}).style("top",function(I){var G=C.createNodeUpdateFn();var H=G(I);return H[1]+"px";}).each("end",function(){C.canTransition=true;
});this.updateCard(B);E=w.exit().transition().duration(z).ease(y).style("left",function(I){var G=C.createNodeExitFn(v);var H=G(I);
return H[0]+"px";}).style("top",function(I){var G=C.createNodeExitFn(v);var H=G(I);return H[1]+"px";}).each("end",function(){C.canTransition=true;
}).remove();this.exitCard(E);}else{w=this.chartGroup.selectAll("g.node").data(x,function(G){return G[C.options.joinAttr]||(G[C.options.joinAttr]=++C.cardCount);
});A=w.enter().append("g").attr("class","harpnode").attr("transform",q.createNodeEnterFn(v));B=w.transition().duration(z).ease(y).attr("transform",this.createNodeUpdateFn()).each("end",function(){C.canTransition=true;
});E=w.exit().transition().duration(z).ease(y).attr("transform",this.createNodeExitFn(v)).each("end",function(){C.canTransition=true;
}).remove();D=this.chartGroup.selectAll("path.link").data(F,function(G){return G.target[C.options.joinAttr];});D.enter().insert("path","g").attr("class","link").attr("x",0+(this.cardWidth/2)).attr("y",0+(this.cardHeight/2)).attr("opacity",0.000001).attr("d",this.linkEnterFn(v));
D.transition().duration(z).ease(y).attr("opacity",1).attr("d",C.diagonal);D.exit().transition().duration(z).ease(y).attr("opacity",0.000001).attr("d",function(H){var G={x:v.x,y:v.y};
return C.diagonal({source:G,target:G});}).remove();}x.forEach(this.nodeStorageFn());};q.createCard=function(C){var z=this;
var v=7,y=4;var x=this.cardPadding;var w=x+y;var B=z.cardWidth,A=0;return function(M){var F=m.format("0,000")(M.total);var H=w+(F.length*v);
var O=(z.cardWidth-x-v);var L=m.format(".2f")(M.percentTotal);var K=L.indexOf(".00");if(K>-1){L=L.substring(0,K);}var J=O-(y+(L.length*v));
var N=String(M.authPercent).length;var I=w+(N*v);B=(z.orientation==="vertical")?z.cardWidth/2-10:z.cardWidth+2;A=(z.orientation==="vertical")?z.cardHeight+10:z.cardHeight/2+10;
var P={cardWidth:B,cardHeight:z.cardHeight,halfCardHeight:A,headerWidth:z.cardWidth-4,headerHeight:z.headerHeight,cardPadding:x,headerText:M.dimensionText,iconXPos:(z.cardWidth-x*2)+3,lineWidth:(z.cardWidth-2),txTitleXPos:H,txValueXPos:x,txValue:F,percTxTitleXPos:O,percTxValueXPos:J,percTxValue:L,eurValueXPos:x+10,eurValue:M.eurAmount,authTitleXPos:I,authValueXPos:x,authValue:M.authPercent,allData:M.allData};
var E=z.template.render(P);var G;if(z.templateStyle==="html"){G=document.createElement("div");}else{G=document.createElementNS("http://www.w3.org/2000/svg","g");
}d(G).attr("class","harpnode");if(z.templateStyle==="html"){var Q=z.createNodeEnterFn(C);var D=Q(M);d(G).css("left",D[0]+"px");
d(G).css("top",D[1]+"px");}else{d(G).attr("transform",z.createNodeEnterFn(C));}G.innerHTML=E;if(G.childNodes.length<1){l.innerHTMLShim(G,E);
}d(G).trigger(a.EV_CONTENT_MERGED);return G;};};q.enterCard=function(w,z){var y=this;var x=w.enter().append(this.createCard(z));
this.rootCard=m.select(x[0][0]);x.on("mousedown",function(){}).on("click",function(A){});var v=x.select(".child-icon");v.on("mousedown",function(){y.stopZoom();
}).on("click",function(A){m.event.stopPropagation();y.headerClick(A);});};q.updateCard=function(v){var w=this;v.selectAll("div").style("opacity",1);
v.select(".card-header-text").style("fill-opacity",1);v.select(".child-icon").delay(500).style("opacity",1).text(function(x){if(!x._children&&!x.children){return"";
}if(x._children){return(w.orientation==="vertical")?w.downIcon:w.rightIcon;}else{return(w.orientation==="vertical")?w.upIcon:w.leftIcon;
}});v.select(".card-input").style("opacity",1);v.select(".card-select").style("opacity",1);};q.exitCard=function(v){v.selectAll("div").style("opacity",0);
v.selectAll(".card-input").style("opacity",0);v.selectAll(".card-select").style("opacity",0);};q.headerClick=function(v){if(!this.canTransition){return;
}this.startZoom();if(v.children){v._children=v.children;v.children=null;}else{v.children=v._children;v._children=null;}this.canTransition=false;
this.updateTree(v);};q.collapse=function(v){if(v.children){v._children=v.children;v._children.forEach(this.collapse);v.children=null;
}};q.switchOrientation=function(){var v=(this.orientation==="vertical")?"horizontal":"vertical";this.configureOrientation(v);
this.createTree();this.renderData(false,false);};return q;};return c;});define("chart/widgetFramework/composed/harpViewer/harpGraph",["jquery","underscore","d3","chart/widgetFramework/core/mixins/barDrawingUtils","hogan","util/Functional","chart/widgetFramework/chartTypes/treeLayout","util/Number","Constants","chartutil/svgutils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper"],function(e,k,m,h,g,b,d,f,a,l,j,i){var c=function(t,n,r,p){var q;
var s={};var o=k.defaults(s,t);q=d(o,n,r,p);var u=i(q);q.cardHeight=140;q.init=function(){u.init();this.cardHeight=(t.cardHeight)?t.cardHeight:this.cardHeight;
this.nestedAttr="authRates";this.barUtils=h();k.bindAll(this,"createCard");};q.configureOrientation=function(v){this.orientation=v;
if(this.orientation==="vertical"){this.depth=150;this.vertOffset=0;this.horizOffset=450;this.siblingSeparationVal=1.05;this.nonSiblingSeparationVal=1.3;
}else{this.depth=250;this.vertOffset=250;this.horizOffset=0;this.siblingSeparationVal=0.7;this.nonSiblingSeparationVal=1;
}};q.renderData=function(v,w){var x=this;var z=((typeof v!=="undefined")?v:true);u.renderData(z);if(b.falsy(this.rootCard)){if(window.console&&console.log){console.log("### harpGraph::renderData:: NO ROOT CARD");
}return;}var y=(typeof w!=="undefined")?w:true;if(y){setTimeout(function(){var B=x.rootCard;var A=x.rootCard.datum();x.cardClick(A,B,x);
},this.tranDuration+1250);}};q.updateTree=function(v){var z=this.tranDuration,y="cubic-in-out",B=this;var x=this.tree.nodes(this.root),E=this.tree.links(x);
x.forEach(function(F){F.y=F.depth*B.depth;});var w=this.chartGroup.selectAll("g.node").data(x,function(F){return F[B.options.joinAttr]||(F[B.options.joinAttr]=++B.cardCount);
});this.enterCard(w,v);var A=w.transition().duration(z).ease(y).attr("transform",this.createNodeUpdateFn()).each("end",function(){B.canTransition=true;
});this.updateCard(A);var D=w.exit().transition().duration(z).ease(y).attr("transform",this.createNodeExitFn(v)).each("end",function(){B.canTransition=true;
}).remove();this.exitCard(D);var C=this.chartGroup.selectAll("path.link").data(E,function(F){return F.target.id;});C.enter().insert("path","g").attr("class","link").attr("x",0+(this.cardWidth/2)).attr("y",0+(this.cardHeight/2)).attr("opacity",0.000001).attr("d",this.linkEnterFn(v));
C.transition().duration(z).ease(y).attr("opacity",1).attr("d",B.diagonal);C.exit().transition().duration(z).ease(y).attr("opacity",0.000001).attr("d",function(G){var F={x:v.x,y:v.y};
return B.diagonal({source:F,target:F});}).remove();x.forEach(this.nodeStorageFn());};q.enterCard=function(x,C){var z=this;
var y=x.enter().append(this.createCard(C));this.rootCard=m.select(y[0][0]);y.on("mousedown",function(){z.stopZoom();}).on("click",function(D){z.cardClick(D,m.select(this),z);
});var w=y.select(".child-icon");w.on("mousedown",function(){z.stopZoom();}).on("click",function(D){m.event.stopPropagation();
z.headerClick(D);});var B=y.select("#authRatesImprBar");var A=m.scale.linear().range([0,this.cardWidth-(this.cardPadding*2)]).domain([0,100]);
setTimeout(function(){z.barUtils.stackHorizontal(z.nestedAttr,z.getSecondaryDataJoin(),A,7,null,B);},10);var v=y.select(".eg-tx-download").on("click",function(D){m.event.stopPropagation();
q.$el.trigger(j.CHART_TO_VIEW_EVENT,{type:"downloadTxExample",data:D.harpId});});};q.updateCard=function(v){var w=this;v.selectAll("rect").style("fill-opacity",1);
v.select(".card-header-text").style("fill-opacity",1);v.select(".child-icon").delay(500).style("fill-opacity",1).text(function(x){if(!x._children&&!x.children){return"";
}if(x._children){return(w.orientation==="vertical")?w.downIcon:w.rightIcon;}else{return(w.orientation==="vertical")?w.upIcon:w.leftIcon;
}});v.select(".header-line").style("stroke-opacity",1);v.selectAll(".card-content-text").style("fill-opacity",1);};q.exitCard=function(v){v.selectAll("rect").style("fill-opacity",0.000001).style("stroke-opacity",0.000001);
v.select(".header-line").style("stroke-opacity",0.000001);v.selectAll("text").style("fill-opacity",0.000001);};q.createCard=function(C){var z=this;
var v=7,y=4;var x=this.cardPadding;var w=x+y;var B=z.cardWidth,A=0;return function(L){var E=m.format("0,000")(L.total);var G=w+(E.length*v);
var N=(z.cardWidth-x-v);var K=m.format(".2f")(L.percentTotal);var J=K.indexOf(".00");if(J>-1){K=K.substring(0,J);}var I=N-(y+(K.length*v));
var M=String(L.authPercent).length;var H=w+(M*v);var O={cardWidth:B,cardHeight:z.cardHeight,halfCardHeight:A,headerWidth:z.cardWidth-4,headerHeight:z.headerHeight,cardPadding:x,headerText:L.shortTitle,iconXPos:(z.cardWidth-x/2),lineWidth:(z.cardWidth-2),txTitleXPos:G,txValueXPos:x,txValue:E,percTxTitleXPos:N,percTxValueXPos:I,percTxValue:K,eurValueXPos:x+10,eurValue:L.eurAmount,authTitleXPos:H,authValueXPos:x,authValue:L.authPercent,allData:L.allData};
var D=z.template.render(O);var F=document.createElementNS("http://www.w3.org/2000/svg","g");e(F).attr("class","node");e(F).attr("transform",z.createNodeEnterFn(C));
F.innerHTML=D;if(F.childNodes.length<1){l.innerHTMLShim(F,D);}e(F).trigger(a.EV_CONTENT_MERGED);return F;};};q.cardClick=function(x,w,v){this.$el.trigger(j.CHART_TO_VIEW_EVENT,{type:"baselineData",data:x});
m.select(this.el).selectAll(".card").each(function(){this.className.baseVal="card";});w.select(".card").node().className.baseVal+=" selected";
this.$el.trigger(j.CHART_TO_VIEW_EVENT,{type:"triggerBaselineTransition",data:{card:w.node(),zoom:this.zoom,width:this.cardWidth,height:this.cardHeight}});
};q.headerClick=function(v){if(!this.canTransition){return;}this.startZoom();if(v.children){v._children=v.children;v.children=null;
}else{v.children=v._children;v._children=null;}this.canTransition=false;this.updateTree(v);};q.getSecondaryDataJoin=function(){return this.getDataJoin("name");
};return q;};return c;});define("chart/widgetFramework/composed/transactionsDashboard/formatters/granularAuthsBarsFormatter",["jqueryExtended","underscore","d3","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/core/mixins/formats","chartutil/dateUtils_CET","chartutil/d3utils"],function(h,b,d,e,g,f,c){function a(l,i,k,n){var j={};
j.data=l;j.options=i;j.formattedData={};j.comparator=null;j.reverseDirection=false;j.sortKey=null;j.timeline=k;j.id=n;j.granularity="month";
j.formatData=function(){this.formattedData=m(this.data);if(this.sortKey){this.reverseDirection=!this.reverseDirection;this.sortData(this.sortKey,true);
}if(window.console&&console.log){console.log("### granularAuthsBarsFormatter::"+this.id+" formatData:: this.formattedData=",this.formattedData);
}return{chartData:this.formattedData};};var m=function(r){var s=[],p,q,o;b.each(r,function(t){p=t.authRate*100;q=t.refusedCount;
switch(j.granularity){case"month":o=d.time.format("%B %Y")(t.date);break;case"week":o="wk "+t.date.getWeek(true)+" - "+t.date.getFullYear();
break;case"day":o=f.getUserFriendlyDate(t.dateStr)+" "+t.date.getFullYear();break;}s.push({date:t.date,dateStr:t.dateStr,authRate:p,receivedCount:t.receivedCount,authorizedCount:t.authorizedCount,refusedCount:q,authTxArray:[{name:"authorized",value:t.authorizedCount,startY:0,endY:t.authorizedCount},{name:"refused",value:q,startY:t.authorizedCount,endY:t.authorizedCount+t.refusedCount}],authorizedAmount:t.authorizedAmount/100,formattedTimespan:o});
});return s;};j.setGranularity=function(o){this.granularity=o;};j.sortData=function(o,q){if(window.console&&console.log){console.log("### granularAuthsBarsFormatter::sortData:: pSortKey=",o);
}this.sortKey=o;this.reverseDirection=!this.reverseDirection;var p=b.sortBy(this.formattedData,o);if(this.reverseDirection){p.reverse();
}this.formattedData=p;if(q===true){return;}this.$el.trigger(e.FORMATTER_INFORM_WIDGET,{type:e.SORTED_DATA,data:{chartData:this.formattedData}});
};j.compareFunction=function(o){return o[this.sortKey];};j.getData=function(){return(this.data)?this.data:this.formatData();
};j.setRawData=function(o){this.data=o;};j.retrieveData=function(o){return this.data[o];};return j;}return a;});define("chart/widgetFramework/composed/chargebackReport/rollovers/groupedBarRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/chartTypes/rollover"],function(c,i,j,a,f,h,g,e,d){function b(o,k){var m;
var n={};var l=i.defaults(n,o);m=d(l,k);var p=g(m);m.getYScale=function(){var r=i.pluck(this.data,this.options.joinAttr);
var q=j.scale.ordinal().rangeBands([this.height,0],this.options.barPadding).domain(r);return q;};m.init=function(){p.init();
if(typeof this.options.allowScrolling==="undefined"){this.options.allowScrolling=false;}};m.initRender=function(){p.initRender();
if(this.options.allowScrolling){var q=j.behavior.zoom().on("zoom",null);this.chartGroup.call(q).on("wheel.zoom",function(){m.scrolling();
}).on("mousedown.zoom",null).on("touchstart.zoom",null).on("touchmove.zoom",null).on("touchend.zoom",null);}};m.scrolling=function(){var q=m.options.variation==="horizontal"?j.event.deltaY:j.event.deltaX;
this.$el.trigger(h.CHART_TO_VIEW_EVENT,{type:"groupedBarChartScroll",data:q});};m.setTooltipsOnElements=function(){p.setTooltipsOnElements(true);
};m.enhanceTooltipData=function(r){var s=j.format(",.0f");var q=j.format(",.2f");r.chargebackEurAmountTT=s(r.chargebackEurAmount);
r.chargebackRateTT=q(r.chargebackRate);if(this.options.joinAttr==="countryName"){r.labelName=r.countryName;}else{if(this.options.joinAttr==="paymentMethodName"){r.labelName=r.paymentMethodName;
}else{if(this.options.joinAttr==="acquirerName"){r.labelName=r.acquirerName;}}}};return m;}return b;});define("chart/widgetFramework/composed/demo/demoOutput",["jqueryExtended","json","underscore","d3","chart/widgetFramework/core/mixins/formats","chartutil/domUtils"],function(e,g,b,c,f,a){var d={};
d.outputMarkup=function(h,k,o,i){var q="    ",p="        ",x="            ",r="                ",m,A,l;if(window.console&&console.log){}var y;
var u=b.cloneDeep(h);u.joinAttr=e("#joinAttr").val();u.type="chartTypes/"+i;if(window.console&&console.log){console.log('### demoActions::"getterMethod":: viewOptions=',g.stringify(u));
}var s=g.stringify(u);y=s;if(i!=="lineChart"){y=y.replace(/("centerPoints":[a-z]\w+)/g,"");}else{y=y.replace(/("centerBars":[a-z]\w+)/g,"");
}y=y.replace(/,,/g,",");y=y.replace(/",/g,'",\n'+p);y=y.replace(/e,/g,"e,\n"+p);y=y.replace(/\{/g,"{\n"+p);y=y.replace(/},/g,"},\n"+p);
m=y.match(/[0-9],"/g);b.each(m,function(C){A=C.substring(0,2);y=y.replace(/[0-9],"/,A+"\n"+p+'"');});var t='<div data-widget="chart/widgetFramework/core/ViewCreator"';
t+='\n    class="my-chart-widget"';t+='\n    id="myChartWidget"';t+="\n    data-options='";t+=y;t+="'";t+='\n    data-formatter="myDataFormatter">\n';
var n;var j=b.cloneDeep(k);var z=g.stringify(j);n=z.replace(/("nestedXAttr":[a-z]\w+)|("nestedXAttr":"[a-z]\w+")/g,"");n=n.replace('"ticks":null',"");
if(i!=="lineChart"){n=n.replace(/("centerTicks":[a-z]\w+)/g,"");}else{if(j.scale==="time"){n=n.replace(/("niceScale":[a-z]\w+)/g,"");
}}n=n.replace(/,,,/g,",");n=n.replace(/,}/g,"}");n=n.replace(/",/g,'",\n'+r);n=n.replace(/e,/g,"e,\n"+r);n=n.replace(/\],/g,"],\n"+r);
n=n.replace(/\{/g,"{\n"+r);m=n.match(/[0-9],"/g);b.each(m,function(C){A=C.substring(0,2);n=n.replace(/[0-9],"/,A+"\n"+r+'"');
});t+="\n"+p+'<div data-widget="chart/widgetFramework/core/AxisComponent"';t+="\n"+x+'data-id="xAxis"';t+="\n"+x+"data-options='";
t+=n;t+="'>";t+="\n"+p+"</div>\n";var B;var w=b.cloneDeep(o);var v=g.stringify(w);B=v.replace(/("nestedYAttr":[a-z]\w+)|("nestedYAttr":"[a-z]\w+")/g,"");
B=B.replace('"ticks":null',"");B=B.replace(/,,/g,",");B=B.replace(/,}/g,"}");B=B.replace(/",/g,'",\n'+r);B=B.replace(/e,/g,"e,\n"+r);
B=B.replace(/\],/g,"],\n"+r);B=B.replace(/\{/g,"{\n"+r);m=B.match(/[0-9],"/g);b.each(m,function(C){A=C.substring(0,2);B=B.replace(/[0-9],"/,A+"\n"+r+'"');
});t+="\n"+p+'<div data-widget="chart/widgetFramework/core/AxisComponent"';t+="\n"+x+'data-id="yAxis"';t+="\n"+x+"data-options='";
t+=B;t+="'>";t+="\n"+p+"</div>\n";t+="\n</div>";return t;};return d;});define("chart/widgetFramework/composed/demo/demoActions",["jqueryExtended","json","underscore","d3","chart/widgetFramework/core/mixins/formats","chart/widgetFramework/composed/demo/demoOutput","chartutil/domUtils"],function(f,i,j,l,e,h,a){var k="barChart";
var d="horizontal";var g="linear";var c="ordinal";var b={actions:[{source:".submittable-value",event:"change",target:"demoMediator",callMethod:"noOp",getterMethod:function(m){f("#configSubmit").css("background-color","#3c8a2e");
f(m).parent().removeClass("error");}},{source:"#chartBounds",event:"change",target:"demoMediator",callMethod:"noOp",getterMethod:function(m){var n=m.is(":checked");
l.selectAll(".chartbase-svg").classed("bounds",n);}},{source:"#orientation",event:"change",target:"demoMediator",callMethod:"noOp",getterMethod:function(m){d=m.val();
b.checkShowCenterTicks();}},{source:"#chartType",event:"change",target:"demoMediator",callMethod:"noOp",getterMethod:function(n){var m=f("#myDataFormatter")[0].__formatter;
k=n.val();if(k==="lineChart"){f("#barChartOptions").hide();f("#verticalOption").hide();f("#orientation").val("horizontal");
f("#orientation").trigger("change");f("#lineChartOptions").show();}else{f("#barChartOptions").show();f("#verticalOption").show();
f("#lineChartOptions").hide();}b.checkShowCenterTicks();}},{source:"#xAxisType",event:"change",target:"demoMediator",callMethod:"noOp",getterMethod:function(n){var m;
g=n.val();if(g==="time"){m="defaultTimeFormat";}if(g==="linear"){f(".num-ticks-x").show();f(".nice-scale-x").show();m="defaultLinearFormat";
}else{f(".num-ticks-x").hide();f(".nice-scale-x").hide();}if(g==="ordinal"){m="defaultOrdinalFormat";}b.setXFormatSelect(m);
b.checkShowCenterTicks();}},{source:"#yAxisType",event:"change",target:"demoMediator",callMethod:"noOp",getterMethod:function(n){var m;
c=n.val();if(c==="linear"){f(".num-ticks-y").show();f(".nice-scale-y").show();m="defaultLinearFormat";}else{f(".num-ticks-y").hide();
f(".nice-scale-y").hide();}if(c==="ordinal"){m="defaultOrdinalFormat";}b.setYFormatSelect(m);}},{source:"#xFormat",event:"change",target:"demoMediator",callMethod:"noOp",getterMethod:function(m){var n=e[m.val()].call(null,"getInfo");
f("#xFormatMsg").val(n);}},{source:"#yFormat",event:"change",target:"demoMediator",callMethod:"noOp",getterMethod:function(m){var n=e[m.val()].call(null,"getInfo");
f("#yFormatMsg").val(n);}},{source:"#lineHasLabels",event:"change",target:"demoMediator",callMethod:"noOp",getterMethod:function(m){var n=m.is(":checked");
if(!n){f("#allowToggleLine").prop("checked",false);}}},{source:"#allowToggleLine",event:"change",target:"demoMediator",callMethod:"noOp",getterMethod:function(m){var n=m.is(":checked");
if(n){f("#lineHasLabels").prop("checked",true);}}},{source:"#demoMediator",event:"requireComplete",target:"myDataFetcher",callMethod:"onPassThruData",getterMethod:function(W){var m=f("#demoConfigChart")[0].__view,H=f("#demoConfigChart")[0].__axisHorizontal,V=f("#demoConfigChart")[0].__axisVertical;
var S=f("#configTextArea").val();var y,A;b.writeToView("variation",d);var n=f("#widthInput").val();if(n.length){b.writeToView("width",Number(n));
}var p=f("#heightInput").val();if(p.length){b.writeToView("height",Number(p));}var x=f("#marginTopInput").val();if(x.length){m.chartOptions.margin.top=Number(x);
}var q=f("#marginRightInput").val();if(q.length){m.chartOptions.margin.right=Number(q);}var N=f("#marginBottomInput").val();
if(N.length){m.chartOptions.margin.bottom=Number(N);}var G=f("#marginLeftInput").val();if(G.length){m.chartOptions.margin.left=Number(G);
}var Z=f("#dataSubset").val();if(Z.length){b.writeToView("dataSubset",Z);}switch(k){case"barChart":case"stackedBar":var F=f("#paddingInput").val();
if(F.length){b.writeToView("barPadding",Number(F));}break;case"lineChart":var o=f("#lineDataProp").val();if(o.length){b.writeToView("lineDataProp",o);
}var I=f("#lineHasDots").is(":checked");b.writeToView("hasDots",I);var X=f("#allowToggleLine").is(":checked");b.writeToView("allowToggleLine",X);
var M=f("#lineHasLabels").is(":checked");b.writeToView("hasLabels",M);if(M&&!o.length){b.addError("You want labels on your lines? Then specify a line-data property! (A property in the data, with a unique value, that can be used as a label for your line(s) )","#lineDataProp");
return;}break;}H.graphOptions.scale=g;var T=f("#xDimInput").val()||H.graphOptions.dimension;if(T.length){y='"'+T+'":';A='"'+T+'" :';
if(S.indexOf(y)===-1&&S.indexOf(A)===-1){b.addError("x dimension don't exist in data - c'mon man, raise ya game!","#xDimInput");
return null;}H.graphOptions.dimension=T;}else{b.addError("x dimension's not specified - what'cha thinkin' man?","#xDimInput");
return null;}var K=f("#xAlign").val();H.graphOptions.align=K;var P=f("#xTransformX").val();var O=f("#xTransformY").val();
H.graphOptions.tickTransform=[Number(P),Number(O)];var t=f("#xDrawTick").is(":checked");H.graphOptions.drawTickToChartSize=t;
var R=null;if(g==="linear"){R=Number(f("#numTicksX").val());}H.graphOptions.ticks=R;var s=false;if(g==="linear"){s=f("#xNiceScale").is(":checked");
}H.graphOptions.niceScale=s;var z=false,D=false,Y=false,U;if(g==="time"){U=f("#centerTicksX").is(":checked");z=U;D=U;Y=U;
}H.graphOptions.centerTicks=z;b.writeToView("centerBars",D);b.writeToView("centerPoints",Y);var E=f("#xFormat").val();H.graphOptions.tickFormat=E;
V.graphOptions.scale=c;var w=f("#yDimInput").val()||V.graphOptions.dimension;if(w.length){y='"'+w+'"';if(S.indexOf(y)===-1&&w!=="dateStr"){b.addError("your y dimension doesn't exist in the data - c'mon man, raise ya game!","#yDimInput");
return null;}V.graphOptions.dimension=w;}else{b.addError("your y dimension's not specified - what'cha thinkin' man?","#yDimInput");
return null;}var J=f("#yDrawTick").is(":checked");V.graphOptions.drawTickToChartSize=J;var Q=null;if(c==="linear"){Q=Number(f("#numTicksY").val());
}V.graphOptions.ticks=Q;var B=false;if(c==="linear"){B=f("#yNiceScale").is(":checked");}V.graphOptions.niceScale=B;var r=f("#yAlign").val();
V.graphOptions.align=r;var v=f("#yTransformX").val();var u=f("#yTransformY").val();V.graphOptions.tickTransform=[Number(v),Number(u)];
var C=f("#yFormat").val();V.graphOptions.tickFormat=C;var L=false;if(c==="linear"){L=f("#ySuffixLastTick").is(":checked");
}V.graphOptions.suffixLastTickOnly=L;return b.parseJson(S);}},{source:"#configSubmit",event:"click",target:"demoMediator",callMethod:"noOp",getterMethod:function(o){f(o).css("background-color","#aaa");
f("#errorMsg").val("");f(".reset-line-icon").css("display","none");var n=f("#myDataFormatter")[0].__formatter;var m=n.getRequirePromise();
n.invalidateData();switch(k){case"lineChart":n.requireFormatter("composed/demo/lineDataFormatter");break;case"barChart":n.requireFormatter("composed/demo/barDataFormatter");
break;case"stackedBar":n.requireFormatter("composed/demo/stackedDataFormatter");break;}m.done(function(){var p=f("#demoConfigChart")[0].__view;
var q=p.getRequirePromise();p.invalidateData();p.requireChartType("chartTypes/"+k,"defaultTemplate.html");q.done(function(){f("#demoMediator").trigger("requireComplete");
});});}},{source:"#outputBtn",event:"click",target:"demoMediator",callMethod:"noOp",getterMethod:function(o){var m=h.outputMarkup(f("#demoConfigChart")[0].__view.chartOptions,f("#demoConfigChart")[0].__axisHorizontal.graphOptions,f("#demoConfigChart")[0].__axisVertical.graphOptions,k);
var n=f("#finalOutputMarkup").css("display","block");n.find("pre").text(m);}}],writeToView:function(m,n){f("#demoConfigChart")[0].__view.chartOptions[m]=n;
},parseJson:function(m){try{f("#chartBoundsCheck").css("display","block");f("#demoConfigChart").css("display","block");f("#outputHolder").css("display","block");
var n=i.parse(m);return n;}catch(o){b.addError("##### NOT VALID JSON ##### "+o,"#configTextArea");f("#configTextArea").val(m);
f("#chartBoundsCheck").css("display","none");f("#demoConfigChart").css("display","none");}},getFormats:function(){var t=j.keys(e);
var v="",p="",r="",s=[],w=[],u=[],o=[],m=[];var q={};q.linear={name:"Linear Formats",array:s};q.linearPercent={name:"Linear Percent Formats",array:w};
q.date={name:"Time Formats",array:u};q.ordinal={name:"Ordinal Formats",array:o};q.currency={name:"Currency Formats",array:m};
j.each(t,function(y){if(y==="timeSimple"||y==="ordinalRemoveLabel"||y==="lastTickFormat"){r="";}else{r='<option value="'+y+'">'+y+"</option>";
}if(r.length){var x=r.toLowerCase();if(x.indexOf("number")>-1||x.indexOf("linear")>-1||x.indexOf("float")>-1){s.push(r);}else{if(x.indexOf("percent")>-1){w.push(r);
}else{if(x.indexOf("time")>-1){u.push(r);}else{if(x.indexOf("ordinal")>-1){o.push(r);}else{m.push(r);}}}}}});j.each(q,function(x){v+='<optgroup label="'+x.name+'">';
if(x.name.indexOf("Date")===-1){p+='<optgroup label="'+x.name+'">';}else{p+="";}j.each(x.array,function(y){v+=y;if(x.name.indexOf("Date")===-1){p+=y;
}else{p+="";}});v+="</optgroup>";p+="</optgroup>";});f("#xFormat").html(v);f("#yFormat").html(p);var n=e[t[0]].call(this,"getInfo");
f("#xFormatMsg").val(n);b.setYFormatSelect("defaultOrdinalFormat");},setXFormatSelect:function(m){f("#xFormat").val(m);setTimeout(function(){f("#xFormat").trigger("change");
},100);},setYFormatSelect:function(m){f("#yFormat").val(m);setTimeout(function(){f("#yFormat").trigger("change");},100);},setTestConfig:function(){f("#chartType").val("lineChart");
f("#xAxisType").val("time");f("#yAxisType").val("linear");f("#chartType").trigger("change");f("#xAxisType").trigger("change");
f("#yAxisType").trigger("change");f("#errorMsg").val("WARNING: test configs, setting chart & axis type, are in place");f("#xDimInput").val("date");
f("#yDimInput").val("value");f("#marginRightInput").val(120);f("#marginLeftInput").val(20);f("#widthInput").val(450);f("#lineHasDots").prop("checked",true);
},checkShowCenterTicks:function(){if(g==="time"){if((k==="lineChart")||(k==="barChart"&&d==="vertical")){f(".center-ticks-x").show();
}else{f(".center-ticks-x").hide();}}else{f(".center-ticks-x").hide();}},addError:function(n,m){f("#errorMsg").val(n);f(m).parent().addClass("error");
}};b.getFormats();setTimeout(function(){b.setTestConfig();},100);return b;});define("chart/widgetFramework/composed/harpReportBuilder/harpGraphBuilderNodes",["jquery","underscore","d3","backbone","hogan","util/Functional","chart/widgetFramework/chartTypes/treeLayout","harp/views/charts/authRatesImprBar","util/Number","Constants","chart/widgetFramework/core/constants/UIConstants","chartutil/svgutils","util/ObjectSuper","text!chart/widgetFramework/composed/harpReportBuilder/templates/dimensionsTemplate.html"],function(f,m,o,l,h,d,e,a,g,b,k,n,i,j){var c=function(t,p,q,r){t.templateStyle="html";
var s=e(t,p,null,r);var u=i(s);s.init=function(){u.init();this.dialogShown=false;};s.feedData=function(v){if(v){this.data=v;
}else{return;}};s.configureOrientation=function(v){var w=this;this.orientation=v;if(this.orientation==="vertical"){this.depth=225;
this.vertOffset=30;this.horizOffset=450;this.siblingSeparationVal=1.05;this.nonSiblingSeparationVal=1.3;this.$el.removeClass("dimension-vertical").addClass("dimension-horizontal");
}else{this.depth=250;this.vertOffset=200;this.horizOffset=0;this.siblingSeparationVal=1;this.nonSiblingSeparationVal=1;this.$el.addClass("dimension-vertical").removeClass("dimension-horizontal");
}};s.hideCharts=function(){u.hideCharts("No Tree Has Been Selected");};s.renderData=function(){var v=(typeof this.collapseNodes!=="undefined")?this.collapseNodes:false;
if(m.isEmpty(this.data)){return;}u.renderData(false);};s.createCard=function(C){var z=this;var v=7,y=4;var x=this.cardPadding;
var w=x+y;var B=z.cardWidth,A=0;return function(N){var F=o.format("0,000")(N.total);var I=w+(F.length*v);var P=(z.cardWidth-x-v);
var M=o.format(".2f")(N.percentTotal);var L=M.indexOf(".00");if(L>-1){M=M.substring(0,L);}var K=P-(y+(M.length*v));var O=String(N.authPercent).length;
var J=w+(O*v);B=(z.orientation==="vertical")?z.cardWidth/2-10:z.cardWidth;A=(z.orientation==="vertical")?z.cardHeight+10:z.cardHeight/2+12;
var Q={cardWidth:B,cardHeight:z.cardHeight,halfCardHeight:A,headerWidth:z.cardWidth-4,headerHeight:z.headerHeight,cardPadding:x,headerText:N.dimensionText,iconXPos:(z.cardWidth-x*2)+3,lineWidth:(z.cardWidth-2),txTitleXPos:I,txValueXPos:x,txValue:F,percTxTitleXPos:P,percTxValueXPos:K,percTxValue:M,eurValueXPos:x+10,eurValue:N.eurAmount,authTitleXPos:J,authValueXPos:x,authValue:N.authPercent,allData:N.allData,explanationRights:(f("#explanation_permission").length>0)};
if(typeof(Q.allData.possibleNewDimensions)!=="undefined"){for(var H=Q.allData.possibleNewDimensions.dimensions.length;H>0;
H--){Q.allData.possibleNewDimensions.dimensions[H-1].values.sort(function(T,S){return T.name.localeCompare(S.name);});}}var E=z.template.render(Q);
var G;if(z.templateStyle==="html"){G=document.createElement("div");}else{G=document.createElementNS("http://www.w3.org/2000/svg","g");
}f(G).attr("class","harpnode");if(z.templateStyle==="html"){var R=z.createNodeEnterFn(C);var D=R(N);f(G).css("left",D[0]+"px");
f(G).css("top",D[1]+"px");}else{f(G).attr("transform",z.createNodeEnterFn(C));}G.innerHTML=E;if(G.childNodes.length<1){n.innerHTMLShim(G,E);
}f(G).trigger(b.EV_CONTENT_MERGED);return G;};};s.updateTree=function(v){u.updateTree(v);setTimeout(function(){s.$el.trigger(k.CHART_TO_VIEW_EVENT,{type:k.CHART_RENDERED,data:s.data});
},100);};s.showDestroyDimensionDialog=function(v){if(!this.dialogShown){var w=f("#dialogWindow_"+v.id).show();w.prependTo(f("#harp-dialog-window"));
f("#harp-dialog-overlay").show();f("#schedulingWindow").hide();f(".explanationWindow").hide();}else{f("#deleteSplit_"+v.id).click();
f(".explanationWindow").hide();}};s.showExplanationDialog=function(v){f(".explanationWindow").hide();f(".deleteDimensionDialog").hide();
var w=f("#editExplanationWindow_"+v.id).show();w.prependTo(f("#harp-dialog-window"));f("#harp-dialog-overlay").show();f("#schedulingWindow").hide();
};s.deleteNodeChildren=function(z){var x=m.first(z.nodes).parentNodeId;z.nodeId=x;z.possibleNewDimensions=m.findWhere(z.possibleNewDimensions,{nodeId:x.toString()});
var F=z.possibleNewDimensions.dimensions;for(var G=0;G<F.length;G++){var y=F[G];var v=[];var E=y.values;for(var C=0;C<E.length;
C++){v.push({index:C,name:E[C].value});}y.values=v;y.title=y.name;if(E.length){y.title=E[0].dimensionTitle;}}var w=j;var D=h.compile(w);
z.possibleNewDimensions.dimensions.sort(function(I,H){return I.name.localeCompare(H.name);});for(var B=z.possibleNewDimensions.dimensions.length;
B>0;B--){z.possibleNewDimensions.dimensions[B-1].values.sort(function(I,H){return I.name.localeCompare(H.name);});}var A=D.render(z);
f("#hn_"+x).find(".hn-container").prepend(A);f("#showDeleteSplitDialog_"+x).remove();};s.findNode=function(z,A){var w=this;
if(z.harpNodeId===A){return z;}var y=z.children;if(y){for(var x=0;x<y.length;x++){var B=y[x];var v=w.findNode(B,A);if(v){return v;
}}}};s.deleteDimensionNode=function(){f("#harp-dialog-overlay").hide();this.dialogShown=true;};return s;};return c;});define("chartlib/events/layoutEvents",[],function(){var a={};a.BASE="layout:";a.RESIZE=a.BASE+"resize";return a;});define("chart/widgetFramework/chartTypes/barChart",["jquery","underscore","d3","hogan","util/Functional","chart/widgetFramework/core/constants/WidgetConstants","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/drivers/axisBaseView"],function(b,i,j,f,a,e,h,g,c){var d=function(q,k,o,m){var n;
var p={};var l=i.defaults(q,p);n=c(l,k);var r=g(n);n.timeline=o;n.init=function(){r.init();};n.feedData=function(s){var t=r.feedData(s);
if(this.timeline){this.configData.granularity=this.timeline.getGranularity();}return t;};n.renderData=function(){if(a.falsy(this.data)){this.hideCharts("no data to display");
return;}var t=this,v=this.scales[this.options.xAttr],u=this.scales[this.options.yAttr];var s;if(this.options.variation===e.VERTICAL){s=this.barUtils.containerBarsVertical(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),this.barPositioningFn,true).barVertical(this.options.yAttr,u,this.barSize);
}else{s=this.barUtils.containerBarsHorizontal(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),this.barPositioningFn,true).barHorizontal(this.options.xAttr,v,this.barSize);
}this.addLabels();};n.addLabels=function(){};return n;};return d;});define("chart/widgetFramework/composed/chargebackReport/paymentMethodBarChart",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/chartTypes/barChart"],function(c,g,j,b,e,a,f,h,d){function i(m,p,r,q){var o;
var k={};var s=g.defaults(k,m);o=d(s,p,r);var l=f(o);var n=false;o.init=function(){l.init();this.maxRowsForBrush=(this.options.numBars&&this.options.numBars>0)?this.options.numBars:10;
};o.initRender=function(){l.initRender();setTimeout(function(){if(!n&&o.options.ranked){o.chartGroup.classed("barchart-ranked",true);
}n=true;},100);o.textScale=j.scale.linear().domain([8,50]).range([11,5]).clamp(true);var t=o.mainGroup.append("defs");t.append("clipPath").attr("id","clip-bars-payment-method").append("rect").attr("width",o.options.width-o.options.margin.left-o.options.margin.right).attr("height",o.options.height-o.options.margin.top-o.options.margin.bottom);
t.append("clipPath").attr("id","clip-y-axis-payment-method").append("rect").attr("clipPathUnits","objectBoundingBox").attr("x","-100%").attr("width","100%").attr("height",((o.options.height-o.options.margin.top-o.options.margin.bottom)/(o.options.height)*100)+"%");
};o.render=function(){o.showCharts();o.doBrush=o.data.length>o.maxRowsForBrush;o.barUtils.transitionTime=o.doBrush?0:500;
o.barUtils.delayTime=o.doBrush?0:500;var u=o.$el.width();o.height=o.options.height-(o.options.margin.top+o.options.margin.bottom);
var t=o.height+o.options.margin.top+o.options.margin.bottom;o.topSVG.attr("width",u+"px").attr("height",t+"px");j.select("#"+o.$el[0].id).transition().duration(500).style("height",t+"px");
if(o.doBrush){o.chartGroup.attr("clip-path","url(#clip-bars-payment-method)").style("clip-path","url(#clip-bars-payment-method)");
o.axisGroup.select(".y.axis").attr("clip-path","url(#clip-y-axis-payment-method)").style("clip-path","url(#clip-y-axis-payment-method)");
}else{o.scales[o.options.yAttr].rangeBands([o.height,0],o.options.barPadding);o.axisGroup.selectAll(".y.axis text").style("font-size",null);
}o.update();};o.scrolling=function(){};o.updateScale=function(t){o.scales[o.options.yAttr].rangeBands(t.newScale,o.options.barPadding);
o.axisGroup.selectAll(".y.axis text").style("font-size",o.textScale(t.numSelected));var u=j.max(o.data,function(v){return t.selected.indexOf(v[o.options.yAttr])>-1?v[o.options.xAttr]:0;
});this.maxXScale=u;o.update();};o.setBandSizes=function(){if(o.doBrush){o.barSize=o.vertBarSize=o.scales[o.options.yAttr].rangeBand();
o.bandSize=o.barSize*(1+o.options.barPadding);}else{l.setBandSizes();}};return o;}return i;});define("chart/widgetFramework/core/mixins/widgetAxes",["d3","jquery","underscore","chartutil/d3utils","chart/widgetFramework/core/mixins/formats","util/Functional"],function(f,g,a,e,h,b){var d=function(i){if(i&&typeof h[i]==="function"){return true;
}return false;};var c={};c.getOrdinalXAxis=function(i,j){return c.getDefaultXAxis(i,j);};c.getLinearXAxis=function(i,j){return c.getDefaultXAxis(i,j);
};c.getTimeXAxis=function(i,j){return c.getDefaultXAxis(i,j);};c.getDefaultXAxis=function(i,j){return function(){var k=(j.drawTickToChartSize)?-this.height:0;
this.axes[i]=f.svg.axis().orient(j.align).tickSize(k);};};c.getFormatOrdinalXAxis=function(i,j){return function(){this.axes[i].tickFormat((d(j.tickFormat))?g.proxy(h[j.tickFormat](i),this):g.proxy(h.defaultOrdinalFormat(i),this));
};};c.getFormatLinearXAxis=function(i,j){return function(){this.axes[i].tickFormat((d(j.tickFormat))?g.proxy(h[j.tickFormat](i),this):g.proxy(h.defaultLinearFormat(i),this));
};};c.getFormatTimeXAxis=function(i,j){return function(){var k=(this.configData&&this.configData.granularity)?this.configData.granularity:"day";
this.axes[i].ticks(f.time[k],1).tickFormat((d(j.tickFormat))?g.proxy(h[j.tickFormat](i,k),this):g.proxy(h.defaultTimeFormat(i,k),this));
};};c.getRenderOrdinalXAxis=function(i,j){return c.getRenderDefaultXAxis(i,j);};c.getRenderLinearXAxis=function(i,j){return c.getRenderDefaultXAxis(i,j);
};c.getRenderTimeXAxis=function(i,j){return c.getRenderDefaultXAxis(i,j);};c.getRenderDefaultXAxis=function(i,j){return function(){var r=this;
var k=r.xAxesHolders[i];var n=r.scales[i];var m=r.axes[i];if(r.options.barHeight!==null&&j.drawTickToChartSize===true){m.tickSize(-r.height);
}if(b.existy(j.ticks)){m.ticks(j.ticks);}var s=(typeof j.axisTranTime!=="undefined")?j.axisTranTime:500;var q=j.axisDelayTime||0;
var l=(j.align==="bottom")?r.height:0;k.call(m.scale(n)).transition().duration(s).delay(q).ease("exp-in-out").attr("opacity",1).attr("transform","translate(0,"+l+")").each("start",function(){if(!j.allowTickOverlap){e.preventTickOverlap(this);
}});var p=0;if(b.notFalsy(j.tickTransform)){var o=j.tickTransform;if(j.centerTicks){p=o[1]||0;}else{if(b.existy(o[1])){p=o[1];
}k.selectAll(".tick").select("text").attr("transform",function(){return"translate("+o[0]+","+p+")";});}}if(j.centerTicks){e.spreadXAxisTicks(r,p,k);
}};};c.getOrdinalYAxis=function(i,j){return c.getDefaultYAxis(i,j);};c.getLinearYAxis=function(i,j){return c.getDefaultYAxis(i,j);
};c.getDefaultYAxis=function(i,j){return function(){var k=(j.drawTickToChartSize)?-this.width:0;this.axes[i]=f.svg.axis().orient(j.align).tickSize(k);
};};c.getFormatOrdinalYAxis=function(i,j){return function(){this.axes[i].tickFormat((d(j.tickFormat))?g.proxy(h[j.tickFormat](i),this):g.proxy(h.defaultOrdinalFormat(i),this));
};};c.getFormatLinearYAxis=function(i,j){return function(){this.axes[i].tickFormat((d(j.tickFormat))?g.proxy(h[j.tickFormat](i),this):g.proxy(h.defaultLinearFormat(i),this));
};};c.getRenderOrdinalYAxis=function(i,j){return c.getRenderDefaultYAxis(i,j);};c.getRenderLinearYAxis=function(i,j){return c.getRenderDefaultYAxis(i,j);
};c.getRenderDefaultYAxis=function(i,j){return function(){var r=this;var k=r.yAxesHolders[i];var m=r.scales[i];var l=r.axes[i];
if(r.options.barWidth!==null&&j.drawTickToChartSize===true){l.tickSize(-r.width);}if(b.existy(j.ticks)){l.ticks(j.ticks);
}var s=(typeof j.axisTranTime!=="undefined")?j.axisTranTime:500;var p=j.axisDelayTime||0;k.attr("transform",function(){var t=0;
if(j.align==="right"){t=r.width;}return"translate("+t+",0)";}).transition().duration(s).delay(p).ease("exp-in-out").attr("opacity",1).call(l.scale(m));
var q=0,o=0;if(!b.falsy(j.tickTransform)){var n=j.tickTransform;if(j.centerTicks){if(n.length===1){q=0;}else{q=n[0];}}else{if(n.length===1){q=0;
o=n[0];}else{q=n[0];o=n[1];}k.selectAll(".tick").select("text").attr("transform",function(){return"translate("+q+","+o+")";
});}}if(j.centerTicks){e.spreadYAxisTicks(r,q,k);}};};c.moveLinesToBack=function(){this.xAxis.selectAll("line").each(function(){if(typeof this.raphaelNode!=="undefined"){this.raphaelNode.toBack();
}});};return c;});define("chart/widgetFramework/core/AxisComponent",["jqueryExtended","chart/widgetFramework/core/constants/DataConstants","underscore","util/Functional","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/core/mixins/widgetScales","chart/widgetFramework/core/mixins/widgetAxes","chartutil/stringutils"],function(a,i,l,e,j,m,n,f){var c=false;
var k="color:deepskyblue;font-size:1em";var b=false;var g="color:darkseagreen;font-size:1em";var d=false;var h=function(o){var t={};
t.init=function(){l.bindAll(this,"onNotifiedChartCreated");this.$el=o.getNode();this.id=this.$el.attr("data-id");if(window.console&&console.log&&c){console.log("%c\n################",k);
console.log("%c### INIT STAGE :: GraphComp::"+this.id+":: INIT",k);console.log("%c################",k);}this.parameters=this.getParameters(o);
this.graphOptions=this.parameters.options;this.vizCompContainer=this.$el.parent();this.parentID=this.vizCompContainer.attr("id");
if(!this.parentID){this.parentID=this.vizCompContainer.attr("data-id");}if(window.console&&console.log&&d){console.log("### AxisComponent2::init:: getting ViewCreator promise----");
}this.vizCompContainer.widget().then(function(v){t.vizCompInstance=v.instance;if(window.console&&console.log&&c){console.log("%c\n################",k);
console.log("%c### INIT STAGE :: GraphComp::"+t.id+'::ADDING OBSERVER: "onNotifiedChartCreated" - widgetRef= '+v.instance.id,k);
console.log("%c################",k);}t.vizCompInstance.registerObserver(t.onNotifiedChartCreated,false,t.id);});};t.onNotifiedChartCreated=function(x,v){var w=this.vizCompInstance.deregisterObserver(this.onNotifiedChartCreated);
if(v===this.parentID){this.chart=x.changeObject.data;if(window.console&&console.log&&b){console.log("%c\n################",g);
console.log("%c### START STAGE :: GraphComp::"+this.id+":: onNotifiedChartCreated create scale & axis fny on chart",g);console.log("### START STAGE :: GraphComp::"+this.id+":: onNotifiedChartCreated create scale & axis fny on chart:",this.chart);
console.log("%c################",g);}if(this.graphOptions.orientation==="x"){p(this.graphOptions,this.chart.dimensionsXArray,this.chart.dimensionsYArray);
if(!p){return;}this.chart.options.xScale=this.graphOptions.scale;this.graphOptions.nestedXAttr=e.getValueOrDefault(this.chart.options,null,"nestedXAttr");
this.chart.dimensionsXArray.push(this.graphOptions.dimension);this.chart.options.niceScaleX=this.graphOptions.niceScale;this.chart.options.xTicks=this.graphOptions.ticks;
this.chart.options.suffixLastXTickOnly=this.graphOptions.suffixLastTickOnly;this.chart.options.xAxisTranTime=(this.graphOptions.axisTranTime!=="undefined")?this.graphOptions.axisTranTime:500;
e.getValueOrDefault(this.graphOptions,"bottom","align",true);s(this.graphOptions,this.chart);q(this.graphOptions,this.chart);
}else{if(this.graphOptions.orientation==="y"){p(this.graphOptions,this.chart.dimensionsXArray,this.chart.dimensionsYArray);
if(!p){return;}this.chart.options.yScale=this.graphOptions.scale;this.graphOptions.nestedYAttr=e.getValueOrDefault(this.chart.options,null,"nestedYAttr");
this.chart.dimensionsYArray.push(this.graphOptions.dimension);this.chart.options.yTicks=this.graphOptions.ticks;this.chart.options.yAxisIsPercent=false;
if(this.graphOptions.tickFormat&&this.graphOptions.tickFormat.toLowerCase().indexOf("percent")>-1){this.chart.options.yAxisIsPercent=true;
}this.chart.options.suffixLastYTickOnly=this.graphOptions.suffixLastTickOnly;this.chart.options.yAxisTranTime=(typeof this.graphOptions.axisTranTime!=="undefined")?this.graphOptions.axisTranTime:500;
e.getValueOrDefault(this.graphOptions,"left","align",true);r(this.graphOptions,this.chart);u(this.graphOptions,this.chart);
}}this.$el.remove();}};function s(w,v){var x=w.scale;var y=w.dimension;var z=f.capitaliseFirstLetter(x);v.xScaleCreationFns[y]=m["get"+z+"XScale"](y);
v.calibrateXScaleFns[y]=m["getCalibrate"+z+"XScale"](y,w);}function q(w,v){var x=w.scale;var y=w.dimension;var z=f.capitaliseFirstLetter(x);
v.xAxisCreationFns[y]=n["get"+z+"XAxis"](y,w);v.formatXAxisFns[y]=n["getFormat"+z+"XAxis"](y,w);v.renderXAxisFns[y]=n["getRender"+z+"XAxis"](y,w);
}function r(w,v){var x=w.scale;var z=w.dimension;var y=f.capitaliseFirstLetter(x);v.yScaleCreationFns[z]=m["get"+y+"YScale"](z);
v.calibrateYScaleFns[z]=m["getCalibrate"+y+"YScale"](z,w);}function u(w,v){var x=w.scale;var z=w.dimension;var y=f.capitaliseFirstLetter(x);
v.yAxisCreationFns[z]=n["get"+y+"YAxis"](z,w);v.formatYAxisFns[z]=n["getFormat"+y+"YAxis"](z,w);v.renderYAxisFns[z]=n["getRender"+y+"YAxis"](z,w);
}t.getParameters=function(v){var y=v.getNode().data();var w;if(l.keys(y).length){w=y;}else{v.parameters.options=a.parseJSON(v.parameters.options);
w=v.parameters;}var x={};if(l.keys(w).length){x.options=w.options;}else{throw"The parameters are not well defined"+w;}return x;
};function p(y,v,A){var z=e.checker(e.validator("must be a map",e.aMap),e.hasKeysWithTruthyValues("scale","dimension"));var x=z(y);
if(x.length){if(window.console&&console.log){console.log("\n###############");console.error("### AxisComponent::onNotifiedChartCreated:: CHECKED =",x);
console.log("################");}return false;}var w=v.concat(A);if(l.includes(w,y.dimension)){if(window.console&&console.log){console.log("\n###############");
console.error("### AxisComponent::onNotifiedChartCreated:: Dimension values must be unique across both axes:",y.dimension,"already exists");
console.log("################");}return false;}return true;}t.init();if(window.console&&console.log&&d){console.log("\n### AxisComponent2::constructor:: calling pWidgetApi.ready()");
}o.ready();return t;};return h;});define("chart/widgetFramework/chartTypes/heatmap",["jquery","underscore","d3","hogan","util/Functional","chart/widgetFramework/core/constants/WidgetConstants","chart/widgetFramework/core/constants/UIConstants","chartutil/stringutils","util/ObjectSuper","chart/widgetFramework/core/drivers/baseView"],function(d,j,k,g,b,f,i,c,h,a){var e=function(r,l,p,n){var o;
var q={colorScaleRange:["#FFFFDD","#3E9583","#1F2D86"],interpolate:false,legendText:"legend"};var m=j.defaults(r,q);o=a(m,l);
var s=h(o);o.timeline=p;o.init=function(){s.init();var t=this.options.xRange;if(t){if(t[0]==="true"){this.xRange=k.range(t[1],t[2]);
}else{this.xRange=t;}}var u=this.options.yRange;if(u){if(u[0]==="true"){this.yRange=k.range(u[1],u[2]);}else{this.yRange=u;
}}this.xDimension=this.options.dimensions[0];this.yDimension=this.options.dimensions[1];this.zDimension=this.options.dimensions[2];
};o.initRender=function(){s.initRender();var u=Math.floor(this.width/this.xRange.length);var t=Math.floor(this.height/this.yRange.length);
this.gridSize=Math.min(u,t);this.colorScale=k.scale.linear().domain([0,k.max(this.data,function(v){return v[o.zDimension];
})/2,k.max(this.data,function(v){return v[o.zDimension];})]).range(this.options.colorScaleRange);if(this.options.interpolate){this.colorScale.interpolate(k.interpolateHcl);
}};o.feedData=function(t){var u=s.feedData(t);return u;};o.renderData=function(){if(b.falsy(this.data)){this.hideCharts("no data to display");
return;}var u="."+this.xDimension;var w=this.chartGroup.selectAll(u).data(this.data);var v=w;var t=w.enter().append("rect").attr("class",function(x){return o.xDimension+" bordered";
}).attr("x",function(y,x){return((y[o.xDimension])*o.gridSize)+o.gridSize/2;}).attr("y",function(x){return o.getYPos(x)+o.gridSize/2;
}).attr("width",0).attr("height",0).style("stroke","white").style("stroke-opacity",0.6).style("fill",function(x){return o.colorScale(x.count);
}).transition().duration(150).delay(function(y,x){return x*10;}).attr("x",function(x){return(x[o.xDimension])*o.gridSize;
}).attr("y",function(x){return o.getYPos(x);}).attr("width",this.gridSize).attr("height",this.gridSize);this.addXLabels();
this.addYLabels();this.createLegend();};o.getYPos=function(t){return(t[o.yDimension])*o.gridSize;};o.addXLabels=function(){var t="."+this.xDimension+"-label";
var u=this.chartGroup.selectAll(t).data(this.xRange);var w=u;var v=u.enter().append("text").text(function(x){return x;}).attr("x",function(y,x){return x*o.gridSize;
}).attr("y",0).style("text-anchor","middle").attr("transform","translate("+o.gridSize/2+", -6)").attr("class",function(y,x){return o.xDimension+"-label "+o.xDimension+"-"+c.lowerCaseReplaceSpace(y,"-");
});};o.addYLabels=function(){var u="."+this.yDimension+"-label";var t=this.chartGroup.selectAll(u).data(this.yRange);var w=t;
var v=t.enter().append("text").text(function(x){return x;}).attr("x",0).attr("y",function(y,x){return x*o.gridSize;}).style("text-anchor","end").attr("transform","translate(-6,"+o.gridSize/1.5+")").attr("class",function(y,x){return o.yDimension+"-label "+o.yDimension+"-"+c.lowerCaseReplaceSpace(y,"-");
});};o.createLegend=function(){var t=k.scale.linear().domain([0,k.max(this.data,function(C){return C[o.zDimension];})]).range([0,this.width]);
var B=10;var v=t.domain();v[2]=v[1]-v[0];var y=[];for(var x=0;x<B;x++){y.push(x*v[2]/(B-1)+v[0]);}this.chartGroup.append("defs").append("linearGradient").attr("id","legend-traffic").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").selectAll("stop").data(k.range(B)).enter().append("stop").attr("offset",function(D,C){return t(y[C])/o.width;
}).attr("stop-color",function(D,C){return o.colorScale(y[C]);});var A=Math.min(this.width*0.8,400);var w=this.chartGroup.append("g").attr("class","legendWrapper").attr("transform","translate("+(this.width/2)+","+(this.gridSize*this.yRange.length+40)+")");
w.append("rect").attr("class","legendRect").attr("x",-A/2).attr("y",0).attr("width",A).attr("height",10).style("fill","url(#legend-traffic)");
w.append("text").attr("class","legendTitle").attr("x",0).attr("y",-10).style("text-anchor","middle").text(o.options.legendText);
var z=k.scale.linear().range([-A/2,A/2]).domain([0,k.max(this.data,function(C){return C[o.zDimension];})]).nice(5);var u=k.svg.axis().orient("bottom").ticks(5).scale(z);
w.append("g").attr("class","axis").attr("transform","translate(0,"+(10)+")").call(u);};return o;};return e;});define("chart/widgetFramework/composed/harpViewer/baselineRollover",["jqueryExtended","underscore","d3","chart/widgetFramework/core/mixins/widgetScales","util/Functional","chartutil/domUtils","util/ObjectSuper","chart/widgetFramework/chartTypes/rollover"],function(c,g,i,h,a,e,f,d){var b=function(p,j,n,l){var m;
var o={};var k=g.defaults(o,p);m=d(k,j);var q=f(m);m.enhanceTooltipData=function(s){var r=i.format("n"),t=i.format(".2f");
s.dateTT=i.time.format("%d/%m/%Y")(s.date);s.authRateTT=t(+s.authRate)+"%";s.averageRateTT=t(+s.averageRate||0)+"%";s.authorisationsTT=r(+s.authorisations);
s.totalTT=r(+s.total);};return m;};return b;});define("chart/widgetFramework/composed/cardAcquirerAuthorizationReport/binBrushBarChart",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chartutil/stringutils","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/core/drivers/axisBaseView","text!chart/widgetFramework/composed/cardAcquirerAuthorizationReport/templates/binBarLegendTemplate.html"],function(f,k,m,e,h,b,i,l,c,j,g,a){function d(s,n,q){var p;
var r={};var o=k.defaults(r,s);p=g(o,n,q);var u=i(p);var t=false;p.init=function(){u.init();p.maxRowsForBrush=10;p.oldSelected=0;
p.barUtils.barClassStr="dot-group";p.barUtils.barSelectorStr=".dot-group";var v=p.el.id;v=v.replace("composed/cardAcquirerAuthorizationReport/","");
p.IDname=v.replace("RateBarChart","");};p.initRender=function(){u.initRender();setTimeout(function(){if(!t&&p.options.ranked){p.chartGroup.classed("barchart-ranked",true);
}t=true;},100);p.textScale=m.scale.linear().domain([8,50]).range([11,5]).clamp(true);var v=p.mainGroup.append("defs");v.append("clipPath").attr("id","clip-bars-"+p.IDname).append("rect").attr("x",-p.options.margin.left).attr("width",p.options.width).attr("height",p.options.height-p.options.margin.top-p.options.margin.bottom);
v.append("clipPath").attr("id","clip-y-axis-"+p.IDname).append("rect").attr("clipPathUnits","objectBoundingBox").attr("x","-100%").attr("width","100%").attr("height",((p.options.height-p.options.margin.top-p.options.margin.bottom)/(p.options.height)*100)+"%");
};p.render=function(){p.showCharts();if(b.notFalsy(this.data)){p.doBrush=p.data.length>p.maxRowsForBrush;}p.barUtils.transitionTime=p.doBrush?0:500;
p.barUtils.delayTime=0;var w=this.$el.width();if(!p.doBrush&&b.notFalsy(this.data)){p.height=(p.data.length*30);}else{p.height=this.$el.height()-(p.options.margin.top+p.options.margin.bottom);
}var v=p.height+p.options.margin.top+p.options.margin.bottom;p.topSVG.attr("width",w+"px").attr("height",v+"px");m.select("#"+p.$el[0].id).transition().duration(500).style("height",v+"px");
if(p.doBrush){p.chartGroup.attr("clip-path","url(#clip-bars-"+p.IDname+")").style("clip-path","url(#clip-bars-"+p.IDname+")");
p.axisGroup.select(".y.axis").attr("clip-path","url(#clip-y-axis-"+p.IDname+")").style("clip-path","url(#clip-y-axis-"+p.IDname+")");
}else{p.scales[p.options.yAttr].rangeBands([p.height,0],p.options.barPadding);p.axisGroup.selectAll(".y.axis text").style("font-size",null);
}this.update();};p.renderData=function(){if(b.falsy(this.data)){this.hideCharts("no data to display");return;}var y=this.scales[this.options.xAttr];
p.tranTime=this.barUtils.transitionTime;p.delayTime=this.barUtils.delayTime;var x=this.barSize/2*0.8;var v=p.extraData.colors;
var w=this.barUtils.containerBarsHorizontal(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),this.barPositioningFn,true);
p.lineHorizontal(y,w.bars);p.dotHorizontal("acquirerValues","labelName",y,x,w.bars.bar,this.options.xAttr,v);p.averageRectangle(y,w.bars,x,this.options.xAttr);
p.placeLabels(w.bars);p.renderLegend();};p.placeLabels=function(w){var v=m.format(",.2f");w.update.select(".bar-label").attr("y",this.barSize/2).attr("dy","0.35em").text(function(x){return v(x.authorizationRate)+"%";
}).style("opacity",1);w.enter.append("text").attr("class","bar-label").attr("x",-8).attr("y",this.barSize/2).attr("dy","0.35em").style("text-anchor","end").text(function(x){return v(x.authorizationRate)+"%";
});w.exit.select(".bar-label").remove();};p.renderLegend=function(){var y=h.compile(a);var A=[];var v=[];var z=false;k.each(this.extraData.acquirers,function(B){if(B.toLowerCase().indexOf("adyen")>-1){z=true;
if(A.length===0){A.unshift({title:"Adyen based acquirers",color:"transparent"});}A.push({title:B,color:p.extraData.colors[B.toLowerCase()]});
}else{if(v.length===0){v.unshift({title:z?"Other acquirers":"Acquirers",color:"transparent"});}v.push({title:B,color:p.extraData.colors[B.toLowerCase()]});
}});var w={adyenAcquirers:A,otherAcquirers:v};var x=y.render(w);f("#binBarLegend").html(x);};p.lineHorizontal=function(x,w){var v=p.barSize/2;
var z=x.range()[0];var y=x.range()[1];w.update.select(".dot-line").transition("update").duration(p.tranTime).delay(p.delayTime).attr("x1",z).attr("y1",v).attr("x2",y-z).attr("y2",v);
w.enter.append("line").attr("class","dot-line").attr("x1",z).attr("y1",v).attr("x2",y-z).attr("y2",v).style("opacity",0).transition("enter").duration(p.tranTime).delay(2*p.delayTime).style("opacity",1);
w.exit.select(".dot-line").transition().duration(p.tranTime).style("opacity",0).remove();};p.averageRectangle=function(x,w,A,B){var y=this.barSize*1.2;
var v=(this.barSize-y)/2;var z=2;w.update.select(".average").transition("update").duration(p.tranTime).delay(p.delayTime).attr("y",v).attr("height",y).attr("x",function(C){return x(C[B])-z/2;
}).attr("width",z).style("opacity",function(C){return C.acquirerValues.length>1?1:0;});w.enter.append("rect").attr("class","average dot-average").attr("y",v).attr("height",y).attr("x",function(C){return x(C[B])-z/2;
}).attr("width",z).style("opacity",0).transition("enter").duration(p.tranTime).delay(2*p.delayTime).style("opacity",function(C){return C.acquirerValues.length>1?1:0;
});w.exit.select(".average").transition().duration(p.tranTime).style("opacity",0).remove();};p.dotHorizontal=function(x,A,E,B,I,G,v){var H=function(J){return J[x];
};var z=function(J){return J[A];};var D=p.barSize/2;var w=I.selectAll("circle").data(H,z);var F=w.transition().duration(p.tranTime).delay(p.delayTime).attr("transform",function(){return"translate(0,"+D+")";
}).attr("cx",function(J){return E(J[G]);}).attr("cy",0).attr("r",B).style("opacity",0.8).style("fill",function(J){return v[c.lowerCaseReplaceSpace(J.labelName,"-")];
});var y=w.enter().append("circle").attr("class",function(J){return"dot "+J.labelName;}).attr("transform",function(){return"translate(0,"+D+")";
}).attr("cx",function(J){return E(J[G]);}).attr("cy",0).attr("r",0).style("fill",function(J){return v[c.lowerCaseReplaceSpace(J.labelName,"-")];
}).style("opacity",0.8).transition().duration(p.tranTime).delay(2*p.delayTime).attr("r",B);var C=w.exit().transition().duration(p.tranTime).attr("r",0).style("opacity",0).remove();
this.dots={dot:w,enter:y,update:F,exit:C};return this;};p.updateScale=function(v){p.scales[p.options.yAttr].rangeBands(v.newScale,p.options.barPadding);
if(v.numSelected!==p.oldSelected){p.axisGroup.selectAll(".y.axis text").style("font-size",p.textScale(v.numSelected));p.chartGroup.selectAll(".bar-label").style("font-size",p.textScale(v.numSelected));
}p.oldSelected=v.numSelected;p.update();};p.setBandSizes=function(){if(p.doBrush){p.barSize=p.vertBarSize=p.scales[p.options.yAttr].rangeBand();
p.bandSize=p.barSize*(1+p.options.barPadding);}else{u.setBandSizes();}};return p;}return d;});define("chart/widgetFramework/composed/chargebackReport/formatters/cfnRolloverFormatter",["underscore","d3","chart/widgetFramework/core/constants/DataConstants","chartutil/domUtils"],function(b,c,e,d){var a=function(i,f,h,j){var g={};
g.data=i;g.options=f;g.formattedData={};g.comparator=null;g.reverseDirection=false;g.sortKey=null;g.timeline=h;g.id=j;g.dataType="count";
g.formatData=function(){var k={};this.formattedData=this.calculateMetaData(this.data);if(window.console&&console.log){console.log("### cfnRolloverFormatter::formatData:: this.formattedData=",this.formattedData);
}return{chartData:this.formattedData};};g.calculateMetaData=function(o){var n=[];var m=c.time.format("%Y-%m-%d");var k=c.format(".2f");
var l=c.format(",g4f");b.each(o,function(s){var p=+s.authorisedEurAmount/100;var r=+s.chargebackEurAmount/100;var q=+s.fraudNotificationsEurAmount/100;
if(g.dataType==="count"){n.push({date:m(s.date),chargebackValue:s.chargebackCount,chargebackVol:l(s.chargebackCount),nofValue:s.fraudNotificationsCount,nofVol:l(s.fraudNotificationsCount),chargebackRate:(s.chargebackCount>0)?k((s.chargebackCount/s.authorisedCount)*100):0,nofRate:(s.fraudNotificationsCount>0)?k((s.fraudNotificationsCount/s.authorisedCount)*100):0});
}else{n.push({date:m(s.date),chargebackValue:r,chargebackAmt:"\u20AC"+l(r),nofValue:q,nofAmt:"\u20AC"+l(q),chargebackRate:(r>0)?k((r/p)*100):0,nofRate:(q>0)?k((q/p)*100):0});
}});return n;};g.reformatData=function(k){this.dataType=k;var l=this.formatData();this.$el.trigger(e.FORMATTER_INFORM_WIDGET,{type:e.REFORMATTED_DATA,data:l});
};g.downloadCSV=function(){var k=["date","chargebackValue","chargebackRate","nofValue","nofRate"];var l=["Date","Chargeback "+this.dataType,"Chargeback rate","Notifications of fraud "+this.dataType,"Notifications of fraud rate"];
d.createCSV(this.formattedData,k,l,"ChargebacksAndFraudNotifications");};g.setRawData=function(k){this.data=k;};return g;
};return a;});define("chartutil/arrayutils",[],function(){var a={};a.removeFrom=function(e,c,d){var b=a.findIndexByKeyValue(e,c,d);if(b>-1){return e.splice(b,(e.length-b));
}};a.findIndexByKeyValue=function(f,d,e){var b=f.length;for(var c=0;c<b;c++){if(f[c].get(d)===e){return c;}}return -1;};a.countElements=function(d){var e=[],c=[],g;
d.sort();for(var f=0;f<d.length;f++){if(d[f]!==g){e.push(d[f]);c.push(1);}else{c[c.length-1]++;}g=d[f];}return[e,c];};return a;
});define("chart/widgetFramework/composed/retryreport/formatters/acquirerSankeyDataFormatter",["jqueryExtended","underscore","d3","util/Functional"],function(e,b,d,c){function a(i,f,h,j){var g={};
g.data=i;g.options=f;g.formattedData={};g.reverseDirection=false;g.sortKey=null;g.timeline=h;g.id=j;g.formatData=function(){var m,l=this.options.variation;
if(this.data&&l==="original"){m=this.data.originalAcquirerSankeyData;}else{if(this.data&&l==="retry"){m=this.data.retryAcquirerSankeyData;
}else{m={};}}if(c.falsy(m)){return[];}var k;if(typeof this.chosenAcquirer!=="undefined"){k=this.chosenAcquirer;}this.nestedData=g.nestData(m,k);
this.formattedData=g.parse(this.nestedData.acquirerData);this.formattedData.acquirers=this.nestedData.acquirers;this.formattedData.chosenAcquirer=this.nestedData.chosenAcquirer;
return{chartData:this.formattedData};};g.nestData=function(m,k){var l=d.nest().key(function(o){return o.acquirer;}).entries(m);
var n=b.pluck(l,"key");n=n.sort();if(b.findIndex(l,{key:k})===-1){k=n[0];}return{acquirerData:l[b.findIndex(l,{key:k})].values,acquirers:n,chosenAcquirer:k};
};g.parse=function(l){var k={nodes:[],links:[],nodeNames:[]};l.forEach(function(m){if(/_O$|_R$/.test(m.source)){k.nodeNames.push(m.source);
}if(/_O$|_R$/.test(m.target)){k.nodeNames.push(m.target);}k.nodes.push({name:m.source});k.nodes.push({name:m.target});k.links.push({source:m.source,target:m.target,value:+m.value,type:m.type});
});k.nodes=d.keys(d.nest().key(function(m){return m.name;}).map(k.nodes));k.links.forEach(function(n,m){k.links[m].source=k.nodes.indexOf(k.links[m].source);
k.links[m].target=k.nodes.indexOf(k.links[m].target);});k.nodes.forEach(function(n,m){k.nodes[m]={name:n};});k.nodeNames=d.keys(d.nest().key(function(m){return m.replace(/_O$|_R$/,"");
}).map(k.nodeNames));return k;};g.sortData=function(k){};g.compareFunction=function(k){};g.getData=function(){return(this.data)?this.data:this.formatData();
};g.setRawData=function(k){this.data=k;};g.retrieveData=function(k){return this.data[k];};return g;}return a;});define("chart/widgetFramework/composed/settlementBatchOverview/settlementBatchChart",["jquery","underscore","d3","hogan","util/Functional","chartutil/d3utils","util/ObjectSuper","chart/widgetFramework/chartTypes/barChart","text!chart/widgetFramework/composed/settlementBatchOverview/settlementBatchTableTemplate.html"],function(b,g,i,e,a,j,f,c,h){var d=function(q,k,o,m){var n;
var p={};var l=g.defaults(p,q);n=c(l,k);var r=f(n);n.init=function(){r.init();};n.feedData=function(s){this.data=s.batches;
this.configData={granularity:"day"};this.renderTable(s);};n.renderData=function(){r.renderData();j.highlightCurrentDay(this.$el,this.options.xAttr,this.data);
};n.renderTable=function(s){var t=0;var w=0;var y=0;var A=b('[data-view="settlementBatchOverviewTable"]');var z=e.compile(h);
var v=g.clone(s.tableData);g.each(s.tableData,function(C){var E=g.get(C,"depositCorrection.quantity",0);var D=g.get(C,"invoiceDeduction.quantity",0);
var B=g.get(C,"internalPayout.quantity",0);if(E!==""){t+=Number(E);}if(D!==""){w+=Number(D);}if(B>0){y+=Number(B);}else{y="";
}});var x=g.first(s.tableData).currency;var u=z.render({month:{batches:v.reverse(),currency:x,payoutTotal:s.total,depoTotal:j.formatAmount(t,x),balTransferTotal:j.formatAmount(y,x),invTotal:j.formatAmount(w,x),downloadLink:adyen.config.settlementBatchDownloadUrl}});
A.html(u);this.setHoverHandling();};n.setHoverHandling=function(){var s;b(".settlement-batch-overview-table tr").hover(function(){b('[data-id="'+b(this)[0].dataset.batch+'"]').css("fill-opacity",".3").mouseenter();
},function(){b('[data-id="'+b(this)[0].dataset.batch+'"]').css("fill-opacity","0").mouseleave();});b("#settlementBatchOverviewRollover rect").hover(function(){s=b(this).data().id;
if(typeof s!=="undefined"){b('[data-batch="'+b(this).data().id+'"] td').addClass("row-active");}},function(){if(typeof s!=="undefined"){b('[data-batch="'+s+'"] td').removeClass("row-active");
}});};return n;};return d;});define("chart/widgetFramework/chartTypes/lineChart_buttonToggle",["jquery","underscore","d3","hogan","util/Functional","chartutil/d3utils","chartutil/stringutils","util/ObjectSuper","chart/widgetFramework/core/drivers/axisBaseView","chart/widgetFramework/core/constants/UIConstants"],function(c,g,j,d,a,k,b,e,h,f){var i=function(p,r,t,s){var l="Default Line Name";
var q;var n={};var u=g.defaults(p,n);q=h(u,r);var o=e(q);q.isBarChart=false;q.timeline=t;q.tranTime=500;q.toggleLineChar="\u2716";
q.defaultLineClass="line-holder";q.removedObjectsArr=[];var m=true;q.init=function(){o.init();this.$resetBtn=this.$el.find(".reset-line-icon");
setTimeout(function(){q.$resetBtn.css("display","none");},10);this.$resetBtn.on("click",function(){q.data=q.masterData;q.render();
q.$resetBtn.css("display","none");});};q.initRender=function(){o.initRender();this.$resetBtn.css("left",(this.$el.width()-(20))+"px");
};q.feedData=function(v){var w=o.feedData(v);this.masterData=this.data;if(this.timeline){this.configData.granularity=this.timeline.getGranularity();
}if(a.falsy(this.data)){if(m){m=false;var x=a.notFalsy(this.options.nestedAttr)?this.options.nestedAttr:"lineValues";this.setNestedAttr(x,true);
}return;}this.setNestedAttr(this.data,true);q.removedObjectsArr=[];var y="#"+this.$el.attr("id");this.$el.parent().find(y+" + .line-chart-button-holder .lcbh-buttons").empty();
this.$el.parent().find(y+" + .line-chart-button-holder .lcbh-text").css("display","none");return w;};q.setBandSizes=function(){if(a.notFalsy(this.data)){this.maxLinePoints=0;
g.each(this.data,function(w){var v=w[q.nestedAttr].length;if(v>q.maxLinePoints){q.maxLinePoints=v;}});this.bandSize=(this.width/this.maxLinePoints);
this.barSize=this.horizBarSize=(this.bandSize*(1-this.options.barPadding));}};q.xAccessor=function(y){var v=this.scales[this.options.xAttr],w=this.options.centerPoints;
if(w){return function(z,x){return((q.bandSize*x)+(q.bandSize/2));};}else{return function(x){return v(q.getXAttrVal(x));};
}};q.yAccessor=function(v){var w=this.scales[this.options.yAttr];return function(x){return w(q.getYAttrVal(x));};};q.getLineData=function(v){return v[this.nestedAttr];
};q.renderData=function(){this.dropEmptyData();if(a.falsy(this.data)){this.hideCharts("no data to display");return;}var L=this.scales[this.options.xAttr],I=this.scales[this.options.yAttr],K=this.tranTime,z=this.options.centerPoints,v=this.options.lineDataProp||this.options.joinAttr||"",G=this.options.interpolate||"linear",w=[],H,F,J=[];
var E=this.chartGroup.selectAll("."+this.defaultLineClass).data(this.getData(),this.getPrimaryDataJoin());var D=E.enter().append("g").attr("class",this.defaultLineClass).append("path").attr("class","line");
if(this.options.allowToggleLine){var M=E.transition().duration(K).ease("exp-in-out").style("opacity",1);}E.attr("class",function(x){return q.getClassName("",x[v]);
});E.select(".line").attr("d",function(x){return q.lineUtils.lineCreator("L",G,q.getLineData(x),q.xAccessor(x),q.yAccessor(x),"enter",j.select(this));
}).transition().duration(K).ease("exp-in-out").style("opacity",1).attr("d",function(x){return q.lineUtils.lineCreator("L",G,q.getLineData(x),q.xAccessor(x),q.yAccessor(x),"update");
});q.performLineExit(E,G,K);if(this.options.hasDots){H=E.selectAll("."+this.defaultLineClass+"-dot").data(function(x){return q.getLineData(x);
});var N=H.enter().append("circle").attr("class",q.defaultLineClass+"-dot").attr("cx",function(y,x){if(z){return((q.bandSize*x)+(q.bandSize/2));
}else{return L(q.getXAttrVal(y));}}).attr("cy",function(x){return 0;}).attr("r",3);H.attr("class",function(x){return q.getClassName("-dot",x[v]);
});H.transition().duration(K).ease("exp-in-out").each(function(P){var y=c(j.select(this).node());var x=P[v];if(!x){x=l;}var O=b.lowerCaseReplaceSpace(x,"-");
if(O.length&&O!=="undefined"){y.attr("data-id",O);}}).attr("cx",function(y,x){if(z){return((q.bandSize*x)+(q.bandSize/2));
}else{return L(q.getXAttrVal(y));}}).attr("cy",function(x){return I(x[q.options.yAttr]);}).style("opacity",1);var B=H.exit().transition().duration(K).attr("cy",function(x){return q.height+10;
}).style("opacity",0).remove();}else{H=E.selectAll("."+this.defaultLineClass+"-dot").transition().duration(K).attr("cy",function(x){return q.height+10;
}).style("opacity",0).remove();}if(this.options.hasLabels){var C;F=this.chartGroup.selectAll("."+this.defaultLineClass+"-label").data(this.getData(),this.getPrimaryDataJoin());
F.enter().append("text").attr("class",function(x){this.masterD=x;return q.defaultLineClass+"-label";}).style("cursor",function(x){if(q.options.allowToggleLine){c(this).attr("data-col",c(this).css("fill"));
return"pointer";}else{return"auto";}}).attr("dy",".35em").attr("y",0).on("mousedown",function(x){if(q.options.allowToggleLine){q.hideLine(this.masterD,this);
}else{return null;}});F.attr("class",function(x){return q.getClassName("-label",x[v]);}).datum(function(P){var y=P[q.nestedAttr];
if(a.falsy(y)){P.labelPosValue=-1;return P;}var O=g.findLast(y,function(Q){return Q[q.options.yAttr]!==null;});var x=O[q.options.yAttr];
P.labelPosValue=x;return P;}).sort(function(y,x){return y.labelPosValue<x.labelPosValue;}).transition().duration(K).attr("x",this.width+10).attr("y",function(y){var x=q.lineUtils.checkLabelPos(I(y.labelPosValue),w,y.labelPosValue,y[q.options.lineDataProp]);
y.yPos=x;return x;}).text(function(x){if(x.labelPosValue===-1){return"";}if(q.options.allowToggleLine){C=q.getLabelName(x);
return q.toggleLineChar+" "+C;}else{C=q.getLabelName(x);return C;}});if(this.options.allowToggleLine){F.style("opacity",1).style("cursor","pointer").style("pointer-events","auto");
}else{F.style("cursor","initial");}var A=F.exit().transition().duration(K).attr("y",function(){return q.height+10;}).style("opacity",function(x){return 0;
}).style("cursor","default").style("pointer-events","none").each(function(){if(q.data.length===q.masterData.length){j.select(this).remove();
}});}else{F=this.chartGroup.selectAll("."+this.defaultLineClass+"-label").transition().duration(K).attr("y",function(x){return q.height+10;
}).style("opacity",0).remove();}};q.dropEmptyData=function(){if(this.data){var w=this.data.length;for(var v=w-1;v>-1;v--){if(a.falsy(this.data[v][this.nestedAttr])){this.data.splice(v,1);
}}}};q.performLineExit=function(x,w,v){};q.getClassName=function(v,x){if(!x){x=l;}var w=b.lowerCaseReplaceSpace(x,"-");if(x&&w.length){return this.defaultLineClass+v+" "+w;
}else{return this.defaultLineClass+v;}};q.getLabelName=function(x){var v=this.options.lineDataProp||this.options.joinAttr||"";
var w=x[v];if(!w){w=l;}return b.lowerCaseReplaceSpace(w,"-");};q.hideLine=function(B,z){var y=c(z).attr("class");var w=y.match(/\s(.*)/)[1];
var v="."+this.defaultLineClass+".";var x=w.replace(/\s+/g,".");if(w.length){var A=this.$el.find(v+x);A.fadeTo(250,0);this.filterData(B);
}};q.filterData=function(w){var v=this.options.lineDataProp||this.options.joinAttr;var x=g.filter(this.data,function(y){if(y[v]===w[v]){q.removedObjectsArr.push(y);
}return y[v]!==w[v];});this.createRemovedItemButton(w[v]);this.data=x;this.render();};q.createRemovedItemButton=function(y){var z="#"+this.$el.attr("id");
if(this.removedObjectsArr.length===1){this.$el.parent().find(z+" +.line-chart-button-holder .lcbh-text").css("display","block");
}var w=this.$el.parent().find(z+" + .line-chart-button-holder .lcbh-buttons");var x=b.lowerCaseReplaceSpace(y,"-");var v='<button class="csr-button-2 border '+x+'">'+y+"</button>";
w.append(v);w.find("."+x).on("click",function(){q.restoreRemovedItem(y);c(this).remove();});};q.restoreRemovedItem=function(y){var A="#"+this.$el.attr("id");
var z={};z[this.options.lineDataProp]=y;var x=g.find(this.removedObjectsArr,z);var v=this.options.lineDataProp||this.options.joinAttr;
var w=g.filter(this.removedObjectsArr,function(B){return B[v]!==y;});this.removedObjectsArr=w;if(this.removedObjectsArr.length===0){this.$el.parent().find(A+" + .line-chart-button-holder .lcbh-text").css("display","none");
}this.data.push(x);this.render();};q.hideCharts=function(v){o.hideCharts(v);var w="#"+this.$el.attr("id");if(this.removedObjectsArr.length){this.$el.parent().find(w+" + .line-chart-button-holder").css("display","block");
}};return q;};return i;});define("chart/widgetFramework/chartTypes/stackedHistogram",["jquery","underscore","d3","hogan","util/Functional","util/ObjectSuper","chart/widgetFramework/core/drivers/axisBaseView","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/core/constants/WidgetConstants","chartutil/d3utils"],function(c,h,k,e,b,f,i,g,d,j){var a=function(r,l,p,n){var o;
var q={};var m=h.defaults(r,q);o=i(m,l);var s=f(o);o.timeline=p;o.feedData=function(t){var u=s.feedData(t);this.setNestedAttr(this.data);
return u;};o.getStackData=function(){return function(t){return t[o.nestedAttr];};};o.getSecondaryDataJoin=function(){return this.getDataJoin("name");
};o.renderData=function(){if(b.falsy(this.data)){this.hideCharts("no data to display");return;}var w=this.scales[this.options.xAttr],v=this.scales[this.options.yAttr];
var u,t;if(this.options.variation===d.VERTICAL){u=this.barUtils.containerBarsVertical(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),this.barPositioningFn,true).stackVertical(this.getStackData(),this.getSecondaryDataJoin(),v,this.barSize);
t=o.options.xAttr;}else{u=this.barUtils.containerBarsHorizontal(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),this.barPositioningFn,true).stackHorizontal(this.getStackData(),this.getSecondaryDataJoin(),w,this.barSize);
t=o.options.yAttr;}if(b.notFalsy(this.options.threshold)||this.options.threshold===0){u.bars.enter.selectAll("rect").classed("over-threshold",function(x){if(x[t]>=o.options.threshold){return true;
}return false;});}};return o;};return a;});define("chart/widgetFramework/composed/riskReport/views/fraudScoreStackedHistogramView",["jquery","underscore","d3","util/Functional","chart/widgetFramework/core/constants/WidgetConstants","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/chartTypes/stackedHistogram"],function(c,g,i,b,d,f,e,h){var a=function(l,n,q,p){var m;
var j={};var r=g.defaults(j,l);m=h(r,n);var k=e(m);m.renderData=function(){k.renderData();var s=m.options.threshold;if(b.notFalsy(s)||s===0){var x=this.scales[this.options.xAttr];
var y=this.chartGroup.selectAll(".marker").data([this.data]);var w=y.enter().append("g").attr("class","marker");var v=w.append("line").attr("x1",function(z){return x(s);
}).attr("y1",-20).attr("x2",function(z){return x(s);}).attr("y2",-20);o(w,x,s,5,-9,"Refused by RevenueProtect");o(w,x,s,170,-7,"\u203a");
var t=y.transition().delay(500).duration(500);var u=t.select("line").attr("y2",this.height);t.selectAll(".marker-text").attr("fill-opacity",1);
}};var o=function(y,t,w,s,v,u){var x=y.append("text").attr("class","marker-text").attr("fill-opacity",0.000001).attr("x",function(z){return t(w)+s;
}).attr("y",v).text(function(z){return u;});};return m;};return a;});define("chartlib/events/appstateevents",[],function(){var a={};a.BASE="app:state:";a.CHANGE_REQUESTED=a.BASE+"changeRequested";
a.STATE_CHANGED=a.BASE+"stateChanged";a.CONFIG_SET=a.BASE+"configSet";a.REQUEST_STATE_CHANGE=a.BASE+"requestStateChange";
a.RENDER_CHARTS=a.BASE+"renderCharts";return a;});define("chart/widgetFramework/composed/settlementBatchOverview/settlementBatchRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","util/ObjectSuper","chart/widgetFramework/chartTypes/rollover","chartutil/d3utils"],function(c,g,h,a,e,f,d,i){var b=function(p,j,n,l){var m;
var o={};var k=g.defaults(o,p);m=d(k,j);var q=f(m);m.feedData=function(r){if(r!==undefined){if(r.batches!==undefined){this.data=r.batches;
}}};m.enhanceTooltipData=function(r){r.payoutTT=i.formatAmount(r.payout,r.currency);};m.getBarId=function(){return"batchId";
};return m;};return b;});define("chart/widgetFramework/composed/cardAcquirerAuthorizationReport/formatters/acquirerAccountBarFormatter",["jqueryExtended","underscore","d3","chart/widgetFramework/core/constants/DataConstants"],function(e,b,c,d){function a(j,g,i,l){var h={};
h.data=j;h.options=g;h.formattedData={};h.comparator=null;h.reverseDirection=false;h.sortKey="authorizationRate";h.timeline=i;
h.id=l;h.formatData=function(){var m=this.data.acquirerAccount_aggregation?this.data.acquirerAccount_aggregation:{};if(m.length===0){return[];
}this.formattedData=k(m);if(this.sortKey){this.reverseDirection=!this.reverseDirection;this.sortData(this.sortKey,true);}return{chartData:this.formattedData};
};var k=function(o){var n=[];o=b.filter(o,function(p){return p.acquirerAccount!=="RefusedAcquirerAccount"&&typeof p.acquirerAccount!=="undefined"&&!(b.isNull(p.acquirerAccount));
});o=b.filter(o,function(p){return +p.authorisedCount>0&&+p.authRate>0;});var m=c.sum(o,function(p){return +p.authorisedCount;
});b.each(o,function(r){var q=+r.authRate*100,p=100-q;n.push({labelName:f(r.acquirerAccount),authorizedCount:+r.authorisedCount,authorizedEurAmount:+r.authorisedAmount/100,authorizedCountShare:m===0?0:+r.authorisedCount/m*100,authorizationRate:q,authRate:[{name:"authorized",value:q,startX:0,endX:q},{name:"refused",value:p,startX:q,endX:100}],total:100,name:"authorized"});
});return n;};var f=function(m){return m.replace(/_/g," ");};h.sortData=function(m,o){this.sortKey=m;if(this.sortKey===this.oldSortKey){this.reverseDirection=!this.reverseDirection;
}else{this.reverseDirection=false;}this.oldSortKey=this.sortKey;var n=b.sortBy(this.formattedData,m);if(this.reverseDirection){n.reverse();
}this.formattedData=n;if(o===true){return;}this.$el.trigger(d.FORMATTER_INFORM_WIDGET,{type:d.SORTED_DATA,data:{chartData:this.formattedData}});
};h.compareFunction=function(m){return m[this.sortKey];};h.getData=function(){return(this.data)?this.data:this.formatData();
};h.setRawData=function(m){this.data=m;};h.retrieveData=function(m){return this.data[m];};return h;}return a;});define("chart/widgetFramework/composed/settlementBatchWidget/settlementBatchWidgetFormatter",["jqueryExtended","underscore","d3","chartutil/d3utils"],function(e,a,c,b){function d(g,f){this.data=g;
this.fullMonthData=[];this.options=f;this.comparator=this.compareFunction;this.reverseDirection=false;this.sortKey="payout";
}d.prototype.formatData=function(){var f=["January","February","March","April","May","June","July","August","September","October","November","December"];
var j=c.time.format("%Y/%m/%d");var i=c.time.format("%Y-%m-%d");var h=this;var g=0;var k=function(l){var m={USD:"$",EUR:"&euro;",GBP:"&pound;"};
var n=m[l];if(typeof n!=="undefined"){return n;}return l;};a.each(this.data.months,function(r){var q=[];var n={hasBatch:false,payout:0};
g=0;a.each(r.batches,function(s,t){var u=i;if(s.closeDate.indexOf("/")>-1){u=j;}s.date=u.parse(s.closeDate);s.dateString=s.closeDate;
s.month=f[s.date.getMonth()];s.payout=Number(s.realMoneyPayout.quantity)/100;s.batchId=s.batchId;s.detailsUrl=s.detailsUrl?s.detailsUrl:adyen.base+"ca/reports/settlementbatchdetails.shtml?sequenceNumber="+s.batchId;
s.currency=s.fee.unit;s.currencySymbol=k(s.fee.unit);s.hasBatch=true;if(s.closeDate!==s.closeDateLocal){s.localTime=adyen.tz.userTimeZoneCode;
}g+=s.payout;q.push(s);});var m=a.first(q)||{};m.date=m.date||new Date();var p=new Date(m.date.getFullYear(),m.date.getMonth(),1);
var l=new Date(m.date.getFullYear(),m.date.getMonth()+1,0);var o=b.fillTimeScaleBucketsNonBackbone([p,l],"day",q);h.result={batches:[],total:c.format(",.2f")(g),currency:m.currency,currencySymbol:m.currencySymbol,month:f[m.date.getMonth()]};
a.each(o,function(s){s=a.defaults(s,n);h.result.batches.push(a.omit(s,["authRate","authorisations","averageRate","averageTotal","rates","total","utcdate"]));
});});if(window.console&&console.log){console.log("### settlementBatchWidgetFormatter::formatData:: that.result=",h.result);
}return h.result;};d.prototype.sortData=function(f){this.sortKey=f;this.reverseDirection=!this.reverseDirection;var g=a.sortBy(this.fullMonthData,f);
if(this.reverseDirection){g.reverse();}this.fullMonthData=g;return this.fullMonthData;};d.prototype.compareFunction=function(f){return f[this.sortKey];
};d.prototype.getData=function(){return(this.data)?this.data:this.formatData();};d.prototype.setRawData=function(f){this.data=f;
};d.prototype.setOptions=function(f){this.options=f;};return d;});define("chart/widgetFramework/chartTypes/chargebackBarView",["d3","jquery","underscore","backbone","hogan","chart/widgetFramework/core/drivers/axisBaseView","util/ObjectSuper","chart/widgetFramework/core/mixins/formats","chart/widgetFramework/core/mixins/widgetAxes","chart/widgetFramework/core/mixins/widgetScales","util/Functional","chartutil/d3utils"],function(m,c,g,f,d,h,e,b,l,i,a,k){var j=function(t,o){var q;
var s={};var p=g.defaults(t,s);q=h(p,o);var u=e(q);q.dataSpecificCountProperty="count";q.dataSpecificRateProperty="rate";
q.dataSpecificCountThresholdProperty="countThreshold";q.dataSpecificRateThresholdProperty="rateThreshold";q.init=function(){u.init();
this.barUtils.delayTime=1000;};q.calibrateXScale=function(){var v;g.each(this.dimensionsXArray,function(w){if(w==="currentRate"){v=i.getDomainFromDataExtremes(q.data,"rateLimit");
}else{v=i.getDomainFromDataExtremes(q.data,"countLimit");}v[0]=0;q.scales[w].domain(v);});};q.calibrateYScale=function(){this.scales[this.options.yAttr].domain([q.dataSpecificRateProperty,q.dataSpecificCountProperty]);
};q.renderData=function(){if(a.falsy(this.data)){this.hideCharts("no data to display");return;}var z=this.dimensionsXArray[0],L=this.dimensionsXArray[1],H=this.scales[z],J=this.scales[L];
var G=this.chartGroup.selectAll(".area-rect").data(this.data.areaData,function(O){return O.areaType;});var A=G.enter().append("g").attr("class",function(O){return"area-rect";
}).append("rect").attr("class",function(O){return O.areaType;}).attr("fill-opacity",0.000001).attr("x",function(O){return H(O.start);
}).attr("y",0).attr("width",function(O){return H(O.width);}).attr("height",this.height);var N=G.transition().delay(500).duration(500).select("rect").attr("x",function(O){return H(O.start);
}).attr("width",function(O){return H(O.width);}).attr("fill-opacity",1);var D=this.barUtils.containerBarsHorizontal(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),this.barPositioningFn,true);
var B=D.bars.update.transition().delay(this.barUtils.delayTime);B.select("rect").attr("class",function(P){var O="";if(P.count>P.threshold||P.rate>P.threshold){O=" excess";
}return"bar-"+P.barType+O;}).attr("width",function(O){if(O.barType===q.dataSpecificCountProperty){return H(O.count);}if(O.barType===q.dataSpecificRateProperty){return J(O.rate);
}});var E=D.bars.enter.append("rect").attr("height",this.barSize).attr("width",function(O){return 0;}).attr("class",function(P){var O="";
if(P.count>P.threshold||P.rate>P.threshold){O=" excess";}return"bar-"+P.barType+O;}).transition().delay(this.barUtils.delayTime).attr("width",function(O){if(O.barType===q.dataSpecificCountProperty){return H(O.count);
}if(O.barType===q.dataSpecificRateProperty){return J(O.rate);}});var F=this.chartGroup.selectAll(".marker").data([this.data],function(O){return O.programName;
});var I=F.enter().append("g").attr("class","marker");var w=I.append("line").attr("y1",0).attr("y2",0);n(I,H,this.dataSpecificCountThresholdProperty,-3);
n(I,J,this.dataSpecificRateThresholdProperty,this.height+11,"%");var v=F.transition().delay(1300).duration(500);var K=v.select("line").attr("x1",function(O){return J(O.rateThreshold);
}).attr("x2",function(O){return J(O.rateThreshold);}).attr("y2",this.height);var y=r(v,H,this.dataSpecificCountThresholdProperty);
var x=r(v,J,this.dataSpecificRateThresholdProperty,"%");var C,M;if(y){C="."+z+" .tick text";M=this.$el.find(C);c(M[0]).css("fill-opacity","0");
}if(x){C="."+L+" .tick text";M=this.$el.find(C);c(M[0]).css("fill-opacity","0");}};var n=function(A,w,y,x,v){var z=A.append("text").attr("class","marker-text "+y).attr("fill-opacity",0.000001).attr("x",function(C){var B=w(C[y]);
return B;}).attr("y",x);};var r=function(w,y,z,x){var v=false;var B=".marker-text."+z;var A=w.select(B).attr("fill-opacity",1).attr("x",function(D){var C=y(D[z]);
if(C<17){v=true;}return C;}).text(function(D){var C=D[z];if(x!=="%"){return k.numberFormatter(C);}return C+x;});return v;
};q.getData=function(){return this.data.barData;};return q;};return j;});define("chart/widgetFramework/composed/ecpReport/ecpChargebackView",["jqueryExtended","underscore","d3","chart/widgetFramework/core/mixins/widgetScales","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/WidgetConstants","util/ObjectSuper","chart/widgetFramework/chartTypes/chargebackBarView","chart/widgetFramework/core/constants/DataConstants","chartutil/dateUtils_CET"],function(c,j,l,k,a,g,e,h,i,f,b){var d=function(s,m,q,o){var p;
var r={};var n=j.defaults(r,s);p=i(n,m);var t=h(p);p.feedData=function(v){var u=j.filter(v.chartData,function(w){return w.programName===p.options.dataSubset;
});if(!a.existy(u[0])){return f.HALT_RENDER_PROCESS;}this.data=u[0];this.masterData=j.cloneDeep(this.data);};p.feedBarData=function(z,y,x){var v=this.getData();
var A=j.find(v,"barType","count");A.count=z.count;var u=j.find(v,"barType","rate");u.rate=z.rate;this.barUtils.delayTime=0;
this.render();var w=b.getUserFriendlyDate(z.dateStr);this.$el.parent().find(".bar-title-date").text(w);w=b.getUserFriendlyDate(z.countStartDate)+" & "+b.getUserFriendlyDate(z.countEndDate);
this.$el.parent().find(".sub-title-date").text(w);};p.resetBarData=function(w){this.data.barData=j.cloneDeep(this.masterData.barData);
this.render();this.barUtils.delayTime=1000;var v=this.$el.parent().find(".bar-title-date");v.text(v.attr("data-date"));var u=this.$el.parent().find(".sub-title-date");
u.text(u.attr("data-daterange"));};return p;};return d;});define("chart/widgetFramework/composed/microBundle/microBundleMediator",["jqueryExtended","lodash","chart/widgetFramework/core/BasicMediator","util/Implement","d3"],function(d,g,f,b,i){var a=function(j){this.timelineInstances=[];
this.actionCommanderInstances=[];this.tooltipInstances=[];this.$allTimelines=j.__$node.find("[data-widget*=Timeline]");this.$allTooltips=j.__$node.find("[data-widget*=Tooltip]");
this.$actionCommanders=j.__$node.find("[data-widget*=ActionCommander]");f.apply(this,arguments);this.totalDomElements=this.$allFetchers.length+this.$allFormatters.length+this.$allCharts.length+this.$allTimelines.length+this.$actionCommanders.length+this.$allTooltips.length;
};a.prototype.setActionCommander=function(j){this.actionCommander=j;};a.prototype.getWidgets=function(){this.getWidgetInstances(this.$actionCommanders,this.actionCommanderInstances,"ActionCommander");
this.getWidgetInstances(this.$allTimelines,this.timelineInstances,"Timelines");this.getWidgetInstances(this.$allTooltips,this.tooltipInstances,"Tooltips");
};a.prototype.setUpOwnEvents=function(k){var j=this;f.prototype.setUpOwnEvents.call(this,k);if(this.allInstances.length-1!==this.totalDomElements){return;
}g.each(this.actionCommanderInstances,function(l){l.pushAllInstances(j.chartInstances.concat(j.timelineInstances).concat(j.fetcherInstances).concat(j.tooltipInstances));
});};a.prototype.onNotifiedFetcher=function(k,j){};a.prototype.mediatorReady=function(){f.prototype.mediatorReady.call(this);
var k={identifierStyles:h,status:c};g.each(this.formatterInstances,function(l){if(!l.options){l.options={};}g.extend(l.options,{styles:k});
});var j=g.findWhere(this.fetcherInstances,{id:"microShopperData"});if(j){j.fetchData();}};a.prototype.onNotifiedViewCreator=function(l,k){var n=l.changeObject;
var j;var m=n.data;d(".force-directed").height(d(".bundle-layout").height());if(n.message==="highlightSelectedLinkingIdentifiers"&&k==="oilsplash"){j=g.findWhere(this.chartInstances,{id:"fd1"}).chart;
j.highlightLinkingIdentifiers(m);}else{if(n.message==="reset"&&k==="oilsplash"){j=g.findWhere(this.chartInstances,{id:"fd1"}).chart;
j.resetHighlighting();}else{if(n.message==="highlightSelectedLinkingIdentifiersWhenNodesAreClicked"&&k==="oilsplash"){j=g.findWhere(this.chartInstances,{id:"fd1"}).chart;
j.resetHighlighting();j.highlightLinkingIdentifiers(m);}}}d("#microBundleSpinner").hide();};a.prototype.onNotifiedFormatter=function(k,j){};
var e="shopper-dna";var h=[{type:"pspref",textName:"PSP Reference",header:"PSP Reference",symbol:"circle",className:e+"-node-pspref-value",colorfill:"#e0e9ee",colorline:"#c2cbd0",text:"C",status:"normal",count:0,yOffset:12},{type:"HashedCardNumber.value",textName:"Card Number",header:"Card Number",symbol:"circle",className:e+"-node-hashedcardnumber-value "+e+"-node-cardnumber-value",colorfill:"#e0e9ee",colorline:"#c2cbd0",text:"C",status:"normal",count:0,yOffset:24},{type:"HolderName.text",textName:"Holder Name",header:"Holder Name",symbol:"circle",className:e+"-node-holdername-text",colorfill:"#d5fced",colorline:"#b9d7cb",text:"H",status:"normal",count:0,yOffset:48},{type:"IPAddress.ip",textName:"IP Address",header:"IP Address",symbol:"circle",className:e+"-node-ipaddress-ip",colorfill:"#ddefcb",colorline:"#bcdb9b",text:"I",status:"normal",count:0,yOffset:72},{type:"ShopperAddress.text",textName:"Shopper Address",header:"Shopper Address",symbol:"circle",className:e+"-node-shopperaddress-text",colorfill:"#d5fced",colorline:"#b9d7cb",text:"A",status:"normal",count:0,yOffset:96},{type:"ShopperEmail.email",textName:"Shopper Email",header:"Shopper Email",symbol:"circle",className:e+"-node-shopperemail-email",colorfill:"#f1e5c2",colorline:"#d9cca8",text:"E",status:"normal",count:0,yOffset:120},{type:"ShopperReference.text",textName:"Shopper Reference",header:"Shopper Reference",symbol:"circle",className:e+"-node-shopperreference-text",colorfill:"#d5fced",colorline:"#b9d7cb",text:"R",status:"normal",count:0,yOffset:144}];
var c=[{journaltypes:["Authorised","Received","Settled","SettledBulk","SettledExternally","SettledExternallyWithInfo","SettledinInstalments","SettledInstalments"],header:"Authorised/Settled",name:e+"-node-authorised",symbol:"square",className:e+"-node-authorised",count:0,amount:0,opacity:1,yOffset:54},{journaltypes:["Refused"],header:"Refused",name:e+"-node-refused",symbol:"square",className:e+"-node-refused",count:0,amount:0,opacity:1,yOffset:78},{journaltypes:["Cancelled"],header:"Cancelled",name:e+"-node-cancelled",symbol:"square",className:e+"-node-cancelled",count:0,amount:0,opacity:1,yOffset:102},{journaltypes:["Refunded","RefundedBulk","RefundedExternally","RefundedExternallyWithInfo","SentForRefund"],header:"Refunded",name:e+"-node-refunded",symbol:"square",className:e+"-node-refunded",count:0,amount:0,opacity:1,yOffset:126},{journaltypes:["Chargeback","ChargebackExternally","ChargebackExternallyWithInfo","ChargebackReversed","ChargebackReversedExternallyWithInfo"],header:"Chargeback",name:e+"-node-chargeback",symbol:"square",className:e+"-node-chargeback",count:0,amount:0,opacity:1,yOffset:150}];
b.fromTo(f,a);return a;});define("chart/widgetFramework/composed/baseline/BaselineSessionsAggMediator",["jqueryExtended","lodash","d3","chart/widgetFramework/core/BasicMediator","util/ObjectSuper","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/core/constants/DataConstants","util/Functional","chartutil/cssutils"],function(a,j,l,i,g,h,f,d,k){var c=false;
var e=false;var b=function(m){var n;n=i(m,true);var o=g(n);n.init=function(){o.init();this.actionCommanderExclusionArray=["actioncommander","viewcreator","timeline"];
};n.getAdditionalDOMElements=function(){o.getAdditionalDOMElements();};n.getWidgets=function(){o.getWidgets();};n.onNotifiedFetcher=function(q,p){o.onNotifiedFetcher(q,p);
};n.onNotifiedFormatter=function(t,r){o.onNotifiedFormatter(t,r);if(r==="sessionsAggregateDataFormatter"){if(t.changeObject.type===f.SORTED_DATA){var u=this.$sortButtonRef.find(".arrow")[0];
var s=this.getInstanceById("#sessionsAggregateDataFormatter");var w=s.getSortDirection();var v=(w)?180:0;var q=(w)?0.5:0;
var p=(w)?0.5:0;k.rotateElement(u,v,q,p);}}};n.onNotifiedViewCreator=function(s,q){o.onNotifiedViewCreator(s,q);var p=s.changeObject;
var r=p.type;};n.getInstance=function(){return this;};n.sortData=function(p,q){this.$sortButtonRef=q;};n.init();m.ready();
return n;};return b;});define("chart/widgetFramework/composed/ecpReport/ecpActions",["jqueryExtended","underscore"],function(c,a){var d=c;var b={actions:[{source:"ecpAcquirer",event:"change",target:["ecpDataFetcher","ecpMediator"],callMethod:"fetchNewDataAction",getterMethod:function(e){var f=e.val();
return{acquirerCode:f};}},{source:"[data-id=ecpInfo]",event:"click",lazySelector:".chart-info-btn",target:"#ecpMediator",callMethod:"onInfo",getterMethod:function(f){var e=f.attr("data-rel");
return{sender:f,target:e};}}]};return b;});define("chart/widgetFramework/core/uiComponentsFetcher",["jquery","underscore"],function(c,a){var b=function(e,d,g){var f={};
f.init=function(){var h=this.parseOptions();this.fetchComponents(h,g);};f.parseOptions=function(){var i=[];for(var j in e){if(e.hasOwnProperty(j)){var h=e[j];
if(h&&a.has(h,"type")){i.push({name:h.type,options:h,type:j});}}}return i;};f.fetchComponents=function(h){var j=a.map(h,function(k){return k.name;
});var i=[];require(j,function(){for(var l=0;l<arguments.length;l++){var k=(arguments.length>1)?this[l].amdName:this.amdName;
var m=a.findWhere(h,{name:k});if(m&&m.options){i.push({name:k,module:arguments[l],options:m.options,type:m.type});}}if(!a.isEmpty(i)){g(i);
}},function(k){window.console.log("error: ",k);});};f.init();return f;};return b;});define("chart/widgetFramework/composed/riskReport/views/receivedTxCountStackedView",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/chartTypes/stackedBar"],function(c,g,j,b,e,a,f,i,h){var d=function(n,p,s,r){var o,q,k;
var l={};var t=g.defaults(l,n);o=h(t,p,s);var m=f(o);o.renderYAxis=function(){m.renderYAxis();};o.renderData=function(){m.renderData();
if(c("#issuerCountry").val()!==""){this.hideCharts("no data to display: it is not possible to filter this data by Issuer Country");
return;}if(a.falsy(this.data)){if(c("#issuerCountry").length===0||c("#issuerCountry").val()===""){this.hideCharts("no data to display");
return;}}o.renderReceivedTxLabels();};o.init=function(){m.init();};o.renderReceivedTxLabels=function(){var v=g.last(this.data);
var u=this.scales[this.options.yAttr];var w=function(y){var x=v.rates[y].startY;var A=v.rates[y].endY;var z=((A-x)/2)+x;var B=u(z);
return B;};if(!q&&!k){q=this.chartGroup.append("text").attr("class","rev-protect").text("Routed through RevenueProtect").attr("dy",".35em");
k=this.chartGroup.append("text").attr("class","guaranteed-pm").text("Guaranteed payment method").attr("dy",".35em");}if(this.data.length>1){q.attr("x",this.width+20);
k.attr("x",this.width+20);}else{q.attr("x",t.width-260);k.attr("x",t.width-260);}if((w(0)-20)<w(1)){q.attr("y",(w(0)+15));
}else{q.attr("y",w(0));}k.attr("y",w(1));};return o;};return d;});define("chart/widgetFramework/composed/cardAcquirerAuthorizationReport/formatters/masterDataFormatter",["jqueryExtended","underscore","util/Functional","chartutil/stringutils","d3"],function(f,b,c,e,d){function a(j,g,i,k){var h={};
h.data=j;h.options=g;h.formattedData={};h.comparator=null;h.timeline=i;h.id=k;h.formatData=function(){var l=this.data?this.data:{};
this.formattedData=l;this.formattedData.acquirer_colors=h.createColors(h.findAcquirers(l.acquirer_time));if(window.console&&console.log){console.log("### master data Formater ID::"+this.id+" formatData:: this.formattedData=",this.formattedData);
}return this.formattedData;};h.findAcquirers=function(m){var n=b.pluck(m,"acquirer");n=b.uniq(n);n=b.filter(n,function(o){return o!=="RefusedAcquirer";
});for(var l=0;l<n.length;l++){n[l]=e.lowerCaseReplaceSpace(n[l]);}return n;};h.createColors=function(s){var l={};var m=s.filter(function(t){return/^adyen/.test(t);
});m.sort();if(m.length>0){var p=d.scale.linear().range(["#004E00","#007100","#1C9516","#6AB466","#A1D3A1"].reverse()).domain(d.range(0,1,1/(5-1)).concat(1));
var r=d.scale.ordinal().domain(m).range(d.range(0,1,1/(m.length-1)).concat(1));m.forEach(function(t){l[t]=p(r(t));});}var q=s.filter(function(t){return !(/^adyen/.test(t));
});q.sort();if(q.length>0){var o=d.scale.linear().range(["#0d4f74","#2f6b93","#5388ae","#79a6c4","#a3c4d9"].reverse()).domain(d.range(0,1,1/(5-1)).concat(1));
var n=d.scale.ordinal().domain(q).range(d.range(0,1,1/(q.length-1)).concat(1));q.forEach(function(t){l[t]=o(n(t));});}l.overall="#1e1e1e";
l.average="#1e1e1e";return l;};h.compareFunction=function(l){return l[this.sortKey];};h.getData=function(){return(this.data)?this.data:this.formatData();
};h.setRawData=function(l){this.data=l;};h.retrieveData=function(l){return this.data[l];};return h;}return a;});define("chart/widgetFramework/chartTypes/brushableBarChart",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/core/constants/WidgetConstants","chart/widgetFramework/core/drivers/axisBaseView"],function(d,j,l,c,f,b,g,k,i,e,a){function h(r,m,p){var o;
var q={numBars:10};var n=j.defaults(r,q);o=a(n,m,p);var s=g(o);o.init=function(){s.init();if(typeof this.options.allowScrolling==="undefined"){this.options.allowScrolling=true;
}this.options.outerPadding=0;if(this.options.numBars<=0){this.options.numBars=q.numBars;}};o.renderData=function(){if(b.falsy(this.data)){this.hideCharts("no data to display");
return;}if(o.data.length>this.options.numBars){var w=this.scales[this.options.xAttr],u=this.scales[this.options.yAttr];var t;
if(this.options.variation===e.VERTICAL){t=this.barUtils.containerBarsVertical(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),this.barPositioningFn,true).barVertical(this.options.yAttr,u,this.barSize);
}else{t=this.barUtils.containerBarsHorizontal(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),this.barPositioningFn,true).barHorizontal(this.options.xAttr,w,this.barSize);
}this.axisGroup.remove();l.select("#"+this.$el[0].id).style("display","inline");if(this.options.allowScrolling){var v=l.behavior.zoom().on("zoom",null);
o.mainGroup.call(v).on("wheel.zoom",function(){o.scrollOrdinal();}).on("mousedown.zoom",null).on("touchstart.zoom",null).on("touchmove.zoom",null).on("touchend.zoom",null);
}o.zoomScale=l.scale.linear().range([0,o.options.height-o.options.margin.top-o.options.margin.bottom]).domain([0,o.options.height-o.options.margin.top-o.options.margin.bottom]);
o.brush=o.addBrush();}else{l.select("#"+this.$el[0].id).style("display","none");}};o.setBandSizes=function(){this.barSize=this.vertBarSize=o.scales[o.options.yAttr].rangeBand();
this.bandSize=this.barSize*(1+o.options.barPadding);};o.sortData=function(t){this.$el[0].__axisHorizontal.graphOptions.dimension=t;
};o.addBrush=function(){o.chartGroup.select("g.brush").remove();var w=o.scales[o.options.xAttr],v=o.scales[o.options.yAttr];
var x;if(o.data.length<=this.options.numBars){x=o.data.length;}else{x=Math.min(16,Math.max(this.options.numBars,Math.round(o.data.length*0.2)));
}x=x-1;var t;if(o.options.variation==="horizontal"){if(o.options.yScale==="ordinal"){t=v.range().concat().sort(function(z,y){return z-y;
});o.brushExtent=o.brushExtent||[t[0],t[x]];o.brush=l.svg.brush().y(v).extent(o.brushExtent).on("brush",function(){o.brushmoveOrdinal();
}).on("brushend",function(){o.brushendOrdinal();});}else{t=v.domain().concat().sort(function(z,y){return z-y;});o.brushExtent=o.brushExtent||[t[0],t[x]];
o.brush=l.svg.brush().y(v).extent(o.brushExtent).on("brush",function(){o.brushmoveQuantitative();}).on("brushend",function(){o.brushendQuantitative();
});}}else{if(o.options.xScale==="ordinal"){t=w.range().concat().sort(function(z,y){return z-y;});o.brushExtent=o.brushExtent||[t[0],t[x]];
o.brush=l.svg.brush().x(w).extent(o.brushExtent).on("brush",function(){o.brushmoveOrdinal();}).on("brushend",function(){o.brushendOrdinal();
});}else{t=w.domain().concat().sort(function(z,y){return z-y;});o.brushExtent=o.brushExtent||[t[0],t[x]];o.brush=l.svg.brush().x(w).extent(o.brushExtent).on("brush",function(){o.brushmoveQuantitative();
}).on("brushend",function(){o.brushendQuantitative();});}}o.gBrush=o.chartGroup.append("g").attr("class","brush").call(o.brush);
var u;if(o.options.variation==="horizontal"){u=o.options.width-o.options.margin.left-o.options.margin.right;o.gBrush.selectAll(".resize").append("line").attr("x2",u);
o.gBrush.selectAll(".resize").append("path").attr("d",l.svg.symbol().type("triangle-up").size(20)).attr("transform",function(z,y){return y?"translate("+(u/2)+","+4+") rotate(180)":"translate("+(u/2)+","+-4+") rotate(0)";
});o.gBrush.selectAll("rect").attr("width",u);if(o.options.yScale==="ordinal"){o.gBrush.select(".background").on("mousedown.brush",function(){o.brushcenterOrdinal();
});}}else{u=o.options.height-o.options.margin.top-o.options.margin.bottom;o.gBrush.selectAll(".resize").append("line").attr("y2",u);
o.gBrush.selectAll(".resize").append("path").attr("d",l.svg.symbol().type("triangle-up").size(20)).attr("transform",function(z,y){return y?"translate("+-7+","+u/2+") rotate(-90)":"translate("+7+","+u/2+") rotate(90)";
});o.gBrush.selectAll("rect").attr("width",u);if(o.options.xScale==="ordinal"){o.gBrush.select(".background").on("mousedown.brush",function(){o.brushcenterOrdinal();
});}}o.startBrush();return o.brush;};o.startBrush=function(){if(o.gBrush){o.gBrush.call(o.brush.event);}};o.brushmoveOrdinal=function(){var y,u,t;
if(o.options.variation==="horizontal"){y=o.scales[o.options.yAttr];u=o.options.yAttr;}else{y=o.scales[o.options.xAttr];u=o.options.xAttr;
}var w=o.brush.extent();var v=y.domain().filter(function(A){return(w[0]-y.rangeBand()+0.01<=y(A))&&(y(A)<=w[1]-0.01);});o.chartGroup.selectAll(".bar").select("rect").classed({"brush-selected":false,"brush-unselected":true}).filter(function(A){return v.indexOf(A[u])>-1;
}).classed({"brush-selected":true,"brush-unselected":false});var x=o.zoomScale.range();o.zoomScale.domain(w);var z=[o.zoomScale(x[1]),o.zoomScale(x[0])];
this.$el.trigger(i.CHART_TO_VIEW_EVENT,{type:"brushableBarChartData",data:{newScale:z,selected:v,numSelected:v.length}});
};o.brushcenterOrdinal=function(){var A=(o.options.variation==="horizontal"?o.scales[o.options.yAttr]:o.scales[o.options.xAttr]);
var z=l.event.target,y=o.brush.extent(),x=y[1]-y[0],w=A.range(),v=l.min(w)+x/2,u=l.max(w)+A.rangeBand()-x/2,t=Math.max(v,Math.min(u,l.mouse(z)[1]));
l.event.stopPropagation();o.gBrush.call(o.brush.extent([t-x/2,t+x/2])).call(o.brush.event);};o.brushmoveQuantitative=function(){};
o.brushendOrdinal=function(){};o.brushendQuantitative=function(){};o.scrollOrdinal=function(A){A=A?A:(o.options.variation==="horizontal"?l.event.deltaY:l.event.deltaX);
var z=(o.options.variation==="horizontal"?o.scales[o.options.yAttr]:o.scales[o.options.xAttr]);var y=o.brush.extent(),w=y[1]-y[0],v=z.range(),u=l.min(v),t=l.max(v)+z.rangeBand(),x;
if(y[0]-A<u){x=u;}else{if(y[1]-A>t){x=t-w;}else{x=y[0]-A;}}l.event.stopPropagation();l.event.preventDefault();o.gBrush.call(o.brush.extent([x,x+w])).call(o.brush.event);
};return o;}return h;});define("chart/widgetFramework/composed/cardAcquirerAuthorizationReport/brushBarChart",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/chartTypes/brushableBarChart"],function(d,i,k,c,e,b,f,j,h,g){function a(q,l,o){var n;
var p={};var m=i.defaults(p,q);n=g(m,l,o);var r=f(n);n.init=function(){r.init();n.newRankedVariable="authorizationRate";};
n.initRender=function(){r.initRender();};n.renderData=function(){r.renderData();var s=n.el.id;s=s.replace("composed/cardAcquirerAuthorizationReport/","");
s=s.replace("BrushBarChart","");if(b.notFalsy(this.data)&&n.data.length<=10){k.select("#"+s+"BrushExplanation").style("display","none");
}else{k.select("#"+s+"BrushExplanation").style("display","inline");}};n.sortData=function(s){n.newRankedVariable=s;if(s!=="labelName"){r.sortData(s);
}};n.brushmoveOrdinal=function(){r.brushmoveOrdinal();var s=n.newRankedVariable;n.chartGroup.selectAll(".bar").select("rect").style("fill",null);
if(s==="labelName"){n.chartGroup.selectAll(".bar .brush-selected").style("fill","#A9D8A8");}};return n;}return a;});var console=console;define("chartlib/linechart2",["jquery","underscore","backbone","chartlib/basicChart","d3"],function(e,b,f,a,c){var d=a.extend({pathDelimiter:"L",pathAdjustDirection:0,allowToggleLine:true,initRender:function(){this._super(arguments);
this.xAxis.attr("transform","translate(0, -10)");},setXScale:function(){this.scales.x=c.scale[this.options.xScale]().range([0,this.width]);
},calibrateXScale:function(){this.scales.x.domain(c.extent(b.pluck(this.collection.scaleDataArray,this.options.xAttr)));},setYScale:function(){this._super();
this.scales.y.rangeRound([this.height,0]);},calibrateYScale:function(){var i=this;var h=c.min(this.collection.models,function(j){return c.min(j.get(i.options.yAttr),function(k){return k.rate.value;
});});var g=c.max(this.collection.models,function(j){return c.max(j.get(i.options.yAttr),function(k){return k.rate.value;
});});this.scales.y.domain([h,g]);this.scales.y.nice();},setXAxis:function(){this._super(arguments);this.axes.x.tickSize((-this.height-10),0).ticks(0);
},formatXAxis:function(){},renderXAxis:function(){var h=this.axes.x,j=this.collection.granularity,k="wk ",g=this;var i=this.scales.x.ticks(c.time[j+"s"],1).length;
if(i>90&&j==="day"){j="month";}if(i>42&&j==="week"){j="month";}if(i>25&&j==="week"){k="";}h.ticks(c.time[j+"s"],1).tickFormat(function(n,l){if(j==="week"){return(l>0)?k+n.getWeek(true):n.getFullYear()+" wk "+n.getWeek(true);
}var m=(l>0)?c.time.format(g.granularityFormats[j]):c.time.format(g.granularityFormats[j+"_start"]);return m(n);});this._super();
this.xAxis.selectAll(".tick").select("text").attr("transform",function(n,m){var l=(m===0)?-11:0;return"translate("+l+",7)";
});},renderYAxis:function(){this._super();this.yAxis.selectAll(".tick").select("text").attr("transform",function(j,g){var h=(g===0)?-3:0;
return"translate(0,"+h+")";});},lineCreator:function(q,i,l){var u,k,o;if(l){u=l.attr("d");}if(u){k=u.split(this.pathDelimiter);
var j=q.length;o=k.length;if(j>o){i="mixin";}else{return u;}}var p=this.scales.x;var n=this.scales.y;var h=c.svg.line().interpolate("linear").x(function(v){return p(v.date);
});if(i==="enter"){h.y(function(v){return 0;});}else{if(i==="update"){h.y(function(v){return n(+v.rate.value);});}else{if(i==="mixin"){h.y(function(v){return 0;
});var t=h(q);var s=t.split(this.pathDelimiter);var r=b.drop(s,o);var m=k.concat(r);var g=m.join(this.pathDelimiter);l.style("opacity",0);
return g;}}}return h(q);},mockJoinData:function(j,h){var g=this.options.joinAttr;if(g&&j instanceof f.Model){return j.get(g);
}else{if(g&&b(j).has(g)){return j[g];}else{return h;}}},renderData:function(){var m=this,r=this.scales.x,p=this.scales.y,h=[],q=500,g,n;
var t=this.svg.selectAll(".chart-program").data(this.collection.models,this.joinData);var l=t.enter().append("g").attr("class",function(u){g=m._getDatumValue(u,"name");
n=m.getClassName(g);return"chart-program "+n;}).append("path").attr("class","line");t.select(".line").attr("d",function(u){return m.lineCreator(u.get(m.options.yAttr),"enter",c.select(this));
}).transition().duration(q).ease("exp-in-out").style("opacity",1).attr("d",function(u){return m.lineCreator(u.get(m.options.yAttr),"update");
});var o=t.selectAll(".chart-program-dot").data(function(u){return u.get(m.options.yAttr);});var s=o.enter().append("circle").attr("class",function(u){n=m.getClassName(u.rate.name);
return"chart-program-dot "+n;}).attr("cx",function(u){return r(u.date);}).attr("cy",function(u){return 0;}).attr("r",3).on("mouseover",function(u){m.showTooltip(u,this,false);
}).on("mouseout",function(u){m.hideTooltip(false);});o.transition().duration(q).ease("exp-in-out").attr("cx",function(u){return r(u.date);
}).attr("cy",function(u){return p(u.rate.value);}).style("opacity",1);var j=o.exit().transition().duration(q).attr("cy",function(u){return m.height+10;
}).style("opacity",0).remove();var k=this.svg.selectAll(".chart-program-label").data(this.collection.models);k.enter().append("text").attr("class",function(u){this.masterD=u;
g=m._getDatumValue(u,"name");n=m.getClassName(g);return"chart-program-label "+n;}).style("cursor",function(u){if(m.allowToggleLine){e(this).attr("data-col",e(this).css("fill"));
return"pointer";}else{return"auto";}}).attr("x",m.width+10).attr("dy",".35em").attr("y",0).on("mousedown",function(u){if(m.allowToggleLine){m.toggleLine(this.masterD,this,m);
}else{return null;}}).text(function(u){if(m.allowToggleLine){return m.getLabel(u)+" \u2611";}else{return m.getLabel(u);}});
k.datum(function(u){g=m._getDatumValue(u,"name");return{name:g,value:u.get(m.options.yAttr)[u.get(m.options.yAttr).length-1].rate.value};
}).transition().duration(q).attr("y",function(u){return m.checkLabelPos(p(u.value),h);});var i=k.exit().transition().duration(q).attr("y",m.height+10).style("opacity",0).remove();
},checkLabelPos:function(g,j){var l=this;var m=j.length;for(var k=0;k<m;k++){var h=j[k];var n=Math.floor(h-g);if(this.pathAdjustDirection===0){if(n<0){this.pathAdjustDirection=1;
}else{this.pathAdjustDirection=-1;}}var o=5*this.pathAdjustDirection;var p=n;if(p<0){p*=-1;}if(p<12){g+=o;return l.checkLabelPos(g,j);
}}this.pathAdjustDirection=0;j.push(g);return g;},getClassName:function(g){var h=g.toLowerCase().replace(" ","");return h;
},getLabel:function(g){return this._getDatumValue(g,"name");},toggleLine:function(m,j,i){var h=e(j).attr("class");var g=h.match(/\s(.*)/)[1];
if(g.length){var l=this.$(".chart-program."+g);var k=l.css("display");if(k==="inline"){l.fadeOut(250);e(j).text(i.getLabel(m)+" \u2610");
e(j).fadeTo(250,0.5,function(){e(j).css("fill","#ccc");});}else{if(k==="none"){l.fadeIn(250);e(j).text(i.getLabel(m)+" \u2611");
e(j).css("fill",e(j).attr("data-col"));e(j).fadeTo(250,1);}}}}});return d;});define("chart/widgetFramework/composed/riskReport/formatters/chargebackRateLineFormatter",["jqueryExtended","underscore","d3","chartutil/d3utils","util/Functional","chartutil/dateUtils_CET","chart/widgetFramework/core/constants/DataConstants","chartutil/domUtils","chartutil/stringutils"],function(a,h,i,j,c,e,f,g,d){var b=function(n,k,m,o){var l={};
l.data=n;l.options=k;l.formattedData={};l.comparator=null;l.reverseDirection=false;l.sortKey=null;l.timeline=m;l.id=o;l.formatData=function(){var t=this.data.overall_statistics;
var r={},p;if(c.falsy(t)){return[];}if(h.isArray(t)){var q=t;var w=this.timeline.getGranularity();var s=this.timeline.getDates();
var u=1;var v=new Date(s[1].getFullYear(),s[1].getMonth(),s[1].getDate()-u);p=this.parseDates(q,w,[s[0],v]);}this.formattedData=this.calculateMetaData(p);
if(this.sortKey){this.reverseDirection=!this.reverseDirection;this.sortData(this.sortKey,true);}if(window.console&&console.log){console.log("\n### chargebackRateLineFormatter::formatData:: this.formattedData=",this.formattedData);
}return{config:r,chartData:this.formattedData};};l.calculateMetaData=function(q){var p=[];h.each(q,function(s){var r=(s.authorisedCount>0)?s.chargebackCount/s.authorisedCount:0;
p.push({date:s.date,value:r*100,name:s.dateStr});});return[{name:"Chargeback",lineValues:p}];};l.parseDates=function(p,r,q){h.map(p,function(t){t.dateStr=t.date;
var s=new Date(t.dateStr);t.date=e.trueRoundToDay(s,true);});return p;};l.sortData=function(p,r){this.sortKey=p;this.reverseDirection=!this.reverseDirection;
var q=h.sortBy(this.formattedData,p);if(this.reverseDirection){q.reverse();}this.formattedData=q;if(r===true){return;}this.$el.trigger(f.FORMATTER_INFORM_WIDGET,{type:f.SORTED_DATA,data:this.formattedData});
};l.compareFunction=function(p){return p[this.sortKey];};l.downloadCSV=function(){var r=this.createObjectForCSV();var p=["dateStr","chargebackPercent"];
var q=["Date","Chargeback (%)"];g.createCSV(r,p,q,"ChargebackRate");};l.createObjectForCSV=function(){var r=i.format(",.4f");
var t=this.formattedData;var q=t.length;var p=h.cloneDeep(t[0].lineValues);var s=d.camelCase(t[0].name);p=h.map(p,function(u){var v={dateStr:u.name};
v[s+"Percent"]=+r(u.value);return v;});return p;};l.getData=function(){return(this.data)?this.data:this.formatData();};l.setRawData=function(p){this.data=p;
};l.retrieveData=function(p){return this.data[p];};l.setOptions=function(p){this.options=p;};return l;};return b;});define("chart/widgetFramework/composed/transactionsDashboard/views/granularXAxisCode",["jquery","underscore","d3","util/Functional"],function(e,b,d,c){var a=function(f){f.setGranularity=function(g){this.granularity=g;
};f.formatXAxis=function(){this.formatTimeXAxis(this.options.xAttr);};f.formatTimeXAxis=function(j){var h=this.axes[j],i=(!this.granularity)?this.configData.granularity:this.granularity,k="wk ",g=this.scales[j].ticks(d.time[i],1).length;
if(i==="week"&&this.timeline.timelineData.getValue("mondayWeek")){i="monday";}if(g>40){i="month";}h.ticks(d.time[i],1).tickFormat(function(n,l){if(i==="week"||i==="monday"){return(l>0)?k+n.getWeek(true):n.getFullYear()+" wk "+n.getWeek(true);
}var m;if(l>0){m=f.granularityFormats[i];}else{if(g>25&&i==="day"){m=f.granularityFormats[i];}else{m=f.granularityFormats[i+"_start"];
}}return m(n);});};return f;};return a;});define("chart/widgetFramework/composed/transactionsDashboard/views/granularAuthRateLine",["jquery","underscore","chart/widgetFramework/core/mixins/formats","util/ObjectSuper","chartutil/stringutils","d3","chart/widgetFramework/core/constants/UIConstants","util/Functional","chart/widgetFramework/chartTypes/lineChart","chart/widgetFramework/composed/transactionsDashboard/views/granularXAxisCode"],function(b,i,f,h,e,k,c,d,a,j){function g(r,l,o){var q="Default Line Name";
var n;var p={};var m=i.defaults(p,r);n=a(m,l,o);var s=h(n);j(n);n.granularity=null;n.yScaleType="zoom";n.init=function(){s.init();
this.lineUtils.defined=function(t){return t[n.options.yAttr]!==null;};this.$avgToggle=this.$el.parent().find("#avgToggle");
};n.feedData=function(v){s.feedData(v);var u={};u[this.options.lineDataProp]="Rolling average";var t=i.find(this.data,u);
if(t.lineValues.length){this.$avgToggle.show();}else{this.$avgToggle.hide();}};n.calibrateYScale=function(){i.each(this.dimensionsYArray,function(u){var t=i.pluck(n.data[0][n.nestedAttr],n.options.yAttr);
switch(n.yScaleType){case"zoom":n.scales[u].domain([k.min(t),k.max(t)]).nice();break;case"total":n.scales[u].domain([0,100]);
break;}});};n.renderData=function(){s.renderData();if(this.granularity==="day"){var t=this.scales[this.options.xAttr].ticks(k.time[this.granularity],1).length;
if(t<32){this.$avgToggle.css("opacity",0.5);this.$avgToggle.css("pointer-events","none");if(this.$avgToggle.attr("data-state")==="avg30"){this.$el.trigger(c.CHART_TO_VIEW_EVENT,{type:"setAvgToggle",data:"avg7"});
}}else{this.$avgToggle.css("opacity",1);this.$avgToggle.css("pointer-events","all");}}};n.dropEmptyData=function(){if(this.data){var v=this.data.length;
var t=0;for(var u=0;u<v;u++){if(d.falsy(this.data[u][this.nestedAttr])){t++;}}if(t===v){this.data=[];}}};n.getLabelName=function(v){var t=this.options.lineDataProp||this.options.joinAttr||"";
var u=v[t];if(!u){u=q;}return u;};n.setScaleToggleState=function(t){var u=t;if(u===this.yScaleType){return;}this.yScaleType=t;
this.render();};return n;}return g;});define("chart/widgetFramework/composed/chargebackReport/paymentMethodBrushBarChart",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/chartTypes/brushableBarChart"],function(d,i,k,c,e,b,f,j,h,g){function a(q,l,o){var n;
var p={};var m=i.defaults(p,q);n=g(m,l,o);var r=f(n);n.init=function(){r.init();};n.initRender=function(){r.initRender();
};n.renderData=function(){r.renderData();if(n.data.length<=this.options.numBars){k.select("#paymentMethodBrushExplanation").style("display","none");
}else{k.select("#paymentMethodBrushExplanation").style("display","inline");}};n.sortData=function(s){r.sortData(s);};return n;
}return a;});(function(b,a){define("chart/WorldMap",["jquery"],function(d){function c(g,h){if(typeof console!=="undefined"&&typeof console.warn==="function"){console.warn("Loading map chart",h);
}var i=d(g),e=i.children("div:eq(0)"),f=i.children("div:eq(1)");f.css("display","block").html("<p>This is where the WorldMap should go. Including the drilldown functionality.</p>");
}return{loadChart:c};});}(window,document));define("chart/widgetFramework/composed/funnel/funnelChartRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/chartTypes/axisRollover"],function(b,g,i,a,d,f,e,c){var h=function(p,j,n,l){var m;
var o={};var k=g.defaults(o,p);m=c(k,j);var q=e(m);m.setTooltipsOnElements=function(){q.setTooltipsOnElements(true);};m.enhanceTooltipData=function(r){r.nameTT=r.journaltypecode+":";
r.text1TT="<div>"+r.description+"</div>";};m.tooltipOnMouseoverAction=function(r){this.$el.trigger(f.CHART_TO_VIEW_EVENT,{type:"funnelRolloverData",data:r});
};m.tooltipOnMouseoutAction=function(r){this.$el.trigger(f.CHART_TO_VIEW_EVENT,{type:"funnelRolloutData",data:r});};m.renderData=function(){this.barUtils.containerBarsHorizontal(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),this.barPositioningFn,true).fullBarHorizontal(this.barSize,"journaltypecode");
var r=i.select(this.el).selectAll(".bar");g.each(r[0],function(u,s){var t=i.select(u);if(t.datum()[m.options.yAttr].toLowerCase().indexOf("spacer")>-1){t.style("display","none");
}});};return m;};return h;});define("chart/widgetFramework/composed/mfpReport/mfpLineChart",["jquery","underscore","d3","hogan","util/Functional","chartutil/d3utils","chart/widgetFramework/core/mixins/formats","chartutil/stringutils","util/ObjectSuper","chart/widgetFramework/chartTypes/lineChart","chart/widgetFramework/core/constants/DataConstants"],function(d,h,k,e,a,l,c,b,g,i,f){var j=function(p,s,v,u){var r;
var q=100;var m=true;var n={delay:q};var w=h.defaults(n,p);r=i(w,s,v);var o=g(r);r.renderTickDelay=q*1.5;r.feedData=function(y){if(a.falsy(y)){if(m){m=false;
var A=a.notFalsy(this.options.nestedAttr)?this.options.nestedAttr:"lineValues";this.setNestedAttr(A,true);}return;}this.configData=y.config||{};
if(this.timeline){this.configData.granularity=this.timeline.getGranularity();}var x=h.filter(y.chartData,function(B){return B.programName===r.options.dataSubset;
});this.mainDataObj=x[0];if(!a.existy(this.mainDataObj)){this.setNestedAttr("lineValues",true);return f.HALT_RENDER_PROCESS;
}this.data=this.masterData=[{name:r.options.dataSubset,lineValues:this.mainDataObj.history}];this.setNestedAttr(this.data,true);
var z=this.data[0].lineValues;this.crossedThreshold=false;this.chartVariation="amount";if(this.$el[0].className.indexOf("tx")>-1){this.crossedThreshold=t(this.mainDataObj,this.chartVariation,z);
}else{this.chartVariation="rate";this.crossedThreshold=t(this.mainDataObj,"rate",z);}};var t=function(y,B,z){var x=y[B+"Threshold"];
var A=h.filter(z,function(C){return C[B]>x;});if(A.length){return true;}return false;};r.renderYAxis=function(){o.renderYAxis();
setTimeout(function(){var x=r.yAxesHolders[r.dimensionsYArray[0]];r.actualTicks=l.getActualTickValues(x);},this.renderTickDelay);
};r.renderData=function(){o.renderData();setTimeout(function(){if(r.crossedThreshold){var B=r.scales[r.options.yAttr];var E=r.mainDataObj[r.chartVariation+"Threshold"];
var J=B.ticks();var z=h.max(J);var I=h.max(r.actualTicks);var L=Math.max(z,I);var A=E;var D=[{start:A,lineType:"excess-line"}];
var M=r.chartGroup.selectAll(".area-line").data(D,function(N){return N.lineType;});var y=M.enter().insert("g",function(N){return r.$el.find(".line-holder")[0];
}).attr("class",function(N){return"area-line";}).append("line").attr("class",function(N){return N.lineType;}).attr("x1",0).attr("x2",0);
var C=M.transition().delay(1300).duration(500).select("line").attr("x2",r.width).attr("y1",function(N){return B(N.start)-B(L);
}).attr("y2",function(N){return B(N.start)-B(L);});}else{var K=r.chartGroup.selectAll(".area-line");K.remove();}var H=(r.chartVariation==="amount")?".tx-line-chart":".rates-line-chart";
var x=H+" .line";var F=r.chartGroup.select(x);F.classed("excess",r.crossedThreshold);x=H+" circle";var G=r.chartGroup.selectAll(x);
G.classed("excess",r.crossedThreshold);},this.renderTickDelay);};return r;};return j;});define("chart/widgetFramework/composed/cardAcquirerAuthorizationReport/countBrushBarChart",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/chartTypes/barChart"],function(c,i,k,b,f,a,g,j,h,e){function d(q,l,o){var n;
var p={};var m=i.defaults(p,q);n=e(m,l,o);var s=g(n);var r=false;n.init=function(){s.init();n.maxRowsForBrush=10;n.oldSelected=0;
var t=n.el.id;t=t.replace("composed/cardAcquirerAuthorizationReport/","");n.IDname=t.replace("RateBarChart","");};n.initRender=function(){s.initRender();
setTimeout(function(){if(!r&&n.options.ranked){n.chartGroup.classed("barchart-ranked",true);}r=true;},100);n.textScale=k.scale.linear().domain([8,50]).range([11,5]).clamp(true);
var t=n.mainGroup.append("defs");t.append("clipPath").attr("id","clip-bars-"+n.IDname).append("rect").attr("x",-n.options.margin.left).attr("width",n.options.width-n.options.margin.right).attr("height",n.options.height-n.options.margin.top-n.options.margin.bottom);
t.append("clipPath").attr("id","clip-y-axis-"+n.IDname).append("rect").attr("clipPathUnits","objectBoundingBox").attr("x","-100%").attr("width","100%").attr("height",((n.options.height-n.options.margin.top-n.options.margin.bottom)/(n.options.height)*100)+"%");
};n.render=function(){n.showCharts();if(a.notFalsy(this.data)){n.doBrush=n.data.length>n.maxRowsForBrush;}n.barUtils.transitionTime=n.doBrush?0:500;
n.barUtils.delayTime=0;var u=this.$el.width();if(!n.doBrush&&a.notFalsy(this.data)){n.height=(n.data.length*30);}else{n.height=n.options.height-(n.options.margin.top+n.options.margin.bottom);
}var t=n.height+n.options.margin.top+n.options.margin.bottom;n.topSVG.attr("width",u+"px").attr("height",t+"px");k.select("#"+n.$el[0].id).transition().duration(500).style("height",t+"px");
if(n.doBrush){n.chartGroup.attr("clip-path","url(#clip-bars-"+n.IDname+")").style("clip-path","url(#clip-bars-"+n.IDname+")");
n.axisGroup.select(".y.axis").attr("clip-path","url(#clip-y-axis-"+n.IDname+")").style("clip-path","url(#clip-y-axis-"+n.IDname+")");
}else{n.scales[n.options.yAttr].rangeBands([n.height,0],n.options.barPadding);n.axisGroup.selectAll(".y.axis text").style("font-size",null);
}this.update();};n.renderData=function(){s.renderData();if(a.falsy(this.data)){return;}var u=this.barUtils.bars;var v=k.format(",.0f");
var t=k.format(",.2r");u.update.select(".bar-label").attr("y",this.barSize/2).attr("dy","0.35em").text(function(w){return(w[n.options.xAttr]>9?t(w[n.options.xAttr]):v(w[n.options.xAttr]))+" tx";
}).style("opacity",1);u.enter.append("text").attr("class","bar-label").attr("x",-8).attr("y",this.barSize/2).attr("dy","0.35em").style("text-anchor","end").text(function(w){return(w[n.options.xAttr]>9?t(w[n.options.xAttr]):v(w[n.options.xAttr]))+" tx";
});u.exit.select(".bar-label").remove();};n.updateScale=function(t){n.scales[n.options.yAttr].rangeBands(t.newScale,n.options.barPadding);
if(t.numSelected!==n.oldSelected){n.axisGroup.selectAll(".y.axis text").style("font-size",n.textScale(t.numSelected));n.chartGroup.selectAll(".bar-label").style("font-size",n.textScale(t.numSelected));
}n.oldSelected=t.numSelected;n.update();};n.setBandSizes=function(){if(n.doBrush){n.barSize=n.vertBarSize=n.scales[n.options.yAttr].rangeBand();
n.bandSize=n.barSize*(1+n.options.barPadding);}else{s.setBandSizes();}};return n;}return d;});define("chart/widgetFramework/composed/shopperdna/formatters/shopperDnaTableFormatter",["lodash","d3"],function(b,c){function a(d){this.data=d;
this.formattedData={};}a.prototype.formatData=function(){var h=c.time.format("%Y-%m-%d %X");var d=function(i){i=i.toLowerCase();
if(["authorised","received","settled"].indexOf(i)!==-1||i.indexOf("authorised")!==-1||i.indexOf("received")!==-1||i.indexOf("settled")!==-1){return"authorised";
}else{if(i.indexOf("refund")!==-1){return"refunded";}else{if(i.indexOf("chargeback")!==-1){return"chargeback";}}}return i;
};var f=b.chain(this.data).map(function(j){j.laststatus=j.laststatus||"";var l=new Date(j.eventtime);var k=j.eventidentifiers["ShopperReference.text"];
var i={category:"Payment",values:[{header:"Status",value:j.laststatus,classes:"shopper-dna-node-"+d(j.laststatus),filterValue:d(j.laststatus),square:true,sortable:"alphabetical"},{header:"PSP reference",value:j.pspreference,sortable:"numeric",link:adyen.base+"ca/accounts/showTx.shtml?txType=Payment&pspReference="+j.pspreference},{header:"Creation time",value:h(l),sortable:"alphabetical"},{header:"Interaction",value:j.eventmetrics["ShopperInteraction.value"],sortable:"alphabetical"},{header:"Method",value:j.eventmetrics["DisplayableTxVariantCode.value"],sortable:"alphabetical",image:(adyen.imgbase+"/pm/"+j.eventmetrics["DisplayableTxVariantCode.value"]+".png"),imageOnly:true,classes:"text-align-right"},{header:"Currency",value:j.eventmetrics["Amount.amount"].c,classes:"text-align-right",sortable:"alphabetical"},{header:"Amount",value:c.format(",.2f")(j.eventmetrics["Amount.amount"].v/100),classes:"text-align-right",sortable:"numeric"},{header:"Issuer",value:j.eventmetrics["IssuerRegion.region"]&&j.eventmetrics["IssuerRegion.region"].ctry?j.eventmetrics["IssuerRegion.region"].ctry:"",sortable:"alphabetical",image:j.eventmetrics["IssuerRegion.region"]&&j.eventmetrics["IssuerRegion.region"].ctry?(adyen.imgbase+"/countries-flat/"+j.eventmetrics["IssuerRegion.region"].ctry.toLowerCase()+".png"):"",imageOnly:true,classes:"text-align-right"},{header:"Fraud score",value:(parseInt(j.eventmetrics["AccountRiskScore.value"])),classes:"text-align-right",link:adyen.base+"ca/accounts/showTxRisk.shtml?txType=Payment&pspReference="+j.pspreference,sortable:"numeric"}]};
var m={category:"Shopper",values:[{header:"Holder name",value:j.eventidentifiers["HolderName.text"],circle:true,classes:"shopper-dna-node-holdername-text",sortable:"alphabetical",linking:(b.findWhere(j.linkingidentifiers,{fieldcode:"HolderName.text"})?true:false),identifier:true},{header:"Card number",value:j.eventmetrics["BIN.value"]+"***"+j.eventmetrics["CardNumberSummary.value"],filterValue:j.eventmetrics["BIN.value"],circle:true,classes:"shopper-dna-node-hashedcardnumber-value",sortable:"alphabetical",linking:(b.findWhere(j.linkingidentifiers,{fieldcode:"HashedCardNumber.value"})?true:false),identifier:true},{header:"Reference",value:k?k.substring(0,6)+"..."+k.substring(k.length-3):"",filterValue:k,circle:true,classes:"shopper-dna-node-shopperreference-text",sortable:"alphabetical",linking:(b.findWhere(j.linkingidentifiers,{fieldcode:"ShopperReference.text"})?true:false),identifier:true},{header:"Address",value:j.eventidentifiers["BillingAddress.address"]?[j.eventidentifiers["BillingAddress.address"].country,j.eventidentifiers["BillingAddress.address"].city].join(" | "):"",filterValue:j.eventidentifiers["BillingAddress.address"]?[j.eventidentifiers["BillingAddress.address"].country,j.eventidentifiers["BillingAddress.address"].city,j.eventidentifiers["BillingAddress.address"].street].join(" | "):"",circle:true,image:j.eventidentifiers["BillingAddress.address"]?(adyen.imgbase+"/countries-flat/"+j.eventidentifiers["BillingAddress.address"].country.toLowerCase()+".png"):"",classes:"shopper-dna-node-shopperaddress-text",sortable:"alphabetical",linking:(b.findWhere(j.linkingidentifiers,{fieldcode:"BillingAddress.address"})?true:false),identifier:true},{header:"Email",value:j.eventidentifiers["ShopperEmail.email"],circle:true,classes:"shopper-dna-node-shopperemail-email",sortable:"alphabetical",linking:(b.findWhere(j.linkingidentifiers,{fieldcode:"ShopperEmail.email"})?true:false),identifier:true},{header:"IP address",value:j.eventidentifiers["IPAddress.ip"],circle:true,classes:"shopper-dna-node-ipaddress-ip",sortable:"numeric",linking:(b.findWhere(j.linkingidentifiers,{fieldcode:"IPAddress.ip"})?true:false),identifier:true}]};
return{id:j.pspreference,categories:[i,m],eventIdentifiers:j.eventidentifiers};}).value();f.sort(this.sortDate);var g=b.first(f)?b.first(f).categories:0;
var e=b.chain(g).map(function(i){return{category:i.category,colspan:i.values.length,headers:i.values};}).value();this.formattedData={thead:e,tbody:f};
return this.formattedData;};a.prototype.sortDate=function(e,d){var g=e.categories[0].values[2].value;var f=d.categories[0].values[2].value;
if(g<f){return 1;}else{if(g>f){return -1;}}return 0;};a.prototype.setRawData=function(d){this.data=d;};a.prototype.setOptions=function(d){this.options=d;
};return a;});define("chart/widgetFramework/composed/riskReport/views/refusalRateLineView",["jquery","underscore","chartutil/d3utils","chart/widgetFramework/core/mixins/formats","util/ObjectSuper","chart/widgetFramework/chartTypes/lineChart"],function(g,b,e,f,d,a){var c=function(m,h,k){var j;
var l={};var i=b.defaults(l,m);j=a(i,h,k);var n=d(j);j.renderYAxis=function(){n.renderYAxis();};j.getLabelName=function(o){return o[this.options.joinAttr];
};return j;};return c;});define("chartlib/vertScatterChart",["jquery","underscore","chartlib/scatterChart","d3","chartlib/chartBaseEvents"],function(d,b,f,c,e){var a=f.extend({defaults:{barPadding:0.2,margin:{top:5,right:10,bottom:20,left:40},tooltip:false},addListeners:function(){this._super();
if(this.collection){this.listenTo(this.collection,"sort",this.render);}},setYScale:function(){this.scales.y=c.scale[this.options.yScale]().range([this.height,0]);
},renderScatterBars:function(m,k,p,o,n,j){var h=k.selectAll(".scatter").data(function(q){return q;},m.joinData);var l=h.enter().append("rect").attr("class","scatter").attr("y",m.height).attr("width",function(q){return m.width;
});var i=h.attr("height",2).transition().duration(500).delay(500).ease("cubic-in-out").attr("y",function(q){return n(m.getY(q))-1;
});var g=h.exit().transition().attr("transform",function(q){return"translate(0,"+m.height+")";});g.select("rect").transition().attr("height",0);
g.remove();if(p.tooltip){h.classed("active",true);l.on("mouseover",function(q){m.showTooltip(q,this,false);}).on("mouseout",function(q){m.hideTooltip(false);
});}}});return a;});define("chart/widgetFramework/composed/microBundle/microBundleFormatter",["jqueryExtended","lodash","d3"],function(e,c,d){function g(i,h){this.data=i;
this.options=h;this.formattedData={};}g.prototype.formatData=function(){var m=this.data.data||this.data;var i=m.length;var n;
var l=d.format(",.0f");var h=d.format(",.0f");var p;var o=c.chain(m).reduce(function(r,w){var v=Number(w.eventmetrics["Amount.euramount"]/100);
var s=adyen.config.pspref;var q=w.pspreference;var u=(s===q);if(typeof w.linkingidentifiers==="undefined"){w.linkingidentifiers={};
for(var t in w.eventidentifiers){if(w.eventidentifiers.hasOwnProperty(t)){w.linkingidentifiers[t]={fieldcode:t,value:w.eventidentifiers[t]};
}}}c.each(w.linkingidentifiers,function(x){var y=b(x.value);var z=x.fieldcode+y;if(y){if(!r[z]){r[z]={amount:v,category:x.fieldcode,categoryClass:x.fieldcode.split(".")[0],categoryPretty:c.startCase(x.fieldcode.split(".")[0]),currentPsp:u,payments:[],paymentsAmount:0,value:y};
}r[z].amount+=v;r[z].payments.push(w.laststatus);r[z].paymentsAmount++;}});return r;},{}).reduce(function(q,r){q.push(r);
return q;},[]).value();o=o.sort(k);o=c.chain(o).map(function(q){var r=0;q.payments=c.chain(q.payments).reduce(function(s,t){s[t]=s[t]||0;
s[t]++;return s;},{}).reduce(function(s,u,t){s.push({name:t,count:u,order:-f(t)});return s;},[]).sortBy("order").map(function(s){s.x=r;
r+=s.count;return s;}).value();return q;}).tap(function(q){n=q.length;}).reduce(function(q,s){var r={category:"none",payments:[],paymentsAmount:0,color:"transparent"};
if(p!==s.category){q.push(r);p=s.category;}q.push(s);return q;},[]).value();function k(z,v){if(z.category<v.category){return -1;
}if(z.category>v.category){return 1;}if(z.category==="ShopperEmail.email"){var B=z.value.substr(z.value.indexOf("@")+1);var A=v.value.substr(v.value.indexOf("@")+1);
var r=z.value.substr(0,z.value.indexOf("@"));var q=v.value.substr(0,v.value.indexOf("@"));if(B<A){return -1;}if(B>A){return 1;
}if(r<q){return -1;}if(r>q){return 1;}return 0;}else{if(z.category==="IPAddress.ip"){var u=z.value.split(".");var s=v.value.split(".");
if(+u[0]<+s[0]){return -1;}if(+u[0]>+s[0]){return 1;}if(+u[1]<+s[1]){return -1;}if(+u[1]>+s[1]){return 1;}if(+u[2]<+s[2]){return -1;
}if(+u[2]>+s[2]){return 1;}if(+u[3]<+s[3]){return -1;}if(+u[3]>+s[3]){return 1;}return 0;}else{var w=z.value.toLowerCase(),t=v.value.toLowerCase();
return w<t?-1:w>t?1:0;}}}var j=c.chain(m).reduce(function(q,r){r.laststatus=r.laststatus.replace("Externally","");r.laststatus=r.laststatus.replace("Internally","");
r.laststatus=r.laststatus.replace("WithInfo","");r.laststatus=r.laststatus.replace("SentForRefund","Refunded");r.laststatus=r.laststatus.replace("Error","Unknown");
q.total=q.total||{amount:0,transactions:0};q.statuses=q.statuses||{};if(typeof q.statuses[r.laststatus]==="undefined"){q.statuses[r.laststatus]={status:r.laststatus,statusClass:("status-"+r.laststatus.toLowerCase()),amount:r.eventmetrics["Amount.euramount"]/100,transactions:1};
}else{q.statuses[r.laststatus].amount+=r.eventmetrics["Amount.euramount"]/100;q.statuses[r.laststatus].transactions++;}q.total.amount+=r.eventmetrics["Amount.euramount"]/100;
q.total.transactions++;return q;},{}).thru(function(q){if(c.has(q,"total.amount")){q.total.transactions=h(q.total.transactions);
q.total.amount=l(q.total.amount);}q.statuses=c.chain(q.statuses).reduce(function(r,s){s.transactions=h(s.transactions);s.order=f(s.status);
s.amount=l(s.amount);r.push(s);return r;},[]).sortBy("order").value();return q;}).value();this.formattedData={linkingIdentifiers:o,maxPaymentsAmount:a("paymentsAmount",o),totalPaymentsAmount:i,totalIdentifiersAmount:n,legend:j};
return this.formattedData;};g.prototype.setRawData=function(h){this.data=h;};g.prototype.setOptions=function(h){this.options=h;
};g.prototype.formatExtraData=function(h){this.data=h;return this.formatData();};g.prototype.formatNewData=function(h){if(this.data.length===h.length){return this.formattedData;
}return this.formatData();};function b(h){if(c.isObject(h)){return c.values(h).join(" | ");}return h;}function a(j,i){var h=i.map(function(k){if(k.hasOwnProperty(j)){return k[j];
}});return Math.max.apply(Math,h);}function f(i){var j=["authorised","settled","cancelled","refused","refunded","chargeback"];
var h=-1;c.each(j,function(k){if(i.toLowerCase().indexOf(k)>-1){h=j.indexOf(k);}});return h;}return g;});define("chart/widgetFramework/composed/revenueAccelerate/revOpBaselineStackedChart",["jquery","underscore","d3","hogan","util/Functional","util/ObjectSuper","chart/widgetFramework/chartTypes/stackedBar","chart/widgetFramework/core/constants/UIConstants"],function(c,h,i,e,b,f,d,g){var a=function(l,n,q,p){var m;
var j={};var o="";var r=h.defaults(j,l);m=d(r,n);var k=f(m);m.formatXAxis=function(){this.baselineFormatTimeXAxis(this.options.xAttr);
};m.baselineFormatTimeXAxis=function(w){var u=this,t=this.axes[w],v=this.configData.granularity,x="wk ",s=this.scales[w].ticks(i.time[v],1).length;
t.ticks(i.time[v],1).tickFormat(function(A,y){var z=u.granularityFormats[v];return z(A);});};return m;};return a;});define("chart/widgetFramework/composed/retryreport/percentageStackedBarChart",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/chartTypes/stackedBar"],function(d,g,j,c,e,b,f,i,h){function a(p,k,n){var m;
var o={};var l=g.defaults(o,p);m=h(l,k,n);var q=f(m);m.feedData=function(r){q.feedData(r);this.setNestedAttr(this.data);};
m.init=function(){q.init();this.barUtils.delayStackedTime=0;};m.renderData=function(){q.renderData();if(b.falsy(this.data)){this.hideCharts("no data to display");
return;}var t=this.barUtils.bars;var r=this.barUtils.transitionTime;var v=this.barUtils.delayTime;var u=j.format(",.1f");
t.update.select(".bar-label").text(function(w){return u(w.successRateLabel)+"%";}).style("opacity",0).transition().duration(r).delay(v).style("opacity",1);
t.enter.append("text").attr("class","bar-label").attr("x",-8).attr("y","1.15em").style("text-anchor","end").style("opacity",0).text(function(w){return u(w.successRateLabel)+"%";
}).transition().duration(r).delay(2*v).style("opacity",1);t.exit.select(".bar-label").transition().duration(r).style("opacity",0).remove();
var s=this.data.length*this.options.barHeight+this.options.margin.top+this.options.margin.bottom;j.select("#"+this.$el[0].id).transition().duration(r).style("height",s+"px");
};return m;}return a;});define("chart/widgetFramework/core/drivers/baseAxisView",["jquery","underscore","d3","util/Functional","chart/widgetFramework/core/mixins/barDrawingUtils","chart/widgetFramework/core/mixins/lineDrawingUtils","chart/widgetFramework/core/drivers/tooltipCode","chartutil/domUtils","chartutil/d3utils","chart/widgetFramework/core/constants/WidgetConstants","chart/widgetFramework/core/mixins/formats"],function(f,j,l,d,h,a,c,i,k,g,e){var b=function(u,n){var r;
var p={joinAttr:null,barHeight:null,barWidth:null,barPadding:0,margin:{top:0,right:0,bottom:0,left:0},xAttr:"x",xScale:"linear",yAttr:"y",yScale:"linear",textAnchor:"start"};
var q=500;var m=50;r={};r.el=n;c(r);r.isBarChart=true;r.init=function(){j.bindAll(this,"render");this.options=j.defaults(u,p);
this.id=this.options.type;this.$el=f(this.el);this.createDimensionStorageObjects();if(!this.options.outerPadding){this.options.outerPadding=this.options.barPadding;
}if(d.truthy(this.options.width)&&this.options.width<=0){this.options.width=null;}if(d.truthy(this.options.height)&&this.options.height<=0){this.options.height=null;
}var v=s(this.options);this.$el.width(v);var x=t(this.options);this.$el.height(x);if(this.isBarChart){this.barUtils=h();}else{this.lineUtils=a();
}this.barPositioningFn=null;this.bandSize=0;this.barSize=0;this.granularityFormats={};this.granularityFormats.day=l.time.format("%d");
this.granularityFormats.day_start=l.time.format("%b %d");this.granularityFormats.month=l.time.format("%b");this.granularityFormats.month_start=l.time.format("%b '%y");
};r.feedData=function(v){this.rawData=v;if(j.has(this.options,"dataSubset")){this.data=o(v,this.options.dataSubset);}else{this.data=o(v);
}if(!d.existy(this.data)){this.hideCharts("no data to display");return;}return this.data;};var o=function(x,y){var w=j.cloneDeep(x);
var v={};if(w.config){v.config=w.config;}if(w.chartData){v.chartData=(y)?w.chartData[y]:w.chartData;}if(w.extraData){v.extraData=w.extraData;
}if(j.keys(v)){return v;}return(y)?w[y]:w;};r.setBandSizes=function(){if(d.notFalsy(this.data)){var v,w=this.getData();if(typeof w==="function"){v=w().length;
}else{v=w.length;}if(this.options.variation===g.VERTICAL){this.bandSize=(this.width/v);this.barSize=this.horizBarSize=(this.bandSize*(1-this.options.barPadding));
}else{this.bandSize=(this.height/v);this.barSize=this.vertBarSize=(this.bandSize*(1-this.options.barPadding));}}};r.setNestedAttr=function(y,x,A){if(d.falsy(y)){return;
}var z=(x===true||x===false)?x:null;var w=(A===true||A===false)?A:null;if(typeof this.options.nestedAttr!=="undefined"&&typeof this.options.nestedAttr==="string"){y=this.options.nestedAttr;
}if((typeof y!=="undefined"&&typeof y==="string")){this.nestedAttr=y;if(z){this.options.nestedXAttr=y;if(w===null||w){this.options.nestedYAttr=y;
}}if(w){this.options.nestedYAttr=y;}return;}var B=k.detectNestedArrays(y,true);var v=B.length;if(v===1){this.nestedAttr=B[0];
if(z){this.options.nestedXAttr=B[0];if(w===null||w){this.options.nestedYAttr=B[0];}}if(w){this.options.nestedYAttr=B[0];}}else{if(v===0){if(window.console&&console.log){console.error("### basicAxisCompDriver::setNestedAttr:: I can find no nested data to use to set nestedAttr!");
}}else{if(window.console&&console.log){console.error("### basicAxisCompDriver::feedData:: I'm confused over what the nestedAttr should be: ",B);
}}}};r.initRender=function(){var v=(this.chartType)?"chartbase-svg "+this.chartType:"chartbase-svg";var w=this.options.margin;
if(j.keys(w).length===0){w={top:0,right:0,bottom:0,left:0};}this.width=this.$el.width()-(w.left+w.right);this.height=this.$el.height()-(w.top+w.bottom);
this.topSVG=this.topSVG||l.select(this.el).append("svg").attr("class",v);this.mainGroup=this.mainGroup||this.topSVG.append("g").attr("class","main-group").attr("transform","translate("+w.left+","+w.top+")");
this.axisGroup=this.mainGroup.append("g").attr("class","axis-elements-holder");this.chartGroup=this.mainGroup.append("g").attr("class","chart-elements-holder");
if(!d.falsy(this.dimensionsXArray)){j.each(this.dimensionsXArray,function(y){var x=r.axisGroup.append("g").attr("class",("x axis "+y)).attr("opacity",0.000001).attr("transform","translate(0,0)");
r.xAxesHolders[y]=x;});if(this.dimensionsXArray.length===1){this.options.xAttr=this.dimensionsXArray[0];}}else{this.xAxis=this.axisGroup.append("g").attr("class",("x axis")).attr("opacity",0.000001).attr("transform","translate(0,0)");
}if(!d.falsy(this.dimensionsYArray)){j.each(this.dimensionsYArray,function(y){var x=r.axisGroup.append("g").attr("class",("y axis "+y)).attr("opacity",0.000001);
r.yAxesHolders[y]=x;});if(this.dimensionsYArray.length===1){this.options.yAttr=this.dimensionsYArray[0];}}else{this.yAxis=this.axisGroup.append("g").attr("class",("y axis")).attr("opacity",0.000001);
}this.setScales();this.setAxes();};r.render=function(){this.chartHeight=this.$el.height();this.chartWidth=this.$el.width();
if(this.options.barHeight!==null){this.height=(this.data.length*this.options.barHeight);this.chartHeight=this.height+this.options.margin.top+this.options.margin.bottom;
this.$el.css("height",this.chartHeight+"px");}if(this.options.barWidth!==null){this.width=(this.data.length*this.options.barWidth);
this.chartWidth=this.width+this.options.margin.left+this.options.margin.right;this.$el.css("width",this.chartWidth+"px");
}this.topSVG.attr("width",this.chartWidth+"px").attr("height",this.chartHeight+"px");this.showCharts();this.update();return this;
};r.update=function(){this.calibrateScales();this.renderXAxis();this.renderYAxis();this.setBandSizes();if(this.isBarChart){this.barUtils.chartWidth=this.width;
this.barUtils.chartHeight=this.height;if(this.options.variation===g.VERTICAL){if(this.dimensionsXArray.length===1){this.barPositioningFn=this.barUtils.barPosition(this.options.centerBars,this.bandSize,this.scales[this.options.xAttr],this.options.xAttr);
}}else{if(this.dimensionsYArray.length===1){this.barPositioningFn=this.barUtils.barPosition(this.options.centerBars,this.bandSize,this.scales[this.options.yAttr],this.options.yAttr);
}}}this.renderData();};r.createDimensionStorageObjects=function(x){var w=true,v=true;if(x){if(x.indexOf("x")===-1){w=false;
}if(x.indexOf("y")===-1){v=false;}}if(w){this.dimensionsXArray=[];this.xScaleCreationFns={};this.xAxisCreationFns={};this.calibrateXScaleFns={};
this.formatXAxisFns={};this.renderXAxisFns={};this.xAxesHolders={};}if(v){this.dimensionsYArray=[];this.yScaleCreationFns={};
this.yAxisCreationFns={};this.calibrateYScaleFns={};this.formatYAxisFns={};this.renderYAxisFns={};this.yAxesHolders={};}};
r.setScales=function(){this.scales={};this.setXScale();this.setYScale();};r.calibrateScales=function(){this.calibrateXScale();
this.calibrateYScale();};r.setAxes=function(){this.axes={};this.setXAxis();this.setYAxis();};r.setXScale=function(){this.callFunctionsByKey(this.dimensionsXArray,this.xScaleCreationFns);
};r.setYScale=function(){this.callFunctionsByKey(this.dimensionsYArray,this.yScaleCreationFns);};r.setXAxis=function(){this.callFunctionsByKey(this.dimensionsXArray,this.xAxisCreationFns);
};r.setYAxis=function(){this.callFunctionsByKey(this.dimensionsYArray,this.yAxisCreationFns);};r.formatXAxis=function(v){this.callFunctionsByKey(this.dimensionsXArray,this.formatXAxisFns);
};r.formatYAxis=function(v){this.callFunctionsByKey(this.dimensionsYArray,this.formatYAxisFns);};r.calibrateXScale=function(){this.callFunctionsByKey(this.dimensionsXArray,this.calibrateXScaleFns);
};r.calibrateYScale=function(){this.callFunctionsByKey(this.dimensionsYArray,this.calibrateYScaleFns);};r.renderXAxis=function(){this.formatXAxis();
this.callFunctionsByKey(this.dimensionsXArray,this.renderXAxisFns);};r.renderYAxis=function(){this.formatYAxis();this.callFunctionsByKey(this.dimensionsYArray,this.renderYAxisFns);
if(this.options.suffixLastYTickOnly){e.lastTickFormat(this,this.options.yAxisIsPercent);}};r.callFunctionsByKey=function(w,v){j.each(w,function(x){v[x].apply(r);
});};r.renderData=function(){if(!d.existy(this.data)){return;}};r.setupUiComponents=function(y){for(var x=0;x<y.length;x++){if(y[x]&&y[x].type==="tooltip"){var w=y[x].module;
var v=y[x].options;this.setupTooltip(w,v);}}};r.hideCharts=function(v){this.$el.find(".no-data-text").remove();var x=d.existy(v)?v:"no data to display";
var z=this.height/2;var y=this.width/2;var w=f('<div class="no-data-text"><text style="color: #ccc; font-size: 14px; position: relative; top:'+z+"px; left:"+y+'px;">'+x+"</text></div>");
this.$el.not(this.$el.has(".no-data-text")).prepend(w);this.$el.children().not(".no-data-text").hide();w.show();};r.showCharts=function(){this.$el.find(".no-data-text").remove();
var v=this.$el.children().not(".no-data-text");v.each(function(){var w=f(this)[0].className.baseVal;if(w&&w.indexOf(r.chartType)>-1){f(this).show();
}});};r.createOptions=function(v){j.assign(this.options,v);};r.reset=function(){this.$el.width(this.options.width);this.$el.height(this.options.height);
var x=this.options.margin;this.width=this.$el.width()-(x.left+x.right);this.height=this.$el.height()-(x.top+x.bottom);this.mainGroup.attr("transform","translate("+x.left+","+x.top+")");
var z=this.options.xAttr;this.options.xAttr=this.dimensionsXArray[0];var y=this.axisGroup.select(".x.axis."+z).attr("class",("x axis "+this.options.xAttr)).attr("opacity",0.000001).attr("transform","translate(0,0)");
r.xAxesHolders[this.options.xAttr]=y;var w=this.options.yAttr;this.options.yAttr=this.dimensionsYArray[0];var v=this.axisGroup.select(".y.axis."+w).attr("class",("y axis "+this.options.yAttr)).attr("opacity",0.000001);
r.yAxesHolders[this.options.yAttr]=v;this.setScales();this.setAxes();};r.getData=function(){return function(){return r.data;
};};r.getPrimaryDataJoin=function(){var v=this.options.joinAttr;return this.getDataJoin(v);};r.getDataJoin=function(v){return function(x,w){if(v&&j(x).has(v)){return x[v];
}else{return w;}};};r.getX=function(v){return this._getDatumValue(v,this.options.xAttr);};r.getY=function(v){return this._getDatumValue(v,this.options.yAttr);
};r._getDatumValue=function(w,v){return w?w[v]:null;};var s=function(v){var w=d.defaults({width:q});return w(v,"width");};
var t=function(v){var w=d.defaults({height:m});return w(v,"height");};return r;};return b;});define("chart/widgetFramework/composed/transactionsDashboard/rollovers/authRateRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/chartTypes/rollover"],function(c,i,j,a,f,h,g,e,d){function b(o,k){var m;
var n={};var l=i.defaults(n,o);m=d(l,k);var p=g(m);m.currentRollingAvgType="avg7";m.init=function(){p.init();this.barUtils.setBarSelectorStr(".bar.auth-rate-line-rollover");
};m.renderData=function(){var q=this.options.centerBars;this.barUtils.chartWidth=this.width;this.barUtils.chartHeight=this.height;
var r;r=this.barUtils.barPosition(q,this.bandSize,this.getXScale(),this.options.joinAttr);this.barUtils.containerBarsVertical(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),r).fullBarVertical(3,"thin-bar").fullBarVertical(this.barSize,"dateStr");
};m.setGranularity=function(q){this.granularity=q;};m.setRollingAverageData=function(q){this.currentRollingAvgType=q;};m.tooltipOnMouseoverAction=function(r,q){this.sharedMouseAction(q,0.25,1);
};m.tooltipOnMouseoutAction=function(r,q){this.sharedMouseAction(q,0,0);};m.sharedMouseAction=function(x,v,y){var s=x.find(".dateStr");
var u=s.attr("data-id");var w=x.find(".thin-bar");j.select(w[0]).style("opacity",v);var t=["auth-rate","rolling-average"],r,q;
i.each(t,function(z){r="#authRateLine ."+z+' .line-holder-dot[data-id*="'+u+'"]';q=j.select(r).style("fill-opacity",y).style("stroke-opacity",y);
});};m.enhanceTooltipData=function(q){var r=j.format(",.2f");q.authRateTT=(q.authRate)?r(q.authRate):null;if(this.currentRollingAvgType==="avg7"){q.rollingAvg7TT=(q.rollingAvg7)?r(q.rollingAvg7):null;
q.rollingAvg30TT=null;}else{q.rollingAvg30TT=(q.rollingAvg30)?r(q.rollingAvg30):null;q.rollingAvg7TT=null;}};m.positionTooltip=function(u,w,t,v,q,r,x){var s=u.top+t-q;
var y=((u.left+w+10)-v)+(r/2);return{top:s,left:y};};return m;}return b;});define("chart/widgetFramework/composed/shopperdna/shopperDnaUtils",["lodash"],function(d){var c=["authorised","refused","cancelled","chargeback","fraud"];
var f=function(){return c;};var b=function(){return d.reduce(c,function(h,i){h[i]=0;return h;},{});};var g=function(h){return c.indexOf(h);
};var a=function(h){h=h.toLowerCase();if(["authorised","received","settled"].indexOf(h)!==-1||h.indexOf("authorised")!==-1||h.indexOf("received")!==-1||h.indexOf("settled")!==-1){return"authorised";
}else{if((h.indexOf("chargeback")!==-1)||h==="requestforinformation"){return"chargeback";}else{if((h.indexOf("cancelled")!==-1)||(h.indexOf("refund")!==-1)){return"cancelled";
}else{if(h.indexOf("fraud")!==-1){return"fraud";}}}}return h;};var e=function(l,i){var h=[];var k=["country","cntry","city","cty","postalCode","postal","street","streetname","houseNumberOrName"];
if(!d.isObject(l)){return l;}if(!(d.endsWith(i,"address")||d.endsWith(i,"region"))){h=d.values(l).sort();}else{h=d.chain(l).pairs().sortBy(function(m){return d.indexOf(k,m[0]);
}).map(function(m){return m[1];}).value();}var j=d.chain(h).without("n/a").without("N/A").compact().value().join(" | ");return j;
};return{getStatusCategoryList:f,getStatusCategoryCountObject:b,getStatusCategoryPosition:g,getStatusCategory:a,fixIdentifierObjectValue:e};
});define("chart/widgetFramework/composed/shopperDnaBeta/formatters/shopperDnaBetaTimelineFormatter",["lodash","chart/widgetFramework/composed/shopperdna/shopperDnaUtils"],function(c,b){function a(d){this.data=d;
this.formattedData={};}a.prototype.formatData=function(){var h=0;var g={};var f={};var d=[];var e=c.chain(this.data).filter(function(j){return j.laststatus;
}).sortBy(function(j){return new Date(j.eventtime);}).map(function(n){var l=c.get(n,"eventtime");var m=new Date(l);if(c.isDate(m)){n.date=m;
}var k=c.get(n,"laststatus");if(c.isString(k)){n.category=b.getStatusCategory(k);}var o=c.get(n,"linkingidentifiers");if(o&&c.isArray(o)){c.each(o,function(p){p.value=c.isObject(p.value)?c.values(p.value).join("*"):p.value;
f[p.fieldcode+p.value]=1;});}var j=c.get(n,"eventidentifiers");if(j&&c.isObject(j)){c.each(j,function(q,p){q=c.isObject(q)?c.values(q).join("*"):q;
g[p]=g[p]||{};if(!g[p][q]){g[p][q]=true;d.push({date:m,key:p,value:q});}});}n.amount=c.get(n,'eventmetrics["Amount.euramount"]',0);
h+=n.amount;n.totalAmount=h;return n;}).value();var i=c.chain(d).filter(function(j){return(f[j.key+j.value]===1);}).value();
this.formattedData={identifiers:i,transactions:e,totalAmount:h,firstDate:c.get(c.first(e),"date"),lastDate:c.get(c.last(e),"date")};
return this.formattedData;};a.prototype.setRawData=function(d){this.data=d;};return a;});define("chart/widgetFramework/composed/riskReport/rollovers/atvRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/chartTypes/rollover"],function(c,i,j,b,f,h,g,e,d){var a=function(q,k,o,m){var n;
var p={};var l=i.defaults(p,q);n=d(l,k);var r=g(n);n.init=function(){r.init();this.barUtils.setBarSelectorStr(".bar.atv-line-rollover");
};n.renderData=function(){var s=this.options.centerBars;this.barUtils.chartWidth=this.width;this.barUtils.chartHeight=this.height;
var t;t=this.barUtils.barPosition(s,this.bandSize,this.getXScale(),this.options.joinAttr);this.barUtils.containerBarsVertical(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),t).fullBarVertical(3,"thin-bar").fullBarVertical(this.barSize,"dateStr");
};n.tooltipOnMouseoverAction=function(t,s){this.sharedMouseAction(s,0.25,1);};n.tooltipOnMouseoutAction=function(t,s){this.sharedMouseAction(s,0,0);
};n.sharedMouseAction=function(z,x,A){var u=z.find(".dateStr");var w=u.attr("data-id");var y=z.find(".thin-bar");j.select(y[0]).style("opacity",x);
var v=["all-authorized-transactions","refused-by-revenueprotect","refused-by-bank"],t,s;i.each(v,function(B){t=".atv-chart ."+B+' .line-holder-dot[data-id*="'+w+'"]';
s=j.select(t).style("fill-opacity",A).style("stroke-opacity",A);});};n.enhanceTooltipData=function(u){var s=j.format(".2f");
var t=new Date(u.date);var v=j.time.format("%Y-%m-%d");u.refusedByBank=s(u.refusedByBankEuroAvg);u.refusedByRevProtect=s(u.refusedByRevProEuroAvg);
u.authorized=s(u.authorizedEuroAvg);u.dateStr=v(t);};n.positionTooltip=function(w,y,v,x,s,t,z){var u=w.top+v-s;var A=((w.left+y+10)-x)+(t/2);
return{top:u,left:A};};return n;};return a;});define("chart/widgetFramework/composed/funnel/funnelTable",["jquery","underscore","d3","hogan","util/Functional","chart/widgetFramework/core/constants/WidgetConstants","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/drivers/baseAxisView"],function(b,i,j,f,a,e,h,g,c){var d=function(q,k,o,m){var n;
var p={};var l=i.defaults(p,q);n=c(l,k);var r=g(n);n.init=function(){r.init();this.template=f.compile(m);};n.feedData=function(s){this.data=s.formattedData;
};n.renderData=function(){if(a.falsy(this.data)){this.hideCharts("no data to display");return;}var t=i.filter(this.data,function(u){return u.order!==-1;
});var s=this.template.render({formattedData:t});this.$el.html(s);};return n;};return d;});define("chartlib/linechart",["jquery","underscore","chartlib/basicChart","d3"],function(e,c,b,d){var a=b.extend({setYScale:function(){this._super();
this.scales.y.rangeRound([this.height,0]);},renderData:function(){var h=this,f=this.scales.x,j=this.scales.y;var g=d.svg.line().interpolate("linear").x(function(k){return f(h.getX(k))+f.rangeBand()/2;
}).y(function(k){return j(h.getY(k));});this.line=this.line||this.svg.append("g").append("path").attr("class","line");this.line.datum(this.collection.models).transition().attr("d",g);
var i=this.svg.selectAll(".circle").data(this.collection.models);i.enter().append("svg:circle").attr("class","circle").attr("cx",function(k){return f(h.getX(k))+f.rangeBand()/2;
}).attr("cy",function(k){return j(h.getY(k));}).attr("r",5);i.attr("cx",function(k){return f(h.getX(k))+f.rangeBand()/2;}).attr("cy",function(k){return j(h.getY(k));
});i.exit().remove();if(this.options.tooltip){i.on("mouseover",function(k){h.showTooltip(k,this,false);}).on("mouseout",function(k){h.hideTooltip(false);
});}}});return a;});define("chart/widgetFramework/composed/revenueProtect/revProStackedFormatter",["jqueryExtended","underscore","d3","chartutil/dateUtils_CET","chartutil/d3utils"],function(g,b,d,f,c){function a(j,h,i){this.data=j;
this.options=h;this.formattedData={};this.comparator=this.compareFunction;this.reverseDirection=false;this.sortKey=null;this.timeline=i;
}a.prototype.formatData=function(){var h=this.data.transactionVolume;if(!h){return[];}this.formattedData=e(h.rows);if(this.sortKey){this.reverseDirection=!this.reverseDirection;
this.sortData(this.sortKey);}if(window.console&&console.log){console.log("\n### revProStackedFormatter::formatData:: this.formattedData=",this.formattedData);
}return this.formattedData;};var e=function(h){b.each(h,function(j){j.dateStr=j.date;var i=new Date(j.dateStr);j.date=f.roundToDay(i);
});return h;};a.prototype.sortData=function(h){this.sortKey=h;this.reverseDirection=!this.reverseDirection;var i=b.sortBy(this.formattedData,h);
if(this.reverseDirection){i.reverse();}this.formattedData=i;return this.formattedData;};a.prototype.compareFunction=function(h){return h[this.sortKey];
};a.prototype.getData=function(){return(this.data)?this.data:this.formatData();};a.prototype.setRawData=function(h){this.data=h;
};a.prototype.retrieveData=function(h){return this.data[h];};a.prototype.setOptions=function(h){this.options=h;};return a;
});define("chart/widgetFramework/composed/manualReview/manualReviewMediator",["jqueryExtended","lodash","chart/widgetFramework/core/BasicMediator","util/Implement","d3","text!chart/widgetFramework/composed/shopperdna/shopperDna.css","text!chart/widgetFramework/composed/manualReview/manualReview.css","util/Css"],function(f,j,i,c,l,b,g,a){var e=function(m){this.timelineInstances=[];
this.actionCommanderInstances=[];this.tooltipInstances=[];this.$allTimelines=m.__$node.find("[data-widget*=Timeline]");this.$allTooltips=m.__$node.find("[data-widget*=Tooltip]");
this.$actionCommanders=m.__$node.find("[data-widget*=ActionCommander]");i.apply(this,arguments);this.totalDomElements=this.$allFetchers.length+this.$allFormatters.length+this.$allCharts.length+this.$allTimelines.length+this.$actionCommanders.length+this.$allTooltips.length;
a.addStyle(b);a.addStyle(g);};e.prototype.setActionCommander=function(m){this.actionCommander=m;};e.prototype.getWidgets=function(){this.getWidgetInstances(this.$actionCommanders,this.actionCommanderInstances,"ActionCommander");
this.getWidgetInstances(this.$allTimelines,this.timelineInstances,"Timelines");this.getWidgetInstances(this.$allTooltips,this.tooltipInstances,"Tooltips");
};e.prototype.setUpOwnEvents=function(n){var m=this;i.prototype.setUpOwnEvents.call(this,n);if(this.allInstances.length-1!==this.totalDomElements){return;
}j.each(this.actionCommanderInstances,function(o){o.pushAllInstances(m.chartInstances.concat(m.timelineInstances).concat(m.fetcherInstances).concat(m.tooltipInstances));
});};e.prototype.onNotifiedFetcher=function(n,m){};e.prototype.mediatorReady=function(){i.prototype.mediatorReady.call(this);
var n={identifierStyles:k,status:d};j.each(this.formatterInstances,function(o){if(!o.options){o.options={};}j.extend(o.options,{styles:n});
});var m=j.findWhere(this.fetcherInstances,{id:"shopperPaymentsData"});if(m){m.fetchData();}};e.prototype.onNotifiedViewCreator=function(o,n){var q=o.changeObject;
var m;var p=q.data;f(".force-directed").height(f(".bundle-layout").height());if(q.message==="highlightSelectedLinkingIdentifiers"&&n==="oilsplash"){m=j.findWhere(this.chartInstances,{id:"fd1"}).chart;
m.highlightLinkingIdentifiers(p);}else{if(q.message==="reset"&&n==="oilsplash"){m=j.findWhere(this.chartInstances,{id:"fd1"}).chart;
m.resetHighlighting();}else{if(q.message==="highlightSelectedLinkingIdentifiersWhenNodesAreClicked"&&n==="oilsplash"){m=j.findWhere(this.chartInstances,{id:"fd1"}).chart;
m.resetHighlighting();m.highlightLinkingIdentifiers(p);}}}f("#bundleSpinner").hide();f("#shopperDnaBundleLayoutLegend").show();
};e.prototype.onNotifiedFormatter=function(n,m){};var h="shopper-dna";var k=[{type:"pspref",textName:"PSP Reference",header:"PSP Reference",symbol:"circle",className:h+"-node-pspref-value",colorfill:"#e0e9ee",colorline:"#c2cbd0",text:"C",status:"normal",count:0,yOffset:12},{type:"HashedCardNumber.value",textName:"Card Number",header:"Card Number",symbol:"circle",className:h+"-node-hashedcardnumber-value "+h+"-node-cardnumber-value",colorfill:"#e0e9ee",colorline:"#c2cbd0",text:"C",status:"normal",count:0,yOffset:24},{type:"HolderName.text",textName:"Holder Name",header:"Holder Name",symbol:"circle",className:h+"-node-holdername-text",colorfill:"#d5fced",colorline:"#b9d7cb",text:"H",status:"normal",count:0,yOffset:48},{type:"IPAddress.ip",textName:"IP Address",header:"IP Address",symbol:"circle",className:h+"-node-ipaddress-ip",colorfill:"#ddefcb",colorline:"#bcdb9b",text:"I",status:"normal",count:0,yOffset:72},{type:"ShopperAddress.text",textName:"Shopper Address",header:"Shopper Address",symbol:"circle",className:h+"-node-shopperaddress-text",colorfill:"#d5fced",colorline:"#b9d7cb",text:"A",status:"normal",count:0,yOffset:96},{type:"ShopperEmail.email",textName:"Shopper Email",header:"Shopper Email",symbol:"circle",className:h+"-node-shopperemail-email",colorfill:"#f1e5c2",colorline:"#d9cca8",text:"E",status:"normal",count:0,yOffset:120},{type:"ShopperReference.text",textName:"Shopper Reference",header:"Shopper Reference",symbol:"circle",className:h+"-node-shopperreference-text",colorfill:"#d5fced",colorline:"#b9d7cb",text:"R",status:"normal",count:0,yOffset:144}];
var d=[{journaltypes:["Authorised","Received","Settled","SettledBulk","SettledExternally","SettledExternallyWithInfo","SettledinInstalments","SettledInstalments"],header:"Authorised/Settled",name:h+"-node-authorised",symbol:"square",className:h+"-node-authorised",count:0,amount:0,opacity:1,yOffset:54},{journaltypes:["Refused"],header:"Refused",name:h+"-node-refused",symbol:"square",className:h+"-node-refused",count:0,amount:0,opacity:1,yOffset:78},{journaltypes:["Cancelled"],header:"Cancelled",name:h+"-node-cancelled",symbol:"square",className:h+"-node-cancelled",count:0,amount:0,opacity:1,yOffset:102},{journaltypes:["Refunded","RefundedBulk","RefundedExternally","RefundedExternallyWithInfo","SentForRefund"],header:"Refunded",name:h+"-node-refunded",symbol:"square",className:h+"-node-refunded",count:0,amount:0,opacity:1,yOffset:126},{journaltypes:["Chargeback","ChargebackExternally","ChargebackExternallyWithInfo","ChargebackReversed","ChargebackReversedExternallyWithInfo"],header:"Chargeback",name:h+"-node-chargeback",symbol:"square",className:h+"-node-chargeback",count:0,amount:0,opacity:1,yOffset:150}];
c.fromTo(i,e);return e;});define("chart/widgetFramework/composed/microBundle/microBundleMediator2",["jqueryExtended","lodash","chart/widgetFramework/core/BasicMediator","util/ObjectSuper"],function(g,a,b,d){var h="shopper-dna";
var f=[{type:"pspref",textName:"PSP Reference",header:"PSP Reference",symbol:"circle",className:h+"-node-pspref-value",colorfill:"#e0e9ee",colorline:"#c2cbd0",text:"C",status:"normal",count:0,yOffset:12},{type:"HashedCardNumber.value",textName:"Card Number",header:"Card Number",symbol:"circle",className:h+"-node-hashedcardnumber-value "+h+"-node-cardnumber-value",colorfill:"#e0e9ee",colorline:"#c2cbd0",text:"C",status:"normal",count:0,yOffset:24},{type:"HolderName.text",textName:"Holder Name",header:"Holder Name",symbol:"circle",className:h+"-node-holdername-text",colorfill:"#d5fced",colorline:"#b9d7cb",text:"H",status:"normal",count:0,yOffset:48},{type:"IPAddress.ip",textName:"IP Address",header:"IP Address",symbol:"circle",className:h+"-node-ipaddress-ip",colorfill:"#ddefcb",colorline:"#bcdb9b",text:"I",status:"normal",count:0,yOffset:72},{type:"ShopperAddress.text",textName:"Shopper Address",header:"Shopper Address",symbol:"circle",className:h+"-node-shopperaddress-text",colorfill:"#d5fced",colorline:"#b9d7cb",text:"A",status:"normal",count:0,yOffset:96},{type:"ShopperEmail.email",textName:"Shopper Email",header:"Shopper Email",symbol:"circle",className:h+"-node-shopperemail-email",colorfill:"#f1e5c2",colorline:"#d9cca8",text:"E",status:"normal",count:0,yOffset:120},{type:"ShopperReference.text",textName:"Shopper Reference",header:"Shopper Reference",symbol:"circle",className:h+"-node-shopperreference-text",colorfill:"#d5fced",colorline:"#b9d7cb",text:"R",status:"normal",count:0,yOffset:144}];
var c=[{journaltypes:["Authorised","Received","Settled","SettledBulk","SettledExternally","SettledExternallyWithInfo","SettledinInstalments","SettledInstalments"],header:"Authorised/Settled",name:h+"-node-authorised",symbol:"square",className:h+"-node-authorised",count:0,amount:0,opacity:1,yOffset:54},{journaltypes:["Refused"],header:"Refused",name:h+"-node-refused",symbol:"square",className:h+"-node-refused",count:0,amount:0,opacity:1,yOffset:78},{journaltypes:["Cancelled"],header:"Cancelled",name:h+"-node-cancelled",symbol:"square",className:h+"-node-cancelled",count:0,amount:0,opacity:1,yOffset:102},{journaltypes:["Refunded","RefundedBulk","RefundedExternally","RefundedExternallyWithInfo","SentForRefund"],header:"Refunded",name:h+"-node-refunded",symbol:"square",className:h+"-node-refunded",count:0,amount:0,opacity:1,yOffset:126},{journaltypes:["Chargeback","ChargebackExternally","ChargebackExternallyWithInfo","ChargebackReversed","ChargebackReversedExternallyWithInfo"],header:"Chargeback",name:h+"-node-chargeback",symbol:"square",className:h+"-node-chargeback",count:0,amount:0,opacity:1,yOffset:150}];
var e=function(i){var j;j=b(i,true);var k=d(j);j.init=function(){k.init();this.actionCommanderExclusionArray=["actioncommander","dataformatter","viewcreator","manmediator"];
};j.getAdditionalDOMElements=function(){k.getAdditionalDOMElements();this.tooltipInstances=[];this.$allTooltips=i.__$node.find("[data-widget*=Tooltip]");
this.totalDomElements+=this.$allTooltips.length;};j.getWidgets=function(){k.getWidgets();this.getWidgetInstances(this.$allTooltips,this.tooltipInstances,"Tooltips");
};j.onNotifiedViewCreator=function(n,m){k.onNotifiedViewCreator(n,m);var p=n.changeObject;var l;var o=p.data;g(".force-directed").height(g(".bundle-layout").height());
if(p.message==="highlightSelectedLinkingIdentifiers"&&m==="oilsplash"){l=a.findWhere(this.chartInstances,{id:"fd1"}).chart;
l.highlightLinkingIdentifiers(o);}else{if(p.message==="reset"&&m==="oilsplash"){l=a.findWhere(this.chartInstances,{id:"fd1"}).chart;
l.resetHighlighting();}else{if(p.message==="highlightSelectedLinkingIdentifiersWhenNodesAreClicked"&&m==="oilsplash"){l=a.findWhere(this.chartInstances,{id:"fd1"}).chart;
l.resetHighlighting();l.highlightLinkingIdentifiers(o);}}}g("#microBundleSpinner").hide();};j.mediatorReady=function(){k.mediatorReady();
var l={identifierStyles:f,status:c};a.each(this.formatterInstances,function(m){if(!m.options){m.options={};}a.extend(m.options,{styles:l});
});this.$el.trigger("fetchShopperData",{id:"microShopperData"});};j.getInstance=function(){return this;};j.init();i.ready();
return j;};return e;});define("chartlib/boxPlotChart",["jquery","underscore","chartlib/basicChart","d3","chartlib/chartBaseEvents"],function(e,b,a,c,f){var d=a.extend({initialize:function(){b.bindAll(this,"getBoxQuartiles");
this._super();},calibrateXScale:function(){var g=this.collection.pluck(this.options.xAttr);this.scales.x.domain(g);},setYScale:function(){},calibrateYScale:function(){},renderData:function(){var j=this,h=this.options,g=this.scales.x,m=this.scales.y;
var l=this.collection.pluck(this.options.xAttr);var i=b.invoke(b.flatten(l),"get",this.options.xNestAttr);var k=this.renderBar(j,h,g,m);
this.renderWhiskers(j,k,h,g,m,i);this.renderBox(j,k,h,g,m,i);this.renderMedianLine(j,k,h,g,m,i);},renderBar:function(j,i,g,n){var k=this.svg.selectAll(".bar").data(j.collection.models,this.joinData);
var m=k.enter().append("g").attr("class","bar full boxplot").attr("transform",function(o){return"translate(0,0)";});var l=k.transition().duration(500).delay(500).attr("transform",function(o){return"translate(0,0)";
});var h=k.exit().transition().attr("transform",function(o){return"translate(0,"+j.height+")";});h.select("rect").transition().attr("height",0);
h.remove();if(i.tooltip){k.classed("active",true);m.on("mouseover",function(o){j.showTooltip(o,this,false);}).on("mouseout",function(o){j.hideTooltip(false);
});}if(i.isClickable){m.on("click",j.onBarClicked);k.classed({"hand-cursor active":true});}return k;},renderWhiskers:function(k,i,p,n,l,h){var j=i.selectAll(".whisker.bottom").data(k.getBoxQuartiles);
j.enter().append("rect").attr("class","whisker bottom").attr("width",0).attr("height",function(q){return k.height;});var o=j.transition().duration(500).delay(500).ease("cubic-in-out").attr("x",function(q){return(n(c.min(h)))||0;
}).attr("width",function(q){return(n(q[0])-n(c.min(h)))||0;});var m=i.selectAll(".whisker.top").data(k.getBoxQuartiles);m.enter().append("rect").attr("class","whisker top").attr("width",0).attr("height",function(q){return k.height;
});var g=m.transition().duration(500).delay(500).ease("cubic-in-out").attr("x",function(q){return n(q[2])||0;}).attr("width",function(q){return(n(c.max(h))-n(q[2]))||0;
});},renderBox:function(i,k,h,g,m){var j=k.selectAll(".box").data(i.getBoxQuartiles);j.enter().append("rect").attr("class","box").attr("width",0).attr("height",function(n){return i.height;
});var l=j.transition().duration(500).delay(500).ease("cubic-in-out").attr("x",function(n){return(g(n[0]))||0;}).attr("width",function(n){return g(n[2])-g(n[0])||0;
});},renderMedianLine:function(j,k,h,g,l){var i=k.selectAll("line.median").data(j.getBoxQuartiles);i.enter().append("line").attr("class","median").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",j.height);
i.transition().duration(500).delay(500).attr("x1",function(m){return g(m[1])||0;}).attr("x2",function(m){return g(m[1])||0;
});},getBoxQuartiles:function(i){var h=this,g=b.invoke(i.get(h.options.xAttr),"get",h.options.xNestAttr);g.sort(c.ascending);
var j=[c.quantile(g,0.25),c.quantile(g,0.5),c.quantile(g,0.75)];return[j];}});return d;});define("chartlib/vertBoxPlotChart",["jquery","underscore","chartlib/boxPlotChart","d3","chartlib/chartBaseEvents"],function(e,b,d,c,f){var a=d.extend({defaults:{barPadding:0.2,xScale:"ordinal"},setYScale:function(){this.scales.y=c.scale[this.options.yScale]().range([this.height,0]);
},calibrateYScale:function(){var g=this.collection.pluck(this.options.yAttr);this.scales.y.domain([c.min(g),c.max(g)]);},renderData:function(){var j=this,i=this.options,g=this.scales.x,l=this.scales.y;
var h=this.collection.pluck(this.options.yAttr);var k=this.renderBar(j,i,g,l);this.renderWhiskers(j,k,i,g,l,h);this.renderBox(j,k,i,g,l,h);
this.renderMedianLine(j,k,i,g,l,h);},renderBar:function(j,i,g,n){var k=this.svg.selectAll(".bar").data([j.collection.models],this.joinData);
var m=k.enter().append("g").attr("class","bar full boxplot").attr("transform",function(o){return"translate(0,0)";});var l=k.transition().duration(500).delay(500).attr("transform",function(o){return"translate(0,0)";
});var h=k.exit().transition().attr("transform",function(o){return"translate(0,"+j.height+")";});h.select("rect").transition().attr("height",0);
h.remove();if(i.tooltip){k.classed("active",true);m.on("mouseover",function(o){j.showTooltip(o,this,false);}).on("mouseout",function(o){j.hideTooltip(false);
});}if(i.isClickable){m.on("click",j.onBarClicked);k.classed({"hand-cursor active":true});}return k;},renderWhiskers:function(k,i,p,n,l,h){var j=i.selectAll(".whisker.bottom").data(k.getBoxQuartiles);
j.enter().append("rect").attr("class","whisker bottom").attr("width",function(q){return k.width;}).attr("y",k.height).attr("height",0);
var o=j.transition().duration(500).delay(500).ease("cubic-in-out").attr("y",function(q){return l(q[0]);}).attr("height",function(q){return(l(c.min(h))-l(q[0]))||0;
});var m=i.selectAll(".whisker.top").data(k.getBoxQuartiles);m.enter().append("rect").attr("class","whisker top").attr("width",function(q){return k.width;
}).attr("y",k.height).attr("height",0);var g=m.transition().duration(500).delay(500).ease("cubic-in-out").attr("y",function(q){return Math.max(0,l(c.max(h)));
}).attr("height",function(q){return(l(q[2]))-l(c.max(h));});},renderBox:function(i,k,h,g,m){var j=k.selectAll(".box").data(i.getBoxQuartiles);
j.enter().append("rect").attr("class","box").attr("width",function(n){return i.width;}).attr("y",i.height).attr("height",0);
var l=j.transition().duration(500).delay(500).ease("cubic-in-out").attr("y",function(n){return m(n[2]);}).attr("height",function(n){return m(n[0])-m(n[2]);
});},renderMedianLine:function(j,k,h,g,l){var i=k.selectAll("line.median").data(j.getBoxQuartiles);i.enter().append("line").attr("class","median").attr("x1",0).attr("y1",j.height).attr("x2",j.width).attr("y2",j.height);
i.transition().duration(500).delay(500).attr("y1",function(m){return l(m[1])||0;}).attr("y2",function(m){return l(m[1])||0;
});},getBoxQuartiles:function(i){var h=this,g=b.invoke(i.get(h.options.yAttr),"get",h.options.yNestAttr);g.sort(c.ascending);
var j=[c.quantile(g,0.25),c.quantile(g,0.5),c.quantile(g,0.75)];return[j];}});return a;});define("chart/widgetFramework/composed/harpViewer/HarpViewerActions",["jqueryExtended","underscore"],function(c,a){var d=c;
var b={actions:[{source:"harpTreePicker",event:"change",target:"harpDataFormatter",callMethod:"retrieveData",getterMethod:function(f){var e=c("#harpTreePicker option:selected");
var g=e.text();return g;}}]};return b;});define("chart/widgetFramework/composed/demo/lineDataFormatter",["jqueryExtended","underscore","d3","chartutil/dateUtils_CET","chart/widgetFramework/core/constants/DataConstants","chartutil/d3utils"],function(g,b,d,f,e,c){function a(k,h,j,n){var i={};
i.data=k;i.options=h;i.formattedData={};i.comparator=null;i.reverseDirection=false;i.sortKey=null;i.timeline=j;i.id=n;i.formatData=function(){this.formattedData=m(this.data.results);
if(this.sortKey){this.reverseDirection=!this.reverseDirection;this.sortData(this.sortKey,true);}if(window.console&&console.log){console.log("### lineDataFD::formatData:: this.formattedData=",this.formattedData);
}var o={};this.parsedData={config:o,chartData:this.formattedData};return this.parsedData;};var m=function(o){var p=b.chain(o).map(function(q){return q.lineValues;
}).flatten().each(function(r){r.dateStr=r.date;var q=new Date(r.dateStr);r.date=f.trueRoundToDay(q,true);}).value();return o;
};var l=function(o){var p=[];b.each(o,function(s){s.dateStr=s.date;var r=new Date(s.dateStr);s.date=f.trueRoundToDay(r,true);
var q=s.authRate;p.push({date:s.date,value:q*100,name:s.dateStr});});return[{name:"myline",lineValues:p}];};i.sortData=function(o,q){this.sortKey=o;
this.reverseDirection=!this.reverseDirection;var p=b.sortBy(this.formattedData,o);if(this.reverseDirection){p.reverse();}this.formattedData=p;
if(q===true){return;}this.$el.trigger(e.FORMATTER_INFORM_WIDGET,{type:e.SORTED_DATA,data:{chartData:this.formattedData}});
};i.compareFunction=function(o){return o[this.sortKey];};i.getData=function(){return(this.data)?this.data:this.formatData();
};i.setRawData=function(o){this.data=o;};i.retrieveData=function(o){return this.data[o];};i.setOptions=function(o){this.options=o;
};return i;}return a;});define("chartlib/ui/animatedListView",["jquery","underscore","backbone","chartlib/events/layoutEvents"],function(c,a,e,d){var b=e.View.extend({listItems:[],duration:null,easing:"",initialize:function(){a.bindAll(this,"layout","setDuration","getDuration","setEasing","getEasing","onModelRemove");
this.setDuration(this.options.duration||600);this.setEasing(this.options.easing||"swing");this.listenTo(this.collection,"remove",this.onModelRemove);
this._super();},layout:function(){if(this.listItems.length<1){return;}var o=this;var g,j,h,q,l,k=0,m,n=this.collection.length;
a.each(this.listItems,function(i){i.$el[0].targetPosition=i.$el.position().top;});for(m=0;m<n;m++){h=this.collection.at(m);
g=a.findWhere(this.listItems,{model:h});if(g){var p=g.$el;p.css("position","absolute");p.parent().append(p);if(m>0){q=this.collection.at(m-1);
j=a.findWhere(this.listItems,{model:q});l=k+j.$el.outerHeight(true);}else{l=0;}k=l;p.stop(true,true).animate({targetPosition:l},{duration:this.getDuration(),easing:this.getEasing(),step:function(i){c(this).css({transform:"translate(0px, "+i+"px)"});
},complete:function(){c(this).css({position:"relative",transform:"translate(0px, 0px)"});}});}}var f=a.map(o.listItems,function(i){return i.el;
});c(f).promise().done(function(){e.trigger(d.RESIZE);});},onModelRemove:function(f){this.listItems=a.without(this.listItems,a.findWhere(this.listItems,{model:f}));
},setDuration:function(f){this.duration=f;},getDuration:function(){return this.duration;},setEasing:function(f){this.easing=f;
},getEasing:function(){return this.easing;}});return b;},function(a){if(window.console&&console.log){console.log("APP JS ERROR ="+a);
}});define("chart/widgetFramework/composed/riskReport/rollovers/chargebackDistRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/chartTypes/rollover","chart/widgetFramework/core/mixins/widgetScales"],function(b,i,k,a,f,h,g,e,c,j){var d=function(r,l,p,n){var o;
var q={};var m=i.defaults(q,r);o=c(m,l);var s=g(o);o.getXScale=function(){var u=j.getDomainFromDataExtremes(this.data,this.options.joinAttr);
var t=k.scale.linear().rangeRound([0,this.width]).domain(u);t.nice();return t;};o.enhanceTooltipData=function(v){var w=k.format("0,000");
var u=v.x;var t=v.x+(v.dx-1);v.fraudScoreTT=u+" to "+t;v.chargebacksTT=w(v.y);};return o;};return d;});define("chart/widgetFramework/composed/chargebackReport/formatters/acquirerBarFormatter",["jqueryExtended","underscore","chart/widgetFramework/core/constants/DataConstants"],function(d,b,c){function a(i,f,h,k){var g={};
g.data=i;g.options=f;g.formattedData={};g.comparator=null;g.reverseDirection=false;g.sortKey="chargebackCount";g.timeline=h;
g.id=k;g.formatData=function(){var l=(this.data&&b.has(this.data,"acquirer_statistics"))?this.data.acquirer_statistics:{};
this.formattedData=j(l);if(this.sortKey){this.reverseDirection=!this.reverseDirection;this.sortData(this.sortKey,true);}return{chartData:this.formattedData};
};var j=function(m){var l=[];b.each(m,function(n){l.push({acquirerName:e(n.acquirer),chargebackCount:+n.chargebackCount,chargebackEurAmount:+n.chargebackEurAmount,chargebackRate:+n.authorisedCount>0?+n.chargebackCount/+n.authorisedCount*100:0});
});return l;};var e=function(m){var l=m.toLowerCase();return l.replace(/\w\S*/g,function(n){return n.charAt(0).toUpperCase()+n.substr(1).toLowerCase();
});};g.sortData=function(l,n){this.sortKey=l;if(this.sortKey===this.oldSortKey){this.reverseDirection=!this.reverseDirection;
}else{this.reverseDirection=false;}this.oldSortKey=this.sortKey;var m=b.sortBy(this.formattedData,l);if(this.reverseDirection){m.reverse();
}this.formattedData=m;if(n===true){return;}this.$el.trigger(c.FORMATTER_INFORM_WIDGET,{type:c.SORTED_DATA,data:{chartData:this.formattedData}});
};g.compareFunction=function(l){return l[this.sortKey];};g.getData=function(){return(this.data)?this.data:this.formatData();
};g.setRawData=function(l){this.data=l;};g.retrieveData=function(l){return this.data[l];};return g;}return a;});define("chartlib/models/state",["jquery","underscore","backbone"],function(c,b,d){var a=d.Model.extend({defaults:{label:"",statsType:"",region:""}});
return a;});define("chart/widgetFramework/composed/posOverview/rollovers/posOverviewRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/chartTypes/axisRollover"],function(c,i,j,a,f,h,g,e,d){function b(o,k){var m;
var n={};var l=i.defaults(n,o);m=d(l,k);var p=g(m);m.init=function(){p.init();this.barUtils.setBarSelectorStr(".bar.pos-overview-rollover");
this.hasXAxis=!this.options.centerBars;};m.positionTooltip=function(r,t,x,q,w,s,v){var u=p.positionTooltip(r,t,x,q,w,s,v);
u.top-=5;return u;};m.enhanceTooltipData=function(q){q.authorisedAmountTT=j.format("0,000")(q.authorizedAmount);};return m;
}return b;});define("chart/widgetFramework/composed/settlementBatchOverview/settlementBatchMediator",["jqueryExtended","lodash","util/Implement","chart/widgetFramework/core/BasicMediator","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/core/constants/DataConstants","util/Functional","chartutil/cssutils"],function(a,i,d,h,g,f,c,j){var b=false;
var e=false;function k(m){this.init(m);this.firstDataFlag=true;var l=new Date();this.currentYear=l.getFullYear();this.startYear=this.currentYear;
this.minYear=this.currentYear-4;this.currentMonth=11;this.enableButtons("nextYear",false,["#prevYearBtn","#nextYearBtn"]);
m.ready();}k.prototype.getAdditionalDOMElements=function(l){this.timelineInstances=[];this.$allTimelines=this.$el.find("[data-widget*=Timeline]");
this.totalDomElements+=this.$allTimelines.length;};k.prototype.getWidgets=function(){this.getWidgetInstances(this.$allTimelines,this.timelineInstances,"Timelines");
};k.prototype.onNotifiedFetcher=function(m,l){};k.prototype.onNotifiedFormatter=function(n,m){this.$el.find("#processIndicator").fadeOut("fast");
if(window.console&&console.log&&e){console.log("\n################ ","\n### settlementBatchMediator::onNotifiedFormatter :: pId=",m," pData=",n,"\n################ ");
}var l=n.changeObject.data;if(m==="settlementBatchDataFormatterYear"){a(".chart-year").text(l.year);a(".total-year-currency").text(l.currency);
a(".total-year-value").text(l.yearTotal);}if(m==="monthBatchDataFormatter"||m==="settlementBatchWidgeFormatter"){a(".chart-month").text(l.month);
a(".total-month-currency").text(l.currency);a(".total-month-value").text(l.total);}};k.prototype.onNotifiedViewCreator=function(p,n){if(window.console&&console.log&&e){console.log("\n################ ","\n### settlementBatchMediator::onNotifiedViewCreator :: pId=",n," pData=",p,"\n################ ");
}var l,q;var o=p.changeObject.data;if(n==="settlementBatchYearRollover"&&p.changeObject.type==="requestMonthData"){var m=this.getInstanceById("settlementBatchOverviewYear",this.chartInstances);
if(m&&m.chart){m.informChart(null,"setCurrentMonth",o.monthNum);}l=this.getInstanceById(n,this.chartInstances);q=l.$el;q.trigger(f.FETCH_EXISTING_DATA,o.monthData);
}if(n==="settlementBatchOverviewYear"&&p.changeObject.type==="requestMonthData"){l=this.getInstanceById(n,this.chartInstances);
q=l.$el;q.trigger(f.FETCH_EXISTING_DATA,o.monthData);}};k.prototype.mediatorReady=function(){h.prototype.mediatorReady.call(this);
var m=String(this.currentMonth+1);if(m.length===1){m="0"+m;}var l=this.currentYear+"-"+m+"-01";this.$el.trigger(f.TIME_INFO_SET,[l]);
};k.prototype.onYearChange=function(n,l){this.$el.find("#processIndicator").fadeIn("fast");var m;if(l==="minus"){this.currentYear--;
m=this.currentYear+"-12-01";if(this.currentYear<=this.minYear){this.currentYear=this.minYear;this.enableButtons("prevYear",false);
}if(this.currentYear!==this.startYear){this.enableButtons("nextYear",true);}}if(l==="plus"){this.currentYear++;m=this.currentYear+"-12-01";
if(this.currentYear>=this.startYear){this.currentYear=this.startYear;this.enableButtons("nextYear",false);m=this.currentYear+"-"+(this.currentMonth+1)+"-01";
}if(this.currentYear!==this.minYear){this.enableButtons("prevYear",true);}}this.$el.trigger(f.TIME_INFO_SET,[m]);};k.prototype.enableButtons=function(m,o){var n=this.$el.find("#prevYearBtn");
var l=this.$el.find("#nextYearBtn");switch(m){case"prevYear":n.css("pointer-events",(o===false)?"none":"auto");n.css("opacity",(o===false)?0.3:1);
break;case"nextYear":l.css("pointer-events",(o===false)?"none":"auto");l.css("opacity",(o===false)?0.3:1);break;default:n.css("pointer-events","auto");
n.css("opacity",1);l.css("pointer-events","auto");l.css("opacity",1);break;}};d.fromTo(h,k);return k;});define("chartlib/constants/chart",[],function(){var a={};a.BASE="chart-";a.types={};a.types.BAR="bar";a.types.LINE="line";
a.types.STACKED="stacked";a.types.MULTIBAR="multi-bar";a.types.MULTILINE="multi-line";a.types.ENHANCED_MULTILINE="enhanced-multi-line";
a.types.BOXPLOT="boxplot";a.types.SCATTER="scatter";a.types.BULLET="bullet";a.directions={};a.directions.HORIZONTAL="horizontal";
a.directions.VERTICAL="vertical";a.scales={};a.scales.ORDINAL="ordinal";a.scales.LINEAR="linear";a.scales.LINEAR_RANGE="linear-range";
a.scales.TIME="time";a.getLocalTypeName=function(b){return b.replace(a.BASE,"");};return a;});define("chart/widgetFramework/composed/riskReport/formatters/lineFormatter",["jqueryExtended","underscore","d3","chartutil/dateUtils_CET","chart/widgetFramework/core/constants/DataConstants","chartutil/domUtils","chartutil/stringutils"],function(h,a,b,g,e,d,f){var c=function(l,i,k,m){var j={};
j.data=l;j.options=i;j.formattedData={};j.comparator=null;j.reverseDirection=false;j.sortKey=null;j.timeline=k;j.id=m;j.formatData=function(){var n={};
this.formattedData=this.calculateMetaData(this.data);if(this.sortKey){this.reverseDirection=!this.reverseDirection;this.sortData(this.sortKey,true);
}if(window.console&&console.log){console.log("### lineFormatter::formatData---------------------:: this.formattedData=",this.formattedData);
}return{config:n,chartData:this.formattedData};};j.calculateMetaData=function(t){var u=[];var q=[];var r=[];var p=[];var o=[];
var s=[];var n=[];a.each(t,function(y){var v=(y.authorisedCount>0)?y.authorisedEurAmount/y.authorisedCount:0;u.push({date:y.date,value:v/100,name:y.dateStr});
var A=(y.refusedByRiskCount>0)?y.refusedByRiskEurAmount/y.refusedByRiskCount:0;p.push({date:y.date,value:A/100,name:y.dateStr});
var x=(y.refusedByBankCount>0)?y.refusedByBankEurAmount/y.refusedByBankCount:0;o.push({date:y.date,value:x/100,name:y.dateStr});
var w=(y.riskTransactionCount>0)?y.refusedByRiskCount/y.riskTransactionCount:0;s.push({date:y.date,value:w*100,name:y.dateStr});
var z=(y.riskTransactionCount>0)?y.refusedByBankCount/y.riskTransactionCount:0;n.push({date:y.date,value:z*100,name:y.dateStr});
r.push({date:y.date,dateStr:y.dateStr,formattedTimespan:y.formattedTimespan,refusedByBankPercent:z*100,refusedByRevProPercent:w*100,chargebackPercent:99999999,refusedByBankCount:y.refusedByBankCount,refusedByBankAmount:(y.refusedByBankEurAmount/100),refusedByRiskCount:y.refusedByRiskCount,refusedByRiskAmount:y.refusedByRiskEurAmount/100});
q.push({date:y.date,dateStr:y.dateStr,formattedTimespan:y.formattedTimespan,authorizedEuroAvg:v/100,refusedByRevProEuroAvg:A/100,refusedByBankEuroAvg:x/100});
});return{refusalRates:[{name:"Refused by bank",lineValues:n},{name:"Refused by RevenueProtect",lineValues:s}],averageTransactionValues:[{name:"All Authorized Transactions",lineValues:u},{name:"Refused by RevenueProtect",lineValues:p},{name:"Refused by bank",lineValues:o}],refusalAndChargebackRolloverData:r,averageTxValuesRolloverData:q};
};j.sortData=function(n,p){this.sortKey=n;this.reverseDirection=!this.reverseDirection;var o=a.sortBy(this.formattedData,n);
if(this.reverseDirection){o.reverse();}this.formattedData=o;if(p===true){return;}this.$el.trigger(e.FORMATTER_INFORM_WIDGET,{type:e.SORTED_DATA,data:this.formattedData});
};j.compareFunction=function(n){return n[this.sortKey];};j.downloadRefusalRateCSV=function(){var p=this.createObjectForCSV("refusalRates","Percent",",.4f");
var n=["dateStr","refusedByRevenueprotectPercent","refusedByBankPercent"];var o=["Date","Refused by RevenueProtect (%)","Refused by bank (%)"];
d.createCSV(p,n,o,"RefusalRates");};j.downloadAtvCSV=function(){var p=this.createObjectForCSV("averageTransactionValues","Amount");
var n=["dateStr","allAuthorizedTransactionsAmount","refusedByRevenueprotectAmount","refusedByBankAmount"];var o=["Date","All Authorized Transactions (EUR)","Refused by RevenueProtect (EUR)","Refused by bank (EUR)"];
d.createCSV(p,n,o,"AverageTransactionValues");};j.createObjectForCSV=function(v,t,o){var p=o||",.2f";var n=b.format(p);var r=this.formattedData[v];
var u=r.length;var y=a.cloneDeep(r[0].lineValues);var w=f.camelCase(r[0].name);y=a.map(y,function(z){var A={dateStr:z.name};
A[w+t]=+n(z.value);return A;});for(var s=1;s<u;s++){var q=r[s];var x=f.camelCase(q.name);a.each(q.lineValues,function(A,z){y[z][x+t]=+n(A.value);
});}return y;};j.getData=function(){return(this.data)?this.data:this.formatData();};j.setRawData=function(n){this.data=n;
};j.retrieveData=function(n){return this.data[n];};j.setOptions=function(n){this.options=n;};return j;};return c;});define("chart/widgetFramework/core/ViewCreator",["jqueryExtended","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/core/constants/UIConstants","underscore","util/Functional","chart/widgetFramework/core/drivers/observableCode","chart/widgetFramework/core/uiComponentsFetcher","chartutil/domUtils"],function(a,l,n,p,h,b,c,m){var e=false;
var o="color:blue;font-size:1em";var d=false;var j="color:green;font-size:1em";var k=false;var g=false;var f="color:red;font-size:1em";
var i=function(q){var r={};b(r,"viewCreator");r.init=function(){p.bindAll(this,"onNotifiedDataFormatted");this.$el=q.getNode();
this.id=this.$el.attr("id");if(!this.id){this.id=this.$el.attr("data-id");}var x=this.parameters=this.getParameters(q);this.chartOptions=this.parameters.options||{};
var t=x.formatterName;var y=a("#"+t);y.widget().then(function(z){r.Formatter=z.instance;if(window.console&&console.log&&g){console.log("### ViewCreator2:: registering observer on formatter:: ");
}r.Formatter.registerObserver(r.onNotifiedDataFormatted,false,r.id);},function(){if(window.console&&console.warn){console.warn("VizComp:: Error loading dataFormatter",arguments);
}});var w=x.timeline;var v=(w&&w.indexOf("#")===-1)?a("#"+w):a(w);if(v.length){if(window.console&&console.log&&g){console.log("### ViewCreator2::init:: getting timeline promise----");
}v.widget().then(function(z){var A=z.instance;A.renderPromise.done(function(){r.timeline=A.timeline;});},function(){if(window.console&&console.warn){console.warn("VizComp:: Error loading timelineObject",arguments);
}});}var u=this.parameters.options.type;var s=(this.parameters.options.template||"defaultTemplate")+".html";r.resolvedRequire=false;
r.hasData=false;if(h.notFalsy(u)){r.requireChartType(u,s);}else{if(window.console&&console.log){console.log("%c\n################",f);
console.warn("%c### ViewCreator::init:: you have failed, failed I tell you! to specify a valid **type** for this ViewCreator",f);
console.log("%c\n################",f);}}};r.requireChartType=function(t,s){this.chartType=t.substring(t.lastIndexOf("/")+1);
require(["chart/widgetFramework/"+t,"text!chart/widgetFramework/"+s],function(u,v){r.ChartRef=u;r.TemplateRef=v;r.resolvedRequire=true;
r.checkReady("require");},function(u){if(window.console&&console.log){console.log("VizComp:: widget Require error: ",u);}});
};r.checkReady=function(s){if(this.resolvedRequire&&this.hasData){this.createChart();}};r.onNotifiedDataFormatted=function(t,s){if(window.console&&console.log&&d){console.log("%c\n################",j);
console.log("%c### START STAGE :: VizComp::"+this.id+":: onNotifiedDataFormatted pId="+s+" pData.type= "+t.changeObject.type+" pData.stopRender= "+t.changeObject.stopRender,j);
console.log("%c################",j);}switch(t.changeObject.type){case l.DATA_FORMATTED:case l.RETRIEVED_DATA:case l.SORTED_DATA:case l.REFORMATTED_DATA:case l.NEW_DATA_AVAILABLE:if(h.falsy(t.changeObject.silentFormat)){this.data=t.changeObject.data;
this.hasData=true;this.checkReady("data");}break;}};r.createChart=function(){var s;if(!h.existy(this.chart)){if(window.console&&console.log&&d){console.log("%c\n################",j);
console.log("%c### START STAGE :: VizComp::"+this.id+":: createChart:: CREATE NEW CHART type:"+this.parameters.options.type,j);
console.log("%c################",j);}var t=h.existy(this.timeline)?this.timeline:null;this.chart=new this.ChartRef(this.chartOptions,this.$el[0],t,this.TemplateRef);
this.chart.chartType=this.chartType;this.chart.init(this.chartOptions,this.$el[0]);s=this.chart.feedData(this.data);this.$el.on(n.CHART_TO_VIEW_EVENT,p.bind(this.onChartToWidgetEvent,this));
this.setProperty("changeObject",{type:n.CHART_INITIALISED,data:this.chart});this.chart.initRender();if(s!==l.HALT_RENDER_PROCESS){this.chart.render();
}this.setProperty("changeObject",{type:n.CHART_FIRST_RENDER,data:this.chart});var u=c(this.chartOptions,this.$el[0],function(y){for(var x=0;
x<y.length;x++){if(y[x]&&y[x].type==="tooltip"){var w=y[x].module;var v=y[x].options;r.chart.setupTooltip(w,v);}}});m.removeDataAtrributes(this.$el,["options"]);
}else{if(window.console&&console.log&&d){console.log("%c\n################",j);console.log("%c### START STAGE :: VizComp::"+this.id+":: createChart:: UPDATING EXISTING CHART type:"+this.parameters.options.type,j);
console.log("%c################",j);}s=this.chart.feedData(this.data);if(s!==l.HALT_RENDER_PROCESS){this.chart.render();if(typeof this.chart.setTooltipsOnElements==="function"){this.chart.setTooltipsOnElements();
}}this.setProperty("changeObject",{type:n.CHART_UPDATED,data:this.chart});}};r.getInstance=function(){return this.chart;};
r.onChartToWidgetEvent=function(t,s){if(window.console&&console.log&&k){console.log("\n################ ");console.log("### ViewCreator::"+this.id+" onChartEvent:: e=",t);
console.log("### ViewCreator::"+this.id+" onChartEvent:: pData=",s);console.log("################ ");}this.$el.trigger(s.type,s);
this.setProperty("changeObject",s);};r.getParameters=function(s){var v=s.getNode().data();var t;if(p.keys(v).length){t=v;
}else{s.parameters.options=a.parseJSON(s.parameters.options);t=s.parameters;}var u={};if(p.keys(t).length){u.formatterName=t.formatter;
u.options=t.options;if(!h.existy(u.options.margin)){u.options.margin={};}u.timeline=t.timeline;}else{throw"The parameters are not well defined"+t;
}return u;};r.init();if(window.console&&console.log&&g){console.log("\n### ViewCreator2::constructor:: calling pWidgetApi.ready()");
}q.ready();return r;};return i;});define("chart/widgetFramework/composed/chargebackReport/rollovers/groupedBarRolloverBrushed",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/chartTypes/axisRollover"],function(c,i,j,a,f,h,g,e,d){function b(o,k){var m;
var n={};var l=i.defaults(n,o);m=d(l,k);var p=g(m);m.init=function(){p.init();if(typeof this.options.allowScrolling==="undefined"){this.options.allowScrolling=false;
}this.firstBrushPass=true;this.maxRowsForBrush=(this.options.numBars&&this.options.numBars>0)?this.options.numBars:10;};m.initRender=function(){p.initRender();
m.mainGroup.append("defs").append("clipPath").attr("id","clip-bars-rollover").append("rect").attr("width",m.options.width-m.options.margin.left-m.options.margin.right).attr("height",m.options.height-m.options.margin.top-m.options.margin.bottom);
};m.render=function(){m.doBrush=m.data.length>this.maxRowsForBrush;var r=this.$el.width();this.height=this.options.height-(this.options.margin.top+this.options.margin.bottom);
var q=this.height+this.options.margin.top+this.options.margin.bottom;this.topSVG.attr("width",r+"px").attr("height",q+"px");
j.select("#"+this.$el[0].id).transition().duration(500).style("height",q+"px");if(this.options.allowScrolling&&m.doBrush&&m.firstBrushPass){var s=j.behavior.zoom().on("zoom",null);
this.mainGroup.call(s).on("wheel.zoom",function(){m.scrolling();}).on("mousedown.zoom",null).on("touchstart.zoom",null).on("touchmove.zoom",null).on("touchend.zoom",null);
m.firstBrushPass=false;}if(m.doBrush){m.chartGroup.attr("clip-path","url(#clip-bars-rollover)").style("clip-path","url(#clip-bars-rollover)");
}else{m.scales[m.options.yAttr].rangeBands([m.height,0],m.options.barPadding);}this.update();};m.updateScale=function(q){m.scales[m.options.yAttr].rangeBands(q.newScale,m.options.barPadding);
m.update();};m.setBandSizes=function(){if(m.doBrush){this.barSize=this.vertBarSize=m.scales[m.options.yAttr].rangeBand();
this.bandSize=this.barSize*(1+m.options.barPadding);}else{p.setBandSizes();}};m.scrolling=function(){var q=m.options.variation==="horizontal"?j.event.deltaY:j.event.deltaX;
this.$el.trigger(h.CHART_TO_VIEW_EVENT,{type:"groupedBarChartScroll",data:q});};m.setTooltipsOnElements=function(){p.setTooltipsOnElements(true);
};m.enhanceTooltipData=function(r){var s=j.format(",.0f");var q=j.format(",.2f");r.chargebackEurAmountTT=s(r.chargebackEurAmount);
r.chargebackRateTT=q(r.chargebackRate);if(this.options.joinAttr==="countryName"){r.labelName=r.countryName;}else{if(this.options.joinAttr==="paymentMethodName"){r.labelName=r.paymentMethodName;
}else{if(this.options.joinAttr==="acquirerName"){r.labelName=r.acquirerName;}}}};return m;}return b;});define("chart/widgetFramework/composed/harpReportBuilder/harpGraphBuilderLinks",["jquery","underscore","d3","backbone","chart/widgetFramework/chartTypes/treeLayout","util/ObjectSuper"],function(f,a,e,g,d,c){var b=function(l,h,i,j){var k=d(l,h,null,j);
var m=c(k);k.init=function(){m.init();};k.hideCharts=function(){this.$el.css({"background-color":"#f4f4f4"});};k.feedData=function(n){if(n){this.data=n;
}else{return;}};k.renderData=function(){var n=(typeof this.collapseNodes!=="undefined")?this.collapseNodes:false;if(a.isEmpty(this.data)){return;
}m.renderData(false);};k.deleteNodeChildren=function(p){var o=a.first(p.nodes);var n=this.findNode(this.root,o.parentNodeId);
if(n){this.collapse(n);}n.__children=[];};k.findNode=function(r,s){var o=this;if(r.harpNodeId===s){return r;}var q=r.children;
if(q){for(var p=0;p<q.length;p++){var t=q[p];var n=o.findNode(t,s);if(n){return n;}}}};return k;};return b;});define("chartlib/decorators/filteredCollection",["underscore"],function(a){var b=function(c){var d=this;this.filters=[];this.original=c;
a.extend(this,c);this.original.on("reset",function(){if(typeof d.stackAttr!=="undefined"){d.filterData(d.stackAttr);}else{d.reset(d.original.models);
}});};b.prototype.filterStacks=function(c,d){this.stackAttr=c;if(a.contains(this.filters,d)){this.filters=a.without(this.filters,d);
}else{this.filters.push(d);}this.filterData(c);};b.prototype.filterData=function(c){var e=this;var d=a.map(this.original.models,function(f){var g=a.clone(f.toJSON());
g[c]=a.filter(g[c],function(h){return !a.contains(e.filters,h.name);});return g;});this.reset(d);};b.prototype.filterByDomain=function(d){var c=this.original.where({domain:d});
this.reset(c);};return b;},function(a){if(window.console&&window.console.log){window.console.log("APP JS ERROR = "+a);}});
define("chartutil/objectutils",[],function(){var a={};a.removeFrom=function(b,c){var d=false;for(var e in b){if(e===c){d=true;
}if(d){delete b[e];}}};a.joinKeys=function(c,b){var d="";for(var e in c){d+=e+b;}return d;};return a;});define("chart/widgetFramework/composed/transactionsDashboard/views/txHeatmap",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/chartTypes/heatmap"],function(c,g,j,b,d,a,e,i,h){function f(p,k,n){var m;
var o={};var l=g.defaults(o,p);m=h(l,k,n);var r=e(m);var q=["Mo","Tu","We","Th","Fr","Sa","Su"];m.init=function(){r.init();
var s=new Date().getDay()-1;var u=g.slice(q,0,s);var t=g.slice(q,s,q.length);this.yRange=t.concat(u);};m.getYPos=function(t){var s=g.indexOf(this.yRange,t.dayName);
return s*m.gridSize;};return m;}return f;});define("chart/widgetFramework/composed/riskReport/constants/riskConstants",["jquery"],function(b){var a={RECEIVED_TX_TOTAL:"receivedTxTotal",RECEIVED_TX_REVPRO_TOTAL:"receivedTxRevProTotal",RECEIVED_TX_GPM_TOTAL:"receivedTxGpmTotal"};
return a;});define("chart/widgetFramework/composed/riskReport/formatters/masterFormatter",["lodash","chartutil/d3utils","chartutil/dateUtils_CET","util/Functional","chart/widgetFramework/composed/riskReport/constants/riskConstants"],function(a,e,f,d,c){function b(i,g,h){this.data=i;
this.timeline=h;this.months=["January","February","March","April","May","June","July","August","September","October","November","December"];
}b.prototype.formatData=function(){var g=[];var m={};if(this.data){if(a.has(this.data,"statistics")){m=this.data.statistics;
}else{if(a.has(this.data,"overall_statistics")){m=this.data.overall_statistics;}}}if(d.falsy(m)){return[];}if(a.isArray(m)){var h=m;
var l=this.timeline.getGranularity();var i=this.timeline.getDates();var j=1;var k=new Date(i[1].getFullYear(),i[1].getMonth(),i[1].getDate()-j);
g=this.parseDates(h,l,[i[0],k]);}return g;};b.prototype.parseDates=function(i,k,j){var h=this;a.map(i,function(n){n.dateStr=n.date;
var l=new Date(n.dateStr);var m=f.convertDateToAMS(l);n.date=f.roundToDay(m);});var g=i;a.each(g,function(l){if(k==="month"){l.formattedTimespan=h.months[l.date.getMonth()]+" "+l.date.getFullYear();
}else{if(k==="week"){l.formattedTimespan="week "+l.date.getWeek();}else{l.formattedTimespan=l.dateStr;}}});return g;};b.prototype.setRawData=function(g){this.data=g;
};return b;});define("chart/widgetFramework/composed/shopperdna/shopperDnaMediator",["jqueryExtended","lodash","chart/widgetFramework/core/BasicMediator","util/ObjectSuper"],function(e,a,b,d){function c(f){var g=b(f,true);
var h=d(g);g.init=function(){h.init();this.actionCommanderExclusionArray=["actioncommander"];g.$el.trigger("updateState","Loading ShopperDNA Network.");
};g.retryCount=0;g.retryFetching=function(){if(g.retryCount<2){g.$el.trigger("widgetAppStartup");g.retryCount++;}else{g.$el.trigger("updateState","Loading ShopperDNA network failed. Please refresh to try again.");
g.$el.trigger("hideCharts");}};g.onNotifiedFetcher=function(j,i){h.onNotifiedFetcher(j,i);if(a.get(j,"changeObject.data",[]).length<2){e("#shopperdnaBarChart").hide();
e("#chartToggles").hide();}};g.mediatorReady=function(){h.mediatorReady();var j=e("#chartToggles");var n=j.find(".csr-toggle-button-2");
var k=e("#forceTab");var m=e("#bundleTab");var i=e("#timelineTab");var l=function(){var q=(!a.isUndefined(this))?e(this):j.find(".active");
var o=q.attr("id");var p=e("body");n.removeClass("active");if(o==="forceToggle"){k.css({display:"block"});m.css({display:"none"});
i.css({display:"none"});q.addClass("active");p.addClass("pg-force-is-visible");setTimeout(function(){if(g.forceFormatter.options.delayFormatting===true){g.forceFormatter.options.delayFormatting=false;
g.forceFormatter.formatData();}},100);}else{if(o==="bundleToggle"){m.css({display:"block"});k.css({display:"none"});i.css({display:"none"});
q.addClass("active");p.removeClass("pg-force-is-visible");}else{if(o==="timelineToggle"){i.css({display:"block"});m.css({display:"none"});
k.css({display:"none"});q.addClass("active");p.removeClass("pg-force-is-visible");}}}};l();n.on("click",l);g.forceFormatter=a.find(g.formatterInstances,{id:"forceFormatter"});
};g.init();f.ready();return g;}return c;});define("chart/widgetFramework/composed/manualReview/manualReviewMediator2",["jqueryExtended","lodash","chart/widgetFramework/core/BasicMediator","util/ObjectSuper","text!chart/widgetFramework/composed/manualReview/manualReview.css","util/Css"],function(a,i,h,g,d,b){var f="shopper-dna";
var j=[{type:"pspref",textName:"PSP Reference",header:"PSP Reference",symbol:"circle",className:f+"-node-pspref-value",colorfill:"#e0e9ee",colorline:"#c2cbd0",text:"C",status:"normal",count:0,yOffset:12},{type:"HashedCardNumber.value",textName:"Card Number",header:"Card Number",symbol:"circle",className:f+"-node-hashedcardnumber-value "+f+"-node-cardnumber-value",colorfill:"#e0e9ee",colorline:"#c2cbd0",text:"C",status:"normal",count:0,yOffset:24},{type:"HolderName.text",textName:"Holder Name",header:"Holder Name",symbol:"circle",className:f+"-node-holdername-text",colorfill:"#d5fced",colorline:"#b9d7cb",text:"H",status:"normal",count:0,yOffset:48},{type:"IPAddress.ip",textName:"IP Address",header:"IP Address",symbol:"circle",className:f+"-node-ipaddress-ip",colorfill:"#ddefcb",colorline:"#bcdb9b",text:"I",status:"normal",count:0,yOffset:72},{type:"ShopperAddress.text",textName:"Shopper Address",header:"Shopper Address",symbol:"circle",className:f+"-node-shopperaddress-text",colorfill:"#d5fced",colorline:"#b9d7cb",text:"A",status:"normal",count:0,yOffset:96},{type:"ShopperEmail.email",textName:"Shopper Email",header:"Shopper Email",symbol:"circle",className:f+"-node-shopperemail-email",colorfill:"#f1e5c2",colorline:"#d9cca8",text:"E",status:"normal",count:0,yOffset:120},{type:"ShopperReference.text",textName:"Shopper Reference",header:"Shopper Reference",symbol:"circle",className:f+"-node-shopperreference-text",colorfill:"#d5fced",colorline:"#b9d7cb",text:"R",status:"normal",count:0,yOffset:144}];
var c=[{journaltypes:["Authorised","Received","Settled","SettledBulk","SettledExternally","SettledExternallyWithInfo","SettledinInstalments","SettledInstalments"],header:"Authorised/Settled",name:f+"-node-authorised",symbol:"square",className:f+"-node-authorised",count:0,amount:0,opacity:1,yOffset:54},{journaltypes:["Refused"],header:"Refused",name:f+"-node-refused",symbol:"square",className:f+"-node-refused",count:0,amount:0,opacity:1,yOffset:78},{journaltypes:["Cancelled"],header:"Cancelled",name:f+"-node-cancelled",symbol:"square",className:f+"-node-cancelled",count:0,amount:0,opacity:1,yOffset:102},{journaltypes:["Refunded","RefundedBulk","RefundedExternally","RefundedExternallyWithInfo","SentForRefund"],header:"Refunded",name:f+"-node-refunded",symbol:"square",className:f+"-node-refunded",count:0,amount:0,opacity:1,yOffset:126},{journaltypes:["Chargeback","ChargebackExternally","ChargebackExternallyWithInfo","ChargebackReversed","ChargebackReversedExternallyWithInfo"],header:"Chargeback",name:f+"-node-chargeback",symbol:"square",className:f+"-node-chargeback",count:0,amount:0,opacity:1,yOffset:150}];
var e=function(k){var l;l=h(k,true);var m=g(l);l.init=function(){m.init();this.actionCommanderExclusionArray=["actioncommander","dataformatter","viewcreator","manmediator"];
b.addStyle(d);};l.getAdditionalDOMElements=function(){m.getAdditionalDOMElements();this.tooltipInstances=[];this.$allTooltips=k.__$node.find("[data-widget*=Tooltip]");
this.totalDomElements+=this.$allTooltips.length;};l.getWidgets=function(){m.getWidgets();this.getWidgetInstances(this.$allTooltips,this.tooltipInstances,"Tooltips");
};l.onNotifiedViewCreator=function(p,o){m.onNotifiedViewCreator(p,o);var r=p.changeObject;var n;var q=r.data;a(".force-directed").height(a(".bundle-layout").height());
if(r.message==="highlightSelectedLinkingIdentifiers"&&o==="oilsplash"){n=i.findWhere(this.chartInstances,{id:"fd1"}).chart;
n.highlightLinkingIdentifiers(q);}else{if(r.message==="reset"&&o==="oilsplash"){n=i.findWhere(this.chartInstances,{id:"fd1"}).chart;
n.resetHighlighting();}else{if(r.message==="highlightSelectedLinkingIdentifiersWhenNodesAreClicked"&&o==="oilsplash"){n=i.findWhere(this.chartInstances,{id:"fd1"}).chart;
n.resetHighlighting();n.highlightLinkingIdentifiers(q);}}}a("#bundleSpinner").hide();a("#shopperDnaBundleLayoutLegend").show();
};l.mediatorReady=function(){m.mediatorReady();var n={identifierStyles:j,status:c};i.each(this.formatterInstances,function(o){if(!o.options){o.options={};
}i.extend(o.options,{styles:n});});this.$el.trigger("fetchShopperData",{id:"shopperPaymentsData"});this.$el.trigger(" widgetAppStartup");
a("#bundleSpinner").hide();a("#shopperDnaBundleLayoutLegend").show();};l.getInstance=function(){return this;};l.init();k.ready();
return l;};return e;});define("chartlib/barchart",["jquery","underscore","chartlib/basicChart","d3","chartlib/chartBaseEvents"],function(e,b,a,c,f){var d=a.extend({dataLoadError:function(){if(this.options.barHeight===null){this._super();
return;}var i=this.height/2;var h=this.width/2;if(i<=25){i=0;}var g=e('<div class="no-data-text"><text style="color: #ccc; font-size: 14px; position: relative; top:'+i+"px; left:"+h+'px;">no data to display</text></div>');
this.$el.not(this.$el.has(".no-data-text")).prepend(g);this.$el.children().not(".no-data-text").hide();g.show();},render:function(){if(this.options.barHeight!==null){var g=(this.collection.length*this.options.barHeight)+this.options.margin.top+this.options.margin.bottom;
c.select(this.el).transition().style("height",g+"px");}this._super();},renderData:function(){var k=this,o=this.options,n=this.scales.x,l=this.scales.y,m=500;
var j=this.svg.selectAll(".bar").data(this.collection.models,this.joinData);var i=j.enter().append("g").attr("class","bar full").attr("transform",function(p){return"translate(0,"+l(k.getY(p))+")";
}).append("rect").attr("class",function(q){var p=k.getClassName(q);return"rect "+p;}).attr("width",0).attr("height",function(p){return l.rangeBand();
});var g=j.transition().duration(m).attr("transform",function(p){return"translate(0,"+l(k.getY(p))+")";});g.select("rect").attr("height",function(p){return l.rangeBand();
}).transition().duration(m).delay(500).ease("cubic-in-out").attr("width",function(p){return n(k.getX(p));});var h=j.exit().transition().duration(m).attr("transform",function(p){return"translate(0,"+k.height+")";
});h.select("rect").attr("height",0);h.remove();if(this.options.tooltip){j.classed("active",true);i.on("mouseover",function(p){k.showTooltip(p,this,false);
}).on("mouseout",function(p){k.hideTooltip(false);});}if(this.options.isClickable){i.on("click",k.onBarClicked);j.classed({"hand-cursor active":true});
}return{bar:j,enter:i,update:g,exit:h};},showToolTip_fromText:function(h){var i=this.getElementFromAttrValue(".bar.full",this.options.yAttr,h);
var g=i.select("rect");if(typeof window.SVGElement==="undefined"){window.clearTimeout(this.IE_tooltip_timeout);g=g.node();
}this.showTooltip(i.datum(),g,true);return i;},textClicked:function(g){var h=this.getElementFromAttrValue(".bar.full",this.options.yAttr,g);
h.select("rect").on("click")(h.datum());},getClassName:function(i){var g=this.getY(i);var h=g.toLowerCase().replace(/[\s\/]/g,"");
return h;}});return d;},function(a){if(window.console&&console.log){console.log("APP JS ERROR =",a);}});define("chartlib/vertbarchart",["jquery","underscore","chartlib/barchart","d3"],function(e,a,d,c){var b=d.extend({addListeners:function(){this._super();
if(this.collection){this.listenTo(this.collection,"sort",this.render);}},setYScale:function(){this._super();this.scales.y.rangeRound([this.height,0]);
},calibrateYScale:function(){this.scales.y.domain([0,c.max(this.collection.pluck(this.options.yAttr))]);},renderData:function(){var h=this,f=this.scales.x,k=this.scales.y;
var i=this.svg.selectAll(".bar").data(this.collection.models,this.joinData);i.transition().attr("transform",function(l){return"translate("+f(h.getX(l))+",0)";
});var j=i.enter().append("g").on("click",h.onBarClicked).attr("class","bar full").attr("transform",function(l){return"translate("+f(h.getX(l))+",0)";
}).append("rect").attr("width",function(l){return f.rangeBand();}).attr("y",h.height).attr("height",0);i.select("rect").transition().attr("y",function(l){return k(h.getY(l));
}).attr("height",function(l){return h.height-k(h.getY(l));});if(this.options.tooltip){i.classed("active",true);j.on("mouseenter",function(l){h.showTooltip(l,this,false);
}).on("mouseout",this.tip.hide);}var g=i.exit().transition();g.attr("transform",function(l){return"translate(0,0)";}).select("rect").attr("width",0);
g.remove();}});return b;},function(a){if(window.console&&console.log){console.log("APP JS ERROR =",a);}});define("chartlib/vertstacked",["jquery","underscore","chartlib/vertbarchart","d3"],function(e,a,c,b){var d=c.extend({calibrateYScale:function(){if(!this.options.percentile){this.scales.y.domain([0,b.max(this.collection.pluck(this.options.yAttr))]);
}},renderData:function(){var i=this,g=this.scales.x,l=this.scales.y,k=this.options.percentile;i.collection.models.forEach(function(n){var m=0;
e.each(n.get(i.options.yNestAttr),function(o,p){if(!k){p.startY=m;p.endY=(m+p.value);}else{p.startY=m/n.get("total");p.endY=(m+p.value)/n.get("total");
}m+=p.value;});});var j=this.svg.selectAll(".bar").data(i.collection.models,this.joinData);j.enter().append("g").attr("class","bar").attr("transform",function(m){return"translate("+g(i.getX(m))+",0)";
});j.transition().delay(500).attr("transform",function(m){return"translate("+g(i.getX(m))+", 0)";});var f=j.selectAll("rect").data(function(m){return m.get(i.options.yNestAttr);
},function(m){return m.name;});f.enter().append("rect").attr("class",function(m){return"stack "+m.name;}).attr("width",g.rangeBand()).attr("height",0).attr("y",function(m){return l(m.startY);
});if(this.options.tooltip){f.on("mouseover",i.showTooltip).on("mouseout",i.tip.hide);}f.transition().duration(500).delay(function(n,m){return 500+(m*500);
}).attr("y",function(m){return l(m.endY);}).attr("height",function(m){return l(m.startY)-l(m.endY);});f.exit().remove();var h=j.exit().transition();
h.attr("transform",function(m){return"translate(0,0)";}).select("rect").attr("width",0);h.remove();}});return d;});define("chart/widgetFramework/composed/shopperdna/formatters/shopperDnaForceFormatter",["lodash"],function(a){function b(d,c){this.data=d;
this.options=c;this.formattedData={};}b.prototype.formatData=function(){if(this.options.delayFormatting!==true){var f=a.sortBy(this.data,"eventtime");
var h=this.createTransactionNodes(f);var g=this.createLinkingIdentifiersNodes(f,h);var d=h.concat(g);var c=this.createLinks(d);
var e=this.floydWarshall(d,c);this.formattedData={nodes:d,transactionNodes:h,data:f,links:c,nodeSizeInfo:e};return this.formattedData;
}};b.prototype.floydWarshall=function(p,f){var o=new Array(p.length);a.each(p,function(c){if(c.type==="identifier"){var d=c.nodes;
a.each(d,function(m){p[m].nodes.push(c.index);});}});var k=a.findWhere(p,{type:"identifier"});var g=k?k.index:0;var i=new Array(p.length);
var e=new Array(p.length);var j=new Array(p.length);for(var r=0;r<p.length;r++){o[r]=0;var u=new Array(p.length);for(var q=0;
q<p.length;q++){u[q]=Infinity;}i[r]=u;e[r]=a.clone(u);}a.each(f,function(c){i[c.source][c.target]=c.strength;i[c.target][c.source]=c.strength;
e[c.source][c.target]=c.target;e[c.target][c.source]=c.source;});for(var w=0;w<p.length;w++){for(var v=0;v<p.length;v++){for(var t=0;
t<p.length;t++){if(i[v][w]+i[w][t]<i[v][t]){i[v][t]=i[v][w]+i[w][t];e[v][t]=e[v][w];}}}}for(var h=0;h<j.length;h++){j[h]=new Array(j.length);
for(var x=0;x<j[h].length;x++){if(!e[h][x]){continue;}j[h][x]=[h];var l=h;while(l!==x&&l!==Infinity){o[l]++;l=e[l][x];j[h][x].push(l);
}}}for(var s=0;s<g;s++){o[s]=0;}return{shortestPaths:j,nodeSizes:o,maxNodeSize:a.max(o,function(c){return c;})};};b.prototype.createTransactionNodes=function(c){return a.map(c,function(f,e){f.type="transaction";
f.index=e;f.nodes=[];return f;});};b.prototype.createLinkingIdentifiersNodes=function(d,e){var c=[];var f=e.length;a.each(d,function(h,g){a.each(h.linkingidentifiers,function(i){var j=a.find(c,function(l){return(a.isEqual(l.name,i.fieldcode)&&a.isEqual(l.value,i.value));
});if(!j){var k=h.eventmetrics["BIN.value"]+"*******"+h.eventmetrics["CardNumberSummary.value"];c.push({name:i.fieldcode,value:i.value,displayName:i.fieldcode+"->"+i.value,displayValue:(i.fieldcode==="HashedCardNumber.value")?k:i.value,type:"identifier",index:f,strength:i.strength,nodes:[g]});
f++;}});});this.calculateIdentifiersData(c,e);return c;};b.prototype.calculateIdentifiersData=function(d,c){a.each(d,function(f){var g=f.name;
var e=f.value;var h=a.filter(c,function(k){var j=true;if(j){var i=k.eventidentifiers;return(i[g]&&a.isEqual(i[g],e));}else{return a.find(k.linkingidentifiers,function(l){return(l.fieldcode===g&&l.value===e);
});}});a.each(h,function(i){f.nodes=a.union(f.nodes,[i.index]);});});};b.prototype.createLinks=function(c){return a.chain(c).filter(function(d){return(d.type==="identifier");
}).reduce(function(d,e){a.each(e.nodes,function(f){var g=c[e.index];var h=c[f];d.push({source:g.index,target:h.index,strength:e.strength});
});return d;},[]).value();};b.prototype.getData=function(){return(this.formattedData)?this.formattedData:this.formatData();
};b.prototype.formatExtraData=function(c){this.data=c;return this.formatData();};b.prototype.formatNewData=function(c){if(this.data.length===c.length){return this.formattedData;
}return this.formatData();};b.prototype.setRawData=function(c){this.data=c;};b.prototype.setOptions=function(c){this.options=c;
};return b;});define("chart/widgetFramework/composed/settlementBatchOverview/settlementBatchChartYear",["jquery","underscore","d3","hogan","util/Functional","util/ObjectSuper","chart/widgetFramework/chartTypes/barChart","chart/widgetFramework/core/constants/UIConstants","text!chart/widgetFramework/composed/settlementBatchOverview/settlementBatchTableTemplate.html","chartutil/d3utils"],function(b,h,k,e,a,f,d,g,i,j){var c=function(n,q,s,r){var p;
var l={};var t=h.defaults(l,n);p=d(t,q);var m=f(p);var o={formatData:function(u){o.data=u;o.depoTotal=0;h.each(u.allTableBatches,function(v){if(v){o.depoTotal+=Number(v.depositCorrection.quantity);
v.payout=j.formatAmount(v.payout,v.currency);}});b(".full-year-btn").on("click",o.renderRows);},renderRows:function(){var x=b('[data-view="settlementBatchOverviewTable"]');
var w=e.compile(i);var v=h.clone(o.data.allTableBatches);var u=w.render({month:{batches:v.reverse(),currency:h.first(o.data.allTableBatches).currency,depoTotal:o.depoTotal,payoutTotal:o.data.yearTotal,downloadLink:adyen.config.settlementBatchDownloadUrl}});
x.html(u);}};p.init=function(){m.init();var u=new Date();this.currentMonth=u.getMonth();this.maxMonth=this.currentMonth;this.maxYear=u.getFullYear();
this.barUtils.barSelectorStr=".bar.settle-year";this.barUtils.barClassStr="bar settle-year";};p.feedData=function(u){this.data=u.monthData;
this.currentYear=u.year;this.configData={granularity:"month"};o.formatData(u);};p.renderData=function(){m.renderData();if(this.barUtils.bars){this.setCurrentBar(this.barUtils.bars.enter,true);
}};p.setCurrentBar=function(u,v){var w=0;h.each(u[0],function(y){var x=k.select(y);if(x.datum().monthNum===p.currentMonth){x.classed("selected",true);
if(v){p.$el.trigger(g.CHART_TO_VIEW_EVENT,{type:"requestMonthData",data:{bdate:x.datum().dateString,monthData:x.datum().monthData}});
}}else{if(v){w++;if(p.currentYear===p.maxYear&&p.currentMonth>p.maxMonth&&w===p.data.length){if(x.datum().monthNum===p.maxMonth){x.classed("selected",true);
}p.currentMonth=p.maxMonth;var z=p.data[p.data.length-1];p.$el.trigger(g.CHART_TO_VIEW_EVENT,{type:"requestMonthData",data:{bdate:z.dateString,monthData:z.monthData}});
}}}});};p.setCurrentMonth=function(v){this.currentMonth=v;var u=this.barUtils.bars.enter;this.deselectBars(u);this.setCurrentBar(u,false);
};p.deselectBars=function(u){h.each(u[0],function(v){k.select(v).classed("selected",false);});};return p;};return c;});define("chart/widgetFramework/composed/shopperdna/formatters/shopperDnaMasterFormatter",["jqueryExtended","lodash","util/Console","chart/widgetFramework/composed/shopperdna/shopperDnaUtils"],function(e,c,b,a){function d(f){this.data=f;
this.formattedData={};}d.prototype.formatData=function(){var g;var f={};if(c.isArray(this.data)){g=c.chain(this.data).map(function(h){if(c.has(h,"journals")){c.each(h.journals,function(i){var k=c.get(i,"bookingdate");
if(k){i.bookingdateDate=new Date(k);}});}return h;}).filter(function(i){if((i.type==="Payment")&&!c.isNull(i.laststatus)&&!c.isUndefined(i.eventidentifiers)){return true;
}if((i.type==="Dispute")){var j=c.get(i,"paymentpspreference");var h=c.get(i,"journals",[]);if(j){f[j]=f[j]||h;f[j]=f[j].concat(h);
}}b.log("master formatter filtered out following entry:",i);return false;}).map(function(l){var j=f[l.pspreference];var i=c.get(l,"journals",[]);
if(j&&i){l.journals=i.concat(j);var k=c.max(l.journals,"bookingdateDate");var h=c.get(k,"journaltype");if(h){l.laststatus=h;
}}c.each(l.eventidentifiers,function(n,m){l.eventidentifiers[m]=a.fixIdentifierObjectValue(n,m);});c.each(l.linkingidentifiers,function(o){var n=o.value;
var m=o.fieldcode;o.value=a.fixIdentifierObjectValue(n,m);});return l;}).value();}if(c.isArray(g)&&g.length===0){e("#shopperdnaMediator").trigger("updateState","Loading ShopperDNA network failed. Please refresh to try again.");
e("#shopperdnaMediator").trigger("hideCharts");e("#shopperdnaLegend").remove();}else{if(g.length===1){e("#shopperdnaBarChart").hide();
e("#chartToggles").hide();}e("#shopperdnaMediator").trigger("updateState","");}this.formattedData=g;return this.formattedData;
};d.prototype.getData=function(){return(this.formattedData)?this.formattedData:this.formatData();};d.prototype.formatExtraData=function(f){this.data=f;
return this.formatData();};d.prototype.formatNewData=function(f){if(this.data.length===f.length){return this.formattedData;
}return this.formatData();};d.prototype.setRawData=function(f){this.data=f;};d.prototype.setOptions=function(f){this.options=f;
};return d;});define("chart/widgetFramework/composed/revenueProtect/revProLineFormatter",["jqueryExtended","underscore","d3","chartutil/dateUtils_CET","chartutil/d3utils"],function(g,b,d,f,c){function e(j,h,i){this.data=j;
this.options=h;this.formattedData={};this.comparator=this.compareFunction;this.reverseDirection=false;this.sortKey=null;this.timeline=i;
}e.prototype.formatData=function(){var i=this.data[this.options.lineDataId];if(!i){return[];}this.formattedData=a(i.rows);
if(this.sortKey){this.reverseDirection=!this.reverseDirection;this.sortData(this.sortKey);}if(window.console&&console.log){console.log("\n### revProLineFormatter::formatData:: this.formattedData=",this.formattedData);
}var h={};h.granularity="day";this.parsedData={config:h,chartData:this.formattedData};return this.parsedData;};var a=function(h){var i=b.chain(h).map(function(j){return j.lineValues;
}).flatten().each(function(k){k.dateStr=k.date;var j=new Date(k.dateStr);k.date=f.roundToDay(j);}).value();return h;};e.prototype.sortData=function(h){this.sortKey=h;
this.reverseDirection=!this.reverseDirection;var i=b.sortBy(this.formattedData,h);if(this.reverseDirection){i.reverse();}this.formattedData=i;
return this.formattedData;};e.prototype.compareFunction=function(h){return h[this.sortKey];};e.prototype.getData=function(){return(this.data)?this.data:this.formatData();
};e.prototype.setRawData=function(h){this.data=h;};e.prototype.retrieveData=function(h){return this.data[h];};e.prototype.setOptions=function(h){this.options=h;
};return e;});define("chart/widgetFramework/components/Timeline",["jqueryExtended","ui/UIConstants","underscore","hogan","calendar/datepicker","text!chart/widgetFramework/components/timeline.html","timeline/views/timelineFacade","timeline/events/timelineEvents","chartutil/domUtils"],function(a,g,h,d,b,c,j,k,f){var e="color:darkorange;font-size:1em";
var i=function(l){var m={};m.init=function(){this.loadCSS();this.template=d.compile(c);this.$el=l.getNode();this.id=this.$el.attr("id");
this.mediator=this.$el.parent();var p=this.mediator.attr("data-widget");var o=this.mediator.attr("id");var n=this.mediator.attr("class");
this.mediatorId=o.toLowerCase();if((p&&p.toLowerCase().indexOf("mediator")>-1)||(o&&o.toLowerCase().indexOf("mediator")>-1)||(n&&n.toLowerCase().indexOf("mediator")>-1)){this.mediator.on(g.WIDGET_APP_STARTUP,this.onAppStartup);
}else{this.appStarted=true;}this.parameters=this.getParameters(l);this.timelineOptions=this.parameters.options;this.renderPromise=new a.Deferred();
this.$el.widget().done(function(q){m.hasResolved=true;m.checkReady("promise");});f.removeDataAtrributes(this.$el,["options"]);
};m.onAppStartup=function(){m.appStarted=true;m.checkReady("startup");};m.checkReady=function(n){if(this.appStarted&&this.hasResolved){this.render();
this.renderPromise.resolve();}};m.getInstance=function(){return this;};m.loadCSS=function(){var n=document.createElement("link");
n.type="text/css";n.rel="stylesheet";n.href="../../js/calendar/datepicker.css";document.getElementsByTagName("head")[0].appendChild(n);
};m.getParameters=function(n){var q=n.getNode().data();var o;if(h.keys(q).length){o=q;}else{n.parameters.options=a.parseJSON(n.parameters.options);
o=n.parameters;}var p={};if(h.keys(o).length){p.options=o.options;}else{throw"The parameters are not well defined"+o;}return p;
};m.render=function(){var p=this.template.render();this.$el.html(p);var o=this.timelineOptions;var n=a({});n.on(k.TIMESPAN_SET,function(){var q=h.rest(arguments);
m.currentTimeObj=[q];m.$el.trigger("timelineTimespanSet",m.currentTimeObj);});this.timeline=new j({uid:this.mediatorId,timeCollectionMode:o.timeCollectionMode,formatPeriod:o.formatPeriod,baseGranularity:o.baseGranularity,startPreset:o.startPreset,fixedExtent:o.fixedExtent,calendar:o.calendar,controls:o.controls,forceJumpFwd:o.forceJumpFwd,presets:o.presets,allowDynamicPresets:o.allowDynamicPresets,mondayWeek:o.mondayWeek,minStartDates:o.minStartDates,config:o.config,chartGranularity:o.chartGranularity,chartGranularityDisabled:o.chartGranularityDisabled,forceCET:o.forceCET,widgetContainer:n});
};m.getData=function(){if(this.timeline){return this.timeline.getDates();}return;};m.init();l.ready();return m;};return i;
});define("chart/widgetFramework/composed/cardAcquirerAuthorizationReport/formatters/merchantBarFormatter",["jqueryExtended","underscore","d3","chart/widgetFramework/core/constants/DataConstants"],function(e,b,c,d){function a(j,g,i,l){var h={};
h.data=j;h.options=g;h.formattedData={};h.comparator=null;h.reverseDirection=false;h.sortKey="authorizationRate";h.timeline=i;
h.id=l;h.formatData=function(){var m=this.data.merchantAccount_aggregation?this.data.merchantAccount_aggregation:{};if(m.length===0){return[];
}this.formattedData=k(m);if(this.sortKey){this.reverseDirection=!this.reverseDirection;this.sortData(this.sortKey,true);}return{chartData:this.formattedData};
};var k=function(o){var n=[];o=b.filter(o,function(p){return typeof p.merchantAccount!=="undefined"&&!(b.isNull(p.merchantAccount));
});o=b.filter(o,function(p){return +p.authorisedCount>0&&+p.authRate>0;});var m=c.sum(o,function(p){return +p.authorisedCount;
});b.each(o,function(r){var q=+r.authRate*100,p=100-q;n.push({labelName:f(r.merchantAccount),authorizedCount:+r.authorisedCount,authorizedCountShare:m===0?0:+r.authorisedCount/m*100,authorizedEurAmount:+r.authorisedAmount/100,authorizationRate:q,authRate:[{name:"authorized",value:q,startX:0,endX:q},{name:"refused",value:p,startX:q,endX:100}],total:100,name:"authorized"});
});return n;};var f=function(m){return m.replace(/_/g," ");};h.sortData=function(m,o){this.sortKey=m;if(this.sortKey===this.oldSortKey){this.reverseDirection=!this.reverseDirection;
}else{this.reverseDirection=false;}this.oldSortKey=this.sortKey;var n=b.sortBy(this.formattedData,m);if(this.reverseDirection){n.reverse();
}this.formattedData=n;if(o===true){return;}this.$el.trigger(d.FORMATTER_INFORM_WIDGET,{type:d.SORTED_DATA,data:{chartData:this.formattedData}});
};h.compareFunction=function(m){return m[this.sortKey];};h.getData=function(){return(this.data)?this.data:this.formatData();
};h.setRawData=function(m){this.data=m;};h.retrieveData=function(m){return this.data[m];};return h;}return a;});define("chart/widgetFramework/chartTypes/histogramChart",["jquery","underscore","d3","util/Functional","chart/widgetFramework/core/constants/WidgetConstants","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/drivers/axisBaseView"],function(b,g,i,a,d,f,e,h){var c=function(p,j,n,l){var m;
var o={};var k=g.defaults(p,o);m=h(k,j);var q=e(m);m.renderData=function(){if(a.falsy(this.data)){this.hideCharts("no data to display");
return;}var u=this.scales[this.options.xAttr],t=this.scales[this.options.yAttr];var s,r;if(this.options.variation===d.VERTICAL){s=this.barUtils.containerBarsVertical(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),this.barPositioningFn,true).barVertical(this.options.yAttr,t,this.barSize);
r=m.options.xAttr;}else{s=this.barUtils.containerBarsHorizontal(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),this.barPositioningFn,true).barHorizontal(this.options.xAttr,u,this.barSize);
r=m.options.yAttr;}if(a.notFalsy(this.options.threshold)||this.options.threshold===0){s.bars.enter.selectAll("rect").classed("over-threshold",function(v){if(v[r]>=m.options.threshold){return true;
}return false;});}};return m;};return c;});define("chart/widgetFramework/composed/riskReport/views/fraudScoreHistogramView",["jquery","underscore","d3","util/Functional","chart/widgetFramework/core/constants/WidgetConstants","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/chartTypes/histogramChart"],function(b,f,i,a,c,e,d,g){var h=function(l,n,q,p){var m;
var j={};var r=f.defaults(j,l);m=g(r,n);var k=d(m);m.renderData=function(){this.barUtils.barSelectorStr=".bar-chargeback";
this.barUtils.barClassStr="bar-chargeback";k.renderData();var s=m.options.threshold;if(a.notFalsy(s)||s===0){var x=this.scales[this.options.xAttr];
var y=this.chartGroup.selectAll(".marker").data([this.data]);var w=y.enter().append("g").attr("class","marker");var v=w.append("line").attr("x1",function(z){return x(s);
}).attr("y1",-20).attr("x2",function(z){return x(s);}).attr("y2",-20);var t=y.transition().delay(500).duration(500);var u=t.select("line").attr("y2",this.height);
t.selectAll(".marker-text").attr("fill-opacity",1);}};var o=function(y,t,w,s,v,u){var x=y.append("text").attr("class","marker-text").attr("fill-opacity",0.000001).attr("x",function(z){return t(w)+s;
}).attr("y",v).text(function(z){return u;});};return m;};return h;});define("chart/widgetFramework/composed/harpReportBuilderV2/HarpBuilderMediator2",["jqueryExtended","lodash","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/core/constants/DataConstants","util/ObjectSuper","chart/widgetFramework/core/BasicMediator","Constants","util/Functional"],function(a,i,g,e,f,h,b,c){var d=function(j){var l;
l=h(j,true);var m=f(l);l.init=function(){m.init();this.dialogShown=false;this.actionCommanderExclusionArray=["actioncommander","dataformatter","timeline"];
};l.getAdditionalDOMElements=function(){m.getAdditionalDOMElements();this.snapshotInstances=[];this.$allSnapshots=this.$el.find("[data-widget*=Snapshot]");
this.totalDomElements+=this.$allSnapshots.length;};l.getWidgets=function(){m.getWidgets();this.getWidgetInstances(this.$allSnapshots,this.snapshotInstances,"Snapshot");
};l.onNotifiedFetcher=function(o,n){m.onNotifiedFetcher(o,n);if(o.changeObject.type===e.NEW_DATA_AVAILABLE&&i.has(o.changeObject.data,"descriptionExists")){if(o.changeObject.data.descriptionExists){a(".pg-observed-input").addClass("pg-input-error").siblings("button").removeClass("rename-button--available").addClass("rename-button--unavailable");
}else{a(".pg-observed-input").removeClass("pg-input-error").siblings("button").removeClass("rename-button--unavailable").addClass("rename-button--available");
a(".pg-observed-button").trigger("clickConfirmed");}}else{if(o.changeObject.type===e.NEW_DATA_AVAILABLE&&i.has(o.changeObject.data,"action")){var p=o.changeObject.data;
this.action=p.action;this.updateUI(p);this.updateSchedulingUi(p);}}};l.onNotifiedFormatter=function(o,n){m.onNotifiedFormatter(o,n);
};l.onNotifiedViewCreator=function(o,n){m.onNotifiedViewCreator(o,n);a("[id^=valueSelectorCarrier]").on("mousewheel",function(){event.stopPropagation();
});if(this.action==="New Split"||this.action==="New Tree"){a(".dimension-selector, .icon-times").removeClass("inactive").addClass("active");
}if(this.action==="Under Schedule"){a(".dimension-selector, .icon-times").addClass("deactivate-scheduling");}this.$el.trigger(b.EV_CONTENT_MERGED);
if(o.changeObject.type===g.CHART_RENDERED){i.each(this.actionCommanderInstances,function(q){var p=i.cloneDeep(q.actions);
var r=p.splice(20);q.unbindEvents(r);q.setUpEvents(r);});}};l.updateUI=function(r){if(r.action==="New Tree"){a("#harpTreePicker").append('<option value ="'+r.treeId+'">'+r.treeName+"</option>");
a("#treeName").val(r.treeName);a("#step2_toggle,#step3_toggle").css({"pointer-events":"all"});a("#step2_toggle").slideDown();
a(".dimension-selector, .icon-times").removeClass("inactive").addClass("active");}if(r.action==="Get Tree"){a(".dimension-selector, .icon-times").removeClass("active").addClass("inactive");
a("#step2_toggle,#step3_toggle").css({"pointer-events":"all"});if(r.pspVisibleOnly===true){a("#permission_switch_container").removeClass("switch-off").addClass("switch-on");
}a("#treeName").val(r.treeName);a("#pg-obscuring-screen").hide();}if(r.action==="Delete Tree"){a("path, .link, .harpnode").remove();
a("#harpTreePicker option[value='"+r.treeId+"']").remove();a("#harpTreePicker").val("-1");a("#step2_toggle, #step3_toggle").css({"pointer-events":"none"});
}if(r.action==="Update Tree"){var p=r.treeName;var q=r.treeId;if(r.isTemplate){a("#harpTemplatePicker").append('<option value ="'+q+'">'+p+"</option>");
a("#message").text("Template Named "+p+" has been created!").fadeIn(1000,function(){var s=a(this);setTimeout(function(){s.fadeOut(2000);
},1000);});}else{if(r.treeName!==a("#treeName").val()){a("#message").text("Tree has been succesfully renamed to: "+p).fadeIn(1000).delay(1000).fadeOut(2000);
}else{a("#message").text("Psp Visibility for this tree has changed to: "+((a("#permissionSwitch").attr("checked"))?"true":"false")).fadeIn("slow").delay("1000").fadeOut("slow");
}a(".tree-header").text(p);a("#treeName").val(p);a("#edit_controller").slideUp();a("#harpTreePicker option[value='"+r.treeId+"']").text(p);
}}if(r.action==="New Split"){var o=a("#hn_"+r.parentNodeId);o.addClass("pg-parent-node").removeClass("pg-end-node").find(".button-container .button-content").css("display","block");
a("#pg-obscuring-screen").hide();}if(r.action==="Delete Nodechildren"){a("#hn_"+r.possibleNewDimensions[0].nodeId).removeClass("pg-parent-node").addClass("pg-end-node");
this.$el.trigger("deleteNodeChildren",{data:r});}if(r.action==="Update Node"){a("#harp-dialog-overlay").hide();var n={};n.message="Description saved";
n.containerClass="success";n.iconClass="icon-adyen-activate";this.showNotification(n);}};l.updateSchedulingUi=function(p){var n=new Date();
if(i.has(p,"action")&&p.action==="Schedule Report"){n.setTime(p.schedulingDate);var o=n.toFormattedString("yyyy-mm-dd").split(" ")[0];
a("#schedule_msg").text("Scheduling Report starting from "+o);a("#datepickStart").val(o).text(o);a(".harp-edit-button").removeClass("harp-enabled").addClass("harp-disabled").attr("disabled",true);
a(".availability-message").show();a(".dimension-selector, .icon-times").addClass("deactivate-scheduling");a("#showSchedulingDialog").attr("disabled",true);
a("#harp-dialog-overlay").hide();return;}if(p.scheduling&&p.scheduling.status==="no data"){n=k(p.scheduling);a("#schedule_msg").text("Not Scheduled");
a(".harp-edit-button").removeClass("harp-disabled").addClass("harp-enabled").attr("disabled",false);a(".availability-message").hide();
a("#showSchedulingDialog").attr("disabled",false);a("#datepickStart").val(n).text(n);return;}if(p.scheduling&&p.scheduling.status==="runnning"){n=k(p.scheduling);
a("#schedule_msg").text("Scheduling Report starting from "+n);a(".harp-edit-button").removeClass("harp-enabled").addClass("harp-disabled").attr("disabled",true);
this.action="Under Schedule";}if(p.scheduling&&p.scheduling.status==="completed"){n=k(p.scheduling);a("#schedule_msg").text("This report is already scheduled containg data from: "+n);
a(".dimension-selector, .icon-times").removeClass("deactivate-scheduling").addClass("active");a("#showSchedulingDialog").attr("disabled",false);
}};function k(o){var n=new Date();if(o.status==="no data"){n.setTime((new Date()).setDate((new Date()).getDate()-2));}else{n.setTime(o.firstDataStartDate);
}return n.toFormattedString("yyyy-mm-dd").split(" ")[0];}l.forceRebindGlobal=function(){i.each(this.actionCommanderInstances,function(o){var n=i.cloneDeep(o.events);
var p=n.splice(20);o.unbindEvents(p);o.setUpEvents(p);});};l.forceRebindTargeted=function(n){var o=[];i.each(n,function(p){o.push(p.source);
});i.each(this.actionCommanderInstances,function(t){var p=i.cloneDeep(t.events);var u=[];for(var s=p.length;s>0;s--){var r=p[s-1];
if(o.indexOf(r.source)!==-1){var q=o.indexOf(r.source);if(typeof(n[q].eventType)==="object"){if(r.source===n[q].source&&n[q].eventType.indexOf(r.event)!==-1){u.push(r);
}}else{if(r.source===n[q].source&&n[q].eventType===r.event){u.push(r);}}}}t.unbindEvents(u);t.setUpEvents(u);});};l.showNotification=function(p){window.clearTimeout(window.errormessage);
var q=p.message;var o=p.containerClass;var n=p.iconClass;var s="<div class='csr-notification-message-2 "+o+"'> <ul><li><i class=' "+n+" '></i>"+q+"</li></ul></div>";
var t=a("#message");var r=a("#message-container");t.html(s);t.addClass(o);r.addClass("pg-shown");t.fadeIn("fast",function(){window.errormessage=setTimeout(function(){t.fadeOut("slow",function(){t.html("");
t.removeClass(o);r.removeClass("pg-shown");});},2000);});};l.getInstance=function(){return this;};l.init();j.ready();return l;
};return d;});define("chart/widgetFramework/composed/mfpReport/mfpLineRollover",["jqueryExtended","underscore","d3","chart/widgetFramework/core/mixins/widgetScales","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/WidgetConstants","util/ObjectSuper","chart/widgetFramework/chartTypes/rollover","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/core/constants/UIConstants"],function(b,j,l,k,a,f,c,g,i,d,h){var e=function(s,m,q,o){var p;
var r={};var n=j.defaults(r,s);p=i(n,m);var t=g(p);p.thinBarWidth=3;p.init=function(){t.init();this.barUtils.barSelectorStr=".bar.mfp-line-rollover";
this.barUtils.barClassStr="bar mfp-line-rollover";};p.feedData=function(v){var u=j.filter(v.chartData,function(w){return w.programName===p.options.dataSubset;
});if(!a.existy(u[0])){return d.HALT_RENDER_PROCESS;}this.data=u[0].history;};p.renderData=function(){var u=this.options.centerBars;
this.barUtils.chartWidth=this.width;this.barUtils.chartHeight=this.height;var v;v=this.barUtils.barPosition(u,this.bandSize,this.getXScale(),this.options.joinAttr);
this.barUtils.containerBarsVertical(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),v).fullBarVertical(this.thinBarWidth,"thin-bar one",null,90).fullBarVertical(this.thinBarWidth,"thin-bar two",null,138).fullBarVertical(this.barSize,"dateStr");
};p.tooltipOnMouseoverAction=function(v,u){this.$el.trigger(h.CHART_TO_VIEW_EVENT,{type:"lineChartRollover",data:v});this.sharedMouseAction(u,0.25,1);
};p.tooltipOnMouseoutAction=function(v,u){this.$el.trigger(h.CHART_TO_VIEW_EVENT,{type:"lineChartRolloverReset",data:v});
this.sharedMouseAction(u,0,0);};p.sharedMouseAction=function(D,A,E){var w=D.find(".dateStr");var z=w.attr("data-id");var C=D.find(".thin-bar");
l.selectAll(C).style("opacity",A);var x=D.find(".thin-bar.two");l.select(x[0]).attr("transform","translate("+(-(this.thinBarWidth/2))+",117)");
var B=D.closest(".csr-panel-content-2");var y=["chargeback-tx","chargeback-rates"],v,u;j.each(y,function(G){v='.line-holder-dot[data-id*="'+z+'"]';
var F=B.find(v);u=l.selectAll(F).style("fill-opacity",E).style("stroke-opacity",E);});};p.positionTooltip=function(y,A,x,z,u,v,B){var w=y.top+x-10-u+(B/2);
var C=((y.right-A-10)+z)-(v/2)-10;return{top:w,left:C};};p.enhanceTooltipData=function(w){var u=l.time.format("%Y-%m-%d");
var z=l.format("0,000");var B=l.format(".2f");if(w.settledCountStartDate){var x=new Date(w.settledCountStartDate);w.settledCountStartDateTT=u(x);
}if(w.settledCountEndDate){var v=new Date(w.settledCountEndDate);w.settledCountEndDateTT=u(v);}w.settledAmountTT=z(w.settledAmount);
if(w.countStartDate){var y=new Date(w.countStartDate);w.countStartDateTT=u(y);}if(w.countEndDate){var A=new Date(w.countEndDate);
w.countEndDateTT=u(A);}w.amountTT=l.format("0,000")(w.amount);w.rateTT=B(w.rate)+"%";};return p;};return e;});define("chart/widgetFramework/composed/shopperDnaBeta/shopperDnaBetaMediator",["jquery","lodash","chart/widgetFramework/core/BasicMediator","util/ObjectSuper"],function(e,b,c,d){function a(f){var g=c(f,true);
var h=d(g);g.init=function(){h.init();this.actionCommanderExclusionArray=["actioncommander"];g.$el.trigger("widgetAppStartup");
};g.mediatorReady=function(){h.mediatorReady();var j=b.indexBy(this.formatterInstances,"id");var i="data-trigger-formatter";
e("["+i+"]").on("click",function(){var k=e(this).attr(i);var l=j[k];g.triggerFormatter(l,function(){g.updateState();});});
};g.triggerFormatter=function(i,j){if(i.options.silentFormat){i.options.silentFormat=i.silentFormat=false;i.formatData();
j();}};g.updateState=function(j){j=j||this.state||{};var i=b.get(j,"temporary",false);if(i){this.temporaryState=j;g.$el.trigger("temporaryStateUpdated",{data:j});
}else{this.state=j;g.$el.trigger("stateUpdated",{data:j});}};g.init();f.ready();return g;}return a;});define("chart/widgetFramework/composed/riskReport/rollovers/riskChecksStackedRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/chartTypes/axisRollover"],function(b,h,j,a,e,g,f,d,c){var i=function(q,k,o,m){var n;
var p={};var l=h.defaults(p,q);n=c(l,k);var r=f(n);n.init=function(){r.init();this.barUtils.setBarSelectorStr(".bar.risk-checks-stacked-rollover");
};n.positionTooltip=function(w,y,v,x,s,t,z){var u=w.top+v-s+((w.bottom-w.top)/2);var A=((w.left+y)-x)+(w.width+10);return{top:u,left:A};
};return n;};return i;});define("chart/widgetFramework/core/DataFormatter",["jqueryExtended","underscore","chart/widgetFramework/core/constants/DataConstants","util/Functional","chart/widgetFramework/core/drivers/observableCode","chartutil/domUtils"],function(a,k,h,e,b,i){var l="color:cornflowerblue;font-size:1em";
var c=false;var f="color:#5bda61;font-size:1em";var g=false;var d=false;var j=function(m){var n={};b(n,"formatter");n.init=function(){k.bindAll(this,"onNotifiedNewData");
this.$el=m.getNode();this.id=this.$el.attr("id");this.formatter=null;this.timeline=null;var r=this.parameters=this.getParameters(m);
var q=r.formatterName;this.options=r.options;var s=r.datasetName;this.dataFetcherContainer=a("#"+s);if(window.console&&console.log&&d){console.log("### DataFormatter2::init:: getting dataFetcher promise----");
}this.dataFetcherContainer.widget().then(function(t){n.dataFetcher=t.instance;n.dataFetcher.registerObserver(n.onNotifiedNewData,false,n.id);
},function(){if(window.console&&console.warn){console.warn("DataFormatter:: Error finding fetcher '"+q+"'",arguments);}});
var p=r.timeline;var o=(p&&p.indexOf("#")===-1)?a("#"+p):a(p);if(o.length){if(window.console&&console.log&&d){console.log("### DataFormatter2::init:: getting timeline promise----");
}o.widget().then(function(t){var u=t.instance;u.renderPromise.done(function(){n.timeline=u.timeline;});},function(){if(window.console&&console.warn){console.warn("DataFormatter:: Error loading timelineObject",arguments);
}});}this.silentFormat=(r.options&&r.options.silentFormat)?r.options.silentFormat:false;this.FormatterRef=null;this.requireFormatter(q);
i.removeDataAtrributes(this.$el,["options"]);};n.requireFormatter=function(o){require(["chart/widgetFramework/"+o],function(p){n.FormatterRef=p;
n.resolvedRequire=true;n.checkReady("require");},function(p){if(window.console&&console.log){console.log("DataFormatter2:: Formatter require error: ",p);
}});};n.onNotifiedNewData=function(p,o){if(window.console&&console.log&&c){console.log("%c\n################",f);console.log("%c### START STAGE :: DataFormatter::"+this.id+":: onNotifiedNewData pId="+o+" pData.type= "+p.changeObject.type,f);
console.log("%c################",f);}this.data=p.changeObject.data;this.hasData=true;this.checkReady("data");};n.checkReady=function(o){if(this.resolvedRequire&&this.hasData){this.createFormatter();
}};n.createFormatter=function(){if(!e.existy(this.formatter)){if(window.console&&console.log&&c){console.log("%c\n################",f);
console.log("%c### START STAGE :: DataFormatter::"+this.id+" ::formatData:: CREATING NEW FORMATTER",f);console.log("%c################",f);
}this.formatter=new this.FormatterRef(this.data,this.options,this.timeline,this.id);this.$el.on(h.FORMATTER_INFORM_WIDGET,k.bind(this.onFormatterToWidgetEvent,this));
this.formatter.$el=this.$el;}else{if(window.console&&console.log&&c){console.log("%c\n################",f);console.log("%c### START STAGE :: DataFormatter::"+this.id+" ::formatData:: UPDATING EXISTING FORMATTER",f);
console.log("%c################",f);}this.formatter.setRawData(this.data);}this.formatData();};n.getInstance=function(){return this.formatter;
};n.formatData=function(){if(e.existy(this.data)){if(window.console&&console.log&&c){console.log("%c\n################",f);
console.log("%c### START STAGE :: DataFormatter::"+this.id+" ::formatData:: formatting data",f);console.log("%c### START STAGE :: DataFormatter::"+this.id+" ::formatData:: silentFormat="+this.silentFormat,f);
console.log("%c################",f);}var o=this.formatter.formatData();this.setProperty("changeObject",{type:h.DATA_FORMATTED,data:o,silentFormat:this.silentFormat});
if(this.timeline){var p=this.parameters.timeline;if(this.parameters.timeline.indexOf("#")===-1){p="#"+this.parameters.timeline;
}setTimeout(function(){a(p).find("#timelineLoader").css("display","none");},1000);}if(this.silentFormat){this.silentFormat=false;
}}else{if(window.console&&console.log&&g){console.log("\n################ ","\n### DataFormatter:: "+this.id+" ::formatData:: no data to format","\n################ ");
}}};n.onFormatterToWidgetEvent=function(p,o){this.setProperty("changeObject",o);};n.getSortDirection=function(){return this.formatter.reverseDirection;
};n.getFormatter=function(){return this.formatter;};n.setData=function(o){this.data=o;};n.getData=function(o){return this.data||{};
};n.getParameters=function(o){var r=o.getNode().data();var p;if(k.keys(r).length){p=r;if(e.notFalsy(p.options)){if(!k.isObject(p.options)){if(window.console&&console.log){console.error("### DataFormatter::getParameters:: options JSON has not parsed correctly, option=",p.options);
}}}}else{o.parameters.options=a.parseJSON(o.parameters.options);p=o.parameters;}var q={};if(k.keys(p).length){q.formatterName=p.formatter;
q.datasetName=p.dataset;q.options=p.options;q.timeline=p.timeline;}else{throw"The parameters are not well defined"+p;}return q;
};n.init();if(window.console&&console.log&&d){console.log("\n### DataFormatter2::constructor:: calling pWidgetApi.ready()");
}m.ready();return n;};return j;});define("chart/widgetFramework/composed/revenueProtect/revenueProtectMediator",["jqueryExtended","lodash","d3","chart/widgetFramework/core/BasicMediator","util/ObjectSuper","chartutil/numberutils","chartutil/d3utils","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/core/constants/DataConstants","util/Functional","chartutil/cssutils"],function(a,k,m,j,g,f,n,i,e,c,l){var b=false;
var d=false;var h=function(o){var p;p=j(o,true);var s=g(p);p.init=function(){s.init();this.actionCommanderExclusionArray=["actioncommander","dataformatter","viewcreator","timeline"];
};p.getAdditionalDOMElements=function(){s.getAdditionalDOMElements();this.timelineInstances=[];this.$allTimelines=this.$el.find("[data-widget*=Timeline]");
this.totalDomElements+=this.$allTimelines.length;};p.getWidgets=function(){s.getWidgets();this.getWidgetInstances(this.$allTimelines,this.timelineInstances,"Timelines");
};p.onNotifiedFetcher=function(u,t){s.onNotifiedFetcher(u,t);if(t==="revOpBlockReportDataFetcher"){var v=u.changeObject.data.conversionOptimizations;
this.populateReportBlocks(v.rows);}};p.onNotifiedFormatter=function(t,z){s.onNotifiedFormatter(t,z);var w=a("#totalsList");
var D=m.format(".2f");var y=m.format(",.2f");var u,A,B;if(z==="txVolumeStackedFormatter"){var x=t.changeObject.data;var C=m.format(",.0f");
var v=n.getCollectionSum(x,"authorisations");f.animateValue(w.find("#authTotal"),v,C,false);}if(z==="revProRefusalRatesFormatter"){B=t.changeObject.data.chartData;
if(!B){if(window.console&&console.log){console.warn("### revenueProtectMediator::onNotifiedFormatter:: pId=",z," NO LINE DATA #####");
}return;}u=q(B,"Refused by bank","percent");f.animateValue(w.find("#refusedByBankRate"),u,D,false);A=r(B,"Refused by bank","refusedEurQuantity");
w.find("#refusedByBankEur").html(y(A));u=q(B,"Refused by Adyen risk","percent");f.animateValue(w.find("#refusedByRiskRate"),u,D,false);
A=r(B,"Refused by Adyen risk","refusedEurQuantity");w.find("#refusedByRiskEur").html(y(A));}if(z==="revProChargebackFormatter"){B=t.changeObject.data.chartData;
if(!B){if(window.console&&console.log){console.warn("### revenueProtectMediator::onNotifiedFormatter:: pId=",z," NO LINE DATA #####");
}return;}u=q(B,"Chargeback","percent");f.animateValue(w.find("#chargebackRate"),u,D,false);A=r(B,"Chargeback","refusedEurQuantity");
w.find("#chargebackEur").html(y(A));}};p.onNotifiedViewCreator=function(w,u){s.onNotifiedViewCreator(w,u);var t=w.changeObject;
var v=t.type;};var q=function(v,t,x){var u=k.filter(v,function(z){return z.name.toLowerCase()===t.toLowerCase();});var y=n.getCollectionSum(u[0].lineValues,x);
var w=y/u[0].lineValues.length;return w;};var r=function(v,t,w){var u=k.filter(v,function(y){return y.name.toLowerCase()===t.toLowerCase();
});var x=n.getCollectionSum(u[0].lineValues,w);return x/100;};p.populateReportBlocks=function(z){var C=this;var B,t,A,x=m.format(",.2f"),y=m.format(",.0f"),D=m.format(",.4f");
if(z.length===0){var u={product:"AutoRetries",rescued:0,rescuedPercentage:0,rescuedEurQuantity:0};var w={product:"IntelligentPaymentRouting",rescued:0,rescuedPercentage:0,rescuedEurQuantity:0};
var v={product:"SmartIssuerLogic",rescued:0,rescuedPercentage:0,rescuedEurQuantity:0};z.push(u);z.push(w);z.push(v);}k.each(z,function(G,F){var E="[data-product-id='"+G.product+"']";
B=C.$el.find(E);if(B.length){t=B.find(".report-numbers--price.--rescued-amt");if(t.length){f.animateValue(t,G.rescued,y,true,F);
}}});};p.getInstance=function(){return this;};p.init();o.ready();return p;};return h;});define("chart/widgetFramework/composed/cardAcquirerAuthorizationReport/formatters/paymentMethodBarFormatter",["jqueryExtended","underscore","d3","chart/widgetFramework/core/constants/DataConstants"],function(e,b,c,d){function a(j,g,i,l){var h={};
h.data=j;h.options=g;h.formattedData={};h.comparator=null;h.reverseDirection=false;h.sortKey="authorizationRate";h.timeline=i;
h.id=l;h.formatData=function(){var m=this.data.paymentMethod_aggregation?this.data.paymentMethod_aggregation:{};if(m.length===0){return[];
}this.formattedData=k(m);if(this.sortKey){this.reverseDirection=!this.reverseDirection;this.sortData(this.sortKey,true);}return{chartData:this.formattedData};
};var k=function(o){var n=[];o=b.filter(o,function(p){return typeof p.paymentMethod!=="undefined"&&!(b.isNull(p.paymentMethod));
});o=b.filter(o,function(p){return +p.authorisedCount>0&&+p.authRate>0;});var m=c.sum(o,function(p){return +p.authorisedCount;
});b.each(o,function(r){var q=+r.authRate*100,p=100-q;n.push({labelName:f(r.paymentMethod),authorizedCount:+r.authorisedCount,authorizedCountShare:m===0?0:+r.authorisedCount/m*100,authorizedEurAmount:+r.authorisedAmount/100,authorizationRate:q,authRate:[{name:"authorized",value:q,startX:0,endX:q},{name:"refused",value:p,startX:q,endX:100}],total:100,name:"authorized"});
});return n;};var f=function(m){var n=m.charAt(0).toUpperCase()+m.slice(1);return n.replace(/_/g," ");};h.sortData=function(m,o){this.sortKey=m;
if(this.sortKey===this.oldSortKey){this.reverseDirection=!this.reverseDirection;}else{this.reverseDirection=false;}this.oldSortKey=this.sortKey;
var n=b.sortBy(this.formattedData,m);if(this.reverseDirection){n.reverse();}this.formattedData=n;if(o===true){return;}this.$el.trigger(d.FORMATTER_INFORM_WIDGET,{type:d.SORTED_DATA,data:{chartData:this.formattedData}});
};h.compareFunction=function(m){return m[this.sortKey];};h.getData=function(){return(this.data)?this.data:this.formatData();
};h.setRawData=function(m){this.data=m;};h.retrieveData=function(m){return this.data[m];};return h;}return a;});define("chart/widgetFramework/composed/settlementBatchWidget/settlementBatchWidget",["jquery","underscore","d3","hogan","util/ObjectSuper","util/Functional","chartutil/d3utils","chart/widgetFramework/chartTypes/barChart"],function(c,g,h,e,f,b,i,d){var a=function(p,j,n,l){var m;
var o={};var k=g.defaults(o,p);m=d(k);var q=f(m);m.el=j;m.init=function(){q.init();};m.feedData=function(r){if(typeof r!=="undefined"){if(typeof r.batches!=="undefined"){m.data=r.batches;
}}};m.renderData=function(){q.renderData();i.highlightCurrentDay(this.$el,this.options.xAttr,this.data);};return m;};return a;
});define("chart/widgetFramework/composed/baseline/AggregateDataFD",["jqueryExtended","underscore","d3","chartutil/dateUtils_CET","chart/widgetFramework/core/constants/DataConstants"],function(f,a,b,e,d){function c(h,g){this.data=h;
this.options=g;this.formattedData={};this.ticks=this.data.ticks;this.baselineData=this.data.baselineData;this.comparator=this.compareFunction;
this.reverseDirection=false;this.sortKey=null;}c.prototype.formatData=function(){if(!this.ticks){this.aggregatedData=[];return this.aggregatedData;
}this.aggregatedData=this.createAggregateData();var h=a.max(this.aggregatedData,function(i){return i.tx;});var g=h.tx;this.aggregatedData.forEach(function(j){var i=0;
f.each(j.barArray,function(l,n){if(j.pmName){n.pmName=j.pmName;}n.startX=j.total>0?i:0;var k=j.total>0?Math.max(0,n.value)/j.total:0;
var m=g*k;n.endX=n.startX+m;i+=m;});});if(this.sortKey){this.reverseDirection=!this.reverseDirection;this.sortData(this.sortKey,true);
}return{chartData:this.aggregatedData};};c.prototype.createAggregateData=function(){var j=["authorised","abandoned"];var g=[];
var h=this;this.ticks.each(function(n,q){n=e.trueRoundToDay(n);var t=n.toFormattedString();var p=t.substring(0,t.lastIndexOf("-"));
var o=h.getTotalsByMonth(p,q===0);var m=h.getAuthsByMonth(p);var u=h.getRatesByMonth(p);var r=(q===0)?"%b '%y":"%b";var l=b.format("0,000");
var k={};k.tx=l(o);k.auths=l(m);k.authRate=Number(b.format(".1f")(u));k.pmName=b.time.format("%b")(n);var s={};s.date=n;s.auths=m;
s.tx=o;s.authRate=Number(b.format(".1f")(u));s.pmName=b.time.format(r)(n);s.totalsArray=[];s.totalsArray.push(k);s.barArray=[];
j.forEach(function(w){var v={};v.name=w;if(w==="authorised"){v.value=m;}else{if(w==="abandoned"){v.value=o-m;}}s.barArray.push(v);
});g.push(s);});var i=a.max(a.pluck(g,"tx"));g.forEach(function(k){k.barArray.push({name:"rest",value:i-k.tx});k.total=i;
});return g;};c.prototype.getTotalsByMonth=function(h,i){var g=this.getAmountByMonth(h,"total",i);return g;};c.prototype.getAuthsByMonth=function(h){var g=this.getAmountByMonth(h,"authorisations");
return g;};c.prototype.getRatesByMonth=function(g){var h=(this.getAuthsByMonth(g)/this.getTotalsByMonth(g))||0;return h*100;
};c.prototype.getAmountByMonth=function(i,l,k){var j=0;var h=a.map(this.baselineData,function(m){if(m.amsDate&&m.amsDate.toFormattedString().indexOf(i)>-1){j+=m[l];
return m[l];}return false;});var g=a.reduceRight(h,function(m,n){return m+n;},0);return g;};c.prototype.sortData=function(g,i){this.sortKey=g;
this.reverseDirection=!this.reverseDirection;var h=a.sortBy(this.aggregatedData,g);if(this.reverseDirection){h.reverse();
}this.aggregatedData=h;if(i===true){return;}this.$el.trigger(d.FORMATTER_INFORM_WIDGET,{type:d.SORTED_DATA,data:{chartData:this.aggregatedData}});
};c.prototype.compareFunction=function(g){return g[this.sortKey];};c.prototype.getData=function(){return(this.aggregatedData)?this.aggregatedData:this.formatData();
};c.prototype.setRawData=function(g){this.data=g;this.ticks=this.data.ticks;this.baselineData=this.data.baselineData;};c.prototype.setOptions=function(g){this.options=g;
};return c;});define("chart/widgetFramework/composed/shopperdna/formatters/shopperDnaBundleFormatter",["jquery","lodash","d3"],function(h,c,e){function d(i){this.data=i;
this.formattedData={};}d.prototype.formatData=function(){var m=c.chain(this.data).map(function(o){var n=c.get(adyen,"config.pspRef");
if(n&&c.has(o,"eventidentifiers")&&(n===o.pspreference)){o.eventidentifiers.pspref=n;}return o;}).value();var l=a(m);var k=b(m);
var i=this.getHierarchies(m);var j=this.getMatrix(i);this.formattedData={data:m,hierarchies:i,matrix:j,identifiersMap:k,cardNumberMap:l};
return this.formattedData;};d.prototype.getHierarchies=function(j){var k=[];var i=f(j);c.each(i.children,function(l){l.children=c.chain(j).groupBy(function(m){var n=l.name;
return m.eventidentifiers[n];}).map(function(n,o){var m={name:o,key:o,parent:l,childNodes:n};if(!c.isUndefined(o)){k.push(m);
}return m;}).filter(function(m){return(m.name!==""&&m.key!=="undefined"&&m.value!=="undefined");}).value();});c.each(i.children,function(l){c.each(l.children,function(n){if(n.childNodes){var m=[];
c.each(n.childNodes,function(o){var q=[];for(var p in o.eventidentifiers){if(o.eventidentifiers.hasOwnProperty(p)){var r=o.eventidentifiers[p];
q.push(r);}}c.each(q,function(s){var t=c.findWhere(k,{name:s});if(typeof t!=="undefined"&&t.name!==""){m.push({childNode:t});
}});});n.childNodes=c.unique(m,false,function(o){return o.childNode.name;});}});});c.each(i.children,function(l){if(l.name==="ShopperEmail.email"){l.children.sort(function(o,n){var m=o.key.substr(o.key.indexOf("@")+1);
var r=n.key.substr(n.key.indexOf("@")+1);var q=o.key.substr(0,o.key.indexOf("@"));var p=n.key.substr(0,n.key.indexOf("@"));
if(m<r){return -1;}if(m>r){return 1;}if(q<p){return -1;}if(q>p){return 1;}return 0;});}else{if(l.name==="IPAddress.ip"){l.children.sort(function(n,m){var p=n.key.split(".");
var o=m.key.split(".");if(+p[0]<+o[0]){return -1;}if(+p[0]>+o[0]){return 1;}if(+p[1]<+o[1]){return -1;}if(+p[1]>+o[1]){return 1;
}if(+p[2]<+o[2]){return -1;}if(+p[2]>+o[2]){return 1;}if(+p[3]<+o[3]){return -1;}if(+p[3]>+o[3]){return 1;}return 0;});}else{l.children.sort(function(o,n){var m=o.key.toLowerCase(),p=n.key.toLowerCase();
if(m<p){return -1;}else{if(m>p){return 1;}}return 0;});}}l.children=c.map(l.children,function(n,m){n.order=m;return n;});
});return i;};d.prototype.getMatrix=function(i){var m=i.children;var l=e.map();var k=e.map();var j=[];var o=0;m.forEach(function(n){if(!k.has(n.name)){l.set(o,n.name);
k.set(n.name,o++);n.matrixIndex=o;}});m.forEach(function(s){var q=k.get(s.name);var r=j[q];if(!r){r=j[q]=[];for(var p=-1;
++p<o;){r[p]=0;}}var n=c.filter(s.children,function(t){return t.name!=="";});r[k.get(s.name)]=n.length;});return j;};function a(j){if(!c.isArray(j)){return j;
}var i=c.reduce(j,function(l,k){var p=c.get(k,'eventidentifiers["HashedCardNumber.value"]');if(p&&!c.has(l,p)){var n=c.get(k,'eventmetrics["BIN.value"]');
var m=c.get(k,'eventmetrics["CardNumberSummary.value"]');if(n&&m){var o=(n+"***"+m);c.set(l,p,o);}}return l;},[]);return i;
}function b(j){if(!c.isArray(j)){return j;}var i=c.reduce(j,function(m,l,n){var k=c.get(l,"eventidentifiers");if(!c.isObject(k)){return m;
}c.each(k,function(p,o){if(m[o]){if(m[o][p]){m[o][p].push(n);}else{m[o][p]=[n];}}else{m[o]={};m[o][p]=[n];}});return m;},{});
return i;}function f(j){if(!c.isArray(j)){return j;}var i={name:"root",children:[]};i.children=g(j,i);return i;}function g(k,i){if(!c.isArray(k)){return k;
}var j=c.chain(k).map(function(l){return c.keys(l.eventidentifiers);}).flatten().unique().map(function(l){return{name:l,key:l,parent:i,children:[]};
}).value();return j;}return d;});define("chartlib/ui/baseui",["jquery","underscore","backbone","chartutil/cssutils"],function(d,b,e,a){var c=e.View.extend({constructor:function(){this.buttons=[];
e.View.apply(this,arguments);},renderButtons:function(f){var g;d(this.buttons).each(function(h,i){i.removeClass("selected");
g=i.find(".arrow");g.removeClass("selected");});if(!f){return;}f.addClass("selected");g=f.find(".arrow");g.addClass("selected");
this.rotateArrow(g);},rotateArrow:function(h){var i=(this.collection.getReverseDirection())?180:0;var g=(this.collection.getReverseDirection())?0.5:0;
var f=(this.collection.getReverseDirection())?0.5:0;a.rotateElement(h,i,g,f);},infoOver:function(g){var f=d(g.currentTarget);
var h=d(f.attr("data-rel"));this.positionPanel(f,h);h.fadeTo(500,1);f.on("mouseout",{infoPanel:h},this.infoOut);},infoOut:function(f){var g=f.data.infoPanel;
g.off();g.fadeTo(250,0);},infoShow:function(i){var k=d(".chart-info").hide();var g=d(i.currentTarget);var j=d(g.attr("data-rel"));
this.positionPanel(g,j);j.fadeTo(500,1);var f=j.find("#removeBtn");var h=(f.length)?f:j;h.on("click",{infoPanel:j,closeElement:h},this.infoHide);
},positionPanel:function(o){var m=20,j;var h=d(o);var g=h.position().left;var k=h.offset().left;var n=d(h.attr("data-rel"));
var i=d(window).width();var l=n.width();var f=n.position().left;if(k+m+l>i){j=Number(g)-m-Number(l);}else{j=m;}n.css("left",(j+"px"));
},infoHide:function(g){var h=g.data.infoPanel;var f=g.data.closeElement;f.off();h.fadeTo(250,0);}});return c;});define("chart/widgetFramework/composed/harpReportBuilderV2/HarpBuilderActions",["jqueryExtended","underscore","json","Constants","text!chart/widgetFramework/composed/harpReportBuilderV2/templates/harpGroupCard.html","text!chart/widgetFramework/composed/harpReportBuilderV2/templates/harpGroupCardEntry.html"],function(ay,ab,o,I,y,S){var l=ay;
var j="tree-selected";var aj="dimension-selectbox";var C="dimension-values-list";var aI="pg-main-dimension-values-list";var X="csr-panel-content-2";
var aa="csr-list-container-2";var L="csr-list-2";var an="list-placeholder";var ai="csr-list-extension-2";var Z="list-extension-content";
var aL="card-title-content";var E="card-content-search-input";var aH="transitioning";var P="transitioned";var k="transitioned-";
var aA="button-container";var d="add-group-button";var m="button-add-selection";var al="csr-button-submit-2";var aN="remove-mode";
var T="group-cards-container";var aw="group-card";var g="group-card-transitioning";var H="group-card-opened";var R="group-card-header";
var z="group-card-name";var aD="group-card-content-list";var am="group-card-color-";var D="csr-list-container-2--search-visible";
var aG="group-card-content--search-visible";var av="card-title-delete-button";var N="icon-search";var h="disabled";var K="show";
var Q="hidden";var ar="selected";var q="error";var af=11;var aE="data-origin-index";var e="data-group-color-index";var r=240;
var A={};var p=["D0E39E","A9D6A6","75Be9C","60A397","378888","37638D","04486C","152F47"];var aK=[];var ah=function(aS,aR){var aO=aR.parents("."+aa).find("."+T);
n(aO);var aQ=a(aR,aO);var aP=U(aO);c(aQ,aP);setTimeout(function(){w(aQ);},10);return aQ;};var f=function(aS,aR){var aO=aR.parents("."+aa).find("."+T);
n(aO);var aQ=a(aR,aO);var aP=U(aO);c(aQ,aP);aQ.addClass(H).find("ul").trigger("checkSize");return aQ;};var n=function(aO){var aP=parseInt(aO.css("width"))+r;
aO.css("width",aP+"px");};var a=function(aR,aP){var aS=aR.parents("."+aw);var aQ;if(!aS.length){aP.prepend(y);aQ=aP.children("."+aw+":nth-child(1)");
}else{aS.after(y);var aO=aS.index()+2;aQ=aP.children("."+aw+":nth-child("+aO+")");}return aQ;};var U=function(aR){var aP=aR.parents("."+aa).find("."+C+":not(."+aD+")").attr("id");
if(!(aP in aK)){aK[aP]=[];}var aO={};var aT=null;var aS=p.length;for(var aQ=0;aQ<aS;aQ++){if(typeof(aK[aP][aQ])!=="number"||aK[aP][aQ]===0||(aK[aP][aQ]<aK[aP][(aQ+1)]&&aQ+1>=8)){aO.colorCode=p[aQ];
aO.colorIndex=aQ;break;}if(typeof(aT)!=="number"||aK[aP][aQ]<aT){aO.colorCode=p[aQ];aO.colorIndex=aQ;aT=aK[aP][aQ];}}if(typeof(aK[aP][aO.colorIndex])!=="number"){aK[aP][aO.colorIndex]=0;
}aK[aP][aO.colorIndex]+=1;return aO;};var c=function(aP,aO){aP.find("."+R).css("background-color","#"+aO.colorCode).attr(e,aO.colorIndex);
if(l("input:checked").parents("li:not(."+h+")").length!==0){O(aP.find("."+m));}};var w=function(aO){aO.addClass(g+" "+H).one("webkitTransitionEnd transitionend",function(){aO.removeClass(g).find("ul").trigger("checkSize");
l(".pg-apply-pattern-button").trigger("rebindForGroup");});};var u=function(aO){aO.children("li").removeClass(ar).find("input").attr("checked",false);
var aP=l("."+m);aP.removeClass(al).removeClass(aN);};var B=function(aU){var aP=aU.parents("."+aw);var aR=aP.find("li");var aT=aP.parents("."+aa);
var aQ=aT.find("."+C+":not(."+aD+")");var aS=aP.find("."+R).attr(e);aR.each(function(){var aV=ay(this);l(aQ.children()[aV.attr(aE)]).removeClass(h+" "+ar+" "+am+aS).find("input").prop("checked",false).prop("disabled",false);
});var aO=aP.parents("."+aa).find("."+C+":not(."+aD+")").attr("id");aK[aO][aS]-=1;aP.addClass(g).removeClass(H).one("webkitTransitionEnd transitionend",function(){aP.remove();
var aV=parseInt(aP.parent().css("width"))-r;aP.parent().css("width",aV+"px");});if(!aT.find("."+ar+":not(."+h+")").length){aT.find("."+m).removeClass(al);
}};var ax=function(aT,aU,aQ){if(aU.hasClass(h)){aQ.preventDefault();return false;}aU.toggleClass(ar);var aS=aU.find("input");
aS.attr("checked",!aS.attr("checked"));var aP=aU.parents("."+aa).find("."+C+" ."+ar+":not( ."+h+" )");var aR=aP.parents("ul");
var aV=l("."+m);aV.removeClass(aN);if(aP.length){aV.addClass(al);if(aR.length===1){if(aR.hasClass(aD)){var aO=aR.parents("."+aw).find("."+m);
aO.addClass(aN);}}}else{aV.removeClass(al);}aS.attr("checked",!aS.attr("checked"));};var W=function(aU,aP,aS){var aO=l(aS.srcElement);
aO.addClass("pg-to-ignore");var aR=aP.parents("."+aa).find("."+C+" input:checked").parents("li:not( ."+h+" )");var aT=aR.parents("ul");
var aV=l("."+m);aV.removeClass(aN);if(aR.length){aV.addClass(al);if(aT.length===1){if(aT.hasClass(aD)){var aQ=aT.parents("."+aw).find("."+m);
aQ.addClass(aN);}}}else{aV.removeClass(al);}aO.removeClass("pg-to-ignore");};var O=function(aQ){var aR=aQ.parents("."+aw).find("."+aD);
var aU=aQ.parents("."+aw);var aP=aQ.parents("."+aa);var aO=aP.find("."+C);var aS=aO.index(aR);var aT=aU.find("."+R).attr(e);
V(aR,aP,aT);M(aQ,aP,aR,aO,aS);if(aQ.hasClass(aN)){ag(aQ,aP,aR,aT);}u(aR);aQ.trigger("reload");setTimeout(function(){if(aR.parent().find("."+E).val()===""){aR.trigger("checkSize");
}},500);};var V=function(aP,aO,aR){var aQ=aO.find("."+aI+" input:checked");aQ.each(function(){var aS=ay(this).parents("li");
if(aS.hasClass(h)){return true;}aP.prepend(S);var aT=aP.children("li:nth-child( 1 )");aT.addClass(k+"left").attr(aE,aS.index()).append(aS.html()).removeClass(Q);
setTimeout(function(){aT.removeClass(P+" "+k+"left").one("webkitTransitionEnd transitionend",function(){aT.removeClass(aH);
});},50);aS.addClass(ar+" "+h+" "+am+aR).find("input").attr("disabled","disabled");});};var M=function(aQ,aP,aR,aO,aT){var aS=aQ.parents("."+aw).siblings("."+aw).find("input:checked");
aS.each(function(){var aX=ay(this).parents("li");var aY=aO.index(aX.parents("."+aD));var aW=(aT-aY)/Math.abs(aT-aY);var aU=aW===-1?k+"left":k+"right";
var a2=aW===-1?k+"right":k+"left";var a1=aP.find("."+C+":not(."+aD+")");var aV=(aX.attr(aE)*1)+1;var a0=a1.find("li:nth-child("+aV+")");
var aZ=aR.parents("."+aw).find("."+R).attr(e);aq(aX,a0,aZ,aU);F(aR,aX,a2);});};var aq=function(aR,aO,aP,aQ){aO.removeClass().addClass(ar+" "+h+" "+am+aP);
aR.addClass(aH);setTimeout(function(){aR.addClass(P+" "+aQ).one("webkitTransitionEnd transitionend",function(){var aS=aR.parent();
aR.remove();if(aS.parent().find("."+E).val()===""){aS.trigger("checkSize");}});},50);if(aR.hasClass(Q)){aR.remove();}};var F=function(aP,aO,aQ){aP.prepend(S);
var aR=aP.children("li:nth-child( 1 )");aR.addClass(aQ).attr(aE,aO.attr(aE)).append(aO.html()).removeClass(Q);setTimeout(function(){aR.removeClass(P+" "+aQ).one("webkitTransitionEnd transitionend",function(){aR.removeClass(aH);
});},50);};var ag=function(aR,aO,aS,aT){var aQ=aO.find("."+C).not("."+aD);var aP=aS.find("input:checked").parents("li");aP.each(function(){var aU=ay(this);
aU.addClass(aH);setTimeout(function(){aU.addClass(P+" "+k+"left").one("webkitTransitionEnd transitionend",function(){aU.remove();
});if(aU.hasClass("hidden")){aU.remove();}},50);l(aQ.children()[aU.attr(aE)]).removeClass(h+" "+ar+" "+am+aT).find("input").prop("checked",false).removeAttr("disabled");
});aR.removeClass("remove-mode");};var au=function(aP){var aO=aM();aO=Y(aO);t(aP,aO);i(aP,aO);ao(aP,aO);aC(aO);};var aM=function(){return A;
};var aC=function(aO){A=aO;};var Y=function(aO){aO={};aO.groups=[];aO.groupsContent={};aO.groupsContent.indexes=[];aO.groupsContent.value=[];
aO.groupsContent.groups=[];aO.isolatedSelection=[];aO.dimensionName=null;return aO;};var t=function(aU,aR){var aQ=[];var aP=function(){if(typeof(aQ[aS])==="undefined"){aQ[aS]=[];
}aQ[aS].push(l(this).find("input").attr("id"));ad(l(this),aR,aS);};for(var aO=aU.children().length;aO>0;aO--){var aT=aU.children("div:nth-child("+aO+")");
var aS=aO-1;aR.groups[aS]=aT.find("."+z).val();aT.find("li").each(aP);}aR.groupsContent.groups=aQ;};var i=function(aQ,aP){var aO=aQ.parents(".csr-list-container-2").find(".dimension-values-list:not(.group-card-content-list)");
aO.children("li").each(function(){var aR=l(this);if(!aR.hasClass(h)&&aR.find("input[type=checkbox]").attr("checked")==="checked"){aP.isolatedSelection.push(aR.find("input[type=checkbox]").val());
}});};var ao=function(aP,aO){aO.dimensionName=aP.parents(".dimension-selector").find(".dimension-selectbox").val();};var ad=function(aO,aP,aQ){aP.groupsContent.value.push(aO.find("input").val());
aP.groupsContent.indexes.push(aQ);};var J=function(aQ){ap();var aP=aM();var aO=aQ.parents(".dimension-selector").find(".dimension-selectbox");
aO.val(aP.dimensionName).attr("data-ready",true);if(!az(aO,s)){aQ.trigger("triggerNotification");}};var s=function(aP){if(aP.siblings(".dimension-selectbox").val()==="Select Dimension"){x();
return false;}var aU=aM();if(typeof(aU)==="undefined"){x();return false;}var aW=aP.parents(".dimension-selector").find(".dimension-selectbox");
var aY=function(){var aZ=l(this);if(aZ.val()===aU.isolatedSelection[aT-1]){aZ.attr("checked","checked").parents("li").change();
}};for(var aQ=0;aQ<aU.groups.length;aQ++){var aV=aU.groupsContent.groups[aQ];for(var aX=0;aX<aV.length;aX++){var aR=aV[aX];
aP.find("#"+aR).attr("checked","checked").parents("li").change();}var aS=aP.parents(".csr-list-container-2").find(".add-group-button");
var aO=f(null,l(aS[aS.length-1]));aO.find(".group-card-name").val(aU.groups[aQ]);}for(var aT=aU.isolatedSelection.length;
aT>0;aT--){aP.find("li input[type=checkbox]").each(aY);}aP.parents(".csr-list-container-2").find(".list-placeholder").click();
if(aU.groupsContent.value.length){l(".pg-apply-pattern-button").trigger("rebindForGroup");}x();};var ac=function(aR){var aP=aR.parent();
var aT=aR.parents("."+aa);var aO=aT.find("."+aw);var aS;var aQ;aP.hide();aS=aJ(aR,aO,aT);aQ=aT.find("."+aI+" input:checked");
if(!aQ.length){aS=true;aR.trigger("nothingSelected");aP.show();}if(!aS){aR.trigger("clickConfirmed");return true;}aP.show();
};var aJ=function(aP,aO,aS){var aQ=false;var aR=[aS.find("."+Z).find("."+aL).html()];aO.each(function(){var aV=ay(this);var aU=aV.find("."+z).removeClass(q).val();
if(!aU.length){aV.find("."+z).addClass(q).focus();aP.trigger("missingGroupName");aQ=true;}else{if(aR.indexOf(aU)!==-1){aV.find("."+z).addClass(q).focus();
aP.trigger("showDuplicateNameError");aQ=true;}else{aR.push(aU);}}var aT=aV.find("li").length;if(!aT){aV.find("."+z).addClass(q).focus();
aP.trigger("emptyGroup");aQ=true;}});return aQ;};var b=function(aQ){var aO=aQ.val().toLowerCase();var aP=aQ.parents("."+aw);
var aR;if(!aP.length){aP=aQ.parents("."+aa);aR=aP.find("."+L+":not( ."+aD+" ) li");}else{aR=aP.find("."+aD+" li");}if(aO===""){aR.each(function(){l(this).removeClass(Q);
});aP.find("ul").trigger("checkSize");return true;}aR.each(function(){var aT=l(this);var aS=aT.find("input").val().toLowerCase();
if(aS.indexOf(aO)===-1){aT.addClass(Q);}else{aT.removeClass(Q);}});};var aF=function(aP){var aO=aP.parents("."+aw);var aQ;
if(!aO.length){aO=aP.parents("."+aa);aQ=aO.find("."+L+":not(."+aD+") li:not(."+Q+",."+h+")");}else{aQ=aO.find("."+aD+" li:not(."+Q+" ."+h+")");
}aQ.each(function(){var aR=l(this).toggleClass(ar).find("label input");aR.attr("checked",!aR.attr("checked"));});l(aQ[0]).trigger("change");
};var ak=function(aR){var aP={treeId:l("#treeId").val(),builderAction:"New Split",nodeId:aR.val(),dimension:l("#dimensions_"+aR.val()).val()};
var aQ=[];var aS=aR.parents("."+aa);var aO=aS.find("."+aw);aR.parents(".harpnode").addClass("pg-pattern-possible");aQ=aQ.concat(ae(aO));
aQ=aQ.concat(v(aS));aP.children=o.stringify(aQ);return aP;};var ae=function(aO){var aP=[];aO.each(function(){var aV=ay(this);
var aU=aV.find("."+z).val();var aQ=[];var aS=aV.find("li").find("input:checkbox");for(var aR=aS.length;aR>0;aR--){var aT=l(aS[aR-1]);
aQ.push(aT.val());}if(aQ.length!==0){aP.push({name:aU,values:aQ});}});return aP;};var v=function(aP){var aO=[];aP.find("."+L+":not(."+aD+") li:not(."+h+") label input:checked").each(function(){var aQ=l(this).val();
aO.push({name:aQ,values:[aQ]});});return aO;};var az=function(aP,aS){var aR=aP.attr("id").split("_")[1];var aQ=aP.val();l(".csr-list-container-2").hide();
l("#selectorContainer_"+aR+"_"+aQ).show();var aO=l("#valueSelectorCarrier_"+aR+"_"+aQ);if(typeof(aS)==="function"){aS(aO);
}return true;};var aB=function(aO){ap();aO.siblings(".list-placeholder").click();x();};var ap=function(){l("#pg-obscuring-screen").show();
};var x=function(){l("#pg-obscuring-screen").hide();};var G=function(aP,aQ){l(".pg-observed-input").removeClass("pg-observed-input");
l(".pg-observed-button").removeClass("pg-observed-button");aP.addClass("pg-observed-input");aQ.addClass("pg-observed-button");
var aO={};aO.builderAction="Description Exists";aO.description=aP.val();return aO;};var at={actions:[{source:"harpZoomIn",event:"click",target:"harpGraph",callMethod:"buttonZoomIn"},{source:"harpZoomIn",event:"click",target:"harpGraphSvg",callMethod:"buttonZoomIn"},{source:"harpZoomOut",event:"click",target:"harpGraph",callMethod:"buttonZoomOut"},{source:"harpZoomOut",event:"click",target:"harpGraphSvg",callMethod:"buttonZoomOut"},{source:"harpReset",event:"click",target:"harpGraph",callMethod:"resetZoomPan"},{source:"harpReset",event:"click",target:"harpGraphSvg",callMethod:"resetZoomPan"},{source:"harpSwitch",event:"clickDone",target:"harpGraph",callMethod:"switchOrientation"},{source:"harpSwitch",event:"clickDone",target:"harpGraphSvg",callMethod:"switchOrientation"},{source:"harpGraph",event:"treeLayout-drag-event",target:"harpGraphSvg",callMethod:"mirrorRedraw"},{source:"edit_tree_name",event:"click",callMethod:function(){l("#edit_controller").toggle("medium");
l("#newTreeName").val(l("#treeName").val());}},{source:"duplicate_controller_button",event:"click",callMethod:function(){l("#duplicate_controller").toggle("medium");
l("#newDuplicateTreeName").val(l("#treeName").val()).trigger("keyup");}},{source:"save_template_controller_button",event:"click",callMethod:function(){l("#template_controller").toggle("medium");
l("#templateName").val(l("#treeName").val()).trigger("keyup");}},{source:"harpTreePicker",event:"change",callMethod:function(aP,aO){l("#treeId").val(aO.val());
}},{source:"step2_toggle",event:"click",callMethod:function(){l("#step1_container").slideUp();l("#step2_container").slideDown();
l("#step3_container").slideUp();l("#step1_toggle").parent().addClass("harp-builder-step-uncollapsed");l("#step2_toggle").parent().removeClass("harp-builder-step-uncollapsed");
l("#step3_toggle").parent().addClass("harp-builder-step-uncollapsed");l(".dimension-selector, .icon-times").removeClass("inactive").addClass("active");
l(".main-group").addClass("pg-harpnodes-editmode");}},{source:"step1_toggle",event:"click",callMethod:function(aP,aO){aO.parent().removeClass("harp-builder-step-uncollapsed");
l("#harpTreePicker").val("-1");l("#step2_container").slideUp();l("#step3_container").slideUp();l("#step1_container").slideDown();
l("#step2_toggle").parent().addClass("harp-builder-step-uncollapsed");l("#step2_toggle").parent().addClass("harp-builder-step-uncollapsed");
l("#step3_toggle").parent().addClass("harp-builder-step-uncollapsed");l(".dimension-selector").removeClass("active").addClass("inactive");
l(".main-group").removeClass("pg-harpnodes-editmode");}},{source:"step3_toggle",event:"click",callMethod:function(aP,aO){aO.parent().removeClass("harp-builder-step-uncollapsed");
l("#step1_container").slideUp();l("#step2_container").slideUp();l("#step3_container").slideDown();l("#step1_toggle").parent().addClass("harp-builder-step-uncollapsed");
l("#step2_toggle").parent().addClass("harp-builder-step-uncollapsed");l(".main-group").removeClass("pg-harpnodes-editmode");
}},{source:".cancel-button",event:"click",callMethod:function(){l("#harp-dialog-overlay").click();}},{source:"showSchedulingDialog",event:"click",callMethod:function(){l("#schedulingWindow").prependTo(l("#harp-dialog-window")).show();
l("#schedulingWindow").show();l("[id^=dialogWindow]").hide();l(".explanationWindow").hide();l("#harp-dialog-overlay").show();
}},{source:"harp-dialog-overlay",event:"click",callMethod:function(aP,aO){aO.hide();}},{source:"#harpFullScreen",event:"click",callMethod:function(){l("."+X).toggleClass(j);
}},{source:"harpSwitch",event:"click",callMethod:function(aP,aO){aO.toggleClass("pg-horizontal");aO.trigger("clickDone");
}},{source:"createNewTree",event:"click",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){var aO={};
aO.description=l("#treeName").val();aO.hasTemplate=l("#harpTemplatePicker").val();aO.builderAction="New Tree";aO.isTemplate="false";
return aO;}},{source:"saveNewName",event:"clickConfirmed",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){var aO={};
aO.description=l("#newTreeName").val();aO.treeId=l("#treeId").val();aO.builderAction="Update Tree";aO.isTemplate=false;return aO;
}},{source:"deleteTree",event:"click",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){l("#step1_toggle").click();
var aO={};aO.treeId=l("#treeId").val();aO.builderAction="Delete Tree";return aO;}},{source:"duplicateTree",event:"clickConfirmed",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){var aO={};
aO.description=l("#newDuplicateTreeName").val();aO.builderAction="New Tree";aO.duplicatedTreeId=l("#treeId").val();aO.isTemplate=false;
return aO;}},{source:"scheduleData",event:"click",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){var aO={};
aO.treeId=l("#treeId").val();aO.builderAction="Schedule Report";aO.startDate=l("#datepickStart").val();return aO;}},{source:".apply-button",event:"clickConfirmed",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(aO){ap();
return ak(aO);}},{source:"saveTemplate",event:"clickConfirmed",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){var aO={};
aO.treeId=l("#treeId").val();aO.description=l("#templateName").val();aO.builderAction="Update Tree";aO.isTemplate=true;aO.hasTemplate=l("#harpTemplatePicker").val();
return aO;}},{source:"harpTreePicker",event:"change",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){ap();
var aO={};aO.treeId=l("#harpTreePicker").val();aO.builderAction="Get Tree";return aO;}},{source:"saveTemplate",event:"click",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){return G(l("#templateName"),l("#saveTemplate"));
}},{source:"duplicateTree",event:"click",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){return G(l("#newDuplicateTreeName"),l("#duplicateTree"));
}},{source:"saveNewName",event:"click",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){return G(l("#newTreeName"),l("#saveNewName"));
}},{source:"[id^=showDeleteSplitDialog]",event:"click",target:"harpGraph",callMethod:"showDestroyDimensionDialog",getterMethod:function(aP){var aO={};
aO.id=aP.attr("id").split("_")[1];return aO;}},{source:"[id^=deleteSplit]",event:"click",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(aP){var aO={};
aO.treeId=l("#treeId").val();aO.builderAction="Delete Nodechildren";aO.nodeId=aP.attr("id").split("_")[1];return aO;}},{source:"[id^=nodeExplanation]",event:"click",target:"harpGraph",callMethod:"showExplanationDialog",getterMethod:function(aP){var aO={};
aO.id=aP.attr("id").split("_")[1];return aO;}},{source:"[id^=textAreaConfirmButton]",event:"click",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(aP){var aO={};
aO.builderAction="Update Node";var aQ=aO.nodeId=aP.attr("id").split("_")[1];aO.treeId=l("#treeId").val();l("#nodeExplanation_"+aQ).html("Edit description");
aO.explanation=l("#textAreaExplanation_"+aQ).val();return aO;}},{source:"permissionSwitch",event:"click",target:"fetcher1",callMethod:"basicDataFetch",getterMethod:function(){var aO={};
aO.builderAction="Update Tree";aO.description=l("#treeName").val();aO.treeId=l("#treeId").val();aO.pspVisibleOnly=(l("#permissionSwitch").attr("checked"))?true:false;
return aO;}},{source:"mediator",event:"deleteNodeChildren",target:["harpGraph","harpGraphSvg"],callMethod:"deleteNodeChildren"},{source:"."+an,event:"click",callMethod:function(aS,aR){var aQ=aR.parent();
var aO=!aQ.hasClass("show");var aP=l("."+aa);aP.children("."+L).hide();aP.children("."+ai).hide();aP.children("."+aA).hide();
aP.removeClass(K);if(aO){aQ.addClass(K).children().show();}}},{source:"."+aj,event:"change",callMethod:function(aP,aO){if(aO.val()==="Select Dimension"){az(aO);
return true;}az(aO,aB);return true;}},{source:"."+aj,event:"forceEventRebind",target:"mediator",callMethod:"forceRebindGlobal"},{source:"."+d,event:"click",callMethod:function(aQ,aO,aP){aP.stopPropagation();
ah(aQ,aO);}},{source:".pg-apply-pattern-button",event:"rebindForGroup",target:"mediator",callMethod:"forceRebindTargeted",getterMethod:function(){var aQ=[];
var aS={source:"."+d,eventType:"click"};var aP={source:"."+m,eventType:["click","reload"]};var aO={source:"."+av,eventType:"click"};
var aR={source:"."+C,eventType:"change"};aQ.push(aS);aQ.push(aP);aQ.push(aO);aQ.push(aR);return aQ;}},{source:".apply-button",event:"click",callMethod:function(aP,aO){ac(aO);
}},{source:".apply-button",event:"nothingSelected",target:"mediator",callMethod:"showNotification",getterMethod:function(){var aO={};
aO.message="No item selected";aO.iconClass="icon-exclamation-triangle";aO.containerClass="error";return aO;}},{source:".apply-button",event:"showDuplicateNameError",target:"mediator",callMethod:"showNotification",getterMethod:function(){var aO={};
aO.message="A group name is used at least twice";aO.iconClass="icon-exclamation-triangle";aO.containerClass="error";return aO;
}},{source:".apply-button",event:"missingGroupName",target:"mediator",callMethod:"showNotification",getterMethod:function(){var aO={};
aO.message="At least one group name is missing";aO.iconClass="icon-exclamation-triangle";aO.containerClass="error";return aO;
}},{source:".apply-button",event:"emptyGroup",target:"mediator",callMethod:"showNotification",getterMethod:function(){var aO={};
aO.message="At least one group is empty";aO.iconClass="icon-exclamation-triangle";aO.containerClass="error";return aO;}},{source:"."+aD,event:"wheel",callMethod:function(aQ,aO,aP){aO.scrollTop(aO.scrollTop()+aP.originalEvent.deltaY);
}},{source:"."+an,event:"click",callMethod:function(aQ,aP){var aO=aP.parent();if(aO.find("."+C+":not(."+aD+")").children().length>af){aO.addClass(D);
}else{aO.removeClass(D);}}},{source:"."+m,event:"click",callMethod:function(aQ,aO,aP){aP.stopPropagation();if(!aO.hasClass(al)){return false;
}O(aO);}},{source:"."+m,event:"reload",target:"mediator",callMethod:"forceRebindTargeted",getterMethod:function(){var aP=[];
var aS={source:".dimension-values-list li label input",eventType:"click"};var aO={source:".dimension-values-list li label",eventType:"click"};
var aQ={source:"."+C+" li",eventType:["change","click"]};var aR={source:"."+C,eventType:"change"};aP.push(aS);aP.push(aO);
aP.push(aQ);aP.push(aR);return aP;}},{source:"."+av,event:"click",callMethod:function(aQ,aO,aP){aP.stopPropagation();B(aO);
}},{source:"."+C,event:"checkSize",callMethod:function(aP,aO){if(aO.children().length>10){aO.parent().addClass(aG);}else{aO.parent().removeClass(aG);
}}},{source:"."+C,event:"change",callMethod:function(aQ,aO,aP){W(aQ,aO,aP);}},{source:"."+z,event:"keyup",callMethod:function(aP,aO){aO.removeClass(q);
}},{source:"html",event:"click",callMethod:function(aQ,aO,aP){aP.stopImmediatePropagation();}},{source:"."+E,event:"keyup",callMethod:function(aP,aO){b(aO);
}},{source:"."+N,event:"click",callMethod:function(aP,aO){aF(aO);}},{source:"input",event:"treeLayout-drag-event",callMethod:function(aQ,aO,aP){aP.stopPropagation();
return false;}},{source:"[id^=deleteSplit]",event:"click",target:"harpGraph",callMethod:"deleteDimensionNode"},{source:".pg-apply-pattern-button",event:"click",callMethod:function(aQ,aO,aP){aP.preventDefault();
J(aO);}},{source:"#newTreeName, #newDuplicateTreeName, #templateName",event:"keydown keyup",callMethod:function(aP,aO){aO.removeClass("pg-input-error").siblings("button").removeClass("rename-button--unavailable");
}},{source:".pg-save-template",event:"click",callMethod:function(aQ,aO){var aP=aO.parents(".harpnode");if(!aO.hasClass("pg-split-saved")){l(".pg-split-saved").removeClass("pg-split-saved");
au(aO.parents(".harpnode").find("."+T));aP.siblings().each(function(){l(this).addClass("pg-pattern-available");});}else{l(".pg-pattern-available").removeClass("pg-pattern-available");
}aO.toggleClass("pg-split-saved");aO.trigger("triggerNotification");}},{source:".pg-save-template",event:"triggerNotification",target:"mediator",callMethod:"showNotification",getterMethod:function(aP){var aO={};
aO.containerClass="success";aO.iconClass="icon-adyen-activate";if(aP.hasClass("pg-split-saved")){aO.message="Split copied";
}else{aO.message="Split dropped";}return aO;}},{source:".icon-plus",event:"click",callMethod:function(aP,aO){aO.parents(".pg-end-node").removeClass("pg-node-show-content").addClass("pg-add-dimension");
}},{source:".icon-minus",event:"click",callMethod:function(aP,aO){aO.parents(".pg-end-node").removeClass("pg-add-dimension");
}},{source:".pg-main-dimension-delete-button",event:"click",callMethod:function(aP,aO){aO.parents(".csr-list-container-2").children(".list-placeholder").click().parents(".dimension-selector").children(".dimension-selectbox").val("Select Dimension").change();
}},{source:".pg-apply-pattern-button",event:"triggerNotification",target:"mediator",callMethod:"showNotification",getterMethod:function(){var aO={};
aO.containerClass="error";aO.iconClass="icon-exclamation-triangle";aO.message="The dimension you try to paste does not exist on this node.";
return aO;}},{source:".pg-node-header-title__clickable",event:"click",callMethod:function(aP,aO){aO.parents(".harp-node").toggleClass("pg-node-show-content");
}},{source:".pg-show-display-toggle",event:"click",callMethod:function(aP,aO){aO.parents(".harp-node").toggleClass("pg-node-show-content");
}}]};return at;});(function(a,b){if(typeof define==="function"){define("chartutil/backbone/queryStringRouter",["underscore","backbone","jquery"],function(c,e,d){return b(c||a._,e||a.Backbone,d);
});}else{if(typeof exports==="object"){module.exports=b(require("underscore"),require("backbone"));}else{b(_,Backbone);}}}(this,function(n,m,i){var l=/^\?(.*)/,c=/\((.*?)\)/g,o=/(\(\?)?:\w+/g,k=/\*\w+/g,h=/[\-{}\[\]+?.,\\\^$|#\s]/g,b=/^([^\?]*)/,d=/[\:\*]([^\:\?\/]+)/g,g=/^[#\/]|\s+$/g,f=/\/$/;
m.Router.arrayValueSplit="|";n.extend(m.History.prototype,{getFragment:function(r,q){if(r==null){if(this._hasPushState||!this._wantsHashChange||q){r=this.location.pathname;
var p=this.root.replace(f,"");var s=this.location.search;if(!r.indexOf(p)){r=r.substr(p.length);}if(s&&this._hasPushState){r+=s;
}}else{r=this.getHash();}}return r.replace(g,"");},getQueryParameters:function(r,p){r=this.getFragment(r,p);var t=r.replace(b,"");
var q=t.match(l);if(q){t=q[1];var s={};e(t,function(u,v){v=j(v);if(!s[u]){s[u]=v;}else{if(n.isString(s[u])){s[u]=[s[u],v];
}else{s[u].push(v);}}});return s;}else{return{};}},updateURL:function(q){var p=this.getQueryParameters(this.fragment);p=n.extend(p,q);
this.root=this.root.replace(f,"");this.navigate("?"+i.param(p));}});n.extend(m.Router.prototype,{initialize:function(p){this.encodedSplatParts=p&&p.encodedSplatParts;
},_routeToRegExp:function(q){var r=(k.exec(q)||{index:-1}),p=(o.exec(q)||{index:-1}),t=q.match(d)||[];q=q.replace(h,"\\$&").replace(c,"(?:$1)?").replace(o,function(v,u){return u?v:"([^\\/\\?]+)";
}).replace(k,"([^??]*?)");q+="(\\?.*)?";var s=new RegExp("^"+q+"$");if(r.index>=0){if(p>=0){s.splatMatch=r.index-p.index;
}else{s.splatMatch=-1;}}s.paramNames=n.map(t,function(u){return u.replace(/\)$/,"").substring(1);});s.namedParameters=this.namedParameters;
return s;},_extractParameters:function(x,v){var r=x.exec(v).slice(1),w={};if(r.length>0&&!r[r.length-1]){r.splice(r.length-1,1);
}var u=r.length&&r[r.length-1]&&r[r.length-1].match(l);if(u){var p=u[1];var t={};if(p){var y=this;e(p,function(z,A){y._setParamValue(z,A,t);
});}r[r.length-1]=t;n.extend(w,t);}var q=r.length;if(x.splatMatch&&this.encodedSplatParts){if(x.splatMatch<0){return r;}else{q=q-1;
}}for(var s=0;s<q;s++){if(n.isString(r[s])){r[s]=j(r[s]);if(x.paramNames&&x.paramNames.length>=s-1){w[x.paramNames[s]]=r[s];
}}}return(m.Router.namedParameters||x.namedParameters)?[w]:r;},_setParamValue:function(r,u,t){r=r.replace("[]","");r=r.replace("%5B%5D","");
var v=r.split(".");var s=t;for(var q=0;q<v.length;q++){var p=v[q];if(q===v.length-1){s[p]=this._decodeParamValue(u,s[p]);
}else{s=s[p]=s[p]||{};}}},_decodeParamValue:function(s,r){var t=m.Router.arrayValueSplit;if(t&&s.indexOf(t)>=0){var p=s.split(t);
for(var q=p.length-1;q>=0;q--){if(!p[q]){p.splice(q,1);}else{p[q]=j(p[q]);}}return p;}s=j(s);if(!r){return s;}else{if(n.isArray(r)){r.push(s);
return r;}else{return[r,s];}}},toFragment:function(q,p){if(p){if(!n.isString(p)){p=a(p);}if(p){q+="?"+p;}}return q;},updateURL:function(p){m.history.updateURL(p);
return this;}});function a(t,s){var r=m.Router.arrayValueSplit;function p(u){return String(u).replace(r,encodeURIComponent(r));
}if(!t){return"";}s=s||"";var q=[];n.each(t,function(z,v){v=s+v;if(n.isString(z)||n.isNumber(z)||n.isBoolean(z)||n.isDate(z)){if(z!=null){q.push(v+"="+p(encodeURIComponent(z)));
}}else{if(n.isArray(z)){var y="";for(var w=0;w<z.length;w++){var x=z[w];if(x!=null){y+=r+p(x);}}if(y){q.push(v+"="+y);}}else{var u=a(z,v+".");
if(u){q.push(u);}}}});return q.join("&");}function j(q){try{return decodeURIComponent(q.replace(/\+/g," "));}catch(p){return q;
}}function e(r,q){var p=r.split("&");n.each(p,function(t){var s=t.split("=");q(s.shift(),s.join("="));});}}));var console=console;define("chartlib/models/appstate",["jquery","underscore","backbone","d3","chartlib/models/state","chartlib/events/appstateevents","chartutil/arrayutils"],function(f,b,h,c,a,d,e){var g=h.Model.extend({defaults:{stub:false,baseURL:adyen.base+"ca/reports/chartxml.shtml?",stateMap:[],targetStat:"MAP_WORLD_8REGION"},timeline:null,config:null,hasMap:false,requestDuringSetup:false,initialize:function(){b.bindAll(this,"changeState");
h.on(d.CHANGE_REQUESTED,this.changeState);},addConfig:function(j){var i=(typeof j.callAtStart!=="undefined")?j.callAtStart:true;
this.timeline=j.timeline;this.config=j.config;this.hasMap=j.hasMap;if(this.requestDuringSetup&&i===true){this.changeState();
}},changeState:function(k,i,j){if(!this.timeline&&!this.config){this.requestDuringSetup=true;return;}if(!this.timeline.getHasConfig){this.timeline={getHasConfig:function(){return null;
},getGranularity:function(){return"day";}};this.addTimeValues=function(){};}var l=new a();if(this.hasMap){l=this.addMapValues(k,i,j);
}if(this.config){this.addConfigValues(l,this.config.getConfigObject());}this.addTimeValues(l);if(this.timeline.getHasConfig()){l.set("granularity",this.timeline.getChartGranularity());
}else{l.set("granularity",this.timeline.getGranularity());}l.set("url",this.get("baseURL"));this.setStubValues(l);this.notifyStateChange(l);
},notifyStateChange:function(i){h.trigger(d.STATE_CHANGED,i);},addMapValues:function(l,i,k){if(!l&&!i){var m=this.retrieveState();
var j=m[0];var n=m[1];var o=m[2];return this.setRegion(j,n,o);}else{return this.setRegion(l,i,k);}},addConfigValues:function(j,i){},addTimeValues:function(j){var i;
i=this.timeline.getDates();j.set("bdate",c.time.format("%Y-%m-%d")(i[0]));j.set("edate",c.time.format("%Y-%m-%d")(i[1]));
},setStubValues:function(i){},setRegion:function(i,k,l){e.removeFrom(this.get("stateMap"),"label",i);var j=new a({label:i,statsType:k});
this.get("stateMap").push(j);if(l){if(b.size(this.get("stateMap"))>2){j.set("ccs",l);}else{j.set("region",l);}}return j;},retrieveState:function(){var j,i,k,l;
if(this.get("stateMap").length>0){j=this.get("stateMap")[(this.get("stateMap").length-1)];i=j.get("label");k=j.get("statsType");
l=j.get("region");}else{i="world";k=this.get("targetStat");}return[i,k,l];}});return g;},function(a){if(window.console&&console.log){console.log("APP JS ERROR =",a);
}});define("chart/widgetFramework/composed/harpReportBuilderV2/harpGraphBuilderLinks",["jquery","underscore","d3","backbone","chart/widgetFramework/chartTypes/treeLayout","util/ObjectSuper"],function(f,a,e,g,d,c){var b=function(l,h,i,j){var k=d(l,h,null,j);
var m=c(k);k.init=function(){m.init();};k.hideCharts=function(){this.$el.css({"background-color":"#f4f4f4"});};k.feedData=function(n){if(n){this.data=n;
}else{return;}};k.renderData=function(){var n=(typeof this.collapseNodes!=="undefined")?this.collapseNodes:false;if(a.isEmpty(this.data)){return;
}m.renderData(false);};k.deleteNodeChildren=function(p){var o=a.first(p.nodes);var n=this.findNode(this.root,o.parentNodeId);
if(n){this.collapse(n);}n.__children=[];};k.findNode=function(r,s){var o=this;if(r.harpNodeId===s){return r;}var q=r.children;
if(q){for(var p=0;p<q.length;p++){var t=q[p];var n=o.findNode(t,s);if(n){return n;}}}};return k;};return b;});define("chartlib/timeLineChart",["jquery","underscore","backbone","backbonesuper","d3","chartlib/linechart","chartutil/stringutils","chartlib/events/appstateevents","chartutil/d3utils","chartlib/mixins/scales"],function(d,h,g,f,k,b,c,e,j,i){var a=b.extend({defaults:{barPadding:0.1,margin:{top:10,right:10,bottom:40,left:50},yScale:"linear",tooltip:true},setXScale:function(){this.scales.x=k.time.scale.utc().range([0,this.width],this.options.barPadding);
},setYScale:function(){this._super();this.scales.y.rangeRound([this.height,0]);},calibrateXScale:function(){var l=this.collection.getDateExtent();
this.scales.x.domain(l);this.scales.x.ticks(this.collection.getIntervalFormat(),1);},calibrateYScale:function(){this.scales.y.domain([0,k.max(this.collection.pluck(this.options.yAttr))]);
},setXAxis:function(){this._super(arguments);this.axes.x.tickSize(0).ticks(0);},formatXAxis:function(){var m=this,l=this.axes.x,n=this.collection.getGranularity();
l.ticks(k.time[n].utc,1).tickFormat(function(o){return j.constants.granularityFormats[n](o);});},renderXAxis:function(){this.formatXAxis();
this._super();j.spreadTimeAxisTicks(this);},formatYAxis:function(){var l=this;if(this.options.percentile){this.axes.y.tickFormat(k.format("%"));
}else{this.axes.y.tickFormat(function(n,m){return j.thousandsFormatter(n,m,l.scales.y);});}},renderYAxis:function(){this.formatYAxis();
this._super();if(this.options.percentile){j.percentageFormat(this.yAxis);}},renderData:function(){this.renderLine();this.renderCircles();
},renderLine:function(){var n=this,l=this.scales.x,o=this.scales.y;var m=k.svg.line().interpolate("linear").x(function(p){return l(n.getX(p))+((n.width/2)-l(n.getX(p)))/n.collection.models.length;
}).y(function(p){return o(n.getY(p));});this.line=this.line||this.svg.append("g").append("path").attr("class","line");this.line.datum(this.collection.models).transition().attr("d",m);
},renderCircles:function(){var m=this,l=this.scales.x,o=this.scales.y;var n=this.svg.selectAll(".circle").data(this.collection.models);
n.enter().append("svg:circle").attr("class","circle").attr("cx",function(p){return l(m.getX(p))+((m.width/2)-l(m.getX(p)))/m.collection.models.length;
}).attr("cy",function(p){return o(m.getY(p));}).attr("r",5);n.attr("cx",function(p){return l(m.getX(p))+((m.width/2)-l(m.getX(p)))/m.collection.models.length;
}).attr("cy",function(p){return o(m.getY(p));});n.exit().remove();if(this.options.tooltip){n.on("mouseover",function(p){m.showTooltip(p,this,false);
}).on("mouseout",function(p){m.hideTooltip(false);});}}});return a;});define("chart/widgetFramework/composed/chargebackReport/formatters/atvLineFormatter",["underscore","chartutil/domUtils","chartutil/stringutils","d3"],function(b,d,e,c){var a=function(i,f,h,j){var g={};
g.data=i;g.options=f;g.formattedData={};g.comparator=null;g.reverseDirection=false;g.sortKey=null;g.timeline=h;g.id=j;g.formatData=function(){var k={};
this.formattedData=this.calculateMetaData(this.data);if(window.console&&console.log){console.log("### atvLineFormatter::formatData:: this.formattedData=",this.formattedData);
}return{config:k,chartData:this.formattedData};};g.calculateMetaData=function(o){var p=[];var m=[];var l=[];var n=[];var k=c.format(".4f");
b.each(o,function(w){var q=+w.authorisedEurAmount/100;var v=+w.chargebackEurAmount/100;var s=+w.fraudNotificationsEurAmount/100;
var t=(w.authorisedCount>0)?q/w.authorisedCount:0;p.push({date:w.date,value:t,name:w.dateStr});var u=(w.chargebackCount>0)?v/w.chargebackCount:0;
m.push({date:w.date,value:u,name:w.dateStr});var r=(w.fraudNotificationsCount>0)?s/w.fraudNotificationsCount:0;l.push({date:w.date,value:r,name:w.dateStr});
n.push({date:w.date,dateStr:w.dateStr,avgAuthorisedAmt:t,avgChargebackAmt:u,avgNofAmt:r,avgAuthorisedAmtCsv:+k(t),avgChargebackAmtCsv:+k(u),avgNofAmtCsv:+k(r)});
});return{atvChartData:[{name:"Authorized",lineValues:p},{name:"Chargeback",lineValues:m},{name:"Notifications of fraud",lineValues:l}],atvRolloverData:n};
};g.downloadCSV=function(){var m=this.formattedData.atvRolloverData;var k=["dateStr","avgAuthorisedAmtCsv","avgChargebackAmtCsv","avgNofAmtCsv"];
var l=["Date","Authorized","Chargeback","Notifications of fraud"];d.createCSV(m,k,l,"AverageTransactionValues");};g.setRawData=function(k){this.data=k;
};return g;};return a;});define("chartutil/backbone/r2d3app",["jquery","underscore","backbone","chartlib/chartBaseEvents"],function(b,a,e,d){var c=e.View.extend({defaults:{retryCounter:0},initialize:function(){this.fixIE8();
},fixIE8:function(){if(typeof window.SVGElement==="undefined"){b("#timelineHolder").remove();b("#timelineModeButtonsHolder").remove();
b("#timelineDatesHolder").remove();b("#calendarUI").css("margin","-35px 0 10px 0");a.bindAll(this,"checkDocumentBody","removeRaphaelDiv");
e.on(d.DATA_LOADED,this.checkDocumentBody);}},checkDocumentBody:function(){this.retryCounter=0;this.removeRaphaelDiv();},removeRaphaelDiv:function(){var g=this;
this.retryCounter++;var f=b('body > div[style*="CLIP"]').remove().length;if(f<1&&this.retryCounter<4){setTimeout(function(){g.removeRaphaelDiv();
},500);}}});return c;});define("chart/widgetFramework/composed/chargebackReport/formatters/paymentMethodBarFormatter",["jqueryExtended","underscore","d3","chart/widgetFramework/core/constants/DataConstants","chartutil/stringutils","chartutil/domUtils"],function(g,b,c,e,f,d){function a(k,h,j,m){var i={};
i.data=k;i.options=h;i.formattedData={};i.comparator=null;i.reverseDirection=false;i.sortKey="chargebackCount";i.timeline=j;
i.id=m;i.dataType="chargebacks";i.rateDataType="count";i.formatData=function(){var n=(this.data&&b.has(this.data,"payment_method_statistics"))?this.data.payment_method_statistics:{};
this.formattedData=l(n);if(this.sortKey){this.reverseDirection=!this.reverseDirection;this.sortData(this.sortKey,true);}if(window.console&&console.log){console.log("### barDataFD::"+this.id+" formatData:: this.formattedData=",this.formattedData);
}return{chartData:this.formattedData};};var l=function(q){var r=c.format(",g4f");var o=[];var n,p;b.each(q,function(v){n={};
p=f.capitaliseAllFirstLetters(v.pm);var s=+v.authorisedEurAmount/100;var u=+v.chargebackEurAmount/100;var t=+v.nofEurAmount/100;
if(i.dataType==="chargebacks"){if(v.pm!==null&&v.chargebackCount>0){n.paymentMethodName=p;n.chargebackCount=+v.chargebackCount;
n.chargebackCountFormatted=r(+v.chargebackCount);n.chargebackEurAmount=u;if(i.rateDataType==="count"){n.chargebackRate=(+v.authorisedCount>0)?+v.chargebackCount/+v.authorisedCount*100:0;
}else{n.chargebackRate=(s>0)?u/s*100:0;}n.chargebackRate=Number(n.chargebackRate.toFixed(4));o.push(n);}}else{if(v.pm!==null&&v.nofCount>0){n.paymentMethodName=p;
n.chargebackCount=+v.nofCount;n.chargebackCountFormatted=r(+v.nofCount);n.chargebackEurAmount=t;if(i.rateDataType==="count"){n.chargebackRate=(+v.authorisedCount>0)?+v.nofCount/+v.authorisedCount*100:0;
}else{n.chargebackRate=(s>0)?t/s*100:0;}n.chargebackRate=Number(n.chargebackRate.toFixed(4));o.push(n);}}});return o;};i.reformatDataChargebacksNof=function(n){this.dataType=n.type;
var o=this.formatData();this.$el.trigger(e.FORMATTER_INFORM_WIDGET,{type:e.REFORMATTED_DATA,data:o});};i.reformatData=function(o){this.rateDataType=o;
var n=this.formatData();this.$el.trigger(e.FORMATTER_INFORM_WIDGET,{type:e.REFORMATTED_DATA,data:n});};i.sortData=function(n,p){this.sortKey=n;
if(this.sortKey===this.oldSortKey){this.reverseDirection=!this.reverseDirection;}else{this.reverseDirection=false;}this.oldSortKey=this.sortKey;
var o=b.sortBy(this.formattedData,n);if(this.reverseDirection){o.reverse();}this.formattedData=o;if(p===true){return;}this.$el.trigger(e.FORMATTER_INFORM_WIDGET,{type:e.SORTED_DATA,data:{chartData:this.formattedData}});
};i.compareFunction=function(n){return n[this.sortKey];};i.downloadCSV=function(){var o=["paymentMethodName","chargebackCount","chargebackEurAmount","chargebackRate"];
var p;var n;if(this.dataType==="chargebacks"){p=["Payment method","Chargeback count","Chargeback amount","Chargeback rate (based on "+this.rateDataType+")"];
n="ChargebacksByPaymentMethod";}else{p=["Payment method","Notifications of fraud count","Notifications of fraud amount","Notifications of fraud rate (based on "+this.rateDataType+")"];
n="NotificationsOfFraudByPaymentMethod";}d.createCSV(this.formattedData,o,p,n);};i.getData=function(){return(this.data)?this.data:this.formatData();
};i.setRawData=function(n){this.data=n;};i.retrieveData=function(n){return this.data[n];};return i;}return a;});define("chart/widgetFramework/composed/ecpReport/ecpMediator2",["jqueryExtended","lodash","d3","chart/widgetFramework/core/BasicMediator","util/ObjectSuper","chartutil/stringutils","util/Functional","chart/widgetFramework/core/constants/UIConstants","chartutil/dateUtils_CET"],function(a,k,l,j,h,d,c,i,e){var b=false;
var g=false;var f=function(m){var n;n=j(m,true);var o=h(n);n.init=function(){o.init();this.actionCommanderExclusionArray=["actioncommander","dataformatter","timeline"];
};n.getAdditionalDOMElements=function(){o.getAdditionalDOMElements();this.timelineInstances=[];this.$allTimelines=this.$el.find("[data-widget*=Timeline]");
this.totalDomElements+=this.$allTimelines.length;};n.getWidgets=function(){o.getWidgets();this.getWidgetInstances(this.$allTimelines,this.timelineInstances,"Timelines");
};n.onNotifiedFetcher=function(q,p){o.onNotifiedFetcher(q,p);};n.onNotifiedFormatter=function(p,v){o.onNotifiedFormatter(p,v);
var r,t=[],x=[],s=[];var q=p.changeObject.data.chartData;var u=k.chain(q).pluck("programName").map(function(z){var A=z.replace(".","");
var y=d.replaceSpace(A.toLowerCase(),"-");return y;}).value();if(window.console&&console.log){console.log("### ecpMediator::onNotifiedFormatter:: progNamesArray =",u);
}if(!u.length){var w=function(){a(this).css("display","none");a(this).detach();};this.$el.find(".ecp-button").fadeTo(500,0,w);
this.$el.find(".ecp-report-panel").fadeTo(500,0,w);setTimeout(function(){n.$el.find(".ecp-no-data").fadeTo(750,1);},1000);
}else{this.$el.find(".ecp-no-data").fadeTo(500,0);}k.each(u,function(y){n.$el.find("."+y).css("display","block");n.$el.find("."+y).fadeTo(500,1);
});this.$el.find(".ecp-button").each(function(){if(a(this).css("display")==="block"){t.push(a(this));}else{x.push(a(this));
}});k.each(x,function(y){y.detach();});if(window.console&&console.log){console.log("### ecpMediator2::onNotifiedFormatter:: $buts=",t);
}t[0].css("margin-left",0);if(t.length>4){t[4].css("margin-left",0);}this.$el.find(".ecp-report-panel").each(function(){if(a(this).css("display")!=="block"){s.push(a(this));
}});k.each(s,function(y){y.detach();});r=".csr-panel-header-2 .threshold-indicator";this.$el.find(r).css("background-color","#f4f4f4");
k.each(q,function(B){var C=B.programName.replace(".","");var y=d.replaceSpace(C.toLowerCase(),"-");if(B.currentRate>B.rateThreshold||B.currentCount>B.countThreshold){r="."+y+" .threshold-indicator";
n.$el.find(r).css("background-color","#80000c");}var A=e.getUserFriendlyDate(B.currentCountStartDate)+" & "+e.getUserFriendlyDate(B.currentCountEndDate);
var z=n.$el.find("."+y+" .sub-title-date");z.text(A);z.attr("data-daterange",A);});};n.onNotifiedViewCreator=function(t,s){o.onNotifiedViewCreator(t,s);
var p,r,q=t.changeObject.data.chartData;};n.mediatorReady=function(){o.mediatorReady();var q=this.$el.find("#ecpAcquirer option:selected");
var p=q.text();var r=this.$el.find(".ecp-acquirer-title");r.text(p);this.programButtonElements=[];this.programPanelElements=[];
this.$el.find(".ecp-button").each(function(){n.programButtonElements.push(a(this));});this.$el.find(".ecp-report-panel").each(function(){n.programPanelElements.push(a(this));
});k.each(this.programButtonElements,function(s){s.detach();});k.each(this.programPanelElements,function(s){s.detach();});
setTimeout(function(){n.$el.find(".ecp-explanation").fadeTo(750,1);},1000);};n.showAllProgramElements=function(){var q=this.$el.find(".ecp-button-holder");
var p=this.$el.find("#mainChart");k.each(this.programButtonElements,function(r){r.css({opacity:0,display:"none","margin-left":"20px"});
q.append(r);});k.each(this.programPanelElements,function(r){r.css({opacity:0,display:"none"});p.append(r);});};n.getInstance=function(){return this;
};n.fetchNewDataAction=function(){var q=this.$el.find("#ecpAcquirer option:selected");var p=q.text();var r=this.$el.find(".ecp-acquirer-title");
r.text(p);this.showAllProgramElements();};n.onTimeData=function(s,p,r){this.showAllProgramElements();var q=e.getUserFriendlyDate(s[1],true);
this.$el.find(".bar-title-date").text(q);this.$el.find(".bar-title-date").attr("data-date",q);};n.onInfo=function(r,p,q){if(r.sender.attr("data-active")==="true"){return;
}this.infoShow(r);};n.infoShow=function(t){var s=t.sender;var q=this.$el.find(t.target);s.attr("data-active","true");this.positionPanel(s,q);
var p=q.find("#removeBtn");var r=(p.length)?p:a("#subcontent");q.fadeTo(500,1,function(){a("#subcontent").on("click",{infoPanel:q,closeElement:r,btn:s},n.infoHide);
a("#subcontent").on("keyup",{infoPanel:q,closeElement:r,btn:s},function(u){if(u.keyCode===27){n.infoHide(u);}});});};n.positionPanel=function(y,q){var v=20,s;
var x=y;var p=x.position().left;var t=x.offset().left;var w=q;var r=a(window).width();var u=w.width();if(t+v+u>r){s=Number(p)-v-Number(u);
}else{s=v;}w.css("left",(s+"px"));};n.infoHide=function(s){var p=s.data.infoPanel;var q=s.data.closeElement;var r=s.data.btn;
var t=p.is(":hover");if(t){return;}q.off("click");q.off("keyup");r.attr("data-active","false");p.fadeTo(250,0);};n.init();
m.ready();return n;};return f;});define("chart/widgetFramework/composed/cardAcquirerAuthorizationReport/countBarChart",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/core/mixins/formats","chart/widgetFramework/chartTypes/barChart"],function(c,h,k,b,e,a,f,j,g,i){function d(q,l,o){var n;
var p={};var m=h.defaults(p,q);n=i(m,l,o);var s=f(n);var r=false;n.init=function(){s.init();};n.initRender=function(){s.initRender();
setTimeout(function(){if(!r&&n.options.ranked){n.chartGroup.classed("barchart-ranked",true);}r=true;},100);};n.renderData=function(){s.renderData();
if(a.falsy(this.data)){return;}var v=this.barUtils.bars;var t=this.barUtils.transitionTime;var x=this.barUtils.delayTime;
var w=k.format(",.2r");v.update.select(".bar-label").text(function(y){return w(y[n.options.xAttr])+" tx";}).style("opacity",0).transition().duration(t).delay(x).style("opacity",1);
v.enter.append("text").attr("class","bar-label").attr("x",-8).attr("y","1.15em").style("text-anchor","end").style("opacity",0).text(function(y){return w(y[n.options.xAttr])+" tx";
}).transition().duration(t).delay(x).style("opacity",1);v.exit.select(".bar-label").transition().duration(t).style("opacity",0).remove();
var u=this.data.length*this.options.barHeight+this.options.margin.top+this.options.margin.bottom;k.select("#"+this.$el[0].id).transition().duration(t).style("height",u+"px");
};return n;}return d;});define("chart/widgetFramework/composed/cardAcquirerAuthorizationReport/rollovers/acquirerLineRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/chartTypes/rollover"],function(c,i,j,a,f,h,g,e,d){function b(o,k){var m;
var n={};var l=i.defaults(n,o);m=d(l,k);var p=g(m);m.removedAcquirersArr=[];m.allLinesAreRemoved=false;m.init=function(){p.init();
this.barUtils.barSelectorStr=".bar.acquirer-time-rollover";this.barUtils.barClassStr="bar acquirer-time-rollover";};m.feedData=function(q){p.feedData(q);
this.removedAcquirersArr=[];this.allLinesAreRemoved=false;};m.renderData=function(){var q=m.options.centerBars;this.barUtils.chartWidth=this.width;
this.barUtils.chartHeight=this.height;var r;r=this.barUtils.barPosition(q,this.bandSize,this.getXScale(),this.options.joinAttr);
this.barUtils.containerBarsVertical(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),r).fullBarVertical(2,"thin-bar").fullBarVertical(this.barSize,"dateStr");
};m.tooltipOnMouseoverAction=function(r,q){this.sharedMouseAction(r,q,0.25,1);};m.tooltipOnMouseoutAction=function(r,q){this.sharedMouseAction(r,q,0,0);
};m.postRender=function(r){var s=this.extraData.colors;for(var q in s){if(s.hasOwnProperty(q)){j.selectAll(".acquirer-time-tooltip .legend-"+q+".line").style("background-color",s[q]);
if(q==="overall"){j.selectAll(".acquirer-time-tooltip .legend-"+q+".label").style("font-weight",600);}}}};m.sharedMouseAction=function(u,x,v,y){var s=x.find(".dateStr");
var t=s.attr("data-id");var w=x.find(".thin-bar");j.select(w[0]).style("opacity",v);var r,q;i.each(u.acquirers,function(z){r=".acquirer-time-chart ."+z.acquirer+' .line-holder-dot[data-id*="'+t+'"]';
q=j.select(r).style("fill-opacity",y).style("stroke-opacity",y);});};m.positionTooltip=function(u,w,t,v,q,r,x){var s=u.top+t-q;
var y=((u.left+w+10)-v)+(r/2);return{top:s,left:y};};m.enhanceTooltipData=function(r){var q=new Date(r.date);var u=j.time.format("%Y-%m-%d");
r.dateStr=u(q);var t=i.filter(r.acquirers,function(v){return i.indexOf(m.removedAcquirersArr,v.acquirerStr)===-1;});r.acquirers=t;
function s(w,v){return +w.authRate<+v.authRate;}r.acquirers.sort(s);};m.removeTooltipElement=function(q){this.removedAcquirersArr.push(q);
};m.restoreTooltipElement=function(q){i.remove(this.removedAcquirersArr,function(r){return q===r;});if(this.allLinesAreRemoved){this.setTooltipsOnElements();
this.allLinesAreRemoved=false;}};m.allLinesRemoved=function(){var q=this.$el.find(this.tooltipSelector);q.off(this.tooltipEvent);
q.off("mouseout");this.allLinesAreRemoved=true;};return m;}return b;});define("chart/widgetFramework/composed/chargebackReport/formatters/countryBarFormatter",["jqueryExtended","underscore","d3","chart/widgetFramework/core/constants/DataConstants","chartutil/stringutils","chartutil/domUtils"],function(g,b,c,e,f,d){function a(k,h,j,m){var i={};
i.data=k;i.options=h;i.formattedData={};i.comparator=null;i.reverseDirection=false;i.sortKey="chargebackCount";i.timeline=j;
i.id=m;i.dataType="chargebacks";i.rateDataType="count";i.formatData=function(){var n=(this.data&&b.has(this.data,"country_statistics"))?this.data.country_statistics:{};
this.formattedData=l(n);if(this.sortKey){this.reverseDirection=!this.reverseDirection;this.sortData(this.sortKey,true);}if(window.console&&console.log){console.log("### country bar data formatter::"+this.id+" formatData:: this.formattedData=",this.formattedData);
}return{chartData:this.formattedData};};var l=function(p){var q=c.format(",g4f");var o=[];var n,r;b.each(p,function(v){n={};
r=f.capitaliseAllFirstLetters(v.countryName);var s=+v.authorisedEurAmount/100;var u=+v.chargebackEurAmount/100;var t=+v.nofEurAmount/100;
if(i.dataType==="chargebacks"){if(v.chargebackCount>0){n.countryName=r;n.regionName=v.regionName;n.chargebackCount=+v.chargebackCount;
n.chargebackCountFormatted=q(+v.chargebackCount);n.chargebackEurAmount=u;if(i.rateDataType==="count"){n.chargebackRate=(+v.authorisedCount>0)?+v.chargebackCount/+v.authorisedCount*100:0;
}else{n.chargebackRate=(s>0)?u/s*100:0;}n.chargebackRate=Number(n.chargebackRate.toFixed(4));o.push(n);}}else{if(v.nofCount>0){n.countryName=r;
n.regionName=v.regionName;n.chargebackCount=+v.nofCount;n.chargebackCountFormatted=q(+v.nofCount);n.chargebackEurAmount=t;
if(i.rateDataType==="count"){n.chargebackRate=(+v.authorisedCount>0)?+v.nofCount/+v.authorisedCount*100:0;}else{n.chargebackRate=(s>0)?(t/(s)*100):0;
}n.chargebackRate=Number(n.chargebackRate.toFixed(4));o.push(n);}}});return o;};i.reformatDataChargebacksNof=function(n){this.dataType=n.type;
var o=this.formatData();this.$el.trigger(e.FORMATTER_INFORM_WIDGET,{type:e.REFORMATTED_DATA,data:o});};i.reformatData=function(o){this.rateDataType=o;
var n=this.formatData();this.$el.trigger(e.FORMATTER_INFORM_WIDGET,{type:e.REFORMATTED_DATA,data:n});};i.sortData=function(n,p){this.sortKey=n;
if(this.sortKey===this.oldSortKey){this.reverseDirection=!this.reverseDirection;}else{this.reverseDirection=false;}this.oldSortKey=this.sortKey;
var o=b.sortBy(this.formattedData,n);if(this.reverseDirection){o.reverse();}this.formattedData=o;if(p===true){return;}this.$el.trigger(e.FORMATTER_INFORM_WIDGET,{type:e.SORTED_DATA,data:{chartData:this.formattedData}});
};i.compareFunction=function(n){return n[this.sortKey];};i.downloadCSV=function(){var o=["countryName","chargebackCount","chargebackEurAmount","chargebackRate"];
var p;var n;if(this.dataType==="chargebacks"){p=["Country","Chargeback count","Chargeback amount","Chargeback rate (based on "+this.rateDataType+")"];
n="ChargebacksByIssuerCountry";}else{p=["Country","Notifications of fraud count","Notifications of fraud amount","Notifications of fraud rate (based on "+this.rateDataType+")"];
n="NotificationsOfFraudByIssuerCountry";}d.createCSV(this.formattedData,o,p,n);};i.getData=function(){return(this.data)?this.data:this.formatData();
};i.setRawData=function(n){this.data=n;};i.retrieveData=function(n){return this.data[n];};return i;}return a;});define("chart/widgetFramework/composed/ecpReport/ecpChargebackRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/chartTypes/rollover"],function(c,i,j,a,f,h,g,e,d){var b=function(q,k,o,m){var n;
var p={};var l=i.defaults(p,q);n=d(l,k);var r=g(n);n.feedData=function(t){var s=i.filter(t.chartData,function(u){return u.programName===n.options.dataSubset;
});if(!a.existy(s[0])){return e.HALT_RENDER_PROCESS;}this.data=s[0];};n.setTooltipsOnElements=function(){r.setTooltipsOnElements(true);
};n.enhanceTooltipData=function(t){var s=j.format(".2f");var u=j.format("0,000");t.valueTT=(a.existy(t.rate))?s(t.rate)+"%":u(t.count)+" tx";
};n.hideCharts=function(s){};n.getData=function(){return this.data.barData;};n.getYScale=function(){var s=j.scale.ordinal().rangeBands([this.height,0],this.options.barPadding).domain(["rate","count"]);
return s;};return n;};return b;});define("chart/widgetFramework/composed/riskReport/txFigures",["jquery","underscore","d3","hogan","util/Functional","chartutil/d3utils","util/ObjectSuper","chart/widgetFramework/core/drivers/basicChartDriver"],function(b,f,h,d,a,i,e,c){var g=function(p,j,n,l){var m;
var o={};var k=f.defaults(o,p);m=c(k,j);var q=e(m);m.init=function(){q.init();this.totalTxt=this.$el.find("#actualTotalText");
};m.feedData=function(t){this.data=t.formattedData;var s=this;var r=f.filter(this.data,function(u){return u[s.options.joinAttr].toLowerCase()==="received";
});this.totalTransactions=r[0].count;};m.renderData=function(){var r=h.format("0,000");var s=r(this.totalTransactions);this.totalTxt.html("Total global transactions: <b>"+s+"</b>");
};return m;};return g;});define("chart/widgetFramework/composed/mfpReport/mfpActions",["jqueryExtended","underscore"],function(c,a){var d=c;var b={actions:[{source:"mfpAcquirer",event:"change",target:["mfpDataFetcher","mfpMediator"],callMethod:"fetchNewDataAction",getterMethod:function(e){var f=e.val();
return{acquirerCode:f};}},{source:"[data-id=mfpInfo]",event:"click",lazySelector:".chart-info-btn",target:"#mfpMediator",callMethod:"onInfo",getterMethod:function(f){var e=f.attr("data-rel");
return{sender:f,target:e};}}]};return b;});define("chart/widgetFramework/composed/harpViewer/harpDataFormatter",["jqueryExtended","json","underscore","d3","chart/widgetFramework/core/constants/DataConstants"],function(b,h,i,j,e){var k=adyen.config||{};
function g(n,l,m){this.data=n;this.options=l;this.formattedData={};this.$el=m;}g.prototype.formatData=function(){var l=this;
this.masterData=this.data;var n=i.keys(this.data);var o=n[0];if(k.chosenTree&&i.includes(n,k.chosenTree)){o=k.chosenTree;
}this.treeData=this.fetchNewTreeData(o);var m=[];i.each(n,function(p){var q={key:p,treeId:String(l.data[p].harpTreeId)};m.push(q);
});this.treeData.keyValArr=m;return{chartData:this.treeData};};g.prototype.retrieveData=function(l){k.chosenTree=l;this.treeData=this.fetchNewTreeData(l);
this.$el.trigger(e.FORMATTER_INFORM_WIDGET,{type:e.RETRIEVED_DATA,data:{chartData:this.treeData}});};g.prototype.fetchNewTreeData=function(n){this.hasData=false;
var l=this.fetchSubsetData(n);var m=i.find(l,function(p){return p.dimensionTypeCode.toLowerCase()==="root";});if(!m){return[];
}this.rootTotal=m.receivedCount;this.currentData=c(l,this.rootTotal);var o=a(this.currentData);return o;};g.prototype.fetchSubsetData=function(m){var n=this.masterData[m].harpNodes;
var l=f(n);if(l.length){this.hasData=true;}else{if(window.console&&console.log){console.log("### harpDataFD::fetchTreeData:: NO VIEWABLE DATA");
}return null;}return l;};function f(l){var m=i.sortBy(l,function(o){return o.dimensionCode+o.dimensionValue;});if(m.length){var n=i.findWhere(m,{parentNodeId:""}).authRate;
i.each(m,function(o){o.baselineAuthorisationRate=n;});}return m;}function c(l,n){var m=[];i.each(l,function(p){var o=d(p,n);
m.push(o);});return m;}function d(s,t){var u={};u.actionable=true;u.harpId=s.harpNodeId;u.parentId=s.parentNodeId;u.dimensionCode=s.dimensionTypeCode;
u.dimensionValue=s.name;u.total=s.receivedCount;var l=u.total/t;u.percentTotal=(i.isFinite(l))?l*100:0;u.auths=s.authorisedCount;
var v=0;var m=(s.receivedEurQuantity)?s.receivedEurQuantity:0;if(m>0){v=j.format("0,000")(m/100);}u.eurAmount=v;u.authPercent=Number(s.authRate.toFixed(2));
u.authPercentDraw=(u.authPercent<=100)?u.authPercent:100;u.authPotentialImpr=Number(s.authRatePotentialImpr.toFixed(2));u.isLeaf=s.isLeaf;
u.baselineAuthorisationRate=s.baselineAuthorisationRate;u.dimensionText=s.label;u.shortTitle=s.shortlabel;u.description=s.dimensionDescription||"";
u.descriptionTitle=s.dimensionTitle||"";u.refusals=u.total-u.auths;u.baselineStats=h.parse(s.statsPerDay);u.baselinePotentialImpr=Number((u.parentId!=="")?Math.max(u.authPotentialImpr,s.baselineAuthorisationRate-s.authRate):s.authRatePotentialImpr);
u.restPercent=Math.max(0,Number((100-u.authPercent-u.baselinePotentialImpr).toFixed(2)));u.authRates=[];var q=0,n,o=["authPercentDraw","baselinePotentialImpr","restPercent"];
for(var p=0;p<3;p++){var r={};r.name=o[p];if(r.name==="authPercentDraw"){if(u.authPercent>100){r.name+="-authover";}}r.startX=(q)?q:0;
n=u[o[p]];r.endX=q+n;q+=n;u.authRates.push(r);}if(u.parentId===""){if(window.console&&console.log){console.log("### harpDataFD:: createMappedDataObject:: ROOT MODEL=",u);
}}return u;}function a(m){var o=m;if(!o.length){return;}if(o.length<1){return null;}var l=i.reduceRight(o,function(q,p){q[p.harpId]=p;
return q;},{});var n=[];o.forEach(function(q){var p=l[q.parentId];if(p){(p.children||(p.children=[])).push(q);}else{n.push(q);
}});return n;}g.prototype.getData=function(){return(this.treeData)?this.treeData:this.formatData();};g.prototype.setRawData=function(l){this.data=l;
};g.prototype.setOptions=function(l){this.options=l;};return g;});define("chart/widgetFramework/composed/riskReport/views/riskChecksStackedView",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/chartTypes/stackedBar"],function(d,g,j,c,e,b,f,i,h){var a=function(n,q,t,s){var p,r,k,o;
var l={};var u=g.defaults(l,n);p=h(u,q,t);var m=f(p);p.renderData=function(){var w=this.scales[this.options.xAttr];var v=m.renderData();
if(!v){return;}v.stacks.enter.transition().each("end",function(y){var x=this;setTimeout(function(){var z=w(y.endX)-w(y.startX);
j.select(x).attr("width",z);},250);});if(b.falsy(this.data)){this.hideCharts("no data to display");return;}};return p;};return a;
});define("chart/widgetFramework/composed/transactionsDashboard/rollovers/groupedBarRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/chartTypes/axisRollover"],function(c,i,j,a,f,h,g,e,d){function b(o,k){var m;
var n={};var l=i.defaults(n,o);m=d(l,k);var p=g(m);m.init=function(){p.init();this.barUtils.setBarSelectorStr(".bar.grouped-bar-rollover");
};m.setTooltipsOnElements=function(){p.setTooltipsOnElements(true);};m.enhanceTooltipData=function(q){q.authRateRankIconTT=(q.authRateDifference>=0)?"grouped-bar-rollover rank-icon":"grouped-bar-rollover rank-icon negative";
q.authTxRankIconTT=(q.authCountDifferencePercentage>=0)?"grouped-bar-rollover rank-icon":"grouped-bar-rollover rank-icon negative";
q.authAmtRankIconTT=(q.authAmountDifferencePercentage>=0)?"grouped-bar-rollover rank-icon":"grouped-bar-rollover rank-icon negative";
};return m;}return b;});define("chart/widgetFramework/composed/riskReport/formatters/receivedTxCountStackedFormatter",["jqueryExtended","underscore","d3","chart/widgetFramework/core/constants/DataConstants","chartutil/dateUtils_CET","chartutil/d3utils","chart/widgetFramework/composed/riskReport/constants/riskConstants","chartutil/domUtils"],function(a,g,h,e,d,i,b,f){var c=function(m,j,l,n){var k={};
k.data=m;k.options=j;k.formattedData={};k.comparator=null;k.reverseDirection=false;k.sortKey=null;k.timeline=l;k.id=n;k.currentCountry="";
k.formatData=function(){if(this.currentCountry!==""){return[];}this.formattedData=this.calculateMetaData(this.data);if(this.sortKey){this.reverseDirection=!this.reverseDirection;
this.sortData(this.sortKey,true);}return{chartData:this.formattedData};};k.fetchNewDataAction=function(o){this.currentCountry=o.countryFilter;
};k.calculateMetaData=function(o){g.map(o,function(p){p[b.RECEIVED_TX_TOTAL]=p.totalCount;p[b.RECEIVED_TX_REVPRO_TOTAL]=p.riskTransactionCount;
p[b.RECEIVED_TX_GPM_TOTAL]=p.totalCount-p.riskTransactionCount;if(p[b.RECEIVED_TX_GPM_TOTAL]<0){p[b.RECEIVED_TX_GPM_TOTAL]=0;
}p.rates=[{name:"revenue-protect",value:p[b.RECEIVED_TX_REVPRO_TOTAL],startY:0,endY:p[b.RECEIVED_TX_REVPRO_TOTAL]},{name:"guaranteed-pm",value:p[b.RECEIVED_TX_GPM_TOTAL],startY:(p[b.RECEIVED_TX_REVPRO_TOTAL]>p[b.RECEIVED_TX_TOTAL])?p[b.RECEIVED_TX_TOTAL]:p[b.RECEIVED_TX_REVPRO_TOTAL],endY:p[b.RECEIVED_TX_TOTAL]}];
});return this.data;};k.sortData=function(o,q){this.sortKey=o;this.reverseDirection=!this.reverseDirection;var p=g.sortBy(this.formattedData,o);
if(this.reverseDirection){p.reverse();}this.formattedData=p;if(q===true){return;}this.$el.trigger(e.FORMATTER_INFORM_WIDGET,{type:e.SORTED_DATA,data:this.formattedData});
};k.compareFunction=function(o){return o[this.sortKey];};k.downloadCSV=function(){var o=["dateStr","receivedTxTotal","receivedTxRevProTotal","receivedTxGpmTotal"];
var p=["Date","Total Received Tx","Routed through RevenueProtect","Guaranteed payment method"];f.createCSV(this.formattedData,o,p,"ReceivedTransactionCount");
};k.getData=function(){return(this.data)?this.data:this.formatData();};k.setRawData=function(o){this.data=o;};k.retrieveData=function(o){return this.data[o];
};k.setOptions=function(o){this.options=o;};return k;};return c;});define("chart/widgetFramework/composed/harpReportBuilder/harpReportBuilderFormatter",["jqueryExtended","underscore"],function(c,a){function b(e,d){this.data=e;
this.options=d;this.formattedData={};}b.prototype.formatData=function(){if(a.has(this.data,"action")&&(this.data.action==="Description Exists")){return this.data;
}if(a.has(this.data,"action")&&(this.data.action==="New Tree"||this.data.action==="Get Tree")){return this.createTreeStructure(this.data);
}if(a.has(this.data,"action")&&(this.data.action==="Delete Tree")){return this.data;}if(this.data.action==="updateExplanation"&&this.data.success){return;
}if(this.data.error){return[{error:this.data.error}];}};b.prototype.createTreeStructure=function(i){var f=this.data.nodes;
this.data.possibleNewDimensions=this.sortDimensionValues(this.data.possibleNewDimensions);a.each(this.data.possibleNewDimensions,function(j){a.each(j.dimensions,function(m){var l=[];
var n=m.values;for(var k=0;k<n.length;k++){l.push({index:k,name:n[k].value});}m.values=l;m.title=m.name;if(n.length!==0){m.title=n[0].dimensionTitle;
}});});var e=a.findWhere(f,{parentNodeId:0});var d=a.findWhere(this.data.possibleNewDimensions,{nodeId:String(e.harpNodeId)});
var h=i.scheduling;var g=a.where(f,{parentNodeId:e.harpNodeId});e.allData={possibleNewDimensions:d,isTemplate:this.data.isTemplate,schedulingStatus:h.status,schedulingDate:h.firstDataStartDate,treeName:this.data.treeName,treeId:this.data.treeId,explanation:(e.explanation)?e.explanation:false,isRoot:true,noChildren:(g.length<=0),nodeId:e.harpNodeId};
this.processChildren(e,this.data);return[e];};b.prototype.setRawData=function(d){if(this.data&&a.has(d,"action")&&d.action==="New Split"){this.data=this.mergeWithExistingData(this.data,d);
return;}if(this.data&&a.has(d,"action")&&d.action==="Delete Nodechildren"){if(!d.nodeId){var e=a.first(d.nodes).parentNodeId;
d.nodeId=e;}this.data=this.removeDimensionFromData(this.data,d);return;}if(this.data&&a.has(d,"action")&&d.action==="Update Tree"){this.data.treeName=d.treeName;
return;}if(this.data&&a.has(d,"action")&&d.action==="Update Node"){return;}if(this.data&&a.has(d,"action")&&d.action==="Schedule Report"){return;
}if(this.data&&a.has(d,"action")&&d.action==="Description Exists"){return;}this.data=d;};b.prototype.removeDimensionFromData=function(f,e){var g=e.nodeId;
var d=this.findNode(f,g);d.children=[];f.action=e.action;return f;};b.prototype.mergeWithExistingData=function(g,e){var d=this;
var h=parseInt(e.parentNodeId);var f=this.findNode(g,h);f.children=e.nodes;f.allData.noChildren=false;a.map(f.children,function(i){d.addNodeMetaData(i,e);
});g.action=e.action;return g;};b.prototype.findNode=function(g,h){if(a.isArray(g)){for(var j=0;j<g.length;j++){var e=g[j];
var d=this.findNode(e,h);if(d){return d;}}}if(g.nodes){for(var i=0;i<g.nodes.length;i++){var f=g.nodes[i];if(f&&f.harpNodeId===h){return f;
}if(f.children){return this.findNode(f.children,h);}}}else{if(g.harpNodeId===h){return g;}else{if(g.children){return this.findNode(g.children,h);
}}}};b.prototype.addNodeMetaData=function(f,k){var e=(f.harpNodeId)?f.harpNodeId:"";k.possibleNewDimensions=this.sortDimensionValues(k.possibleNewDimensions);
var g=a.findWhere(k.possibleNewDimensions,{nodeId:e.toString()});var m=g.dimensions;for(var n=0;n<m.length;n++){var h=m[n];
var d=[];var l=h.values;for(var j=0;j<l.length;j++){d.push({index:j,name:l[j].value});}h.title=h.name;if(l.length){h.title=l[0].dimensionTitle;
}h.values=d;}f.allData={possibleNewDimensions:g,isRoot:false,explanation:(k.explanation)?k.explanation:false,treeId:k.treeId,noChildren:true,harpNodeId:f.harpNodeId,nodeId:f.harpNodeId,dimensionType:f.dimensionType,dimensionTitle:f.name};
};b.prototype.sortDimensionValues=function(d){return a.map(d,function(e){return{title:e.title,nodeId:e.nodeId,dimensions:a.map(a.sortBy(e.dimensions,function(f){return f.name.toString().toLowerCase();
}),function(f){return{name:f.name,values:a.sortBy(f.values,function(g){if(typeof(g.dimensionTitle)!=="undefined"){return g.dimensionTitle.toString().toLowerCase();
}else{return g.dimensionTitle;}})};})};});};b.prototype.processChildren=function(d,j){var f=a.where(j.nodes,{parentNodeId:d.harpNodeId});
if(f.length<1){return false;}d.children=[];for(var e=0;e<f.length;e++){var k=f[e];var g=a.findWhere(j.possibleNewDimensions,{nodeId:String(k.harpNodeId)});
var h=a.where(j.nodes,{parentNodeId:k.harpNodeId});k.allData={possibleNewDimensions:g,isRoot:false,treeId:j.treeId,explanation:(k.explanation)?k.explanation:false,noChildren:(h.length<=0),nodeId:k.harpNodeId,dimensionType:k.dimensionType,dimensionTitle:k.name};
d.children.push(k);this.processChildren(k,j);}};return b;});define("chart/widgetFramework/composed/chargebackReport/formatters/cfnBarFormatter",["underscore","chart/widgetFramework/core/constants/DataConstants"],function(b,c){var a=function(g,d,f,h){var e={};
e.data=g;e.options=d;e.formattedData={};e.comparator=null;e.reverseDirection=false;e.sortKey=null;e.timeline=f;e.id=h;e.dataType="count";
e.formatData=function(){this.formattedData=this.calculateMetaData(this.data);if(window.console&&console.log){console.log("### cfnBarFormatter::formatData:: formattedData=",this.formattedData);
}return{chartData:this.formattedData};};e.calculateMetaData=function(j){var i=[];b.each(j,function(m){var l=+m.chargebackEurAmount/100;
var k=+m.fraudNotificationsEurAmount/100;if(e.dataType==="count"){i.push({total:m.chargebackCount+m.fraudNotificationsCount,date:m.date,dateStr:m.dateStr,"multi-bars":[{name:"chargeback",value:m.chargebackCount},{name:"notifications-of-fraud",value:m.fraudNotificationsCount}]});
}else{i.push({total:l+k,date:m.date,dateStr:m.dateStr,"multi-bars":[{name:"chargeback",value:l},{name:"notifications-of-fraud",value:k}]});
}});return i;};e.reformatData=function(i){this.dataType=i;var j=this.formatData();this.$el.trigger(c.FORMATTER_INFORM_WIDGET,{type:c.REFORMATTED_DATA,data:j});
};e.setRawData=function(i){this.data=i;};return e;};return a;});define("chart/widgetFramework/composed/revenueAccelerate/revOpBaselineRatesChart",["jquery","underscore","d3","hogan","chartutil/d3utils","chart/widgetFramework/core/mixins/widgetScales","chart/widgetFramework/core/mixins/formats","util/Functional","chart/widgetFramework/chartTypes/lineChart","util/ObjectSuper"],function(d,g,j,e,k,i,c,a,h,f){var b=function(r,l,p,n){var o;
var q={};var m=g.defaults(q,r);o=h(m,l);var s=f(o);o.renderTickDelay=550;o.init=function(){s.init();g.bindAll(this,"chartTypeSelected");
this.chartType="total";};o.feedData=function(t){this.configData=t.config||{};this.extraData=t.extraData||{};this.tempData={lines:[{name:"baseline",lineValues:t.chartData}]};
this.data=this.tempData.lines;this.isModeChange=false;this.setNestedAttr(this.data,true);this.options.joinAttr="name";};o.chartTypeSelected=function(t){var u=t[0];
if(u===this.chartType){return;}this.chartType=u;this.isModeChange=true;this.render();};o.formatXAxis=function(t){this.baselineFormatTimeXAxis(this.options.xAttr);
};o.baselineFormatTimeXAxis=function(x){var v=this,u=this.axes[x],w=this.configData.granularity,y="wk ",t=this.scales[x].ticks(j.time[w],1).length;
u.ticks(j.time[w],1).tickFormat(function(B,z){var A=v.granularityFormats[w];return A(B);});};o.calibrateYScale=function(){var t;
switch(this.chartType){case"zoom":t=this.getDataBasedOnDateRange(this.data[0]);t=g.pluck(t,this.options.yAttr);this.scales[this.options.yAttr].domain([j.min(t),j.max(t)]).nice();
break;default:s.calibrateYScale();break;}};o.renderYAxis=function(){s.renderYAxis();setTimeout(function(){c.lastTickFormat(o,o.options.yAxisIsPercent);
},o.renderTickDelay);};o.getLineData=function(t){return this.getDataBasedOnDateRange(t);};o.getDataBasedOnDateRange=function(u){var t=u[o.nestedAttr].filter(function(v){return v.date.getTime()<=o.configData.lastModelDate.getTime();
});return t;};return o;};return b;});define("chart/widgetFramework/composed/transactionsDashboard/formatters/masterFormatter",["lodash","chartutil/d3utils","chartutil/dateUtils_CET","util/Functional"],function(a,d,e,c){var b=function(j,f,i,g){var h={};
h.data=j;h.timeline=i;h.months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];h.formatData=function(){var k=[];
var n={};if(this.data){if(a.has(this.data,"monthlyAuthorizations")){n=this.data.monthlyAuthorizations;}else{if(a.has(this.data,"authorizationsStatistics")){n=this.data.authorizationsStatistics;
}else{if(a.has(this.data,"liveAuthorizations")){n=this.data.liveAuthorizations;}}}}if(c.falsy(n)){return[];}if(a.isArray(n)){var l=n;
var m=(this.timeline)?this.timeline.getGranularity():"hourOrMinute";k=this.parseDates(l,m);}return k;};h.parseDates=function(l,m){var k=a.map(l,function(p){p.dateStr=p.date;
var n=new Date(p.dateStr);if(m!=="hourOrMinute"){var o=e.convertDateToAMS(n);p.date=e.roundToDay(o);}else{p.date=n;}return p;
});a.each(k,function(n){if(m==="month"){n.formattedTimespan=h.months[n.date.getMonth()]+" '"+String(n.date.getFullYear()).substring(2);
}else{if(m==="week"){n.formattedTimespan="week "+n.date.getWeek();}else{n.formattedTimespan=n.dateStr;}}});return k;};h.setRawData=function(k){this.data=k;
};return h;};return b;});define("chartlib/ui/snapshot",["jquery","underscore","backbone","d3","chartutil/svgutils","timeline/util/timelineConstants"],function(f,c,g,e,d,a){var b=g.View.extend({events:{click:"onClick"},initialize:function(h){c.bindAll(this,"onClick");
this.snapshotEl=h.snapshotEl;this.styleSheets=h.styleSheets;this.title=(h.title)?h.title:"chartImage";this.timeline=h.timeline;
},onClick:function(j){var i;var k;var l=this.title;if(this.timeline){i=e.time.format(a.__FORMAT_DATE)(this.timeline.getDates()[0]);
var h=new Date(this.timeline.getDates()[1]);h.setDate(h.getDate()-1);k=e.time.format(a.__FORMAT_DATE)(h);}if(this.timeline){l+=": "+i+" - "+k;
}d.svgToPng(this.snapshotEl,this.styleSheets,l,this.title);}});return b;});define("chart/widgetFramework/composed/riskReport/rollovers/fraudScoreRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/chartTypes/rollover","chart/widgetFramework/core/mixins/widgetScales"],function(c,i,k,a,f,h,g,e,d,j){var b=function(r,l,p,n){var o;
var q={};var m=i.defaults(q,r);o=d(m,l);var s=g(o);o.getXScale=function(){var u=j.getDomainFromDataExtremes(this.data,this.options.joinAttr);
var t=k.scale.linear().rangeRound([0,this.width]).domain(u);t.nice();return t;};o.enhanceTooltipData=function(v){var w=k.format("0,000");
var u=v.x;var t=v.x+(v.dx-1);v.fraudScoreTT=u+" to "+t;v.acceptedTT=w(v.stacksArray[2].frequency);v.refusedBankTT=w(v.stacksArray[1].frequency);
v.refusedRiskTT=w(v.stacksArray[0].frequency);};return o;};return b;});define("chart/widgetFramework/composed/transactionsDashboard/txActions",["jqueryExtended"],function(g){var h=window.adyen||{};
var c=h.config||{};var d=["transactionsMediator"];var b=["transactionsMediator"];var a="widgetAppStartup";if(c.showTxLine){d.push("txLineFetcher");
b.push("txLine");}if(c.showTxLineRollover){b.push("txLineRollover");}var f=["transactionsMediator"];if(c.showTxHeatmap){f.push("txHeatmapFetcher");
}var e={actions:[{source:"#transactionsMediator",event:"widgetAppStartup",target:d,callMethod:"widgetAppStartup"},{source:["#hourToggle","#minuteToggle"],event:"click",target:d,callMethod:"fetchNewDataAction",toggle:"tx-line-toggle",getterMethod:function(i){var j=i.attr("data-toggle-id");
return{timespan:j};}},{source:"#transactionsMediator",event:"setTxGranularity",target:b,callMethod:"setGranularity"},{source:"txLine",event:"lineChart_lineRemoved",target:["txLineRollover"],callMethod:"removeTooltipElement"},{source:"txLine",event:"lineChart_lineRestored",target:["txLineRollover"],callMethod:"restoreTooltipElement"},{source:"txLine",event:"lineChart_allLinesRemoved",target:["txLineRollover"],callMethod:"allLinesRemoved"},{source:"#transactionsMediator",event:a,target:f,callMethod:"widgetAppStartup"},{source:"txFilter",event:"change",target:["txLineFetcher","monthlyAuthsFetcher","granularAuthsFetcher"],callMethod:"fetchNewDataAction",getterMethod:function(i){g("#txLineSpinner").show();
g("#granChartSpinner").show();var j=i.val();return{transactionType:j};}},{source:"shopperInteraction",event:"change",target:["monthlyAuthsFetcher","granularAuthsFetcher"],callMethod:"fetchNewDataAction",getterMethod:function(i){g("#timeline1").find("#timelineLoader").css("display","block");
var j=i.val();return{shopperInteraction:j};}},{source:["#dayToggle","#weekToggle","#monthToggle"],event:"click",target:"transactionsMediator",callMethod:"setToggleGranularity",toggle:"gran-toggle",getterMethod:function(i){var j=i.attr("data-toggle-id");
return{granularity:j};}},{source:"#totalZoomToggleInput",event:"click",target:["#authRateLine"],callMethod:"setScaleToggleState",getterMethod:function(j){var l=j.parents(".total-zoom-toggle-btn");
j.parents(".csr-button-switch-2").toggleClass("switch-off").toggleClass("switch-on");var k="total";var i=j.parents(".csr-button-switch-2")[0].className;
if(i.indexOf("switch-off")>-1){k="zoom";l.find(".toggle-zoom").addClass("active");l.find(".toggle-total").removeClass("active");
}else{l.find(".toggle-zoom").removeClass("active");l.find(".toggle-total").addClass("active");}l.attr("data-state",k);return k;
}},{source:"#rollingAvgToggleInput",event:"click",target:["#granularAuthsLineFormatter","#authRateRollover"],callMethod:"setRollingAverageData",getterMethod:function(j){var l=j.parents(".avg-toggle-btn");
j.parents(".csr-button-switch-2").toggleClass("switch-off").toggleClass("switch-on");var k="avg7";var i=j.parents(".csr-button-switch-2")[0].className;
if(i.indexOf("switch-off")>-1){k="avg30";l.find(".toggle-thirty").addClass("active");l.find(".toggle-seven").removeClass("active");
}else{l.find(".toggle-thirty").removeClass("active");l.find(".toggle-seven").addClass("active");}l.attr("data-state",k);return k;
}},{source:"#authRateLine",event:"setAvgToggle",target:["granularAuthsLineFormatter","#authRateRollover"],callMethod:"setRollingAverageData",getterMethod:function(j,i){var l=j.parent().find(".avg-toggle-btn");
j.parent().find(".csr-button-switch-2").toggleClass("switch-off").toggleClass("switch-on");var k=i.data;l.find(".toggle-thirty").removeClass("active");
l.find(".toggle-seven").addClass("active");l.attr("data-state",k);return k;}}]};return e;});define("chartlib/constants/colours",["underscore","jquery"],function(b,e){var a=null;var d=e.extend({},{chartColours:[],colourMap:{},init:function(){b.bindAll(this,"getAttributeColour");
var f=this;b.each(csr.paletteGroups,function(h,g){if(h==="charts"){f.chartColours.push(csr.paletteColor(g));}});return this;
},getAttributeColour:function(f){var g;if(typeof this.colourMap[f]==="undefined"){g=this.chartColours.splice(0,1)[0]||"#CCCCCC";
this.colourMap[f]=g;}else{g=this.colourMap[f];}return g;}});return function c(){a=a||d.init();return a;};});define("chartlib/models/chartConfig",["jquery","underscore","backbone","chartlib/constants/chart","chartutil/backbone/WhiteListModel"],function(e,c,f,b,d){var a=d.extend({defaults:{yAttr:"",type:b.types.BAR,direction:b.directions.VERTICAL,xScale:b.scales.ORDINAL,yScale:b.scales.LINEAR}});
return a;});define("chartlib/mixins/tooltip",["underscore","chartutil/d3utils"],function(a,c){var b={};b.renderBars=function(){var e=this,d=this.svg.selectAll(".bar");
d.classed("active",true);d.on("mouseover",function(f){b.showTooltip.apply(e,[f,this,false]);}).on("mouseout",function(f){b.hideTooltip.apply(e,[false]);
});};b.renderLines=function(){var g=this,e=this.svg.select(".line");var d=this.svg.append("g").attr("class","focus").style("display","none");
d.append("circle").attr("r",4.5);var f=this.svg.select('[data-view="line-overlay"]').length>1?this.svg.select(".overlay"):this.svg.append("rect").attr("data-view","line-overlay").attr("fill","none").attr("pointer-events","all").attr("width",g.width).attr("height",g.height).on("mousemove",function(){var h=d3.mouse(this),i=c.closestPointOnLine(e.node(),h),j=g.collection.at(i.index);
d.attr("transform","translate("+i.segment.x+","+i.segment.y+")");if(i.distance<20){b.showTooltip.apply(g,[j,d,true]);}else{b.hideTooltip.apply(g,[false]);
}}).on("mouseout",function(h){b.hideTooltip.apply(g,[false]);});};b.renderDots=function(){var d=this,e=this.svg.selectAll("circle");
e.on("mouseover",function(f){b.showTooltip.apply(d,[f,this,false]);}).on("mouseout",function(f){b.hideTooltip.apply(d,[false]);
});};b.showTooltip=function(k,g,d){this.renderTooltipContent(k,g);if(typeof window.SVGElement==="undefined"){var e=$(g)[0].raphaelNode[0];
var f=$(e).offset().top;var j=$(e).offset().left+Number(e.clientWidth);var i=5;var h=$(".d3-tip");h.css({width:"auto","text-align":"center",display:"block",padding:"4px 6px",opacity:"1",left:(j+10)+"px",top:(f-i)+"px"});
h.addClass("on");this.tip.show(k,g);return;}if(d!==true){this.tip.show(k,g);}else{this.tip.show(k,g.node());}};b.hideTooltip=function(d){if(typeof window.SVGElement==="undefined"){var f=$(".d3-tip");
var e=this;if(d){window.clearTimeout(this.IE_tooltip_timeout);this.IE_tooltip_timeout=setTimeout(function(){f.css("display","none");
e.tip.hide();},1000);}else{f.css("display","none");e.tip.hide();}return;}this.tip.hide();};return b;});define("chartlib/mixins/customisations",["d3","jquery","chartutil/d3utils"],function(c,d,b){var a={};a.lowerXTickTransform=function(g,f){var e=0;
return"translate("+e+",7)";};a.getJoinAttrNoSpaces=function(f){var g=this._getDatumValue(f,this.options.joinAttr);var e=g.toLowerCase().replace(" ","");
return e;};a.getName=function(e){return this._getDatumValue(e,"name");};return a;});define("chartlib/mixins/formats",["d3","jquery","chartutil/d3utils"],function(c,d,b){var a={};a.defaultPercentFormat=c.format("%");
a.defaultLinearXFormat=function(f,e){return b.thousandsFormatter(f,e,this.scales.x);};a.defaultLinearYFormat=function(f,e){return b.thousandsFormatter(f,e,this.scales.y);
};a.getDefaultLinearFormat=function(e){return function(g,f){return b.thousandsFormatter(g,f,this.scales[e]);};};a.timeSimple=function(f,e){return parseInt((e+1).toString());
};a.defaultFloatFormat=function(f,e){return c.format(".2f")(f);};a.defaultTimeXFormat=function(e){return b.constants.granularityFormats[this.collection.getGranularity()](e);
};a.getDefaultTimeFormat=function(e){return function(g,f){return b.constants.granularityFormatsNonUTC[e](g);};};a.defaultOrdinalFormat=function(e){return(e.length>14)?d.trim(e).substring(0,11).trim(this)+"...":e;
};a.firstPercentFormat=function(f,e){return(e>0)?f:c.format(".1f")(f)+"%";};a.defaultFirstPercentFormat=function(f,e){return(e>0)?(f*100):c.format("%")(f);
};a.firstTimeFormat=function(h,e){var g=this.collection.getGranularity();if(g==="week"){return(e>0)?"wk "+h.getWeek(true):h.getFullYear()+" wk "+h.getWeek(true);
}var f=(e>0)?c.time.format.utc(this.options.granularityFormats[g]):c.time.format.utc(this.options.granularityFormats[g+"_start"]);
return f(h);};a.firstTimeFormatWidget=function(j,e){var h=(this.configData)?this.configData.granularity:"day";var f=c.time.format("%d");
if(h==="week"){return(e>0)?"wk "+j.getWeek(true):j.getFullYear()+" wk "+j.getWeek(true);}var g;if(e>0){g=(this.granularityFormats)?this.granularityFormats[h]:f;
}else{if(this.granularityFormats){g=(this.granularityFormats[h+"_start"])?this.granularityFormats[h+"_start"]:this.granularityFormats[h];
}else{g=f;}}return g(j);};a.ordinalRemoveLabel=function(e){return(e.toLowerCase().indexOf(this.stripLabel)>-1)?"":e;};return a;
});define("chartlib/mixins/axes",["d3","jquery","underscore","chartutil/d3utils","chartlib/mixins/formats","chartlib/mixins/customisations","util/Functional"],function(i,e,g,j,d,a,c){var f=function(k){if(k&&typeof d[k]==="function"){return true;
}return false;};var b=function(k){if(k&&typeof a[k]==="function"){return true;}return false;};var h={};h.setOrdinalXAxis=function(){this.axes.x=i.svg.axis().scale(this.scales.x).orient("bottom").tickSize(-this.height);
};h.setLinearXAxis=function(){this.axes.x=i.svg.axis().scale(this.scales.x).orient("bottom").tickSize(-this.height).tickFormat(i.format("1s"));
};h.setLinearRangeXAxis=function(){this.axes.x=i.svg.axis().scale(this.scales.x).orient("bottom").tickSize(-this.height).tickFormat(i.format("1s"));
};h.setTimeXAxis=function(){var k=(this.options.drawTickToChartSize)?-this.height:0;this.axes.x=i.svg.axis().scale(this.scales.x).orient("bottom").tickSize(k).tickFormat(0);
};h.formatOrdinalXAxis=function(){};h.formatLinearXAxis=function(){var k=this;if(this.options.percentile){this.axes.x.tickFormat((f(this.options.percentFormat))?e.proxy(d[this.options.percentFormat],this):d.defaultPercentFormat);
}else{this.axes.x.tickFormat((f(this.options.linearXFormat))?e.proxy(d[this.options.linearXFormat],this):e.proxy(d.defaultLinearXFormat,this));
}};h.formatLinearRangeXAxis=function(){var l=this,k=g.chain(this.collection.models).map(function(n){return n.toJSON();}).pluck(l.options.xAttr).value(),m=g.chain(this.collection.models).map(function(n){return n.toJSON();
}).pluck(l.options.xAttrEnd).value();this.axes.x.tickValues(g.union(k,m)).tickFormat(i.format("f"));};h.formatTimeXAxis=function(){var k=this,l=this.collection.getGranularity();
this.axes.x.ticks(i.time[l].utc,1).tickFormat((f(this.options.timeXFormat))?e.proxy(d[this.options.timeXFormat],this):e.proxy(d.defaultTimeXFormat,this));
};h.renderOrdinalXAxis=function(){h.renderLinearXAxis.apply(this);};h.renderLinearXAxis=function(){var l=this.axes.x;if(this.options.barHeight!==null){l.tickSize(-this.height);
}var k=(this.options.delay)?this.options.delay:500;this.xAxis.attr("opacity",1).call(l).transition().duration(500).delay(k).ease("exp-in-out").attr("transform","translate(0,"+this.height+")").each("start",function(){j.preventTickOverlap(this);
});h.moveLinesToBack.apply(this);var m=(b(this.options.tickXTransform))?e.proxy(a[this.options.tickXTransform],this):null;
this.xAxis.selectAll(".tick").select("text").attr("transform",m);};h.renderLinearRangeXAxis=function(){h.formatLinearRangeXAxis.apply(this);
h.renderLinearXAxis.apply(this);};h.renderTimeXAxis=function(){h.formatTimeXAxis.apply(this);h.renderLinearXAxis.apply(this);
if(this.options.centerTicks){j.spreadTimeAxisTicks(this);}};h.setOrdinalYAxis=function(){this.axes.y=i.svg.axis().scale(this.scales.y).orient("left");
};h.setLinearYAxis=function(){this.axes.y=i.svg.axis().scale(this.scales.y).orient("left").tickFormat(i.format("1s"));};h.setTimeYAxis=function(){this.axes.y=i.svg.axis().scale(this.scales.y).orient("left").tickSize(0).tickFormat(0);
};h.formatOrdinalYAxis=function(){};h.formatLinearYAxis=function(){var k=this;if(this.options.percentile){this.axes.y.tickFormat((f(this.options.percentFormat))?e.proxy(d[this.options.percentFormat],this):e.proxy(d.defaultPercentFormat,this));
}else{this.axes.y.tickFormat((f(this.options.linearYFormat))?e.proxy(d[this.options.linearYFormat],this):e.proxy(d.defaultLinearYFormat,this));
}};h.formatTimeYAxis=function(){var k=this,l=this.collection.getGranularity();this.axes.y.ticks(i.time[l].utc,1).tickFormat((f(this.options.timeYFormat))?e.proxy(d[this.options.timeYFormat],this):e.proxy(d.defaultTimeXFormat,this));
};h.renderOrdinalYAxis=function(){h.renderLinearYAxis.apply(this);};h.renderLinearYAxis=function(){this.yAxis.call(this.axes.y).transition().duration(500).ease("exp-in-out").each("start",function(){j.preventTickOverlap(this);
});this.yAxis.selectAll(".tick").select("text").attr("transform",this.tickYTextTransformFn);};h.renderTimeYAxis=function(){h.formatTimeYAxis.apply(this);
h.renderLinearYAxis.apply(this);if(this.options.centerTicks){j.spreadTimeYAxisTicks(this);}};h.moveLinesToBack=function(){this.xAxis.selectAll("line").each(function(k){if(typeof this.raphaelNode!=="undefined"){this.raphaelNode.toBack();
}});};return h;});define("chartlib/polymorph",["jquery","underscore","backbone","d3","chartlib/chartbase","chartutil/d3utils","chartlib/models/chartConfig","chartlib/mixins/charts/vertical","chartlib/mixins/charts/horizontal","chartlib/mixins/scales","chartlib/mixins/axes","chartlib/mixins/tooltip","chartlib/constants/chart","chartlib/constants/colours"],function(f,j,i,n,b,o,a,c,g,l,m,h,e,k){var d=b.extend({defaults:{barPadding:0.1,margin:{top:10,right:10,bottom:20,left:50},centerTicks:true,isRolloverChart:false},initialize:function(){var p=this;
j.bindAll(this,"validateConfig","reconfigureChart","render");this.validateConfig();if(this.collection){this.listenTo(this.collection,"reset",this.render);
this.listenTo(this.options.chartConfig,"change",this.reconfigureChart);}if(this.options.isRolloverChart&&this.options.tooltip){f(document).mousemove(function(q){p.updateTooltipPos(q.pageY);
});}this._super(arguments);return this;},updateTooltipPos:function(p){this.tip.style("top",(p-120)+"px");},validateConfig:function(){if(typeof this.options.chartConfig==="undefined"){this.options.chartConfig=new a();
}},reconfigureChart:function(q){var r=this.options.chartConfig;if(r.get("yAttr")!==""){this.options.yAttr=r.get("yAttr");
}if(typeof q.changed.direction!=="undefined"){this.options.xAttr=[this.options.yAttr,this.options.yAttr=this.options.xAttr][0];
}var s=this.$el.find("svg g.chartbase-holder"),p=s.find(".axis");s.html(p);this.setScales();this.setAxes();this.render();
},renderData:function(){var p=this.options.chartConfig;switch(p.get("type")){case e.types.BAR:if(p.get("direction")===e.directions.VERTICAL){j.extend(c.renderBars).apply(this,arguments);
}else{j.extend(g.renderBars).apply(this,arguments);}if(this.options.tooltip){j.extend(h.renderBars).apply(this,arguments);
}break;case e.types.LINE:if(p.get("direction")===e.directions.VERTICAL){j.extend(c.renderLine).apply(this,arguments);}else{j.extend(g.renderLine).apply(this,arguments);
}if(this.options.tooltip){j.extend(h.renderLines).apply(this,arguments);}break;case e.types.STACKED:if(p.get("direction")===e.directions.VERTICAL){j.extend(c.renderStackedBars).apply(this,arguments);
}else{j.extend(g.renderStackedBars).apply(this,arguments);}if(this.options.tooltip){j.extend(h.renderBars).apply(this,arguments);
}break;case e.types.MULTIBAR:if(p.get("direction")===e.directions.VERTICAL){j.extend(c.renderMultiBars).apply(this,arguments);
}else{j.extend(g.renderMultiBars).apply(this,arguments);}if(this.options.tooltip){j.extend(h.renderBars).apply(this,arguments);
}break;case e.types.MULTILINE:if(p.get("direction")===e.directions.VERTICAL){j.extend(c.renderMultiLines).apply(this,arguments);
}else{j.extend(g.renderMultiLines).apply(this,arguments);}if(this.options.tooltip){j.extend(h.renderLines).apply(this,arguments);
}break;}},setXScale:function(){var p=this.options.chartConfig;switch(p.get("xScale")){case e.scales.ORDINAL:j.extend(l.setOrdinalXScale).apply(this,arguments);
break;case e.scales.LINEAR:j.extend(l.setLinearXScale).apply(this,arguments);break;case e.scales.LINEAR_RANGE:j.extend(l.setLinearRangeXScale).apply(this,arguments);
break;case e.scales.TIME:j.extend(l.setTimeXScale).apply(this,arguments);break;}},setYScale:function(){var p=this.options.chartConfig;
switch(p.get("yScale")){case e.scales.ORDINAL:j.extend(l.setOrdinalYScale).apply(this,arguments);break;case e.scales.LINEAR:j.extend(l.setLinearYScale).apply(this,arguments);
break;case e.scales.TIME:j.extend(l.setTimeYScale).apply(this,arguments);break;}},calibrateXScale:function(){var p=this.options.chartConfig;
switch(p.get("xScale")){case e.scales.ORDINAL:j.extend(l.calibrateOrdinalXScale).apply(this,arguments);break;case e.scales.LINEAR:if(p.get("type")===e.types.STACKED){j.extend(l.calibrateLinearStackedXScale).apply(this,arguments);
}else{j.extend(l.calibrateLinearXScale).apply(this,arguments);}break;case e.scales.LINEAR_RANGE:j.extend(l.calibrateLinearRangeXScale).apply(this,arguments);
break;case e.scales.TIME:j.extend(l.calibrateTimeXScale).apply(this,arguments);break;}},calibrateYScale:function(){var p=this.options.chartConfig;
switch(p.get("yScale")){case e.scales.ORDINAL:j.extend(l.calibrateOrdinalYScale).apply(this,arguments);break;case e.scales.LINEAR:if(p.get("type")===e.types.STACKED){j.extend(l.calibrateLinearStackedYScale).apply(this,arguments);
}else{j.extend(l.calibrateLinearYScale).apply(this,arguments);}break;case e.scales.TIME:j.extend(l.calibrateTimeYScale).apply(this,arguments);
break;}},setXAxis:function(){var p=this.options.chartConfig;switch(p.get("xScale")){case e.scales.ORDINAL:j.extend(m.setOrdinalXAxis).apply(this,arguments);
break;case e.scales.LINEAR:j.extend(m.setLinearXAxis).apply(this,arguments);break;case e.scales.LINEAR_RANGE:j.extend(m.setLinearRangeXAxis).apply(this,arguments);
break;case e.scales.TIME:j.extend(m.setTimeXAxis).apply(this,arguments);break;}},formatXAxis:function(){var p=this.options.chartConfig;
switch(p.get("xScale")){case e.scales.ORDINAL:j.extend(m.formatOrdinalXAxis).apply(this,arguments);break;case e.scales.LINEAR:j.extend(m.formatLinearXAxis).apply(this,arguments);
break;case e.scales.LINEAR_RANGE:j.extend(m.formatLinearRangeXAxis).apply(this,arguments);break;case e.scales.TIME:j.extend(m.formatTimeXAxis).apply(this,arguments);
break;}},renderXAxis:function(){if(!this.options.isRolloverChart){var p=this.options.chartConfig;switch(p.get("xScale")){case e.scales.ORDINAL:j.extend(m.renderOrdinalXAxis).apply(this,arguments);
break;case e.scales.LINEAR:j.extend(m.renderLinearXAxis).apply(this,arguments);break;case e.scales.LINEAR_RANGE:j.extend(m.renderLinearRangeXAxis).apply(this,arguments);
break;case e.scales.TIME:j.extend(m.renderTimeXAxis).apply(this,arguments);break;}}},setYAxis:function(){var p=this.options.chartConfig;
switch(p.get("yScale")){case e.scales.ORDINAL:j.extend(m.setOrdinalYAxis).apply(this,arguments);break;case e.scales.LINEAR:j.extend(m.setLinearYAxis).apply(this,arguments);
break;case e.scales.TIME:j.extend(m.setTimeYAxis).apply(this,arguments);break;}},formatYAxis:function(){var p=this.options.chartConfig;
switch(p.get("yScale")){case e.scales.ORDINAL:j.extend(m.formatOrdinalYAxis).apply(this,arguments);break;case e.scales.LINEAR:j.extend(m.formatLinearYAxis).apply(this,arguments);
break;case e.scales.TIME:j.extend(m.formatTimeYAxis).apply(this,arguments);break;}},renderYAxis:function(){if(!this.options.isRolloverChart){var p=this.options.chartConfig;
switch(p.get("yScale")){case e.scales.ORDINAL:j.extend(m.renderOrdinalYAxis).apply(this,arguments);break;case e.scales.LINEAR:j.extend(m.renderLinearYAxis).apply(this,arguments);
break;case e.scales.TIME:j.extend(m.renderTimeYAxis).apply(this,arguments);break;}}},renderTooltipContent:function(t){var q=this,s=n.time.format("%d-%m-%Y %H:%M"),p=q.getX(t) instanceof Date?s(q.getX(t)):q.getX(t),r=q.getY(t) instanceof Date?s(q.getY(t)):q.getY(t);
if(j.isArray(q.getX(t))){p=j.map(q.getX(t),function(u){return'<div class="csr-col two a" style="color:'+k().getAttributeColour(u.name)+'">'+u.name+':</div><div class="csr-col two a csr-input-number">'+u.value+"</div>";
}).join("");}if(j.isArray(q.getY(t))){r=j.map(q.getY(t),function(u){return'<div class="csr-col two a" style="color:'+k().getAttributeColour(u.name)+'">'+u.name+':</div><div class="csr-col two a csr-input-number">'+u.value+"</div>";
}).join("");}q.tip.html(function(v){var u="<div class='csr-col' style='width:220px'>";u+="<div class='csr-col five a'><b>x:</b></div><div class='csr-col five d'>"+p+"</div>";
u+="<div class='csr-col five a'><b>y:</b></div><div class='csr-col five d'>"+r+"</div>";u+="</div>";return u;});this.tip.attr("class","d3-tip");
this.tip.direction("n");this.tip.offset([-10,0]);},data:function(p){this.collection=p;return this;},xAttribute:function(p){this.options.xAttr=p;
return this.initialize();},yAttribute:function(p){this.options.yAttr=p;return this.initialize();},joinAttribute:function(p){this.options.joinAttr=p;
return this.initialize();},percentile:function(p){this.options.percentile=p;return this.initialize();},tooltip:function(p){this.options.tooltip=p;
return this.initialize();},direction:function(p){this.options.chartConfig.set("direction",p,{silent:true});return this.initialize();
}});return d;},function(a){if(window.console&&console.log){console.log("APP JS ERROR =",a);}});define("chart/widgetFramework/composed/riskReport/rollovers/receivedTxCountStackedRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/composed/riskReport/constants/riskConstants","chart/widgetFramework/chartTypes/axisRollover"],function(d,j,k,b,g,i,h,f,a,e){var c=function(r,l,p,n){var o;
var q={};var m=j.defaults(q,r);o=e(m,l);var s=h(o);o.init=function(){s.init();this.barUtils.setBarSelectorStr(".bar.received-tx-count-stacked-rollover");
this.hasXAxis=!this.options.centerBars;};o.renderData=function(){if(d("#issuerCountry").val()!==""){this.$el.css("display","none");
return;}else{this.$el.css("display","block");}s.renderData();};o.enhanceTooltipData=function(t){var u=k.format("0,000");t.guaranteedPaymentMethod=u(t[a.RECEIVED_TX_GPM_TOTAL])+" tx";
t.RevProtect=u(t[a.RECEIVED_TX_REVPRO_TOTAL])+" tx";};return o;};return c;});define("chart/widgetFramework/composed/manualReview/formatters/CsvToJsonFormatter",["jqueryExtended","lodash","d3"],function(d,a,b){function c(e){this.data=e;
this.formattedData={};}c.prototype.formatData=function(){var f=this.data;var e;var g=this.isCSV(f);if(g){f=this.fixCSV(f);
e=b.csv.parse(f);}else{e=f;}this.formattedData=e;return this.formattedData;};c.prototype.isCSV=function(e){return !(a.isArray(e));
};c.prototype.fixCSV=function(e){return e.replace(/[\w\d,]\s+([\d+,])/gi,"\n$1");};return c;});define("chart/widgetFramework/composed/harpReportBuilder/HarpBuilderMediator",["jqueryExtended","underscore","ui/UIConstants","chart/widgetFramework/core/constants/DataConstants","util/Implement","chart/widgetFramework/core/BasicMediator","Constants"],function(a,h,f,i,d,g,c){var b=function(j){this.actionCommanderInstances=[];
this.snapshotInstances=[];var k=j.getNode();this.$actionCommanders=k.find("[data-widget*=ActionCommander]");this.$allSnapshots=k.find("[data-widget*=Snapshot]");
g.apply(this,arguments);this.dialogShown=false;this.totalDomElements+=this.$actionCommanders.length+this.$allSnapshots.length;
};b.prototype.getWidgets=function(){this.getWidgetInstances(this.$actionCommanders,this.actionCommanderInstances,"ActionCommander");
this.getWidgetInstances(this.$allSnapshots,this.snapshotInstances,"Snapshot");};b.prototype.setUpOwnEvents=function(k){g.prototype.setUpOwnEvents.call(this,k);
if(this.allInstances.length-1!==this.totalDomElements){return;}var j=this;h.each(this.actionCommanderInstances,function(l){l.pushAllInstances(j.chartInstances.concat(j.snapshotInstances).concat(j.fetcherInstances).concat(j));
});};b.prototype.onNotifiedFetcher=function(k,j){if(k.changeObject.type==="newDataAvailable"&&h.has(k.changeObject.data,"descriptionExists")){if(k.changeObject.data.descriptionExists){a(".pg-observed-input").addClass("pg-input-error").siblings("button").removeClass("rename-button--available").addClass("rename-button--unavailable");
}else{a(".pg-observed-input").removeClass("pg-input-error").siblings("button").removeClass("rename-button--unavailable").addClass("rename-button--available");
a(".pg-observed-button").trigger("clickConfirmed");}}else{if(k.changeObject.type==="newDataAvailable"&&h.has(k.changeObject.data,"action")){var l=k.changeObject.data;
this.action=l.action;this.updateUI(l);this.updateSchedulingUi(l);}}};b.prototype.updateUI=function(m){if(m.action==="New Tree"){a("#harpTreePicker").append('<option value ="'+m.treeId+'">'+m.treeName+"</option>");
a("#treeName").val(m.treeName);a("#step2_toggle,#step3_toggle").css({"pointer-events":"all"});a("#step2_toggle").slideDown();
a(".dimension-selector, .icon-times").removeClass("inactive").addClass("active");}if(m.action==="Get Tree"){a(".dimension-selector, .icon-times").removeClass("active").addClass("inactive");
a("#step2_toggle,#step3_toggle").css({"pointer-events":"all"});if(m.pspVisibleOnly===true){a("#permission_switch_container").removeClass("switch-off").addClass("switch-on");
}a("#treeName").val(m.treeName);}if(m.action==="Delete Tree"){a("path, .link, .harpnode").remove();a("#harpTreePicker option[value='"+m.treeId+"']").remove();
a("#harpTreePicker").val("-1");a("#step2_toggle, #step3_toggle").css({"pointer-events":"none"});}if(m.action==="Update Tree"){var k=m.treeName;
var l=m.treeId;if(m.isTemplate){a("#harpTemplatePicker").append('<option value ="'+l+'">'+k+"</option>");a("#message").text("Template Named "+k+" has been created!").fadeIn(1000).delay(1000).fadeOut(2000);
}else{if(m.treeName!==a("#treeName").val()){a("#message").text("Tree has been succesfully renamed to: "+k).fadeIn(1000).delay(1000).fadeOut(2000);
}else{a("#message").text("Psp Visibility for this tree has changed to: "+((a("#permissionSwitch").attr("checked"))?"true":"false")).fadeIn("slow").delay("1000").fadeOut("slow");
}a(".tree-header").text(k);a("#treeName").val(k);a("#edit_controller").slideUp();a("#harpTreePicker option[value='"+m.treeId+"']").text(k);
}}if(m.action==="New Split"){var j=a("#hn_"+m.parentNodeId);j.find(".dimension-selector").remove();j.find(".hn-container").append('<i id="showDeleteSplitDialog_'+m.parentNodeId+'" class="icon-times active"></i>');
a(".dimension-selector").removeClass("inactive").addClass("active");}if(m.action==="Delete Nodechildren"){this.$el.trigger("deleteNodeChildren",{data:m});
}if(m.action==="Update Node"){a("#harp-dialog-overlay").hide();h.each(m.nodes,function(n){if(n.explanation){a("#textAreaExplanation_"+n.harpNodeId).text(n.explanation);
a("#nodeExplanation_"+n.harpNodeId).text("Edit Explanation");}});}};b.prototype.updateSchedulingUi=function(l){var j=new Date();
if(h.has(l,"action")&&l.action==="Schedule Report"){j.setTime(l.schedulingDate);var k=j.toFormattedString("yyyy-mm-dd").split(" ")[0];
a("#schedule_msg").text("Scheduling Report starting from "+k);a("#datepickStart").val(k).text(k);a(".harp-edit-button").removeClass("harp-enabled").addClass("harp-disabled").attr("disabled",true);
a(".availability-message").show();a(".dimension-selector, .icon-times").addClass("deactivate-scheduling");a("#showSchedulingDialog").attr("disabled",true);
a("#harp-dialog-overlay").hide();return;}if(l.scheduling&&l.scheduling.status==="no data"){j=e(l.scheduling);a("#schedule_msg").text("Not Scheduled");
a(".harp-edit-button").removeClass("harp-disabled").addClass("harp-enabled").attr("disabled",false);a(".availability-message").hide();
a("#showSchedulingDialog").attr("disabled",false);a("#datepickStart").val(j).text(j);return;}if(l.scheduling&&l.scheduling.status==="runnning"){j=e(l.scheduling);
a("#schedule_msg").text("Scheduling Report starting from "+j);a(".harp-edit-button").removeClass("harp-enabled").addClass("harp-disabled").attr("disabled",true);
this.action="Under Schedule";}if(l.scheduling&&l.scheduling.status==="completed"){j=e(l.scheduling);a("#schedule_msg").text("This report is already scheduled containg data from: "+j);
a(".dimension-selector, .icon-times").removeClass("deactivate-scheduling").addClass("active");a("#showSchedulingDialog").attr("disabled",false);
}};function e(k){var j=new Date();if(k.status==="no data"){j.setTime((new Date()).setDate((new Date()).getDate()-2));}else{j.setTime(k.firstDataStartDate);
}return j.toFormattedString("yyyy-mm-dd").split(" ")[0];}b.prototype.getInstance=function(){return this;};b.prototype.setActionCommander=function(j){this.actionCommander=j;
};b.prototype.onNotifiedViewCreator=function(k,j){a("[id^=valueSelectorCarrier]").on("mousewheel",function(){event.stopPropagation();
});if(this.action==="New Split"||this.action==="New Tree"){a(".dimension-selector, .icon-times").removeClass("inactive").addClass("active");
}if(this.action==="Under Schedule"){a(".dimension-selector, .icon-times").addClass("deactivate-scheduling");}this.$el.trigger(c.EV_CONTENT_MERGED);
if(k.changeObject.type==="chartRendered"){h.each(this.actionCommanderInstances,function(m){var l=h.cloneDeep(m.events);var n=l.splice(20);
m.unbindEvents(n);m.setUpEvents(n);});}};b.prototype.forceRebindGlobal=function(){h.each(this.actionCommanderInstances,function(k){var j=h.cloneDeep(k.events);
var l=j.splice(20);k.unbindEvents(l);k.setUpEvents(l);});};b.prototype.forceRebindTargeted=function(j){var k=[];h.each(j,function(l){k.push(l.source);
});h.each(this.actionCommanderInstances,function(p){var l=h.cloneDeep(p.events);var q=[];for(var o=l.length;o>0;o--){var n=l[o-1];
if(k.indexOf(n.source)!==-1){var m=k.indexOf(n.source);if(n.source===j[m].source&&j[m].eventType===n.event){q.push(n);}}}p.unbindEvents(q);
p.setUpEvents(q);});};b.prototype.showNotification=function(k){window.clearTimeout(window.errormessage);var l=k.message;var j=k.containerClass;
var m="<div class='csr-notification-message-2 error'> <ul><li><i class='icon-exclamation-triangle'></i>"+l+"</li></ul></div>";
var n=a("#message");n.html(m);n.addClass(j);n.fadeIn("fast",function(){window.errormessage=setTimeout(function(){n.fadeOut("slow",function(){n.html("");
n.removeClass(j);});},2000);});};d.fromTo(g,b);return b;});define("chart/widgetFramework/composed/revenueAccelerate/baselineRollover",["jqueryExtended","underscore","d3","chart/widgetFramework/core/mixins/widgetScales","util/Functional","chartutil/domUtils","util/ObjectSuper","chart/widgetFramework/chartTypes/rollover"],function(c,g,i,h,a,e,f,d){var b=function(p,j,n,l){var m;
var o={};var k=g.defaults(o,p);m=d(k,j);var q=f(m);m.enhanceTooltipData=function(s){var r=i.format("n"),t=i.format(".1%");
s.dateTT=i.time.format("%d/%m/%Y")(s.date);s.authRateTT=t(+s.authRate);s.authorisationsTT=r(+s.authorisations);s.refusedTT=r(+s.refused);
s.totalTT=r(+s.total);};return m;};return b;});define("chart/widgetFramework/composed/revenueProtect/revProFormatter",["jqueryExtended","underscore","d3","chartutil/dateUtils_CET","chartutil/d3utils"],function(g,a,c,f,b){function d(j,h,i){this.data=j;
this.options=h;this.formattedData={};this.comparator=this.compareFunction;this.reverseDirection=false;this.sortKey=null;this.timeline=i;
}d.prototype.formatData=function(){if(window.console&&console.log){console.log("### revProFormatter::formatData:: this DATA=",this.data);
}this.formattedData=this.data.transactionVolume.rows;e(this.data.chargebackFraudRates.rows[0].lineValues,this.formattedData,"chargeback","percent");
e(this.data.chargebackFraudRates.rows[1].lineValues,this.formattedData,"nof","percent");e(this.data.refusalRates.rows[0].lineValues,this.formattedData,"refusedBank","percent");
e(this.data.refusalRates.rows[1].lineValues,this.formattedData,"refusedRisk","percent");if(this.sortKey){this.reverseDirection=!this.reverseDirection;
this.sortData(this.sortKey);}if(window.console&&console.log){console.log("\n### revProFormatter::formatData:: this.formattedData=",this.formattedData);
}return this.formattedData;};var e=function(j,h,i,k){a.each(j,function(n){var l;try{l=a.findWhere(h,{dateStr:n.dateStr});
l[i]=n[k];}catch(m){l=a.findWhere(h,{date:n.dateStr});}finally{l={};}l[i]=n[k];});return j;};d.prototype.sortData=function(h){this.sortKey=h;
this.reverseDirection=!this.reverseDirection;var i=a.sortBy(this.formattedData,h);if(this.reverseDirection){i.reverse();}this.formattedData=i;
return this.formattedData;};d.prototype.compareFunction=function(h){return h[this.sortKey];};d.prototype.getData=function(){return(this.data)?this.data:this.formatData();
};d.prototype.setRawData=function(h){this.data=h;};d.prototype.retrieveData=function(h){return this.data[h];};d.prototype.setOptions=function(h){this.options=h;
};return d;});define("chart/widgetFramework/composed/demo/widgetMediatorTemplate",["jqueryExtended","d3","lodash","chart/widgetFramework/core/BasicMediator","util/ObjectSuper","chartutil/numberutils","chartutil/cssutils"],function(h,f,c,d,e,a,b){function g(i){var j;
j=d(i,true);var k=e(j);j.init=function(){k.init();this.actionCommanderExclusionArray=["actioncommander","timeline"];};j.getAdditionalDOMElements=function(){k.getAdditionalDOMElements();
this.timelineInstances=[];this.$allTimelines=i.__$node.find("[data-widget*=Timeline]");this.totalDomElements+=this.$allTimelines.length;
};j.getWidgets=function(){k.getWidgets();this.getWidgetInstances(this.$allTimelines,this.timelineInstances,"Timelines");};
j.onNotifiedFetcher=function(m,l){k.onNotifiedFetcher(m,l);};j.onNotifiedFormatter=function(o,m){k.onNotifiedFormatter(o,m);
var n=o.changeObject.type;var l=o.changeObject.data;};j.onNotifiedViewCreator=function(m,l){k.onNotifiedViewCreator(m,l);
};j.getInstance=function(){return this;};j.sortData=function(m,l){this.$sortButtonRef=l;};j.init();i.ready();return j;}return g;
});define("chart/widgetFramework/composed/riskReport/riskActions",["jqueryExtended","underscore"],function(e,b){var f=e;var g=window.adyen||{};
var a=g.config||{};var c=["riskReportFetcher","riskChecksFetcher"];if(a.riskHistogramEnabled){c.push("fraudScoreFetcher");
}if(a.chargebackLineEnabled){c.push("chargebackRateFetcher");}var d={actions:[{source:"issuerCountry",event:"change",target:c,callMethod:"fetchNewDataAction",getterMethod:function(h){f("#timeline1").find("#timelineLoader").css("display","block");
var i=h.val();return{countryFilter:i};}},{source:"paymentMethod",event:"change",target:c,callMethod:"fetchNewDataAction",getterMethod:function(h){f("#timeline1").find("#timelineLoader").css("display","block");
var i=h.val();return{paymentMethod:i};}},{source:"shopperInteraction",event:"change",target:c,callMethod:"fetchNewDataAction",getterMethod:function(h){f("#timeline1").find("#timelineLoader").css("display","block");
var i=h.val();return{shopperInteraction:i};}}]};return d;});define("chart/widgetFramework/composed/mfpReport/mfpChargebackView",["jqueryExtended","underscore","d3","chart/widgetFramework/core/mixins/widgetScales","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/WidgetConstants","util/ObjectSuper","chart/widgetFramework/chartTypes/chargebackBarView","chart/widgetFramework/core/constants/DataConstants","chartutil/dateUtils_CET"],function(c,j,l,k,a,f,d,g,i,e,b){var h=function(s,m,q,o){var p;
var r={};var n=j.defaults(r,s);p=i(n,m);var t=g(p);p.dataSpecificCountProperty="amount";p.dataSpecificRateProperty="rate";
p.dataSpecificCountThresholdProperty="amountThreshold";p.dataSpecificRateThresholdProperty="rateThreshold";p.feedData=function(v){var u=j.filter(v.chartData,function(w){return w.programName===p.options.dataSubset;
});if(!a.existy(u[0])){return e.HALT_RENDER_PROCESS;}this.data=u[0];this.masterData=j.cloneDeep(this.data);};p.feedBarData=function(z,y,x){var v=this.getData();
var A=j.find(v,"barType","amount");A.count=z.amount;var u=j.find(v,"barType","rate");u.rate=z.rate;this.barUtils.delayTime=0;
this.render();var w=b.getUserFriendlyDate(z.dateStr);this.$el.parent().find(".bar-title-date").text(w);w=b.getUserFriendlyDate(z.countStartDate)+" & "+b.getUserFriendlyDate(z.countEndDate);
this.$el.parent().find(".sub-title-date").text(w);};p.resetBarData=function(w){this.data.barData=j.cloneDeep(this.masterData.barData);
this.render();this.barUtils.delayTime=1000;var v=this.$el.parent().find(".bar-title-date");v.text(v.attr("data-date"));var u=this.$el.parent().find(".sub-title-date");
u.text(u.attr("data-daterange"));};return p;};return h;});define("chart/widgetFramework/core/AxisComponentUpdateable",["jqueryExtended","chart/widgetFramework/core/constants/DataConstants","underscore","util/Functional","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/core/mixins/widgetScales","chart/widgetFramework/core/mixins/widgetAxes","chartutil/stringutils"],function(a,i,l,e,j,m,n,f){var c=false;
var k="color:deepskyblue;font-size:1em";var b=false;var g="color:darkseagreen;font-size:1em";var d=false;var h=function(o){var t={};
t.init=function(){l.bindAll(this,"onNotifiedChartCreated");this.$el=o.getNode();this.id=this.$el.attr("data-id");if(window.console&&console.log&&c){console.log("%c\n################",k);
console.log("%c### INIT STAGE :: GraphComp::"+this.id+":: INIT",k);console.log("%c################",k);}this.parameters=this.getParameters(o);
this.graphOptions=this.parameters.options;this.vizCompContainer=this.$el.parent();this.parentID=this.vizCompContainer.attr("id");
if(!this.parentID){this.parentID=this.vizCompContainer.attr("data-id");}if(this.graphOptions.orientation==="x"){this.vizCompContainer[0].__axisHorizontal=this;
}else{if(this.graphOptions.orientation==="y"){this.vizCompContainer[0].__axisVertical=this;}}this.vizCompContainer.widget().then(function(v){t.vizCompInstance=v.instance;
if(window.console&&console.log&&c){console.log("%c\n################",k);console.log("%c### INIT STAGE :: GraphComp::"+t.id+'::ADDING OBSERVER: "onNotifiedChartCreated" - widgetRef= '+v.instance.id,k);
console.log("%c################",k);}t.vizCompInstance.registerObserver(t.onNotifiedChartCreated,false,t.id);});};t.onNotifiedChartCreated=function(w,v){if(v===this.parentID){if(w.changeObject.type!==j.CHART_INITIALISED&&w.changeObject.type!==j.CHART_UPDATED){return;
}this.chart=w.changeObject.data;if(this.graphOptions.orientation==="x"){p(this.graphOptions,this.chart.dimensionsXArray,this.chart.dimensionsYArray);
if(!p){return;}this.chart.options.xScale=this.graphOptions.scale;this.graphOptions.nestedXAttr=e.getValueOrDefault(this.chart.options,null,"nestedXAttr");
this.chart.dimensionsXArray.push(this.graphOptions.dimension);this.chart.options.niceScaleX=this.graphOptions.niceScale;this.chart.options.xTicks=this.graphOptions.ticks;
e.getValueOrDefault(this.graphOptions,"bottom","align",true);s(this.graphOptions,this.chart);q(this.graphOptions,this.chart);
}else{if(this.graphOptions.orientation==="y"){p(this.graphOptions,this.chart.dimensionsXArray,this.chart.dimensionsYArray);
if(!p){return;}this.chart.options.yScale=this.graphOptions.scale;this.graphOptions.nestedYAttr=e.getValueOrDefault(this.chart.options,null,"nestedYAttr");
this.chart.dimensionsYArray.push(this.graphOptions.dimension);this.chart.options.yTicks=this.graphOptions.ticks;this.chart.options.yAxisIsPercent=false;
if(this.graphOptions.tickFormat&&this.graphOptions.tickFormat.toLowerCase().indexOf("percent")>-1){this.chart.options.yAxisIsPercent=true;
}this.chart.options.suffixLastYTickOnly=this.graphOptions.suffixLastTickOnly;e.getValueOrDefault(this.graphOptions,"left","align",true);
r(this.graphOptions,this.chart);u(this.graphOptions,this.chart);}}this.$el.remove();}};function s(w,v){var x=w.scale;var y=w.dimension;
var z=f.capitaliseFirstLetter(x);v.xScaleCreationFns[y]=m["get"+z+"XScale"](y);v.calibrateXScaleFns[y]=m["getCalibrate"+z+"XScale"](y,w);
}function q(w,v){var x=w.scale;var y=w.dimension;var z=f.capitaliseFirstLetter(x);v.xAxisCreationFns[y]=n["get"+z+"XAxis"](y,w);
v.formatXAxisFns[y]=n["getFormat"+z+"XAxis"](y,w);v.renderXAxisFns[y]=n["getRender"+z+"XAxis"](y,w);}function r(w,v){var x=w.scale;
var z=w.dimension;var y=f.capitaliseFirstLetter(x);v.yScaleCreationFns[z]=m["get"+y+"YScale"](z);v.calibrateYScaleFns[z]=m["getCalibrate"+y+"YScale"](z,w);
}function u(w,v){var x=w.scale;var z=w.dimension;var y=f.capitaliseFirstLetter(x);v.yAxisCreationFns[z]=n["get"+y+"YAxis"](z,w);
v.formatYAxisFns[z]=n["getFormat"+y+"YAxis"](z,w);v.renderYAxisFns[z]=n["getRender"+y+"YAxis"](z,w);}t.getParameters=function(v){var y=v.getNode().data();
var w;if(l.keys(y).length){w=y;}else{v.parameters.options=a.parseJSON(v.parameters.options);w=v.parameters;}var x={};if(l.keys(w).length){x.options=w.options;
}else{throw"The parameters are not well defined"+w;}return x;};function p(y,v,A){var z=e.checker(e.validator("must be a map",e.aMap),e.hasKeysWithTruthyValues("scale","dimension"));
var x=z(y);if(x.length){if(window.console&&console.log){console.log("\n###############");console.error("### AxisComponent::onNotifiedChartCreated:: CHECKED =",x);
console.log("################");}return false;}var w=v.concat(A);if(l.includes(w,y.dimension)){if(window.console&&console.log){console.log("\n###############");
console.error("### AxisComponent::onNotifiedChartCreated:: Dimension values must be unique across both axes:",y.dimension,"already exists");
console.log("################");}return false;}return true;}t.init();if(window.console&&console.log&&d){console.log("\n### AxisComponent2::constructor:: calling pWidgetApi.ready()");
}o.ready();return t;};return h;});define("chart/widgetFramework/composed/transactionsDashboard/rollovers/authAmtRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/chartTypes/axisRollover"],function(c,i,j,a,f,h,g,e,d){function b(o,k){var m;
var n={};var l=i.defaults(n,o);m=d(l,k);var p=g(m);m.init=function(){p.init();this.barUtils.setBarSelectorStr(".bar.auth-amt-rollover");
this.hasXAxis=!this.options.centerBars;};m.positionTooltip=function(r,t,x,q,w,s,v){var u=p.positionTooltip(r,t,x,q,w,s,v);
u.top-=5;return u;};m.enhanceTooltipData=function(q){q.authorisedAmountTT=j.format("0,000")(q.authorizedAmount);};return m;
}return b;});define("chart/widgetFramework/composed/demo/histogramDataFormatter",["jqueryExtended","underscore","d3","chart/widgetFramework/core/constants/DataConstants","chartutil/dateUtils_CET","chartutil/d3utils"],function(g,b,d,e,f,c){var a=function(k,h,j){var i={};
i.data=k;i.options=h;i.formattedData={};i.comparator=null;i.reverseDirection=false;i.sortKey=null;i.timeline=j;i.formatData=function(){var m=this.data.riskfraudscoredistribution.rows;
this.flatData=l(m,this.options.accessor,this.options.count);this.histData=d.layout.histogram().range(this.options.range).bins(this.options.numBins)(this.flatData);
this.formattedData=b.map(this.histData,function(n){return{dx:n.dx,x:n.x,y:n.y};});if(window.console&&console.log){console.log("### histogramDataFormatter::formatData:: this.formattedData=",this.formattedData);
}return{chartData:this.formattedData};};var l=function(m,o,p){var n=[];b.each(m,function(s){var r=s[o];for(var q=0;q<s[p];
q++){n.push(r);}});return n;};i.sortData=function(m,o){this.sortKey=m;this.reverseDirection=!this.reverseDirection;var n=b.sortBy(this.formattedData,m);
if(this.reverseDirection){n.reverse();}this.formattedData=n;if(o===true){return;}this.$el.trigger(e.FORMATTER_INFORM_WIDGET,{type:e.SORTED_DATA,data:{chartData:this.formattedData}});
};i.compareFunction=function(m){return m[this.sortKey];};i.getData=function(){return(this.data)?this.data:this.formatData();
};i.setRawData=function(m){this.data=m;};i.retrieveData=function(m){return this.data[m];};return i;};return a;});define("chart/widgetFramework/composed/riskReport/views/atvLineView",["jquery","underscore","chart/widgetFramework/core/mixins/formats","util/ObjectSuper","chart/widgetFramework/chartTypes/lineChart"],function(f,c,e,d,a){var b=function(l,g,j){var i;
var k={};var h=c.defaults(k,l);i=a(h,g,j);var m=d(i);i.renderYAxis=function(){m.renderYAxis();};i.getLabelName=function(n){return n[this.options.joinAttr];
};return i;};return b;});define("chartlib/ui/stickyMenu",["jquery","underscore","backbone"],function(b,a,d){var c=d.View.extend({menuHeight:null,menuPosY:null,content:null,initialize:function(){a.bindAll(this,"render");
b(window).scroll(this.render);this.menuHeight=this.$el.outerHeight(true);this.menuPosY=this.$el.offset().top;this.content=this.options.content;
this._super();},render:function(){var e=b(document).scrollTop();if(e>this.menuPosY){this.$el.addClass("is-sticky");this.content.css("margin-top",this.menuHeight+"px");
}if(e<this.menuPosY){this.$el.removeClass("is-sticky");this.content.css("margin-top","0");}}});return c;});define("chart/widgetFramework/composed/shopperdna/formatters/shopperDnaSparklineFormatter",["lodash","d3","timeline/util/timelineConstants"],function(c,d,b){function a(f,e){this.data=f;
this.options=e;this.statusCollection=e.styles.status;this.formattedData={};}a.prototype.formatData=function(){var g="week"||this.options.timelineData.granularity;
var e=this.sortDataByDate(this.data);var h=this.groupDataByGranularity(e,g);var f=this.groupDataByTransactionState(h,this.statusCollection.slice(0));
this.formattedData=f;return this.formattedData;};a.prototype.sortDataByDate=function(e){return c.sortBy(e,function(f){return(new Date(f.eventtime)).getTime();
});};a.prototype.groupDataByTransactionState=function(g,f){var e=[];c.each(g,function(k){var j=k.payments;var i=[];var h=0;
c.each(f,function(l){i.push(c.extend({},l));});c.each(i,function(l){l.startY=h;l.psprefs=[];c.each(j,function(m){if(c.contains(l.journaltypes,m.laststatus)){l.psprefs.push(m.pspreference);
l.count++;h++;}});l.endY=l.count+l.startY;});e.push({date:k.date,count:h,barData:i});});return e;};a.prototype.groupDataByGranularity=function(l,p){var n=c.min(l,function(i){return(new Date(i.eventtime)).getTime();
});var m=c.max(l,function(i){return(new Date(i.eventtime)).getTime();});var h=new Date(n.eventtime);var o=new Date(m.eventtime);
var f=[];var q=[];switch(p){case b.__MONTH_FORMAT:f=d.time.months(d.time.month.offset(h,-1),o,1);break;case b.__WEEK_FORMAT:f=d.time.weeks(d.time.week.offset(h,-1),o,1);
break;case b.__DAY_FORMAT:f=d.time.days(d.time.day.offset(h,-1),o,1);break;}c.each(f,function(i){q.push({date:i,payments:[]});
});for(var k=0;k<l.length;k++){var e=(new Date(l[k].eventtime)).getTime();for(var g=0;g<q.length-1;g++){if(q[g].date.getTime()<e&&q[g+1].date.getTime()>e){q[g].payments.push(l[k]);
g=q.length;}}}return q;};a.prototype.getData=function(){return(this.formattedData)?this.formattedData:this.formatData();};
a.prototype.setRawData=function(e){this.data=e;};a.prototype.setOptions=function(e){this.options=e;};return a;});define("chart/widgetFramework/composed/transactionsDashboard/formatters/txLineFormatter",["jqueryExtended","underscore","d3","chartutil/dateUtils_CET","chart/widgetFramework/core/constants/DataConstants","timeline/util/timelineConstants","chartutil/d3utils"],function(h,c,e,g,f,a,d){function b(l,i,k,m){var j={};
j.data=l;j.options=i;j.formattedData={};j.comparator=null;j.reverseDirection=false;j.sortKey=null;j.timeline=k;j.id=m;j.granularity="hour";
j.formatData=function(){this.formattedData=this.calculateMetaData(this.data);if(window.console&&console.log){console.log("### txLineFormatter::formatData:: this.formattedData=",this.formattedData);
}return{config:{},chartData:c.cloneDeep(this.formattedData)};};j.calculateMetaData=function(p){var r=[];var q=[];var o=[];
var n=[];c.each(p,function(s){r.push({date:s.date,value:s.authorizedCount,name:s.dateStr});q.push({date:s.date,value:s.refusedCount,name:s.dateStr});
o.push({date:s.date,value:s.errorCount,name:s.dateStr});n.push({date:s.date,dateStr:s.dateStr,authorizedCount:s.authorizedCount,refusedCount:s.refusedCount,errorCount:s.errorCount});
});return{txLineValues:[{name:"Authorized",lineValues:r},{name:"Refused",lineValues:q},{name:"Error",lineValues:o}],txRolloverValues:n};
};j.sortData=function(n,p){this.sortKey=n;this.reverseDirection=!this.reverseDirection;var o=c.sortBy(this.formattedData,n);
if(this.reverseDirection){o.reverse();}this.formattedData=o;if(p===true){return;}this.$el.trigger(f.FORMATTER_INFORM_WIDGET,{type:f.SORTED_DATA,data:{chartData:this.formattedData}});
};j.compareFunction=function(n){return n[this.sortKey];};j.getData=function(){return(this.data)?this.data:this.formatData();
};j.setRawData=function(n){this.data=n;};j.retrieveData=function(n){return this.data[n];};j.setOptions=function(n){this.options=n;
};return j;}return b;});define("chartlib/timeVertBarChart",["jquery","underscore","d3","chartlib/vertbarchart","chartutil/d3utils","chartutil/dateUtils_CET"],function(f,b,e,d,c,g){var a=d.extend({granularityFormats:[],defaults:{barPadding:0.1,margin:{top:10,right:10,bottom:40,left:50},tooltip:true},initialize:function(){this.granularityFormats.month=e.time.format.utc("%b");
this.granularityFormats.week=function(h){return"wk "+h.getWeek();};this.granularityFormats.day=e.time.format.utc("%e");this.granularityFormats.hour=function(i){var h=g.getAmsterdamDSTOffset(i);
return new Date(i.getTime()+h*60*1000).getUTCHours();};this.granularityFormats.minute=e.time.format.utc("%_M");this._super(arguments);
},setXScale:function(){this.scales.x=e.time.scale.utc().range([0,this.width],this.options.barPadding);},calibrateXScale:function(){var h=this.collection.getDateExtent();
this.scales.x.domain(h);this.scales.x.ticks(this.collection.getIntervalFormat(),1);},setXAxis:function(){this.axes.x=e.svg.axis().scale(this.scales.x).orient("bottom").tickSize(0);
},formatXAxis:function(){var j=this,i=this.axes.x,k=this.collection.getGranularity(),h=j.scales.x.ticks(e.time[k].utc,1).length;
if(h>40){k="month";}i.ticks(e.time[k].utc,1).tickFormat(j.granularityFormats[k]);},renderXAxis:function(){this.formatXAxis();
this._super();c.spreadTimeAxisTicks(this);},formatYAxis:function(){var h=this;if(this.options.percentile){this.axes.y.tickFormat(e.format("%"));
}else{this.axes.y.tickFormat(function(k,j){return c.thousandsFormatter(k,j,h.scales.y);});}},renderYAxis:function(){this.formatYAxis();
this._super();if(this.options.percentile){c.percentageFormat(this.yAxis);}},renderData:function(){var n=this,p=this.scales.x,o=this.scales.y,m=this.collection.getGranularity(),i=p.ticks(e.time[m].utc,1).length,k=(n.width/i),q=(k*(1-this.options.barPadding))/2;
var l=this.svg.selectAll(".bar").data(n.collection.models,this.joinData);var j=l.enter().append("g").attr("class","bar").append("rect");
l.transition().duration(500).ease("exp-in-out").attr("transform",function(s,r){return"translate("+((k*(r+1))-(k/2))+",0)";
}).select("rect").attr("transform",function(){return"translate("+(-q/2)+",0)";}).attr("width",q).attr("y",function(r){return o(n.getY(r));
}).attr("height",function(r){return n.height-o(n.getY(r));});if(this.options.tooltip){l.classed("active",true);j.on("mouseenter",function(r){n.showTooltip(r,this,false);
}).on("mouseout",this.tip.hide);}var h=l.exit().transition();h.attr("transform",function(){return"translate(0,0)";}).select("rect").transition().attr("width",0);
h.remove();},renderTooltipContent:function(i){var h=this;h.tip.html(function(k){var j="<div class='csr-col' style='width:220px'>";
j+="<div class='csr-col two a'><b>x:</b></div><div class='csr-col two a'>"+h.getX(k)+"</div>";j+="<div class='csr-col two a'><b>y:</b></div><div class='csr-col two a'>"+h.getY(k)+"</div>";
j+="</div>";return j;});this.tip.attr("class","d3-tip");this.tip.direction("n");this.tip.offset([-10,0]);}});return a;},function(a){if(window.console&&console.log){console.log("APP JS ERROR =",a);
}});define("chart/widgetFramework/composed/mfpReport/mfpFormatter",["jqueryExtended","underscore","d3","chartutil/dateUtils_CET","chartutil/d3utils","chart/widgetFramework/core/constants/DataConstants"],function(a,k,l,d,m,g){function j(p,n,o){this.data=p;
this.options=n;this.formattedData={};this.comparator=this.compareFunction;this.reverseDirection=false;this.sortKey=null;this.timeline=o;
}j.prototype.formatData=function(){var o=b(this.data.mfpData);var p=e(o);var n=f(p);this.formattedData=n;if(this.sortKey){this.reverseDirection=!this.reverseDirection;
this.sortData(this.sortKey,true);}this.formattedData=h(this.formattedData);if(this.timeline){this.granularity=this.timeline.getGranularity();
}i(this.formattedData,this.timeline.getDates(),this.granularity);if(window.console&&console.log){console.log("\n### mfpFormatter::formatData:: this.formattedData=",this.formattedData);
}return{chartData:this.formattedData};};var i=function(p,o,n){var q=function(){return{amount:0,rate:0,settledAmount:0,countStartDate:null,countEndDate:null,settledCountStartDate:null,settledCountEndDate:null};
};k.each(p,function(s){var v=s.history;var r=k.last(v).date;var u=[o[0],r];var t=m.fillTimeScaleBucketsFromTemplate(u,n,v,q);
s.history=t;});};var c=function(r,p,o){var q=(p<o)?p:o;var n=(p>o)?p:o;return(r-q)/(n-q);};var b=function(o){var n=1.1;k.each(o,function(z){var y=z.currentAmount;
var v=z.currentRate;var t=k.max(z.history,function(C){return C.amount;});var B=k.max(z.history,function(C){return C.rate;
});var w=k.max([y,t.amount]);var A=z.amountThreshold;var x=k.max([v,B.rate]);var q=z.rateThreshold;var u,p;if(w<=A){if(x<=q){z.rateLimit=q*n;
}else{z.rateLimit=x*n;}u=c(q,0,z.rateLimit);z.countLimit=A/u;}else{if(x<=q){z.countLimit=w*n;p=c(A,0,z.countLimit);z.rateLimit=q/p;
}else{var s=w/A;var r=x/q;if(s>r){z.countLimit=w*n;p=c(A,0,z.countLimit);z.rateLimit=q/p;}else{z.rateLimit=x*n;u=c(q,0,z.rateLimit);
z.countLimit=A/u;}}}});return o;};var e=function(n){k.each(n,function(r){var o=[];var q={barType:"amount",count:r.currentAmount,threshold:r.amountThreshold};
var p={barType:"rate",rate:r.currentRate,threshold:r.rateThreshold};o.push(q);o.push(p);r.barData=o;});return n;};var f=function(n){k.each(n,function(o){var p=[];
var r={areaType:"to-threshold",start:0,width:o.amountThreshold};var q={areaType:"from-threshold",start:o.amountThreshold,width:o.countLimit-o.amountThreshold};
p.push(r);p.push(q);o.areaData=p;});return n;};var h=function(n){var o=k.chain(n).map(function(p){return p.history;}).flatten().each(function(q){q.dateStr=q.date;
var p=new Date(q.dateStr);q.date=d.roundToDay(p);q.name=q.dateStr;}).value();return n;};j.prototype.sortData=function(n,p){this.sortKey=n;
this.reverseDirection=!this.reverseDirection;var o=k.sortBy(this.formattedData,n);if(this.reverseDirection){o.reverse();}this.formattedData=o;
if(p===true){return;}this.$el.trigger(g.FORMATTER_INFORM_WIDGET,{type:g.SORTED_DATA,data:this.formattedData});};j.prototype.compareFunction=function(n){return n[this.sortKey];
};j.prototype.getData=function(){return(this.data)?this.data:this.formatData();};j.prototype.setRawData=function(n){this.data=n;
};j.prototype.retrieveData=function(n){return this.data[n];};return j;});define("chart/widgetFramework/composed/mfpReport/mfpMediator2",["jqueryExtended","lodash","d3","chart/widgetFramework/core/BasicMediator","util/ObjectSuper","chartutil/stringutils","util/Functional","chart/widgetFramework/core/constants/UIConstants","chartutil/dateUtils_CET"],function(a,k,l,j,h,d,c,i,e){var b=false;
var g=false;var f=function(m){var n;n=j(m,true);var o=h(n);n.init=function(){o.init();this.actionCommanderExclusionArray=["actioncommander","dataformatter","timeline"];
};n.getAdditionalDOMElements=function(){o.getAdditionalDOMElements();this.timelineInstances=[];this.$allTimelines=this.$el.find("[data-widget*=Timeline]");
this.totalDomElements+=this.$allTimelines.length;};n.getWidgets=function(){o.getWidgets();this.getWidgetInstances(this.$allTimelines,this.timelineInstances,"Timelines");
};n.onNotifiedFetcher=function(q,p){o.onNotifiedFetcher(q,p);};n.onNotifiedFormatter=function(p,v){o.onNotifiedFormatter(p,v);
var r,t=[],x=[],s=[];var q=p.changeObject.data.chartData;var u=k.chain(q).pluck("programName").map(function(z){var A=z.replace(".","");
var y=d.replaceSpace(A.toLowerCase(),"-");return y;}).value();if(window.console&&console.log){console.log("### mfpMediator::onNotifiedFormatter:: progNamesArray =",u);
}if(!u.length){var w=function(){a(this).css("display","none");a(this).detach();};this.$el.find(".mfp-button").fadeTo(500,0,w);
this.$el.find(".mfp-report-panel").fadeTo(500,0,w);setTimeout(function(){n.$el.find(".mfp-no-data").fadeTo(750,1);},1000);
}else{this.$el.find(".mfp-no-data").fadeTo(500,0);}k.each(u,function(y){n.$el.find("."+y).css("display","block");n.$el.find("."+y).fadeTo(500,1);
});this.$el.find(".mfp-button").each(function(){if(a(this).css("display")==="block"){t.push(a(this));}else{x.push(a(this));
}});k.each(x,function(y){y.detach();});t[0].css("margin-left",0);if(t.length>4){t[4].css("margin-left",0);}this.$el.find(".mfp-report-panel").each(function(){if(a(this).css("display")!=="block"){s.push(a(this));
}});k.each(s,function(y){y.detach();});r=".csr-panel-header-2 .threshold-indicator";this.$el.find(r).css("background-color","#f4f4f4");
k.each(q,function(B){var C=B.programName.replace(".","");var y=d.replaceSpace(C.toLowerCase(),"-");if(B.currentRate>B.rateThreshold||B.currentCount>B.countThreshold){r="."+y+" .threshold-indicator";
n.$el.find(r).css("background-color","#80000c");}var A=e.getUserFriendlyDate(B.currentNofStartDate)+" & "+e.getUserFriendlyDate(B.currentNofEndDate);
var z=n.$el.find("."+y+" .sub-title-date");z.text(A);z.attr("data-daterange",A);});};n.onNotifiedViewCreator=function(q,p){o.onNotifiedViewCreator(q,p);
};n.mediatorReady=function(){o.mediatorReady();var q=this.$el.find("#mfpAcquirer option:selected");var p=q.text();var r=this.$el.find(".mfp-acquirer-title");
r.text(p);this.programButtonElements=[];this.programPanelElements=[];this.$el.find(".mfp-button").each(function(){n.programButtonElements.push(a(this));
});this.$el.find(".mfp-report-panel").each(function(){n.programPanelElements.push(a(this));});k.each(this.programButtonElements,function(s){s.detach();
});k.each(this.programPanelElements,function(s){s.detach();});setTimeout(function(){n.$el.find(".mfp-explanation").fadeTo(750,1);
},1000);};n.showAllProgramElements=function(){var q=this.$el.find(".mfp-button-holder");var p=this.$el.find("#mainChart");
k.each(this.programButtonElements,function(r){r.css({opacity:0,display:"none","margin-left":"20px"});q.append(r);});k.each(this.programPanelElements,function(r){r.css({opacity:0,display:"none"});
p.append(r);});};n.getInstance=function(){return this;};n.fetchNewDataAction=function(){var q=this.$el.find("#mfpAcquirer option:selected");
var p=q.text();var r=this.$el.find(".mfp-acquirer-title");r.text(p);this.showAllProgramElements();};n.onTimeData=function(s,p,r){this.showAllProgramElements();
var q=e.getUserFriendlyDate(s[1],true);this.$el.find(".bar-title-date").text(q);this.$el.find(".bar-title-date").attr("data-date",q);
};n.onInfo=function(r,p,q){if(r.sender.attr("data-active")==="true"){return;}this.infoShow(r);};n.infoShow=function(t){var s=t.sender;
var q=this.$el.find(t.target);s.attr("data-active","true");this.positionPanel(s,q);var p=q.find("#removeBtn");var r=(p.length)?p:a("#subcontent");
q.fadeTo(500,1,function(){a("#subcontent").on("click",{infoPanel:q,closeElement:r,btn:s},n.infoHide);a("#subcontent").on("keyup",{infoPanel:q,closeElement:r,btn:s},function(u){if(u.keyCode===27){n.infoHide(u);
}});});};n.positionPanel=function(y,q){var v=20,s;var x=y;var p=x.position().left;var t=x.offset().left;var w=q;var r=a(window).width();
var u=w.width();if(t+v+u>r){s=Number(p)-v-Number(u);}else{s=v;}w.css("left",(s+"px"));};n.infoHide=function(s){var p=s.data.infoPanel;
var q=s.data.closeElement;var r=s.data.btn;var t=p.is(":hover");if(t){return;}q.off("click");q.off("keyup");r.attr("data-active","false");
p.fadeTo(250,0);};n.init();m.ready();return n;};return f;});define("chartlib/chartLoadQueue",["jquery","underscore","backbone","chartlib/events/appstateevents","chartlib/chartBaseEvents"],function(d,b,f,c,e){var a=f.Collection.extend({initialize:function(){f.on(c.REQUEST_STATE_CHANGE,this.addToQueue,this);
f.on(e.DATA_LOADED,this.dataLoaded,this);},loadQueue:[],addToQueue:function(g){if(this.loadQueue.length===0){this.loadQueue.push(g);
}else{if(this.loadQueue.length>0){this.loadQueue.length=1;this.loadQueue.push(g);}}if(window.console&&window.console.log){window.console.log("\n### ------------------------- chartLoadQueue::addToQueue:: this.loadQueue=",this.loadQueue);
}if(this.loadQueue.length===1){this.loadData("addToQueue");}},dataLoaded:function(){this.loadQueue.shift();if(window.console&&window.console.log){window.console.log("\n### ------------------------- chartLoadQueue::dataLoaded:: this.loadQueue=",this.loadQueue);
}if(this.loadQueue.length===0){if(window.console&&window.console.log){window.console.log("\n### ------------------------- chartLoadQueue::dataLoaded:: SEND RENDER CALL");
}f.trigger(c.RENDER_CHARTS,"loadQueueRender");}else{if(this.loadQueue.length===1){this.loadData("dataLoaded");}}},loadData:function(h){var g=this.loadQueue[0];
if(window.console&&window.console.log){window.console.log("\n### ------------------------- chartLoadQueue::loadData:: SEND LOAD DATA CALL requested by ",h);
}f.trigger(c.STATE_CHANGED,g);}});return a;});define("chart/widgetFramework/composed/funnel/FunnelMediator",["jqueryExtended","lodash","chart/widgetFramework/core/BasicMediator","util/ObjectSuper","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/core/constants/DataConstants","util/Functional","chartutil/cssutils"],function(a,j,i,g,h,f,d,k){var c=false;
var e=false;var b=function(p){var u;u=i(p,true);var r=g(u);u.init=function(){r.init();this.$reportItems=this.$el.find(".report-item");
this.$reportItems.on("mouseover",v);this.$reportItems.on("mouseout",o);};u.getAdditionalDOMElements=function(){r.getAdditionalDOMElements();
this.timelineInstances=[];this.$allTimelines=this.$el.find("[data-widget*=Timeline]");this.totalDomElements+=this.$allTimelines.length;
};u.getWidgets=function(){r.getWidgets();this.getWidgetInstances(this.$allTimelines,this.timelineInstances,"Timelines");};
u.onNotifiedFetcher=function(x,w){r.onNotifiedFetcher(x,w);};u.onNotifiedFormatter=function(w,A){r.onNotifiedFormatter(w,A);
var z=w.changeObject.data.chartData;var B=j.filter(z,function(F){return(F.registertype&&F.registertype.toLowerCase()==="sessions");
});var C=B.length;var D=-18;n();l();q();if(window.console&&console.log){console.log("### funnelMediator::onNotifiedFormatter:: SESSIONS.LENGTH=",C);
}var x=(6-C)*D;t(x);if(B.length<6){var E=-22+((5-C)*D);s(E);var y=-18+((5-C)*D);m(y);}if(B.length===0){s(40);m(40);}};u.onNotifiedViewCreator=function(C,A){r.onNotifiedViewCreator(C,A);
var B,y;var z=C.changeObject;if(C.changeObject.type==="funnelRolloverData"){this.$reportItems.addClass("disabled");this.$reportItems.stop(true);
this.$reportItems.fadeTo(250,0.3);var x=C.changeObject.data.journaltypecode.toLowerCase().replace(/\s/g,"-");var w=function(D){D.removeClass("disabled");
D.stop(true);D.fadeTo(350,1);};this.$reportItems.each(function(F,E){var D=a(this);if(D.attr("data-journaltype").indexOf(" ")>-1){if(D.attr("data-journaltype").indexOf(x)>-1){w(D);
}}else{if(D.attr("data-journaltype")===x){w(D);}}});}if(C.changeObject.type==="funnelRolloutData"){this.$reportItems.removeClass("disabled");
this.$reportItems.stop(true).delay(300).fadeTo(250,1);}};function n(){a(".sessions-blocker").css("top","296px");a(".conversion-blocker").css("top","434px");
a(".authorised-blocker").css("top","534px");a(".settlement-blocker").css("top","734px");}function q(){a(".funnel-border.conversion-received").css("top","342px");
a(".funnel-border.settlement").css("top","588px");}function l(){a(".conversion-group").css("top","194px");a(".authorised-group").css("top","315px");
a(".settlement-group").css("top","431px");a(".final-group").css("top","568px");}function t(w){a(".sessions-blocker").css("top",(parseInt(a(".sessions-blocker").css("top"))+w)+"px");
a(".conversion-blocker").css("top",(parseInt(a(".conversion-blocker").css("top"))+w)+"px");a(".authorised-blocker").css("top",(parseInt(a(".authorised-blocker").css("top"))+w)+"px");
a(".settlement-blocker").css("top",(parseInt(a(".settlement-blocker").css("top"))+w)+"px");}function s(w){a(".funnel-border.conversion-received").css("top",(parseInt(a(".funnel-border.conversion-received").css("top"))+w)+"px");
a(".funnel-border.settlement").css("top",(parseInt(a(".funnel-border.settlement").css("top"))+w)+"px");}function m(w){a(".conversion-group").css("top",(parseInt(a(".conversion-group").css("top"))+w)+"px");
a(".authorised-group").css("top",(parseInt(a(".authorised-group").css("top"))+w)+"px");a(".settlement-group").css("top",(parseInt(a(".settlement-group").css("top"))+w)+"px");
a(".final-group").css("top",(parseInt(a(".final-group").css("top"))+w)+"px");}function v(){var y=a(this).attr("data-journalType");
var w=y.split(" ");var x=a("#funnelChartRollover").find(".bar.rollover").find("rect");x.each(function(){var A=a(this).attr("data-id");
var z=a(this);j.each(w,function(C){if(A===C){var B=z.parent();B.attr("class","bar rollover external-hover");}});});}function o(){var w=a("#funnelChartRollover").find(".bar.rollover");
w.attr("class","bar rollover");}u.getInstance=function(){return this;};u.init();p.ready();return u;};return b;});define("chart/widgetFramework/composed/shopperDnaBeta/formatters/shopperDnaBetaMasterFormatter",["jquery","lodash","util/Console","chart/widgetFramework/composed/shopperdna/shopperDnaUtils"],function(d,c,b,a){function e(f){this.data=f;
this.formattedData={};}e.prototype.formatData=function(){var f=["ManualReviewUnderInvestigation","OpenManualReview"];var h=["AcceptManualReview","ExpireManualReview","RejectManualReview"];
var g=c.chain(this.data).filter(function(i){if((i.type==="Payment")||(typeof i.type==="undefined")&&!c.isNull(i.laststatus)&&!c.isUndefined(i.eventidentifiers)){return true;
}b.log("master formatter filtered out following entry:",i);return false;}).map(function(m){c.each(m.eventidentifiers,function(o,n){m.eventidentifiers[n]=a.fixIdentifierObjectValue(o,n);
});c.each(m.linkingidentifiers,function(p){var o=p.value;var n=p.fieldcode;p.value=a.fixIdentifierObjectValue(o,n);});if((m.type==="Payment")&&c.contains(h,m.laststatus)){var j=c.sortBy(m.journals,function(n){return new Date(n.bookingdate);
});var l=c.findIndex(j,{journaltype:"OpenManualReview"});var k=c.findIndex(j,function(n){return c.contains(h,n.journaltype);
});var i=c.slice(j,(l+1),k);if(c.isEmpty(i)){m.laststatus="Received";}else{m.laststatus=c.last(i).journaltype;}}if((m.type==="Payment")&&c.contains(f,m.laststatus)){m.laststatus="Received";
}return m;}).value();this.formattedData=g;return this.formattedData;};e.prototype.getData=function(){return(this.formattedData)?this.formattedData:this.formatData();
};e.prototype.formatExtraData=function(f){this.data=f;return this.formatData();};e.prototype.formatNewData=function(f){if(this.data.length===f.length){return this.formattedData;
}return this.formatData();};e.prototype.setRawData=function(f){this.data=f;};e.prototype.setOptions=function(f){this.options=f;
};return e;});define("chart/widgetFramework/composed/cardAcquirerAuthorizationReport/acquirerLineChart",["jquery","underscore","chart/widgetFramework/core/mixins/formats","util/ObjectSuper","chartutil/stringutils","d3","chart/widgetFramework/core/constants/UIConstants","util/Functional","chart/widgetFramework/chartTypes/lineChart_buttonToggle"],function(b,i,g,h,f,j,c,e,a){function d(p,k,n){var m;
var o={};var l=i.defaults(o,p);m=a(l,k,n);var q=h(m);m.getLabelName=function(r){return r[this.options.joinAttr];};m.render=function(){var t;
q.render();var u=i.pluck(this.data,"name");for(t=0;t<u.length;t++){u[t]=f.lowerCaseReplaceSpace(u[t],"-");}var r=m.extraData.colors;
for(t=0;t<u.length;t++){var s=u[t]==="overall";m.chartGroup.selectAll(".line-holder."+u[t]+" path").style("stroke",r[u[t]]).style("stroke-width",s?4:null);
m.chartGroup.selectAll(".line-holder."+u[t]+" circle").style("fill",r[u[t]]).attr("r",s?5:3).style("fill-opacity",0).style("stroke-opacity",0);
m.chartGroup.selectAll(".line-holder-label."+u[t]).style("fill",r[u[t]]).style("font-weight",s?600:null);}};m.calibrateYScale=function(){var s=100000;
var r=-100000;i.each(m.data,function(u){var t=i.pluck(u.lineValues,m.options.yAttr);if(j.min(t)<s){s=j.min(t);}if(j.max(t)>r){r=j.max(t);
}});m.scales[m.options.yAttr].domain([s,r]).nice();};m.createRemovedItemButton=function(r){q.createRemovedItemButton(r);this.$el.trigger(c.CHART_TO_VIEW_EVENT,{type:"lineChart_lineRemoved",data:r});
if(this.removedObjectsArr.length===this.masterData.length){this.$el.trigger(c.CHART_TO_VIEW_EVENT,{type:"lineChart_allLinesRemoved",data:{}});
}};m.restoreRemovedItem=function(r){q.restoreRemovedItem(r);this.$el.trigger(c.CHART_TO_VIEW_EVENT,{type:"lineChart_lineRestored",data:r});
};return m;}return d;});define("chartlib/ui/collapsibleview",["jquery","underscore","backbone","chartutil/cssutils"],function(d,c,e,b){var a=e.View.extend({header:null,collapsible:[],collapsed:true,icon:null,speed:"",defaultSpeed:"slow",initialize:function(){c.bindAll(this,"disable","setSpeed");
this.setSpeed(this.defaultSpeed);},render:function(){var g=this,f=d(this.collapsible);this.setCollapsed(this.collapsed);d(this.header).on("click",d.proxy(function(h){this.collapsed=!this.collapsed;
if(this.collapsed){d(this).trigger("close");d.each(f,function(j,k){d(k).stop(false,true);d(k).slideUp({duration:g.speed,complete:function(){d(this).trigger("closed");
g.setSpeed(g.defaultSpeed);}});});}else{d(this).trigger("open");d.each(f,function(j,k){d(k).stop(false,true);d(k).slideDown({duration:g.speed,complete:function(){d(this).trigger("opened");
g.setSpeed(g.defaultSpeed);}});});}if(this.icon){this.updateIcon(this.collapsed);}},this));},setCollapsed:function(g){var f=d(this.collapsible);
if(g){d.each(f,function(h,j){d(j).hide();});}if(this.icon){this.updateIcon(this.collapsed);}},updateIcon:function(g){var f=(g)?0:180;
b.rotateElement(this.icon,f,0.5,0.5);},disable:function(){d(this.header).css("cursor","default");d(this.header).off();d(this.icon).hide();
},setSpeed:function(f){this.speed=f;}});return a;});define("chart/widgetFramework/composed/revenueAccelerate/revenueAccelerateMediator2",["jqueryExtended","lodash","d3","chart/widgetFramework/core/BasicMediator","util/ObjectSuper","chartutil/numberutils","chartutil/d3utils","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/core/constants/DataConstants","util/Functional","chartutil/cssutils"],function(a,k,m,j,h,g,n,i,f,c,l){var b=false;
var e=false;var d=function(o){var p;p=j(o,true);var q=h(p);p.init=function(){q.init();this.actionCommanderExclusionArray=["actioncommander","dataformatter"];
};p.getAdditionalDOMElements=function(){q.getAdditionalDOMElements();this.timelineInstances=[];this.$allTimelines=this.$el.find("[data-widget*=Timeline]");
this.totalDomElements+=this.$allTimelines.length;};p.getWidgets=function(){q.getWidgets();this.getWidgetInstances(this.$allTimelines,this.timelineInstances,"Timelines");
};p.onNotifiedFetcher=function(r,z){q.onNotifiedFetcher(r,z);if(z==="revOpBlockReportDataFetcher"){var s=r.changeObject.data.conversionOptimizations;
if(window.console&&console.log){console.log("### revenueAccelerateMediator::onNotifiedFetcher:: block data=",s);}this.populateReportBlocks(s.rows);
var C=0,w=0;var A=r.changeObject.data.optimizationTotals.rows[0];var v=0;k.each(s.rows,function(G,F){if(k.has(G,"rescuedEurQuantity")){if(G.product.toLowerCase()!=="dynamiccardvalidation"){v+=G.rescuedEurQuantity;
}}});if(A){C=v/100;w=A.rescuedPercentage;}var y=m.format(",.2f");var x=this.$el.find("#mainTotal .report-panel--revenue .--eur-amt");
g.animateValue(x,C,y);var E=m.format(",.4f");var D=this.$el.find("#totalsList .report-panel--auth-rate-gain .percent-span");
if(window.console&&console.log){console.log("### revenueAccelerateMediator::onNotifiedFetcher:: rescuedPerc=",w);}g.animateValue(D,w,E);
var B=D.parent().find("i");B.removeClass("icon-sort-asc icon-sort-desc");if(w>0){B.addClass("icon-sort-asc");B.show();}else{if(w<0){B.addClass("icon-sort-desc");
B.show();}else{if(w===0){B.hide();}}}}if(z==="revOpAccountUpdaterDataFetcher"){var u=r.changeObject.data.cardUpdates;if(u){var t=u.rows;
this.populateAccountBlock(t);}}};p.onNotifiedFormatter=function(r,w){q.onNotifiedFormatter(r,w);if(w==="baselineDataFormatter"){var v=r.changeObject.data.chartData;
var x=m.format(",.0f");var y=m.format(".2f");var t=n.getCollectionSum(v,"total");var s=n.getCollectionSum(v,"authorisations");
var z=(s/t)*100||0;var u=a("#totalsList");g.animateValue(u.find("#receivedTotal"),t,x);g.animateValue(u.find("#authTotal"),s,x);
g.animateValue(u.find("#authRateTotal"),z,y);}};p.onNotifiedViewCreator=function(u,s){q.onNotifiedViewCreator(u,s);var r=u.changeObject;
var t=r.type;};p.populateReportBlocks=function(x){var z,r,y,v=m.format(",.2f"),w=m.format(",.0f"),B=m.format(",.4f");var s={product:"AutoRetries",rescuedPercentage:0,rescuedEurQuantity:0};
var A={product:"DynamicCardValidation",rescuedPercentage:0,rescued:0};var u={product:"IntelligentPaymentRouting",rescuedPercentage:0,rescuedEurQuantity:0};
var t={product:"SmartIssuerLogic",rescuedPercentage:0,rescuedEurQuantity:0};if(!k.find(x,{product:"AutoRetries"})){x.push(s);
}if(!k.find(x,{product:"DynamicCardValidation"})){x.push(A);}if(!k.find(x,{product:"IntelligentPaymentRouting"})){x.push(u);
}if(!k.find(x,{product:"SmartIssuerLogic"})){x.push(t);}k.each(x,function(E,D){var C="[data-product-id='"+E.product+"']";
z=p.$el.find(C);if(z.length){r=z.find(".report-numbers--price.--eur-amt");if(r.length){g.animateValue(r,E.rescuedEurQuantity/100,v,D);
}r=z.find(".report-numbers--price.--rescued-amt");if(r.length){g.animateValue(r,E.rescued,w,D);}r=z.find(".percent-span");
if(r.length){r.html(B(E.rescuedPercentage));y=r.parent().find("i");y.removeClass("icon-sort-asc icon-sort-desc");if(E.rescuedPercentage>0){y.addClass("icon-sort-asc");
y.show();}else{if(E.rescuedPercentage<0){y.addClass("icon-sort-desc");y.show();}else{if(E.rescuedPercentage===0){y.hide();
}}}}}});};p.populateAccountBlock=function(u){var t=this.$el.find("#AccountUpdater").find(".report-numbers--price");if(t.length){var r=m.format(",.0f");
var v=k.filter(u,function(w){return w.Status==="CardUpdated"||w.Status==="CardNumberUpdated"||w.Status==="CardExpiryUpdated";
});var s=k.reduce(v,function(w,x){return w+x.Count;},0);g.animateValue(t,s,r);}};p.getInstance=function(){return this;};p.init();
o.ready();return p;};return d;});define("chart/widgetFramework/composed/funnel/funnelFigures",["jquery","underscore","d3","hogan","util/Functional","chartutil/d3utils","util/ObjectSuper","chart/widgetFramework/chartTypes/barChart"],function(b,f,h,d,a,i,e,c){var g=function(p,j,n,l){var m;
var o={};var k=f.defaults(o,p);m=c(k,j);var q=e(m);m.init=function(){q.init();this.stripLabel="spacer";};m.feedData=function(r){q.feedData(r);
this.mainTypes=this.extraData;};m.renderYAxis=function(){q.renderYAxis();this.yAxesHolders[this.options.yAttr].attr("transform","translate(-80,0)").selectAll("text").style("text-anchor","start");
var r=this;var s=this.yAxesHolders[this.options.yAttr].selectAll("text");f.each(s[0],function(v,u){var t=h.select(v);f.each(r.mainTypes,function(w){if(t.datum()===w){t.style("font-weight","500");
t.style("fill","#000");}});});};m.renderData=function(){if(a.falsy(this.data)){this.hideCharts("no data to display");return;
}var t=this,u=this.scales[this.options.yAttr];var r=h.format("0,000");var s=this.barUtils.containerBarsHorizontal(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),this.barPositioningFn,true);
var v=s.bars;v.update.select("text").transition().duration(500).attr("opacity",1).text(function(w){return(w.count!==-1)?r(w.count):"";
});v.enter.append("text").attr("class",function(w){return i.getJoinAttrNoSpaces.call(t,w,"-");}).attr("x",125).attr("y",function(w){return u.rangeBand()/2;
}).attr("dy",".35em").attr("opacity",0.000001).style("text-anchor","end").style("font-weight",function(w){return(w.main.toLowerCase()==="true")?"500":"300";
}).style("fill",function(w){return(w.main.toLowerCase()==="true")?"#000":"#4d4d4f";}).transition().duration(500).attr("opacity",1).text(function(w){return(w.count!==-1)?r(w.count):"";
});v.exit.select("text").transition().duration(500).style("opacity",0).remove();};return m;};return g;});define("chart/widgetFramework/composed/shopperdna/manualReviewActions",["jquery","lodash"],function(d,a){var b=["#shopperdnaLegend","#shopperdnaBundle"];
var c={actions:[{source:"#shopperdnaMediator",event:"widgetAppStartup",target:"#shopperdnaData",callMethod:"widgetAppStartup"},{source:"#shopperdnaData",event:"fetchDataError",target:"#shopperdnaMediator",callMethod:"retryFetching"},{source:"#shopperdnaMediator",event:"updateState",callMethod:function(e){d("#shopperdnaState").html(e);
}},{source:"#shopperdnaMediator",event:"hideCharts",callMethod:function(){d("#shopperdnaLegend").hide();d("#shopperdnaBundle").hide();
}},{target:"#shopperdnaLegend",callMethod:"renderTemporarySelection",event:"createTemporarySelection",source:["#shopperdnaBundle"]},{target:"#shopperdnaLegend",callMethod:"renderSelection",event:"createSelection",source:a.without(b,"#shopperdnaLegend")},{target:"#shopperdnaBundle",callMethod:"renderSelection",event:"createSelection",source:a.without(b,"#shopperdnaBundle")},{source:"#clearButton",event:"click",target:b,getterMethod:function(){return{selection:[]};
},callMethod:"renderSelection"}]};return c;});define("chart/widgetFramework/core/DataFormatterUpdateable",["jqueryExtended","underscore","chart/widgetFramework/core/constants/DataConstants","util/Functional","chart/widgetFramework/core/drivers/observableCode","chartutil/domUtils"],function(a,k,h,e,b,i){var l="color:cornflowerblue;font-size:1em";
var c=false;var f="color:#5bda61;font-size:1em";var g=false;var d=false;var j=function(m){var n={};b(n,"formatter");n.init=function(){k.bindAll(this,"onNotifiedNewData");
this.$el=m.getNode();m.getNode()[0].__formatter=this;this.id=this.$el.attr("id");this.formatter=null;var r=this.parameters=this.getParameters(m);
this.options=r.options;var s=r.datasetName;this.dataFetcherContainer=a("#"+s);if(window.console&&console.log&&d){console.log("### DataFormatter2::init:: getting dataFetcher promise----");
}this.dataFetcherContainer.widget().then(function(t){n.dataFetcher=t.instance;n.dataFetcher.registerObserver(n.onNotifiedNewData,false,n.id);
},function(){if(window.console&&console.warn){console.warn("DataFormatter:: Error finding fetcher '"+p+"'",arguments);}});
var q=r.timeline;var o=(q&&q.indexOf("#")===-1)?a("#"+q):a(q);if(o.length){if(window.console&&console.log&&d){console.log("### DataFormatter2::init:: getting timeline promise----");
}o.widget().then(function(t){var u=t.instance;u.renderPromise.done(function(){n.timeline=u.timeline;});},function(){if(window.console&&console.warn){console.warn("DataFormatter:: Error loading timelineObject",arguments);
}});}this.silentFormat=(r.options&&r.options.silentFormat)?r.options.silentFormat:false;this.formatterStore={};var p=r.formatterName;
this.FormatterRef=null;this.resolvedRequire=false;this.hasData=false;this.currentFormatterType="noFormatternoFormatter";if(e.notFalsy(p)){this.requireFormatter(p);
}i.removeDataAtrributes(this.$el,["options"]);};n.requireFormatter=function(p){var o=p.substring(p.lastIndexOf("/")+1);if(window.console&&console.log){console.log("### DataFormatterUpdateable::requireFormatter:: formatterName=",p);
console.log("### DataFormatterUpdateable::requireFormatter:: this.formatterStore[requestedFormatterType]=",this.formatterStore[o]);
console.log("### DataFormatterUpdateable::requireFormatter:: requestedFormatterType=",o);}if(!this.formatterStore[o]){if(window.console&&console.log){console.log("### DataFormatterUpdateable::requireFormatter:: REQUIRING: ",p);
}this.resolvedRequire=false;require(["chart/widgetFramework/"+p],function(q){n.formatter=null;n.currentFormatterType=o;n.FormatterRef=q;
n.resolvedRequire=true;n.checkReady("require");if(n.requirePromise){n.requirePromise.resolve();}},function(q){if(window.console&&console.log){console.log("DataFormatter2:: Formatter require error: ",q);
}});}else{if(window.console&&console.log){console.log("### DataFormatterUpdateable::requireFormatter:: HAVE FORMATTER of type:",o);
}this.formatter=this.formatterStore[o];n.currentFormatterType=o;n.checkReady("require");if(n.requirePromise){this.requirePromise.resolve();
}}};n.invalidateData=function(){this.hasData=false;};n.getRequirePromise=function(){this.requirePromise=new a.Deferred();
return this.requirePromise;};n.checkReady=function(o){if(window.console&&console.log){console.log("\n### DataFormatter2::checkReady:: pWho=",o);
console.log("### DataFormatter2::checkReady:: this.resolvedRequire=",this.resolvedRequire);console.log("### DataFormatter2::checkReady:: this.hasData=",this.hasData);
}if(this.resolvedRequire&&this.hasData){this.createFormatter();}};n.onNotifiedNewData=function(p,o){if(window.console&&console.log&&c){console.log("%c\n################",f);
console.log("%c### START STAGE :: DataFormatter::"+this.id+":: onNotifiedNewData pId="+o+" pData.type= "+p.changeObject.type,f);
console.log("%c################",f);}this.data=p.changeObject.data;this.hasData=true;this.checkReady("data");};n.createFormatter=function(){if(window.console&&console.log){console.log("### DataFormatterUpdateable::createFormatter:: this.formatter =",this.formatter);
}if(!e.existy(this.formatter)){if(window.console&&console.log&&c){console.log("%c\n################",f);console.log("%c### START STAGE :: DataFormatter::"+this.id+" ::formatData:: CREATING NEW FORMATTER",f);
console.log("%c################",f);}var o=e.existy(this.timeline)?this.timeline:null;this.formatter=new this.FormatterRef(this.data,this.options,o,this.id);
this.formatterStore[this.currentFormatterType]=this.formatter;this.$el.on(h.FORMATTER_INFORM_WIDGET,k.bind(this.onFormatterToWidgetEvent,this));
this.formatter.$el=this.$el;}else{if(window.console&&console.log&&c){console.log("%c\n################",f);console.log("%c### START STAGE :: DataFormatter::"+this.id+" ::formatData:: UPDATING EXISTING FORMATTER",f);
console.log("%c################",f);}this.formatter.setRawData(this.data);}this.formatData();};n.getInstance=function(){return this.formatter;
};n.formatData=function(){if(e.existy(this.data)){if(window.console&&console.log&&c){console.log("%c\n################",f);
console.log("%c### START STAGE :: DataFormatter::"+this.id+" ::formatData:: formatting data",f);console.log("%c### START STAGE :: DataFormatter::"+this.id+" ::formatData:: silentFormat="+this.silentFormat,f);
console.log("%c################",f);}var o=this.formatter.formatData();this.setProperty("changeObject",{type:h.DATA_FORMATTED,data:o,silentFormat:this.silentFormat});
if(this.timeline){var p=this.parameters.timeline;if(this.parameters.timeline.indexOf("#")===-1){p="#"+this.parameters.timeline;
}a(p).find("#timelineLoader").css("display","none");}if(this.silentFormat){this.silentFormat=false;}}else{if(window.console&&console.log&&g){console.log("\n################ ","\n### DataFormatter:: "+this.id+" ::formatData:: no data to format","\n################ ");
}}};n.onFormatterToWidgetEvent=function(p,o){this.setProperty("changeObject",o);};n.getSortDirection=function(){return this.formatter.reverseDirection;
};n.getFormatter=function(){return this.formatter;};n.setData=function(o){this.data=o;};n.getData=function(o){return this.data||{};
};n.getParameters=function(o){var r=o.getNode().data();var p;if(k.keys(r).length){p=r;if(e.notFalsy(p.options)){if(!k.isObject(p.options)){if(window.console&&console.log){console.error("### DataFormatter::getParameters:: options JSON has not parsed correctly, option=",p.options);
}}}}else{o.parameters.options=a.parseJSON(o.parameters.options);p=o.parameters;}var q={};if(k.keys(p).length){q.formatterName=p.formatter;
q.datasetName=p.dataset;q.options=p.options;q.timeline=p.timeline;}else{throw"The parameters are not well defined"+p;}return q;
};n.init();if(window.console&&console.log&&d){console.log("\n### DataFormatter2::constructor:: calling pWidgetApi.ready()");
}m.ready();return n;};return j;});define("chart/widgetFramework/composed/cardAcquirerAuthorizationReport/formatters/binBarFormatter",["jqueryExtended","underscore","d3","chartutil/stringutils","chart/widgetFramework/core/constants/DataConstants"],function(f,b,c,e,d){function a(j,g,i,l){var h={};
h.data=j;h.options=g;h.formattedData={};h.comparator=null;h.reverseDirection=false;h.sortKey="authorizedCount";h.timeline=i;
h.id=l;h.formatData=function(){var n=this.data.bin_aggregation?this.data.bin_aggregation:{};var m={};if(n.length===0){return[];
}this.formattedData=k(n);h.unique_acquirers=h.findAcquirers(this.formattedData);h.acquirer_colors=h.createColors(h.unique_acquirers);
if(this.sortKey){this.reverseDirection=!this.reverseDirection;this.sortData(this.sortKey,true);}return{config:m,chartData:h.formattedData,extraData:{colors:h.acquirer_colors,acquirers:h.unique_acquirers}};
};h.findAcquirers=function(m){var n=b.pluck(b.flatten(b.pluck(m,"acquirerValues")),"labelName");n=b.uniq(n);n=b.filter(n,function(o){return o!=="RefusedAcquirer";
});return n;};var k=function(o){var n=[];o=b.filter(o,function(p){return typeof p.bin!=="undefined"&&!(b.isNull(p.bin))&&typeof p.acquirers!=="undefined"&&!(b.isNull(p.acquirers));
});o=b.filter(o,function(p){return +p.authorisedCount>0&&+p.authRate>0;});var m=c.nest().key(function(p){return p.bin;}).entries(o);
b.each(m,function(r){var q=0,p=0;b.each(r.values,function(s){q+=+s.receivedCount;p+=+s.authorisedCount;});r.totalReceivedCount=q;
r.totalAuthorizedCount=p;});m=m.sort(function(q,p){return p.totalReceivedCount-q.totalReceivedCount;});b.each(m,function(s){var q=[];
b.each(s.values,function(t){q.push({labelName:t.acquirers,acquirer:e.lowerCaseReplaceSpace(t.acquirers,"-"),authorizedCount:+t.authorisedCount,authorizedCountShare:s.totalAuthorizedCount===0?0:+t.authorisedCount/s.totalAuthorizedCount*100,authorizedEurAmount:+t.authorisedAmount/100,authorizationRate:+t.authRate*100});
});var r=typeof s.values[0].binBankName==="undefined"?"Unknown":s.values[0].binBankName;var p="TODO";n.push({labelName:s.key,binIssuer:r,binCountries:p,authorizedCount:s.totalAuthorizedCount,authorizationRate:s.totalReceivedCount===0?0:s.totalAuthorizedCount/s.totalReceivedCount*100,acquirerValues:q});
});return n;};h.createColors=function(p){var o={};var t=[];b.each(p,function(v){t.push(e.lowerCaseReplaceSpace(v));});var u=t.filter(function(v){return/^adyen/.test(v);
});u.sort();if(u.length>0){var s=c.scale.linear().range(["#004E00","#007100","#1C9516","#6AB466","#A1D3A1"].reverse()).domain(c.range(0,1,1/(5-1)).concat(1));
var m=c.scale.ordinal().domain(u).range(c.range(0,1,1/(u.length-1)).concat(1));u.forEach(function(v){o[v]=s(m(v));});}var n=t.filter(function(v){return !(/^adyen/.test(v));
});n.sort();if(n.length>0){var r=c.scale.linear().range(["#0d4f74","#2f6b93","#5388ae","#79a6c4","#a3c4d9"].reverse()).domain(c.range(0,1,1/(5-1)).concat(1));
var q=c.scale.ordinal().domain(n).range(c.range(0,1,1/(n.length-1)).concat(1));n.forEach(function(v){o[v]=r(q(v));});}o.overall="#1e1e1e";
o.average="#1e1e1e";return o;};h.sortData=function(m,o){this.sortKey=m;if(this.sortKey===this.oldSortKey){this.reverseDirection=!this.reverseDirection;
}else{this.reverseDirection=false;}this.oldSortKey=this.sortKey;var n=b.sortBy(this.formattedData,m);if(this.reverseDirection){n.reverse();
}this.formattedData=n;if(o===true){return;}this.$el.trigger(d.FORMATTER_INFORM_WIDGET,{type:d.SORTED_DATA,data:{chartData:this.formattedData}});
};h.compareFunction=function(m){return m[this.sortKey];};h.getData=function(){return(this.data)?this.data:this.formatData();
};h.setRawData=function(m){this.data=m;};h.retrieveData=function(m){return this.data[m];};return h;}return a;});define("chart/widgetFramework/composed/revenueAccelerate/PaymentRoutingMediator",["jqueryExtended","lodash","d3","util/Implement","chart/widgetFramework/core/BasicMediator","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/core/constants/DataConstants","util/Functional","chartutil/cssutils","chartutil/d3utils"],function(a,j,m,d,i,h,g,c,k,l){var b=false;
var f=false;function e(n){if(window.console&&console.log){console.log("### PaymentRoutingMediator::PaymentRoutingMediator:: !!!!!!!!!!!!!!!!!!!!!!!!!");
}this.init(n);this.getObservables();n.ready();}e.prototype.onNotifiedFetcher=function(p,o){i.prototype.onNotifiedFetcher.call(this,p,o);
if(o==="revOpBlockReportDataFetcher"){var q=p.changeObject.data.conversionOptimizations.rows;var n=j.filter(q,function(r){return r.product==="IntelligentPaymentRouting";
});}};e.prototype.onNotifiedFormatter=function(o,n){i.prototype.onNotifiedFormatter.call(this,o,n);};e.prototype.onNotifiedViewCreator=function(r,p){i.prototype.onNotifiedViewCreator.call(this,r,p);
var q,n;var o=r.changeObject;};e.prototype.mediatorReady=function(){i.prototype.mediatorReady.call(this);this.$el.trigger(g.TIME_INFO_SET,["2015-12-01","2016-01-01"]);
};d.fromTo(i,e);return e;});define("chart/widgetFramework/composed/cardAcquirerAuthorizationReport/cardAcquirerActions",["jqueryExtended"],function(d){var e=d;
var f=window.adyen||{};var a=f.config||{};var b=[];if(a.showAcquirerTimeChart){b.push("acquirerTimeDataFetcher");}if(a.showAcquirerBarChart){b.push("acquirerBarDataFetcher");
}if(a.showAcquirerAccountBarChart){b.push("acquirerAccountBarDataFetcher");}if(a.showMerchantBarChart){b.push("merchantBarDataFetcher");
}if(a.showPaymentMethodBarChart){b.push("paymentMethodBarDataFetcher");}if(a.showIssuerCountryBarChart){b.push("issuerCountryBarDataFetcher");
}if(a.showBINBarChart){b.push("binBarDataFetcher");}var c={actions:[{source:["acquirerIdInput","acquirerAccountIdInput","issuerCountryInput","shopperInteractionsInput","paymentMethodInput","merchantAccountsIdInput"],event:"valueGroupChange",target:b,callMethod:"fetchNewDataAction",getterMethod:function(h){var i=h.val();
var g={};g[h.attr("data-send")]=i;return g;}},{source:["threedSecure"],event:"change",target:["cardAcquirerMediator"],callMethod:"onFilterChange",getterMethod:function(h){var i=h.val();
var g={};g[h.attr("data-send")]=i;return g;}}]};return c;});define("chart/widgetFramework/composed/cardAcquirerAuthorizationReport/formatters/acquirerLineFormatter",["underscore","d3","chartutil/d3utils","chartutil/stringutils","chartutil/dateUtils_CET"],function(a,c,b,f,e){function d(j,g,i){var h={};
h.data=j;h.options=g;h.formattedData={};h.timeline=i;h.formatData=function(){var m=h.data.acquirer_time_aggregation?h.data.acquirer_time_aggregation:{};
var k={};h.formattedData=h.calculateMetaData(m);for(var l=0;l<h.acquirers.length;l++){h.acquirers[l]=f.lowerCaseReplaceSpace(h.acquirers[l]);
}h.acquirer_colors=h.createColors(h.acquirers);return{config:k,chartData:h.formattedData,extraData:{colors:h.acquirer_colors}};
};h.calculateMetaData=function(m){var l=c.format(".2f");var q=c.format(",.0f");var n=[],u=[];var p=h.timeline.getGranularity();
var v=h.timeline.getDates();var s=1;var o=new Date(v[1].getFullYear(),v[1].getMonth(),v[1].getDate()-s);a.each(m,function(w){a.map(w,function(x){x.dateStr=x.date;
var y=new Date(x.dateStr);x.date=e.trueRoundToDay(y,true);});});for(var t in m){if(m.hasOwnProperty(t)){if(t==="RefusedAcquirer"||typeof t==="undefined"||(a.isNull(t))){delete m[t];
}}}h.acquirers=a.keys(m);a.each(m,function(z,x){var w=[];if(a.isArray(z)){w=h.fillGaps(z,p,[v[0],o]);}var y=[];a.each(w,function(A){y.push({date:A.date,name:A.dateStr,authorizedcount:A.authorisedCount,receivedcount:A.receivedCount,value:A.authRate*100});
});n.push({name:x,lineValues:y});});var k=h.fillGaps([],p,[v[0],o]);var r=[];a.each(k,function(z,y){var A=0,x=0;a.each(n,function(B){A+=B.lineValues[y].authorizedcount;
x+=B.lineValues[y].receivedcount;});var w=x>0?A/x:0;r.push({date:z.date,name:z.dateStr,authorizedcount:A,receivedcount:x,value:w*100});
});n.push({name:"Overall",lineValues:r});a.each(k,function(z,y){var x=[];var w=c.sum(n,function(A){return A.lineValues[y].authorizedcount;
});w=w/2;a.each(n,function(A){x.push({acquirerStr:A.name,acquirer:f.lowerCaseReplaceSpace(A.name,"-"),authRate:l(A.lineValues[y].value),authorizedCount:q(A.lineValues[y].authorizedcount),authorizedShare:A.name==="Overall"?"":"("+l(A.lineValues[y].authorizedcount/w*100)+"%)"});
});u.push({date:z.date,dateStr:z.dateStr,acquirers:x});});return{acquirerChartData:n,acquirerRolloverData:u};};h.createColors=function(r){var k={};
var l=r.filter(function(s){return/^adyen/.test(s);});l.sort();if(l.length>0){var o=c.scale.linear().range(["#004E00","#007100","#1C9516","#6AB466","#A1D3A1"].reverse()).domain(c.range(0,1,1/(5-1)).concat(1));
var q=c.scale.ordinal().domain(l).range(c.range(0,1,1/(l.length-1)).concat(1));l.forEach(function(s){k[s]=o(q(s));});}var p=r.filter(function(s){return !(/^adyen/.test(s));
});p.sort();if(p.length>0){var n=c.scale.linear().range(["#0d4f74","#2f6b93","#5388ae","#79a6c4","#a3c4d9"].reverse()).domain(c.range(0,1,1/(5-1)).concat(1));
var m=c.scale.ordinal().domain(p).range(c.range(0,1,1/(p.length-1)).concat(1));p.forEach(function(s){k[s]=n(m(s));});}k.overall="#1e1e1e";
k.average="#1e1e1e";return k;};h.fillGaps=function(k,m,l){return b.fillTimeScaleBucketsFromTemplate(l,m,k,function(){return{authRate:0,authorisedCount:0,authorisedAmount:0,receivedCount:0,receivedAmount:0};
});};h.setRawData=function(k){this.data=k;};return h;}return d;});define("chart/widgetFramework/composed/transactionsDashboard/views/granularAuthAmtBar",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/chartTypes/barChart","chart/widgetFramework/composed/transactionsDashboard/views/granularXAxisCode"],function(c,g,k,b,e,a,f,i,h,j){var d=function(r,l,p,n){var o;
var q={};var m=g.defaults(r,q);o=h(m,l,p);var s=f(o);j(o);return o;};return d;});define("chart/widgetFramework/composed/manualReview/manualReviewActions",["jqueryExtended","lodash","chart/widgetFramework/core/constants/UIConstants"],function(d,a,b){var c={actions:[{source:"#manMediator",event:"widgetAppStartup",target:"#shopperPaymentsData",callMethod:"widgetAppStartup"},{source:"manMediator",event:"fetchShopperData",target:"shopperPaymentsData",callMethod:"fetchData"},{source:"oilsplash",event:"renderTooltip",target:"shopperDnaBundleLayoutLegend",callMethod:"render"}]};
return c;});define("chart/widgetFramework/composed/shopperDnaBeta/formatters/shopperDnaBetaForceFormatter",["lodash","d3","chart/widgetFramework/composed/shopperdna/shopperDnaUtils"],function(d,f,b){function c(i,h){this.data=i;
this.formattedData={};this.options=h||{};}c.prototype.setRawData=function(h){this.data=h;};c.prototype.formatData=function(){if(this.options.silentFormat){return;
}var i=g(this.data);var l=i.transactions;var k=i.identifiers;var j=l.concat(k);var h=a(k);this.formattedData={transactionPspreferenceMap:d.indexBy(l,"pspreference"),nodes:j,links:h};
return this.formattedData;};function g(h){var j={};var i={};var l=d.map(h,function(o,n){o.category=b.getStatusCategory(o.laststatus);
o.index=n;o.type="transaction";o.identifiers=[];o.transactions=[];d.each(o.linkingidentifiers,function(p){i[p.fieldcode]=p.strength;
});d.each(o.eventidentifiers,function(q,p){j[p]=j[p]||{};j[p][q]=j[p][q]||[];j[p][q].push(n);});return o;});var k=[];var m=l.length;
d.each(j,function(n,p){var o=i[p];if(o){d.each(n,function(r,q){var t=r.length;var s={type:"identifier",letter:e(p),index:m,name:p,value:q,strength:o,transactions:r,weight:t,identifiers:[]};
d.each(r,function(u){l[u].identifiers.push(m);});k.push(s);m++;});}});d.each(k,function(n){d.each(n.transactions,function(o){n.identifiers=n.identifiers.concat(l[o].identifiers);
});});return{transactions:l,identifiers:k};}function a(h){var i=[];d.each(h,function(j){d.each(j.transactions,function(l){var k={source:j.index,identifier:j.index,target:l,transaction:l,strength:j.strength};
i.push(k);});});return i;}function e(i){i=i.toLowerCase();var h;if(d.startsWith(i,"shopper")){h=i.charAt(7);}else{if(d.startsWith(i,"hashed")){h=i.charAt(6);
}else{h=i.charAt(0);}}return h.toUpperCase();}return c;});define("chart/widgetFramework/composed/chargebackReport/acquirerBarChart",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/chartTypes/barChart"],function(d,h,j,c,f,b,g,i,e){var a=function(n,r,u,t){var q,s,k,o;
var l={};var v=h.defaults(l,n);q=e(v,r,u);var m=g(q);var p=false;q.init=function(){m.init();this.barUtils.transitionTime=500;
this.barUtils.delayTime=500;};q.initRender=function(){m.initRender();setTimeout(function(){if(!p&&q.options.ranked){q.chartGroup.classed("barchart-ranked",true);
}p=true;},100);};q.renderData=function(){m.renderData();};return q;};return a;});define("chart/widgetFramework/composed/settlementBatchWidget/settlementBatchWidgetMediator",["d3","jqueryExtended","lodash","util/Implement","chart/widgetFramework/core/BasicMediator","chart/widgetFramework/core/constants/DataConstants"],function(c,e,b,a,g,d){function f(i){this.init(i);
var h=new Date();this.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];
this.currentYear=h.getFullYear();this.currentMonth=h.getMonth();this.currentDay=h.getDate();i.ready();}f.prototype.onNotifiedFetcher=function(i,h){};
f.prototype.onNotifiedFormatter=function(j,i){var h=j.changeObject.data;if(h){if(e(".chart-month")&&h.month){e(".chart-month").text(h.month);
}if(e(".total-month-currency")&&h.currencySymbol){e(".total-month-currency").html(h.currencySymbol);}if(e(".total-month-value")&&h.total){e(".total-month-value").text(h.total);
}if(e("#settlement_overview .ca-handle")){e("#settlement_overview .ca-handle").append([this.monthNames[this.currentMonth],this.currentYear].join(" "));
}}var k=e(".settlement-batch-reformat");k.each(function(){var m=e(this).text();var l=c.format(",.2f");e(this).text(l(m));
});};f.prototype.onNotifiedViewCreator=function(i,h){};f.prototype.mediatorReady=function(){var h=(this.currentMonth<10)?"0":"";
g.prototype.mediatorReady.call(this);this.$el.trigger(d.TIME_INFO_SET,(this.currentYear+"-"+h+(this.currentMonth+1)+"-01"));
};a.fromTo(g,f);return f;});define("chartutil/backbone/ViewUtils",["jquery","underscore","backbone"],function(c,b,d){var a={};a.extendMethod=function(h,g,f){if(!b.isUndefined(g[f])){var e=h[f];
h[f]=function(){var i=e.apply(this,arguments);g[f].apply(this,arguments);return i;};}};d.View.mixin=function(f){var e=this.prototype;
b.defaults(e,f);b.defaults(e.events,f.events);a.extendMethod(e,f,"initialize");a.extendMethod(e,f,"render");};return a;},function(a){if(window.console&&console.log){console.log("APP JS ERROR = "+a);
}});define("chart/widgetFramework/composed/cardAcquirerAuthorizationReport/rollovers/groupedBarRolloverBrushed",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/chartTypes/axisRollover"],function(c,i,j,a,f,h,g,e,d){function b(o,k){var m;
var n={};var l=i.defaults(n,o);m=d(l,k);var p=g(m);m.init=function(){p.init();if(typeof this.options.allowScrolling==="undefined"){this.options.allowScrolling=false;
}m.firstBrushPass=true;};m.initRender=function(){p.initRender();m.mainGroup.append("defs").append("clipPath").attr("id","clip-bars-rollover").append("rect").attr("width",m.options.width-m.options.margin.left-m.options.margin.right).attr("height",m.options.height-m.options.margin.top-m.options.margin.bottom);
};m.render=function(){if(a.notFalsy(this.data)){m.doBrush=m.data.length>10;}var r=this.$el.width();if(!m.doBrush&&a.notFalsy(this.data)){this.height=(this.data.length*30);
}else{this.height=this.options.height-(this.options.margin.top+this.options.margin.bottom);}var q=this.height+this.options.margin.top+this.options.margin.bottom;
this.topSVG.attr("width",r+"px").attr("height",q+"px");j.select("#"+this.$el[0].id).transition().duration(500).style("height",q+"px");
if(this.options.allowScrolling&&m.doBrush&&m.firstBrushPass){var s=j.behavior.zoom().on("zoom",null);this.mainGroup.call(s).on("wheel.zoom",function(){m.scrolling();
}).on("mousedown.zoom",null).on("touchstart.zoom",null).on("touchmove.zoom",null).on("touchend.zoom",null);m.firstBrushPass=false;
}if(m.doBrush){m.chartGroup.attr("clip-path","url(#clip-bars-rollover)").style("clip-path","url(#clip-bars-rollover)");}else{m.scales[m.options.yAttr].rangeBands([m.height,0],m.options.barPadding);
}this.update();};m.updateScale=function(q){m.scales[m.options.yAttr].rangeBands(q.newScale,m.options.barPadding);m.update();
};m.setBandSizes=function(){if(m.doBrush){this.barSize=m.scales[m.options.yAttr].rangeBand();this.bandSize=this.barSize*(1+m.options.barPadding);
}else{p.setBandSizes();}};m.scrolling=function(){var q=m.options.variation==="horizontal"?j.event.deltaY:j.event.deltaX;this.$el.trigger(h.CHART_TO_VIEW_EVENT,{type:"groupedBarChartScroll",data:q});
};m.setTooltipsOnElements=function(){p.setTooltipsOnElements(true);};m.positionTooltip=function(u,w,t,v,q,r,x){var s=u.top+t-10-q;
var y=((u.left+w)-v)+(r/2);return{top:s,left:y};};m.enhanceTooltipData=function(r){var q=j.format(",.2f");r.authorizedRateTT=q(r.authorizationRate);
r.authorizedCountShareTT=q(r.authorizedCountShare);var t=j.format(",.0f");r.authorizedCountTT=t(r.authorizedCount);var s=j.format(",.0f");
r.authorizedEurAmountTT=s(r.authorizedEurAmount);};return m;}return b;});define("chart/widgetFramework/composed/retryreport/acquirerButtons",["jquery","underscore","d3","hogan","util/Functional","chart/widgetFramework/core/constants/WidgetConstants","chart/widgetFramework/core/constants/UIConstants","chartutil/domUtils","util/ObjectSuper","chart/widgetFramework/core/drivers/basicChartDriver"],function(c,i,k,e,a,d,h,f,g,j){function b(p,l){var n;
var o={};var m=i.defaults(o,p);n=j(m,l);var q=g(n);n.init=function(){q.init();};n.feedData=function(r){this.data=r;};n.initRender=function(){q.initRender();
};n.renderData=function(){var r=this.options.variation;var t=this.data[r+"Acquirers"];if(typeof this.chosenAcquirer==="undefined"){this.chosenAcquirer=t[0];
k.select("#"+r+"AcquirerBarTitle").html(this.chosenAcquirer);k.select("#"+r+"AcquirerButtons").remove();}var s=k.select("#"+r+"AcquirerButtonHolder").selectAll(".acquirerButton").data(t,function(u){return u;
});s.enter().append("div").attr("class",function(u){return"acquirerButton "+(u===n.chosenAcquirer?"csr-button-2 primary":"csr-toggle-button-2");
}).html(function(u){return u;}).on("click",function(u){k.select("#"+r+"AcquirerButtonHolder").selectAll(".acquirerButton").classed({"csr-button-2":false,primary:false,"csr-toggle-button-2":true});
k.select(this).classed({"csr-button-2":true,primary:true,"csr-toggle-button-2":false});k.select("#"+r+"AcquirerBarTitle").html(u);
n.$el.trigger(h.CHART_TO_VIEW_EVENT,{type:"changeAcquirer",data:{acquirer:u,type:r}});});s.exit().remove();};return n;}return b;
});define("chart/widgetFramework/composed/retryreport/nonPercentageBarChart",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/core/mixins/formats","chart/widgetFramework/chartTypes/barChart"],function(c,h,k,b,e,a,f,j,g,i){function d(q,l,o){var n;
var p={};var m=h.defaults(p,q);n=i(m,l,o);var r=f(n);n.init=function(){r.init();};n.renderData=function(){r.renderData();
if(a.falsy(this.data)){this.hideCharts("no data to display");return;}var v=this.barUtils.bars;var s=this.barUtils.transitionTime;
var x=this.barUtils.delayTime;var w=n.scales[n.options.xAttr].tickFormat();var u=n.options.xAttr==="successEurAmount"?"\u20AC ":"";
v.update.select(".bar-label").text(function(z){var y=z[n.options.xAttr];return y<10?y:w(z[n.options.xAttr]);}).style("opacity",0).transition().duration(s).delay(x).style("opacity",1);
v.enter.append("text").attr("class","bar-label").attr("x",-8).attr("y","1.15em").style("text-anchor","end").style("opacity",0).text(function(z){var y=z[n.options.xAttr];
return y<10?y:w(z[n.options.xAttr]);}).transition().duration(s).delay(x).style("opacity",1);v.exit.select(".bar-label").transition().duration(s).style("opacity",0).remove();
if(u!==""){n.prefix(v,s,x,u);}var t=this.data.length*this.options.barHeight+this.options.margin.top+this.options.margin.bottom;
k.select("#"+this.$el[0].id).transition().duration(s).style("height",t+"px");};n.prefix=function(v,s,x,u){var w=0,t=1;v.bar[0].forEach(function(z){var y=Math.round(z.__data__.successEurAmount).toString().length;
if(y>w){w=y;}});switch(w){case 1:t=6.5;break;case 2:t=13;break;case 3:t=19;break;case 4:t=28;break;case 5:t=35;break;case 6:t=41;
break;case 7:t=50;break;case 8:t=56;break;}v.update.selectAll(".bar-label-prefix").transition().duration(s).delay(2*x).attr("x",-t-20);
v.enter.append("text").attr("class","bar-label-prefix").attr("x",-t-20).attr("y","1.0em").style("text-anchor","end").style("opacity",0).text(u).transition().duration(s).delay(x).style("opacity",1);
v.exit.selectAll(".bar-label-prefix").transition().duration(s).style("opacity",0).remove();};return n;}return d;});define("chart/widgetFramework/composed/retryreport/drivers/sankey-minimal-overlap",["jquery","underscore","d3"],function(c,a,b){function d(){var s={},o=24,j=8,r=[1,1],h=[],p=[];
s.nodeWidth=function(t){if(!arguments.length){return o;}o=+t;return s;};s.nodePadding=function(t){if(!arguments.length){return j;
}j=+t;return s;};s.nodes=function(t){if(!arguments.length){return h;}h=t;return s;};s.links=function(t){if(!arguments.length){return p;
}p=t;return s;};s.size=function(t){if(!arguments.length){return r;}r=t;return s;};s.layout=function(t){g();l();k();q(t);f();
return s;};s.relayout=function(){f();return s;};s.link=function(){var u=0.5;function t(A){var x=A.source.x+A.source.dx,w=A.target.x,y=b.interpolateNumber(x,w),z=y(u),v=y(1-u),E=A.source.y+A.sy,D=A.target.y+A.ty,C=A.target.y+A.ty+Math.max(1,A.dy),B=A.source.y+A.sy+Math.max(1,A.dy);
return"M"+x+","+E+"C"+z+","+E+" "+v+","+D+" "+w+","+D+"L"+w+","+C+"C"+v+","+C+" "+z+","+B+" "+x+","+B+"Z";}t.curvature=function(v){if(!arguments.length){return u;
}u=+v;return t;};return t;};function g(){h.forEach(function(t){t.sourceLinks=[];t.targetLinks=[];});p.forEach(function(t){var u=t.source,v=t.target;
if(typeof u==="number"){u=t.source=h[t.source];}if(typeof v==="number"){v=t.target=h[t.target];}u.sourceLinks.push(t);v.targetLinks.push(t);
});}function l(){h.forEach(function(t){t.value=Math.max(b.sum(t.sourceLinks,n),b.sum(t.targetLinks,n));});}function k(){var u=h,y,t=0;
while(u.length){y=[];for(var w=0;w<u.length;w++){u[w].x=t;u[w].dx=o;for(var v=0;v<u[w].sourceLinks.length;v++){y.push(u[w].sourceLinks[v].target);
}}u=y;++t;}m(t);i((r[0]-o)/(t-1));}function m(t){h.forEach(function(u){if(!u.sourceLinks.length){u.x=t-1;}});}function i(t){h.forEach(function(u){u.x*=t;
});}function q(y){var x=b.nest().key(function(C){return C.x;}).sortKeys(b.ascending).entries(h).map(function(C){return C.values;
});v();t();for(var z=1;y>0;--y){B(z*=0.99);t();w(z);t();}function v(){var C=b.min(x,function(D){return(r[1]-(D.length-1)*j)/b.sum(D,n);
});x.forEach(function(D){D.forEach(function(F,E){F.y=E;F.dy=F.value*C;});});p.forEach(function(D){D.dy=D.value*C;});}function w(D){x.forEach(function(E){E.forEach(function(F){if(F.targetLinks.length){var G=b.sum(F.targetLinks,C)/b.sum(F.targetLinks,n);
F.y+=(G-e(F))*D;}});});function C(E){return e(E.source)*E.value;}}function B(D){x.slice().reverse().forEach(function(E){E.forEach(function(F){if(F.sourceLinks.length){var G=b.sum(F.sourceLinks,C)/b.sum(F.sourceLinks,n);
F.y+=(G-e(F))*D;}});});function C(E){return e(E.target)*E.value;}}function t(){var C=x.length;x.forEach(function(E,K){var I,D,H=0,J=E.length,G=0;
if(K===(C-1)){E.sort(A);E.forEach(function(L){G+=L.dy;});G=G+(J-1)*j;D=(r[1]-G)/2;E.forEach(function(L){L.y=D;D=D+L.dy+j;
});}else{E.sort(u);for(var F=0;F<J;++F){I=E[F];D=H-I.y;if(D>0){I.y+=D;}H=I.y+I.dy+j;}D=H-j-r[1];if(D>0){H=I.y-=D;for(F=J-2;
F>=0;--F){I=E[F];D=I.y+I.dy+j-H;if(D>0){I.y-=D;}H=I.y;}}}});}function u(D,C){return D.y-C.y;}function A(D,C){if(D.name<C.name){return 1;
}if(D.name>C.name){return -1;}return 0;}}function f(){h.forEach(function(v){v.sourceLinks.sort(t);v.targetLinks.sort(u);});
h.forEach(function(w){var x=0,v=0;w.sourceLinks.forEach(function(y){y.sy=x;x+=y.dy;});w.targetLinks.forEach(function(y){y.ty=v;
v+=y.dy;});});function t(w,v){if(w.type<v.type){return 1;}if(w.type>v.type){return -1;}if(w.target.y<v.target.y){return -1;
}if(w.target.y>v.target.y){return 1;}}function u(w,v){if(w.type<v.type){return 1;}if(w.type>v.type){return -1;}if(w.source.y<v.source.y){return -1;
}if(w.source.y>v.source.y){return 1;}}}function e(t){return t.y+t.dy/2;}function n(t){return t.value;}return s;}return d;
});define("chart/widgetFramework/composed/ecpReport/ecpLineRollover",["jqueryExtended","underscore","d3","chart/widgetFramework/core/mixins/widgetScales","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/WidgetConstants","util/ObjectSuper","chart/widgetFramework/chartTypes/rollover","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/core/constants/UIConstants"],function(b,j,l,k,a,f,c,g,i,d,h){var e=function(s,m,q,o){var p;
var r={};var n=j.defaults(r,s);p=i(n,m);var t=g(p);p.thinBarWidth=3;p.init=function(){t.init();this.barUtils.barSelectorStr=".bar.ecp-line-rollover";
this.barUtils.barClassStr="bar ecp-line-rollover";};p.feedData=function(v){var u=j.filter(v.chartData,function(w){return w.programName===p.options.dataSubset;
});if(!a.existy(u[0])){return d.HALT_RENDER_PROCESS;}this.data=u[0].history;};p.renderData=function(){var u=this.options.centerBars;
this.barUtils.chartWidth=this.width;this.barUtils.chartHeight=this.height;var v;v=this.barUtils.barPosition(u,this.bandSize,this.getXScale(),this.options.joinAttr);
this.barUtils.containerBarsVertical(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),v).fullBarVertical(this.thinBarWidth,"thin-bar one",null,90).fullBarVertical(this.thinBarWidth,"thin-bar two",null,138).fullBarVertical(this.barSize,"dateStr");
};p.tooltipOnMouseoverAction=function(v,u){this.$el.trigger(h.CHART_TO_VIEW_EVENT,{type:"lineChartRollover",data:v});this.sharedMouseAction(u,0.15,1);
};p.tooltipOnMouseoutAction=function(v,u){this.$el.trigger(h.CHART_TO_VIEW_EVENT,{type:"lineChartRolloverReset",data:v});
this.sharedMouseAction(u,0,0);};p.sharedMouseAction=function(D,A,E){var w=D.find(".dateStr");var z=w.attr("data-id");var C=D.find(".thin-bar");
l.selectAll(C).style("opacity",A);var x=D.find(".thin-bar.two");l.select(x[0]).attr("transform","translate("+(-(this.thinBarWidth/2))+",117)");
var B=D.closest(".csr-panel-content-2");var y=["chargeback-tx","chargeback-rates"],v,u;j.each(y,function(G){v='.line-holder-dot[data-id*="'+z+'"]';
var F=B.find(v);u=l.selectAll(F).style("fill-opacity",E).style("stroke-opacity",E);});};p.positionTooltip=function(y,A,x,z,u,v,B){var w=y.top+x-10-u+(B/2);
var C=((y.right-A-10)+z)-(v/2)-10;return{top:w,left:C};};p.enhanceTooltipData=function(w){var u=l.time.format("%Y-%m-%d");
var z=l.format("0,000");var B=l.format(".2f");if(w.settledCountStartDate){var x=new Date(w.settledCountStartDate);w.settledCountStartDateTT=u(x);
}if(w.settledCountEndDate){var v=new Date(w.settledCountEndDate);w.settledCountEndDateTT=u(v);}w.settledCountTT=z(w.settledCount);
if(w.countStartDate){var y=new Date(w.countStartDate);w.countStartDateTT=u(y);}if(w.countEndDate){var A=new Date(w.countEndDate);
w.countEndDateTT=u(A);}w.countTT=z(w.count);w.rateTT=B(w.rate)+"%";};return p;};return e;});define("chart/widgetFramework/composed/mfpReport/mfpChargebackRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/chartTypes/rollover"],function(c,i,j,a,f,h,g,e,d){var b=function(q,k,o,m){var n;
var p={};var l=i.defaults(p,q);n=d(l,k);var r=g(n);n.feedData=function(t){var s=i.filter(t.chartData,function(u){return u.programName===n.options.dataSubset;
});if(!a.existy(s[0])){return e.HALT_RENDER_PROCESS;}this.data=s[0];};n.setTooltipsOnElements=function(){r.setTooltipsOnElements(true);
};n.enhanceTooltipData=function(t){var s=j.format(".2f");var u=j.format("0,000");t.valueTT=(a.existy(t.rate))?s(t.rate)+"%":u(t.count)+" EUR";
};n.hideCharts=function(s){};n.getData=function(){return this.data.barData;};n.getYScale=function(){var s=j.scale.ordinal().rangeBands([this.height,0],this.options.barPadding).domain(["rate","amount"]);
return s;};return n;};return b;});define("chart/widgetFramework/composed/transactionsDashboard/rollovers/txHeatmapRollover",["jqueryExtended","underscore","d3","util/Functional","util/ObjectSuper","chart/widgetFramework/composed/transactionsDashboard/views/txHeatmap"],function(f,a,d,b,c,g){function e(m,h){var j;
var l={};var i=a.defaults(l,m);j=g(i,h);var n=c(j);var k=false;j.init=function(){n.init();this.selectorStr=".block.tx-heatmap-rollover";
this.barClassStr="block tx-heatmap-rollover";};j.feedData=function(o){n.feedData(o);};j.initRender=function(){n.initRender();
this.colorScale=null;this.horizBarSize=this.gridSize;this.$el.find(".chartbase-svg").css("background-color","rgba(0,0,0,0)");
};j.renderData=function(){if(b.falsy(this.data)&&!k){return;}var p=this.selectorStr;var r=this.chartGroup.selectAll(p).data(this.data);
var q=r;var o=r.enter().append("rect").attr("class",function(){return j.barClassStr;}).attr("x",function(t,s){return((t[j.xDimension])*j.gridSize);
}).attr("y",function(s){return j.getYPos(s)-1;}).attr("width",this.gridSize).attr("height",this.gridSize);k=true;};j.enhanceTooltipData=function(o){o.countTT=d.format("0,000")(o.count);
};return j;}return e;});define("chart/widgetFramework/composed/shopperdna/formatters/shopperDnaLegendFormatter",["lodash"],function(b){function a(d){var c=this;
c.data=d;c.formattedData={};c.formatData=function(){var e=b.chain(c.data).map(c.formatPayment).value();c.formattedData=e;
return c.formattedData;};c.formatPayment=function(e){var f={pspreference:b.get(e,"pspreference"),laststatus:b.get(e,"laststatus"),euramount:b.get(e,'eventmetrics["Amount.euramount"]'),linkingidentifiers:c.getLinkingIdentifiers(e),eventidentifiers:c.getEventIdentifiers(e)};
return f;};c.getLinkingIdentifiers=function(e){var f=b.map(e.linkingidentifiers,function(g){return{name:g.fieldcode,value:g.value};
});return f;};c.getEventIdentifiers=function(f){var e=b.map(f.eventidentifiers,function(h,g){return{name:g,value:h};});return e;
};}return a;});define("chart/widgetFramework/composed/harpReportBuilderV2/harpReportBuilderFormatter",["jqueryExtended","underscore"],function(c,a){function b(e,d){this.data=e;
this.options=d;this.formattedData={};}b.prototype.formatData=function(){if(a.has(this.data,"action")&&(this.data.action==="Description Exists")){return this.data;
}if(a.has(this.data,"action")&&(this.data.action==="New Tree"||this.data.action==="Get Tree")){return this.createTreeStructure(this.data);
}if(a.has(this.data,"action")&&(this.data.action==="Delete Tree")){return this.data;}if(this.data.action==="updateExplanation"&&this.data.success){return;
}if(this.data.error){return[{error:this.data.error}];}};b.prototype.createTreeStructure=function(i){var f=this.data.nodes;
this.data.possibleNewDimensions=this.sortDimensionValues(this.data.possibleNewDimensions);a.each(this.data.possibleNewDimensions,function(j){a.each(j.dimensions,function(l){var k=[];
var n=l.values;for(var m=0;m<n.length;m++){k.push({index:m,name:n[m].value});}l.values=k;l.title=l.name;if(n.length!==0){l.title=n[0].dimensionTitle;
}});});var e=a.findWhere(f,{parentNodeId:0});var d=a.findWhere(this.data.possibleNewDimensions,{nodeId:String(e.harpNodeId)});
var h=i.scheduling;var g=a.where(f,{parentNodeId:e.harpNodeId});e.allData={possibleNewDimensions:d,isTemplate:this.data.isTemplate,schedulingStatus:h.status,schedulingDate:h.firstDataStartDate,treeName:this.data.treeName,treeId:this.data.treeId,explanation:(e.explanation)?e.explanation:false,isRoot:true,noChildren:(g.length<=0),nodeId:e.harpNodeId};
this.processChildren(e,this.data);return[e];};b.prototype.setRawData=function(d){if(this.data&&a.has(d,"action")&&d.action==="New Split"){this.data=this.mergeWithExistingData(this.data,d);
return;}if(this.data&&a.has(d,"action")&&d.action==="Delete Nodechildren"){if(!d.nodeId){var e=a.first(d.nodes).parentNodeId;
d.nodeId=e;}this.data=this.removeDimensionFromData(this.data,d);return;}if(this.data&&a.has(d,"action")&&d.action==="Update Tree"){this.data.treeName=d.treeName;
return;}if(this.data&&a.has(d,"action")&&d.action==="Update Node"){return;}if(this.data&&a.has(d,"action")&&d.action==="Schedule Report"){return;
}if(this.data&&a.has(d,"action")&&d.action==="Description Exists"){return;}this.data=d;};b.prototype.removeDimensionFromData=function(f,e){var g=e.nodeId;
var d=this.findNode(f,g);d.children=[];f.action=e.action;return f;};b.prototype.mergeWithExistingData=function(g,e){var d=this;
var h=parseInt(e.parentNodeId);var f=this.findNode(g,h);f.children=e.nodes;f.allData.noChildren=false;a.map(f.children,function(i){d.addNodeMetaData(i,e);
});g.action=e.action;return g;};b.prototype.findNode=function(g,h){if(a.isArray(g)){for(var j=0;j<g.length;j++){var e=g[j];
var d=this.findNode(e,h);if(d){return d;}}}if(g.nodes){for(var i=0;i<g.nodes.length;i++){var f=g.nodes[i];if(f&&f.harpNodeId===h){return f;
}if(f.children){return this.findNode(f.children,h);}}}else{if(g.harpNodeId===h){return g;}else{if(g.children){return this.findNode(g.children,h);
}}}};b.prototype.addNodeMetaData=function(f,j){var e=(f.harpNodeId)?f.harpNodeId:"";j.possibleNewDimensions=this.sortDimensionValues(j.possibleNewDimensions);
var g=a.findWhere(j.possibleNewDimensions,{nodeId:e.toString()});var n=g.dimensions;for(var o=0;o<n.length;o++){var i=n[o];
var d=[];var m=i.values;for(var k=0;k<m.length;k++){d.push({index:k,name:m[k].value});}i.title=i.name;if(m.length){i.title=m[0].dimensionTitle;
}i.values=d;}f.allData={possibleNewDimensions:g,isRoot:false,explanation:(j.explanation)?j.explanation:false,treeId:j.treeId,noChildren:true,harpNodeId:f.harpNodeId,nodeId:f.harpNodeId,dimensionType:f.dimensionType,dimensionTitle:f.name};
if(typeof(f.dimensionValues)!=="undefined"){if(f.dimensionValues.length>0){var l=[];for(var o=0;o<f.dimensionValues.length;
o++){var h={name:f.dimensionValues[o]};l.push(h);}if(l.length>1){f.allData.dimensionValues=l;f.allData.hasDimensionValues=true;
}}}};b.prototype.sortDimensionValues=function(d){return a.map(d,function(e){return{title:e.title,nodeId:e.nodeId,dimensions:a.map(a.sortBy(e.dimensions,function(f){return f.name.toString().toLowerCase();
}),function(f){return{name:f.name,values:a.sortBy(f.values,function(g){if(typeof(g.dimensionTitle)!=="undefined"){return g.dimensionTitle.toString().toLowerCase();
}else{return g.dimensionTitle;}})};})};});};b.prototype.processChildren=function(f,k){var e=a.where(k.nodes,{parentNodeId:f.harpNodeId});
if(e.length<1){return false;}f.children=[];for(var i=0;i<e.length;i++){var d=e[i];var h=a.findWhere(k.possibleNewDimensions,{nodeId:String(d.harpNodeId)});
var m=a.where(k.nodes,{parentNodeId:d.harpNodeId});d.allData={possibleNewDimensions:h,isRoot:false,treeId:k.treeId,explanation:(d.explanation)?d.explanation:false,noChildren:(m.length<=0),nodeId:d.harpNodeId,dimensionType:d.dimensionType,dimensionTitle:d.name,isGroup:d.dimensionValues.length>1};
if(typeof(d.dimensionValues)!=="undefined"){if(d.dimensionValues.length>0){var j=[];for(var l=0;l<d.dimensionValues.length;
l++){var g={name:d.dimensionValues[l]};j.push(g);}if(j.length>1){d.allData.dimensionValues=j;d.allData.hasDimensionValues=true;
}}}f.children.push(d);this.processChildren(d,k);}};return b;});define("chart/widgetFramework/composed/cardAcquirerAuthorizationReport/cardAcquirerMediator",["jqueryExtended","d3","underscore","chart/widgetFramework/core/BasicMediator","util/ObjectSuper","chartutil/numberutils","chartutil/cssutils","chartutil/stringutils","Constants"],function(a,j,f,e,d,g,i,c,b){function h(k){var l;
l=e(k,true);var m=d(l);l.init=function(){m.init();l.rankedChartID="Rate";this.$sortButtonRefAcquirer=a("#acquirerBarRateTitle");
this.$sortButtonRefAcquirerAccount=a("#acquirerAccountBarRateTitle");this.$sortButtonRefMerchant=a("#merchantBarRateTitle");
this.$sortButtonRefPaymentMethod=a("#paymentMethodBarRateTitle");this.$sortButtonRefIssuerCountry=a("#issuerCountryBarRateTitle");
this.$sortButtonRefBIN=a("#binBarCountTitle");this.actionCommanderExclusionArray=["actioncommander","timeline"];};l.getAdditionalDOMElements=function(){m.getAdditionalDOMElements();
this.timelineInstances=[];this.$allTimelines=k.__$node.find("[data-widget*=Timeline]");this.totalDomElements+=this.$allTimelines.length;
};l.getWidgets=function(){m.getWidgets();this.getWidgetInstances(this.$allTimelines,this.timelineInstances,"Timelines");};
l.onNotifiedFetcher=function(n,y){m.onNotifiedFetcher(n,y);var t,w;if(y==="activeIssuerCountriesFetcher"){var s="",A=this.$el.find("#issuerCountry"),v="";
f.each(n.changeObject.data,function(B){if(l.storedIssuerCountries&&l.storedIssuerCountries.indexOf(B.countryCode)>-1){v+=(","+B.countryCode);
}s+='<li><label class="csr-label-2 checkbox"><input type="checkbox" class="csr-input-checkbox-2" value="'+B.countryCode+'" data-value-group="issuerCountryId"/>'+c.capitaliseAllFirstLetters(B.countryName)+"</label></li>";
});A.html(s);if(v.length){var u=v.split(",");for(t=1,w=u.length;t<w;t++){a("#issuerCountry").find('[value="'+u[t]+'"]').prop("checked",true).parent().addClass("selected");
}var o=f.filter(n.changeObject.data,function(B){return B.countryCode===u[u.length-1];});var z=c.capitaliseAllFirstLetters(o[0].countryName);
a("#issuerCountry").closest("div").find("span").text(z);}}if(y==="activePaymentMethodsFetcher"){var x="",p=this.$el.find("#paymentMethod"),r="";
f.each(n.changeObject.data,function(B){if(l.storedPaymentMethods&&l.storedPaymentMethods.indexOf(B)>-1){r+=(","+B);}x+='<li><label class="csr-label-2 checkbox"><input type="checkbox" class="csr-input-checkbox-2" value="'+B+'" data-value-group="paymentMethodId"/>'+B+"</label></li>";
});p.html(x);if(r.length){var q=r.split(",");for(t=1,w=q.length;t<w;t++){a("#paymentMethod").find('[value="'+q[t]+'"]').prop("checked",true).parent().addClass("selected");
}a("#paymentMethod").closest("div").find("span").text(q[q.length-1]);}}};l.onNotifiedFormatter=function(q,p){m.onNotifiedFormatter(q,p);
if(q.changeObject.data&&p==="acquirerBarFormatter"){l.renderTotals(q.changeObject.data.chartData);}var r,u,s,t,o,n;if(p==="acquirerBarFormatter"){this.$el.find(".acquirer-grouped-bar-chart .chart-elements-holder").each(function(){j.select(a(this)[0]).classed("barchart-ranked",false);
});j.selectAll("#acquirer"+l.rankedChartID+"BarChart .chart-elements-holder").classed("barchart-ranked",true);r=this.getInstanceById("#acquirerBarFormatter");
s=this.$sortButtonRefAcquirer.find(".arrow")[0];}else{if(p==="acquirerAccountBarFormatter"){this.$el.find(".acquirer-account-grouped-bar-chart .chart-elements-holder").each(function(){j.select(a(this)[0]).classed("barchart-ranked",false);
});j.selectAll("#acquirerAccount"+l.rankedChartID+"BarChart .chart-elements-holder").classed("barchart-ranked",true);r=this.getInstanceById("#acquirerAccountBarFormatter");
s=this.$sortButtonRefAcquirerAccount.find(".arrow")[0];}else{if(p==="merchantBarFormatter"){this.$el.find(".merchant-grouped-bar-chart .chart-elements-holder").each(function(){j.select(a(this)[0]).classed("barchart-ranked",false);
});j.selectAll("#merchant"+l.rankedChartID+"BarChart .chart-elements-holder").classed("barchart-ranked",true);r=this.getInstanceById("#merchantBarFormatter");
s=this.$sortButtonRefMerchant.find(".arrow")[0];}else{if(p==="paymentMethodBarFormatter"){this.$el.find(".payment-method-grouped-bar-chart .chart-elements-holder").each(function(){j.select(a(this)[0]).classed("barchart-ranked",false);
});j.selectAll("#paymentMethod"+l.rankedChartID+"BarChart .chart-elements-holder").classed("barchart-ranked",true);r=this.getInstanceById("#paymentMethodBarFormatter");
s=this.$sortButtonRefPaymentMethod.find(".arrow")[0];}else{if(p==="issuerCountryBarFormatter"){this.$el.find(".issuer-country-grouped-bar-chart .chart-elements-holder").each(function(){j.select(a(this)[0]).classed("barchart-ranked",false);
});j.selectAll("#issuerCountry"+l.rankedChartID+"BarChart .chart-elements-holder").classed("barchart-ranked",true);r=this.getInstanceById("#issuerCountryBarFormatter");
s=this.$sortButtonRefIssuerCountry.find(".arrow")[0];}else{if(p==="binBarFormatter"){this.$el.find(".bin-grouped-bar-chart .chart-elements-holder").each(function(){j.select(a(this)[0]).classed("barchart-ranked",false);
});j.selectAll("#bin"+l.rankedChartID+"BarChart .chart-elements-holder").classed("barchart-ranked",true);r=this.getInstanceById("#binBarFormatter");
s=this.$sortButtonRefBIN.find(".arrow")[0];}}}}}}if(r){u=r.getSortDirection();t=(u)?180:0;o=(u)?-0.5:0.5;n=(u)?1:-0.5;i.rotateElement2(s,t,o,n);
}};l.onNotifiedViewCreator=function(o,n){m.onNotifiedViewCreator(o,n);};l.onTimeData=function(){if(a("#issuerCountryInput").val()!==""){this.storedIssuerCountries=a("#issuerCountryInput").val();
}else{this.storedIssuerCountries=null;a("#issuerCountry").closest("div").find("span").text("Select value");}if(a("#paymentMethodInput").val()!==""){this.storedPaymentMethods=a("#paymentMethodInput").val();
}else{this.storedPaymentMethods=null;a("#paymentMethod").closest("div").find("span").text("Select value");}};l.toggleAcquirerAccountBarChart=function(){var o=a("#acquirer-account-rate-toggle");
var p=a("#acquirerAccountBarContent");var q="Show chart";var n="Hide chart";p.slideToggle();if(o.text()===q){o.text(n);}else{o.text(q);
}};l.sortData=function(o,n){if(o==="authorizationRate"){l.rankedChartID="Rate";}else{if(o==="authorizedCount"){l.rankedChartID="Count";
}else{if(o==="labelName"){l.rankedChartID="None";}}}if(n.attr("id").indexOf("acquirerAccount")>-1){this.$sortButtonRefAcquirerAccount=n;
}else{if(n.attr("id").indexOf("acquirer")>-1){this.$sortButtonRefAcquirer=n;}else{if(n.attr("id").indexOf("merchant")>-1){this.$sortButtonRefMerchant=n;
}else{if(n.attr("id").indexOf("paymentMethod")>-1){this.$sortButtonRefPaymentMethod=n;}else{if(n.attr("id").indexOf("issuerCountry")>-1){this.$sortButtonRefIssuerCountry=n;
}else{if(n.attr("id").indexOf("bin")>-1){this.$sortButtonRefBIN=n;}}}}}}};l.renderTotals=function(q){var n=j.format(",.0f");
var p=j.format(".2f");var o={receivedCount:0,authorizedCount:0};f.each(q,function(r){o.receivedCount+=r.receivedCount;o.authorizedCount+=r.authorizedCount;
});o.authorizedRate=o.receivedCount>0?o.authorizedCount/o.receivedCount*100:0;g.animateValue(a("#totalReceivedAcquirerCount"),o.receivedCount,n);
g.animateValue(a("#authCountTotal span"),o.authorizedCount,n);g.animateValue(a("#authRateTotal span"),o.authorizedRate,p);
};l.getInstance=function(){return this;};l.init();k.ready();return l;}return h;});define("chart/widgetFramework/composed/retryreport/rollovers/groupedBarRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/chartTypes/rollover"],function(c,i,j,a,f,h,g,e,d){function b(o,k){var m;
var n={};var l=i.defaults(n,o);m=d(l,k);var p=g(m);m.getYScale=function(){var r=i.pluck(this.data,this.options.joinAttr);
var q=j.scale.ordinal().rangeBands([this.height,0],this.options.barPadding).domain(r);return q;};m.update=function(){var q=this.$el.height();
var r=this.$el.width();if(this.options.barHeight!==null){this.height=(this.data.length*this.options.barHeight);q=this.height+this.options.margin.top+this.options.margin.bottom;
}j.select("#"+this.$el[0].id).style("height",q+"px");this.topSVG.attr("width",r+"px").attr("height",q+"px");p.update();};
m.hideCharts=function(q){};return m;}return b;});define("chart/widgetFramework/composed/chargebackReport/formatters/masterFormatter",["lodash","chartutil/d3utils","chartutil/dateUtils_CET","util/Functional"],function(a,d,e,c){function b(h,f,g){this.data=h;
this.timeline=g;}b.prototype.formatData=function(){var f=[];var l=(this.data&&a.has(this.data,"overall_statistics"))?this.data.overall_statistics:{};
if(window.console&&console.log){console.log("### masterFormatter::formatData:: rawData=",l);}if(c.falsy(l)){return[];}if(a.isArray(l)){var g=l;
var k=this.timeline.getGranularity();var h=this.timeline.getDates();var i=1;var j=new Date(h[1].getFullYear(),h[1].getMonth(),h[1].getDate()-i);
f=this.fillGaps(g,k,[h[0],j]);}return f;};b.prototype.fillGaps=function(f,h,g){a.map(f,function(j){j.dateStr=j.date;var i=new Date(j.dateStr);
j.date=e.trueRoundToDay(i,true);});return f;};b.prototype.setRawData=function(f){this.data=f;};return b;});define("chart/widgetFramework/components/Snapshot",["jqueryExtended","underscore","d3","chartutil/svgutils","timeline/util/timelineConstants","ui/UIConstants"],function(g,c,f,e,b,d){var a=function(h){var i={};
i.init=function(){var j=h.getNode();var n=this.getParameters(h);var k=n.options;this.id=j.attr("id");this.$el=j;this.snapshotEl=k.snapshotEl;
this.styleSheets=k.styleSheets;this.title=(k.title)?k.title:"chartImage";this.htmlStr=(k.htmlStr)?k.htmlStr:"";this.htmlWidth=(k.htmlWidth)?k.htmlWidth:0;
var m=k.timeline;var l=g(m);l.widget().then(function(o){var p=o.instance;p.renderPromise.done(function(){i.timeline=p.timeline;
});});};i.getParameters=function(j){var m=j.getNode().data();var k;if(c.keys(m).length){k=m;}else{j.parameters.options=g.parseJSON(j.parameters.options);
k=j.parameters;}var l={};if(c.keys(k).length){l.options=k.options;}else{throw"The parameters are not well defined"+k;}return l;
};i.setActionCommander=function(j){this.ac=j;};i.getInstance=function(){return this;};i.takeSnapshot=function(l){var k;var m;
var n=this.title;if(this.timeline){k=f.time.format(b.__FORMAT_DATE)(this.timeline.getDates()[0]);var j=new Date(this.timeline.getDates()[1]);
j.setDate(j.getDate()-1);m=f.time.format(b.__FORMAT_DATE)(j);}if(this.timeline){n+=": "+k+" - "+m;}e.svgToPng(this.snapshotEl,this.styleSheets,n,this.title,this.htmlStr,this.htmlWidth);
};i.setHtmlStr=function(j){this.htmlStr=j;};i.init();h.ready();return i;};return a;});define("chart/widgetFramework/composed/transactionsDashboard/views/granularAuthTxStack",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/chartTypes/stackedBar","chart/widgetFramework/composed/transactionsDashboard/views/granularXAxisCode"],function(d,g,k,c,e,b,f,i,h,j){var a=function(o,q,t,s){var p,r,l;
var m={};var u=g.defaults(m,o);p=h(u,q,t);var n=f(p);j(p);p.renderData=function(){n.renderData();p.renderReceivedTxLabels();
};p.renderReceivedTxLabels=function(){var v=this.scales[this.options.yAttr];var w=function(y){var C=g.findLast(p.data,function(D){return D.authorizedCount!==0&&D.refusedCount!==0;
});var x=(C)?C[p.nestedAttr][y].startY:0;var A=(C)?C[p.nestedAttr][y].endY:0;var z=((A-x)/2)+x;var B=v(z);return B;};if(!r&&!l){r=this.chartGroup.append("text").attr("class","authorized").text("Authorized").attr("dy",".35em");
l=this.chartGroup.append("text").attr("class","refused").text("Refused").attr("dy",".35em");}if(this.data.length>1){r.attr("x",this.width+20);
l.attr("x",this.width+20);}else{r.attr("x",u.width-260);l.attr("x",u.width-260);}if((w(0)-20)<w(1)){r.attr("y",(w(0)+15));
}else{r.attr("y",w(0));}l.attr("y",w(1));};return p;};return a;});define("chart/widgetFramework/composed/riskReport/formatters/barFormatter",["jqueryExtended","underscore","d3","chart/widgetFramework/core/constants/DataConstants","chartutil/dateUtils_CET","chartutil/d3utils"],function(h,b,d,e,g,c){function a(k,i,j){this.data=k;
this.options=i;this.formattedData={};this.comparator=this.compareFunction;this.reverseDirection=false;this.sortKey=null;this.timeline=j;
}a.prototype.formatData=function(){var j=this.data.dataObject;var i=this.calculateMetaData(j);if(this.sortKey){this.reverseDirection=!this.reverseDirection;
this.sortData(this.sortKey,true);}if(window.console&&console.log){console.log("### barFormatter::formatData:: formattedData=",i);
}return i[this.options.barDataId];};a.prototype.calculateMetaData=function(l){var j=[];var i=[];var k=[];var m=[];b.each(l,function(n){j.push({date:n.date,average:(n.authorisedCount>0)?n.authorisedEurAmount/n.authorizedCount:0});
i.push({date:n.date,average:(n.refusedByRiskCount>0)?n.refusedByRiskEurAmount/n.refusedByRiskCount:0});k.push({date:n.date,average:(n.refusedByBankCount>0)?n.refusedByBankEurAmount/n.refusedByBankCount:0});
m.push({data:n.date,average:(n.chargebackCount>0)?n.chargebackEurAmount/n.chargebackCount:0});});return{averageTransactionValues:[{name:"Authorized",lineValues:j},{name:"Refused by RevenueProtect",lineValues:i},{name:"Refused by bank",lineValues:k},{name:"Chargeback",lineValues:m}]};
};var f=function(i){return i;};a.prototype.sortData=function(i,k){this.sortKey=i;this.reverseDirection=!this.reverseDirection;
var j=b.sortBy(this.formattedData,i);if(this.reverseDirection){j.reverse();}this.formattedData=j;if(k===true){return;}this.$el.trigger(e.FORMATTER_INFORM_WIDGET,{type:e.SORTED_DATA,data:this.formattedData});
};a.prototype.compareFunction=function(i){return i[this.sortKey];};a.prototype.getData=function(){return(this.data)?this.data:this.formatData();
};a.prototype.setRawData=function(i){this.data=i;};a.prototype.retrieveData=function(i){return this.data[i];};a.prototype.setOptions=function(i){this.options=i;
};return a;});define("chartutil/backbone/deferredcollection",["jquery","underscore","backbone"],function(c,b,d){var a=d.Collection.extend({constructor:function(){b.bindAll(this,"reset","onLoaded","getLoaded");
this.reset();d.Collection.apply(this,arguments);},reset:function(){this.loaded=c.Deferred();},onLoaded:function(){this.loaded.resolve();
},getLoaded:function(){return this.loaded.promise();}});return a;});define("chart/widgetFramework/composed/cardAcquirerAuthorizationReport/formatters/acquirerBarFormatter",["jqueryExtended","underscore","d3","chart/widgetFramework/core/constants/DataConstants"],function(e,b,c,d){function a(j,g,i,l){var h={};
h.data=j;h.options=g;h.formattedData={};h.comparator=null;h.reverseDirection=false;h.sortKey="authorizationRate";h.timeline=i;
h.id=l;h.formatData=function(){var m=this.data.acquirer_aggregation?this.data.acquirer_aggregation:{};if(m.length===0){return[];
}this.formattedData=k(m);if(this.sortKey){this.reverseDirection=!this.reverseDirection;this.sortData(this.sortKey,true);}return{chartData:this.formattedData};
};var k=function(o){var n=[];o=b.filter(o,function(p){return p.acquirer!=="RefusedAcquirer"&&typeof p.acquirer!=="undefined"&&!(b.isNull(p.acquirer));
});o=b.filter(o,function(p){return +p.authorisedCount>0&&+p.authRate>0;});var m=c.sum(o,function(p){return +p.authorisedCount;
});b.each(o,function(r){var q=+r.authRate*100,p=100-q;n.push({labelName:f(r.acquirer),receivedCount:+r.receivedCount,authorizedCount:+r.authorisedCount,authorizedCountShare:m===0?0:+r.authorisedCount/m*100,authorizedEurAmount:+r.authorisedAmount/100,authorizationRate:q,authRate:[{name:"authorized",value:q,startX:0,endX:q},{name:"refused",value:p,startX:q,endX:100}],total:100,name:"authorized"});
});return n;};var f=function(m){return m.replace(/_/g," ");};h.sortData=function(m,o){this.sortKey=m;if(this.sortKey===this.oldSortKey){this.reverseDirection=!this.reverseDirection;
}else{this.reverseDirection=false;}this.oldSortKey=this.sortKey;var n=b.sortBy(this.formattedData,m);if(this.reverseDirection){n.reverse();
}this.formattedData=n;if(o===true){return;}this.$el.trigger(d.FORMATTER_INFORM_WIDGET,{type:d.SORTED_DATA,data:{chartData:this.formattedData}});
};h.compareFunction=function(m){return m[this.sortKey];};h.getData=function(){return(this.data)?this.data:this.formatData();
};h.setRawData=function(m){this.data=m;};h.retrieveData=function(m){return this.data[m];};return h;}return a;});define("chart/widgetFramework/composed/harpReportBuilderV2/HarpBuilderMediator",["jqueryExtended","underscore","ui/UIConstants","chart/widgetFramework/core/constants/DataConstants","util/Implement","chart/widgetFramework/core/BasicMediator","Constants"],function(a,h,f,i,d,g,c){var b=function(j){this.actionCommanderInstances=[];
this.snapshotInstances=[];var k=j.getNode();this.$actionCommanders=k.find("[data-widget*=ActionCommander]");this.$allSnapshots=k.find("[data-widget*=Snapshot]");
g.apply(this,arguments);this.dialogShown=false;this.totalDomElements+=this.$actionCommanders.length+this.$allSnapshots.length;
};b.prototype.getWidgets=function(){this.getWidgetInstances(this.$actionCommanders,this.actionCommanderInstances,"ActionCommander");
this.getWidgetInstances(this.$allSnapshots,this.snapshotInstances,"Snapshot");};b.prototype.setUpOwnEvents=function(k){g.prototype.setUpOwnEvents.call(this,k);
if(this.allInstances.length-1!==this.totalDomElements){return;}var j=this;h.each(this.actionCommanderInstances,function(l){l.pushAllInstances(j.chartInstances.concat(j.snapshotInstances).concat(j.fetcherInstances).concat(j));
});};b.prototype.onNotifiedFetcher=function(k,j){if(k.changeObject.type==="newDataAvailable"&&h.has(k.changeObject.data,"descriptionExists")){if(k.changeObject.data.descriptionExists){a(".pg-observed-input").addClass("pg-input-error").siblings("button").removeClass("rename-button--available").addClass("rename-button--unavailable");
}else{a(".pg-observed-input").removeClass("pg-input-error").siblings("button").removeClass("rename-button--unavailable").addClass("rename-button--available");
a(".pg-observed-button").trigger("clickConfirmed");}}else{if(k.changeObject.type==="newDataAvailable"&&h.has(k.changeObject.data,"action")){var l=k.changeObject.data;
this.action=l.action;this.updateUI(l);this.updateSchedulingUi(l);}}};b.prototype.updateUI=function(n){if(n.action==="New Tree"){a("#harpTreePicker").append('<option value ="'+n.treeId+'">'+n.treeName+"</option>");
a("#treeName").val(n.treeName);a("#step2_toggle,#step3_toggle").css({"pointer-events":"all"});a("#step2_toggle").slideDown();
a(".dimension-selector, .icon-times").removeClass("inactive").addClass("active");}if(n.action==="Get Tree"){a(".dimension-selector, .icon-times").removeClass("active").addClass("inactive");
a("#step2_toggle,#step3_toggle").css({"pointer-events":"all"});if(n.pspVisibleOnly===true){a("#permission_switch_container").removeClass("switch-off").addClass("switch-on");
}a("#treeName").val(n.treeName);a("#pg-obscuring-screen").hide();}if(n.action==="Delete Tree"){a("path, .link, .harpnode").remove();
a("#harpTreePicker option[value='"+n.treeId+"']").remove();a("#harpTreePicker").val("-1");a("#step2_toggle, #step3_toggle").css({"pointer-events":"none"});
}if(n.action==="Update Tree"){var l=n.treeName;var m=n.treeId;if(n.isTemplate){a("#harpTemplatePicker").append('<option value ="'+m+'">'+l+"</option>");
a("#message").text("Template Named "+l+" has been created!").fadeIn(1000,function(){var o=a(this);setTimeout(function(){o.fadeOut(2000);
},1000);});}else{if(n.treeName!==a("#treeName").val()){a("#message").text("Tree has been succesfully renamed to: "+l).fadeIn(1000).delay(1000).fadeOut(2000);
}else{a("#message").text("Psp Visibility for this tree has changed to: "+((a("#permissionSwitch").attr("checked"))?"true":"false")).fadeIn("slow").delay("1000").fadeOut("slow");
}a(".tree-header").text(l);a("#treeName").val(l);a("#edit_controller").slideUp();a("#harpTreePicker option[value='"+n.treeId+"']").text(l);
}}if(n.action==="New Split"){var k=a("#hn_"+n.parentNodeId);k.addClass("pg-parent-node").removeClass("pg-end-node").find(".button-container .button-content").css("display","block");
a("#pg-obscuring-screen").hide();}if(n.action==="Delete Nodechildren"){a("#hn_"+n.possibleNewDimensions[0].nodeId).removeClass("pg-parent-node").addClass("pg-end-node");
this.$el.trigger("deleteNodeChildren",{data:n});}if(n.action==="Update Node"){a("#harp-dialog-overlay").hide();var j={};j.message="Note saved";
j.containerClass="success";j.iconClass="icon-adyen-activate";this.showNotification(j);}};b.prototype.updateSchedulingUi=function(l){var j=new Date();
if(h.has(l,"action")&&l.action==="Schedule Report"){j.setTime(l.schedulingDate);var k=j.toFormattedString("yyyy-mm-dd").split(" ")[0];
a("#schedule_msg").text("Scheduling Report starting from "+k);a("#datepickStart").val(k).text(k);a(".harp-edit-button").removeClass("harp-enabled").addClass("harp-disabled").attr("disabled",true);
a(".availability-message").show();a(".dimension-selector, .icon-times").addClass("deactivate-scheduling");a("#showSchedulingDialog").attr("disabled",true);
a("#harp-dialog-overlay").hide();return;}if(l.scheduling&&l.scheduling.status==="no data"){j=e(l.scheduling);a("#schedule_msg").text("Not Scheduled");
a(".harp-edit-button").removeClass("harp-disabled").addClass("harp-enabled").attr("disabled",false);a(".availability-message").hide();
a("#showSchedulingDialog").attr("disabled",false);a("#datepickStart").val(j).text(j);return;}if(l.scheduling&&l.scheduling.status==="runnning"){j=e(l.scheduling);
a("#schedule_msg").text("Scheduling Report starting from "+j);a(".harp-edit-button").removeClass("harp-enabled").addClass("harp-disabled").attr("disabled",true);
this.action="Under Schedule";}if(l.scheduling&&l.scheduling.status==="completed"){j=e(l.scheduling);a("#schedule_msg").text("This report is already scheduled containg data from: "+j);
a(".dimension-selector, .icon-times").removeClass("deactivate-scheduling").addClass("active");a("#showSchedulingDialog").attr("disabled",false);
}};function e(k){var j=new Date();if(k.status==="no data"){j.setTime((new Date()).setDate((new Date()).getDate()-2));}else{j.setTime(k.firstDataStartDate);
}return j.toFormattedString("yyyy-mm-dd").split(" ")[0];}b.prototype.getInstance=function(){return this;};b.prototype.setActionCommander=function(j){this.actionCommander=j;
};b.prototype.onNotifiedViewCreator=function(k,j){a("[id^=valueSelectorCarrier]").on("mousewheel",function(){event.stopPropagation();
});if(this.action==="New Split"||this.action==="New Tree"){a(".dimension-selector, .icon-times").removeClass("inactive").addClass("active");
}if(this.action==="Under Schedule"){a(".dimension-selector, .icon-times").addClass("deactivate-scheduling");}this.$el.trigger(c.EV_CONTENT_MERGED);
if(k.changeObject.type==="chartRendered"){h.each(this.actionCommanderInstances,function(m){var l=h.cloneDeep(m.events);var n=l.splice(20);
m.unbindEvents(n);m.setUpEvents(n);});}};b.prototype.forceRebindGlobal=function(){h.each(this.actionCommanderInstances,function(k){var j=h.cloneDeep(k.events);
var l=j.splice(20);k.unbindEvents(l);k.setUpEvents(l);});};b.prototype.forceRebindTargeted=function(j){var k=[];h.each(j,function(l){k.push(l.source);
});h.each(this.actionCommanderInstances,function(p){var l=h.cloneDeep(p.events);var q=[];for(var o=l.length;o>0;o--){var n=l[o-1];
if(k.indexOf(n.source)!==-1){var m=k.indexOf(n.source);if(typeof(j[m].eventType)==="object"){if(n.source===j[m].source&&j[m].eventType.indexOf(n.event)!==-1){q.push(n);
}}else{if(n.source===j[m].source&&j[m].eventType===n.event){q.push(n);}}}}p.unbindEvents(q);p.setUpEvents(q);});};b.prototype.showNotification=function(l){window.clearTimeout(window.errormessage);
var m=l.message;var k=l.containerClass;var j=l.iconClass;var o="<div class='csr-notification-message-2 "+k+"'> <ul><li><i class=' "+j+" '></i>"+m+"</li></ul></div>";
var p=a("#message");var n=a("#message-container");p.html(o);p.addClass(k);n.addClass("pg-shown");p.fadeIn("fast",function(){window.errormessage=setTimeout(function(){p.fadeOut("slow",function(){p.html("");
p.removeClass(k);n.removeClass("pg-shown");});},2000);});};d.fromTo(g,b);return b;});define("chart/widgetFramework/composed/chargebackReport/rollovers/cfnRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/chartTypes/rollover"],function(c,i,j,a,f,h,g,e,d){var b=function(q,k,o,m){var n;
var p={};var l=i.defaults(p,q);n=d(l,k);var r=g(n);n.positionTooltip=function(w,y,v,x,s,t,z){var u=w.top+v-10-s+(z/2);var A=((w.left+y+10)-x)+(t);
return{top:u,left:A};};return n;};return b;});define("chart/widgetFramework/composed/shopperdna/formatters/shopperDnaBarChartFormatter",["lodash","d3","timeline/util/timelineConstants"],function(b,c,a){function d(f,e){this.data=f;
this.options=e;this.statusCollection=e.styles.status;this.formattedData={};}d.prototype.formatData=function(){var g="week"||this.options.timelineData.granularity;
var e=this.sortDataByDate(this.data);var h=this.groupDataByGranularity(e,g);var f=this.groupDataByTransactionState(h,this.statusCollection.slice(0));
this.formattedData=f;return this.formattedData;};d.prototype.sortDataByDate=function(g){var h=c.time.format.iso.parse;var e=b.map(g,function(i){i.date=h(i.eventtime);
return i;});var f=b.sortBy(e,function(i){return i.date;});return f;};d.prototype.groupDataByTransactionState=function(g,f){var e=[];
b.each(g,function(k){var j=k.payments;var i=[];var h=0;b.each(f,function(l){i.push(b.extend({},l));});b.each(i,function(l){l.startY=h;
l.psprefs=[];b.each(j,function(m){if(b.contains(l.journaltypes,m.laststatus)){l.psprefs.push(m.pspreference);l.count++;h++;
}});l.endY=l.count+l.startY;});e.push({date:k.date,count:h,barData:i});});return e;};d.prototype.groupDataByGranularity=function(k,n){var h=c.min(k,function(i){return i.date;
});var m=c.max(k,function(i){return i.date;});var f=[];var o=[];switch(n){case a.__MONTH_FORMAT:f=c.time.months(c.time.month.offset(h,-1),m,1);
break;case a.__WEEK_FORMAT:f=c.time.weeks(c.time.week.offset(h,-1),m,1);break;case a.__DAY_FORMAT:f=c.time.days(c.time.day.offset(h,-1),m,1);
break;}b.each(f,function(i){o.push({date:i,payments:[]});});for(var l=0;l<k.length;l++){var e=k[l].date;for(var g=0;g<o.length-1;
g++){if(o[g].date.getTime()<e&&o[g+1].date.getTime()>e){o[g].payments.push(k[l]);g=o.length;}}}return o;};d.prototype.getData=function(){return(this.formattedData)?this.formattedData:this.formatData();
};d.prototype.setRawData=function(e){this.data=e;};d.prototype.setOptions=function(e){this.options=e;};return d;});define("chart/widgetFramework/composed/shopperdna/formatters/shopperDnaBundleFormatter2",["lodash","chart/widgetFramework/composed/shopperdna/shopperDnaUtils"],function(i,a){function l(m){this.data=m;
this.formattedData={};}l.prototype.formatData=function(){var p=this.data;var q=d(p);var o=b(q);var n=h(p,q);var m=e(n);this.formattedData={identifiersHierarchy:o,identifiers:n,identifiersLinkMap:m};
return this.formattedData;};function d(o){if(!i.isArray(o)){return o;}var n={};var m=0;i.each(o,function(p){i.each(p.eventidentifiers,function(t,r){var q=r;
var s=t;n[q]=n[q]||{};n[q][s]=n[q][s]||m++;});});return n;}function b(n){if(!i.isObject(n)){return n;}var m={name:"",children:[]};
i.each(n,function(o,q){var p={name:q,children:[]};i.each(o,function(s,r){p.children.push({name:r,index:s});});m.children.push(p);
});return m;}function h(n,o){if(!i.isArray(n)){return n;}var m=i.chain(n).reduce(function(r,q){var p=i.get(q,"pspreference");
i.each(q.eventidentifiers,function(t,s){r[s]=r[s]||{};if(!r[s][t]){r[s][t]={index:o[s][t],related:[],name:s,value:t};}i.each(q.eventidentifiers,function(w,v){var u=o[v][w];
if((w!==t)&&(v!==s)&&(!i.contains(r[s][t].related,u))){r[s][t].related.push(u);}});});return r;},{}).reduce(function(p,q){i.each(q,function(r){p.push(r);
});return p;},[]).value();return m;}function e(m){if(!i.isArray(m)){return m;}var n={};i.each(m,function(o){n[o.index]=o.related;
});return n;}function f(o,m){if(!i.isArray(o)){return o;}var n={};i.each(o,function(p){if(!n[p.pspreference]){n[p.pspreference]=[];
}i.each(p.eventidentifiers,function(r,q){n[p.pspreference].push(m[q][r]);});});return n;}function j(m){if(!i.isObject(m)){return m;
}var n={};i.each(m,function(p,o){i.each(p,function(q){if(!n[q]){n[q]=[];}n[q].push(o);});});return n;}function c(m){if(!i.isArray(m)){return m;
}var n=i.chain(m).groupBy("name").reduce(function(o,p,q){o[q]=i.groupBy(p,"value");return o;},{}).mapValues(function(o){var p=i.chain(o).mapValues(g).mapValues(k).value();
return p;}).value();return n;}function g(m){var n=i.chain(m).reduce(function(o,p){return i.assign(o,p,function(r,q){if(i.isArray(r)){return q.concat(r);
}if(i.isNumber(r)){return i.min([r,q]);}return q;});},{}).value();return n;}function k(n){var m=a.getStatusCategoryCountObject();
i.each(n.laststatus,function(o){m[o]++;});n.laststatusMap=m;n.pspreferenceCount=n.pspreference.length;return n;}return l;
});define("chartlib/timeVertStackedChart",["jquery","underscore","d3","chartlib/timeVertBarChart"],function(e,b,d,a){var c=a.extend({renderData:function(){var m=this,k=this.options.percentile,p=this.scales.x,o=this.scales.y,l=this.collection.getGranularity(),g=p.ticks(d.time[l].utc,1).length,i=(m.width/g),r=(i*(1-this.options.barPadding))/2;
m.collection.models.forEach(function(t){var s=0;e.each(t.get(m.options.yNestAttr),function(u,v){if(!k){v.startY=s;v.endY=(s+v.value);
}else{v.startY=s/t.get(m.options.yAttr);v.endY=(s+v.value)/t.get(m.options.yAttr);}s+=v.value;});});var j=this.svg.selectAll(".bar").data(m.collection.models,this.joinData);
var h=j.enter().append("g").attr("class","bar");j.transition().attr("transform",function(t,s){return"translate("+((i*(s+1))-(i/2))+",0)";
});var n=j.selectAll("rect").data(function(s){return s.get(m.options.yNestAttr);},function(s){return s.name;});var q=n.enter().append("rect").attr("class",function(t,s){return"stack stack-color-"+s;
}).attr("height",0).attr("y",function(s){return o(s.startY);});if(this.options.tooltip){h.on("mouseover",function(s){m.showTooltip(s,this,false);
}).on("mouseout",this.tip.hide);}n.attr("width",r).attr("transform",function(t,s){return"translate(-"+(r/2)+",0)";}).transition().duration(500).delay(function(t,s){return 500+(s*500);
}).attr("y",function(s){return o(s.endY);}).attr("height",function(s){return o(s.startY)-o(s.endY);});n.exit().remove();var f=j.exit().transition();
f.attr("transform",function(s){return"translate(0,0)";}).select("rect").transition().attr("width",0);f.remove();},renderTooltipContent:function(g){var f=this;
f.tip.html(function(i){var h="<div class='csr-col' style='width:220px'>";h+="<div class='csr-col two a'><b>total:</b></div><div class='csr-col two a'>"+i.get("total")+"</div>";
h+="</div>";return h;});this.tip.attr("class","d3-tip");this.tip.direction("n");this.tip.offset([-10,0]);}});return c;},function(a){if(window.console&&console.log){console.log("APP JS ERROR =",a);
}});define("chart/widgetFramework/composed/riskReport/formatters/riskChecksStackedFormatter",["jqueryExtended","underscore","d3","chartutil/stringutils","chartutil/dateUtils_CET","chart/widgetFramework/core/constants/DataConstants","chartutil/domUtils","chartutil/d3utils"],function(a,g,h,b,c,e,f,i){var d=function(m,j,l,n){var k={};
k.data=m;k.options=j;k.formattedData={};k.comparator=null;k.reverseDirection=false;k.sortKey="chargeback";k.timeline=l;k.id=n;
k.numChecksToShow=10;k.formatData=function(){var q=[],o=this;var p=g.keys(this.data.riskCheckStatistics);if(p.length===0){return[];
}g.each(p,function(x){var y=h.format("0,000");var v=o.data.riskCheckStatistics[x];var t={};t.riskCheck=(x.length>57)?a.trim(x).substring(0,54).trim(this)+"...":x;
t.total=v.Total;t.checks=[];var s=g.keys(v);var u=0,w=h.format(".1f");g.each(s,function(C){var A=b.lowercaseFirstLetter(C);
var B=b.camelToDash(A);if(C!=="Total"){var z={};z.name=B;z.value=v[C];z.percent=w((z.value/t.total)*100)+"%";z.startX=u;z.endX=z.startX+z.value;
u=z.endX;t.checks.push(z);t[A]=z.value;t[A+"Perc"]=z.percent;t[A+"TT"]=y(z.value);}else{t.totalTT=y(t.total);}});q.push(t);
});var r=g.cloneDeep(q);this.masterData=g.filter(r,function(s){return s.total!==0;});if(this.sortKey){this.reverseDirection=true;
this.sortData(this.sortKey,true);}return{chartData:this.formattedData};};k.sortData=function(o,q){if(q!==true&&o===this.sortKey){return;
}if(o!=="total"){g.each(this.masterData,function(v){var u=[];var t=v.checks;var s=g.findWhere(t,{name:o});g.each(t,function(w){if(w===s){u.unshift(w);
}else{u.push(w);}});var r=0;g.each(u,function(w){w.startX=r;w.endX=w.startX+w.value;r=w.endX;});v.checks=u;});}this.sortKey=o;
this.comparator=(o!=="total")?this.compareFunction:this.compareFunctionTotal;var p=g.sortBy(this.masterData,this.comparator,this);
if(this.reverseDirection){p.reverse();}this.masterData=g.cloneDeep(p);p.length=(p.length>this.numChecksToShow)?this.numChecksToShow:p.length;
this.formattedData=p.reverse();if(q===true){return;}this.$el.trigger(e.FORMATTER_INFORM_WIDGET,{type:e.SORTED_DATA,data:{chartData:this.formattedData}});
};k.compareFunction=function(p){var o=g.findWhere(p.checks,{name:this.sortKey});return o.value;};k.compareFunctionTotal=function(o){return o[this.sortKey];
};k.downloadCSV=function(){var o=["riskCheck","total","refusedByBankPerc","refusedByBank","refusedByRiskPerc","refusedByRisk","chargebackPerc","chargeback","authorisedPerc","authorised"];
var p=["Risk Check","Total","Refused by bank %","Refused by bank tx","Refused by RevenueProtect %","Refused by RevenueProtect tx","Chargebacks %","Chargebacks tx","Authorized %","Authorized tx"];
f.createCSV(this.formattedData,o,p,"riskChecks");};k.getData=function(){return(this.formattedData)?this.formattedData:this.formatData();
};k.setRawData=function(o){this.data=o;};k.retrieveData=function(o){return this.formattedData[o];};return k;};return d;});
define("chart/widgetFramework/composed/funnel/funnelDataFormatter",["jqueryExtended","underscore","d3","chart/widgetFramework/core/constants/DataConstants","chartutil/dateUtils_CET","chartutil/d3utils"],function(a,g,i,f,d,j){function e(n,k,m){this.data=n;
this.options=k;this.formattedData={};this.comparator=this.compareFunction;this.reverseDirection=false;this.sortKey="order";
this.timeline=m;this.showSessionsTotal=false;var l=(this.showSessionsTotal)?5:4;this.dataSpacers=[{insertPoint:[15,l]},{insertPoint:[12,2]},{insertPoint:[8,4]},{insertPoint:[1,2]}];
}e.prototype.formatData=function(){this.formattedData=this.data.PaymentFunnelResults;if(this.sortKey){this.reverseDirection=!this.reverseDirection;
this.sortData(this.sortKey,true);}this.formattedData=b(this.formattedData,this.dataSpacers);if(window.console&&console.log){console.log("### funnelDataFD::formatData:: this.formattedData=",this.formattedData);
}if(this.showSessionsTotal){var l=g.findIndex(this.formattedData,function(p){return(p.registertype&&p.registertype.toLowerCase()==="sessions");
});var m=0;for(var k=this.formattedData.length-1;k>=l;k--){m+=this.formattedData[k].count;}var n=this.formattedData[l-1];
n.count=m;n.journaltypecode="total";n.main="true";}var o=c(this.formattedData);this.formattedData=g.filter(this.formattedData,function(p){return(p.journaltypecode.toLowerCase().indexOf("awaiting")===-1&&p.journaltypecode.toLowerCase().indexOf("pre")===-1);
});return{chartData:this.formattedData,extraData:o};};var b=function(k,l){g.each(l,function(s){var r=s.insertPoint[0];var p=s.insertPoint[1];
var o=g.findIndex(k,"order",r);o+=1;if(o===k.length){p=0;}var n=h(p,o);for(var q=0,m=n.length;q<m;q++){k.splice(o,0,n[q]);
}});return k;};var h=function(l,o){var k=[],m;for(var n=0;n<l;n++){m={count:-1,order:-1,journaltypecode:"spacer"+(o+n),main:"false",start:0};
k.push(m);}return k;};var c=function(l){var k=g.filter(l,function(n){return n.main.toLowerCase()==="true";});var m=g.map(k,function(n){return n.journaltypecode;
});return m;};e.prototype.sortData=function(k,m){this.sortKey=k;this.reverseDirection=!this.reverseDirection;var l=g.sortBy(this.formattedData,k);
if(this.reverseDirection){l.reverse();}this.formattedData=l;if(m===true){return;}this.$el.trigger(f.FORMATTER_INFORM_WIDGET,{type:f.SORTED_DATA,data:{chartData:this.formattedData}});
};e.prototype.compareFunction=function(k){return k[this.sortKey];};e.prototype.getData=function(){return(this.data)?this.data:this.formatData();
};e.prototype.setRawData=function(k){this.data=k;};e.prototype.setOptions=function(k){this.options=k;};return e;});define("chartlib/ui/csvdownload",["jquery","underscore","backbone","chartlib/events/appstateevents","map/collections/mapdata"],function(e,b,f,c,d){var a=f.View.extend({baseURL:adyen.base+"ca/download/reports/chartCSV.shtml",targetURL:"",events:{click:"onClick"},urlParamProps:["region","ccs","granularity","bdate","edate"],initialize:function(){b.bindAll(this,"setDownloadURL","onClick");
f.on(c.STATE_CHANGED,this.setDownloadURL);},setDownloadURL:function(h){var g=b.pick(h.attributes,this.urlParamProps);if(this.collection instanceof d){g.statsType=h.get("statsType");
}else{g.statsType=this.collection.statsType;}g.exportcsv=true;this.targetURL=this.baseURL+"?"+e.param(g);},onClick:function(g){window.location=this.targetURL;
},addUrlParamProps:function(g){this.urlParamProps=this.urlParamProps.concat(g);}});return a;});define("chartlib/ui/collapsiblePanel",["d3","backbone","jquery","underscore","chartlib/ui/collapsibleview"],function(d,f,e,c,b){var a=b.extend({collapsed:false,constructor:function(){this.collapsible=[];
if(arguments[0].collapsed===true||arguments[0].collapsed==="true"){this.collapsed=true;}b.apply(this,arguments);},initialize:function(){this.header=this.$el.find(".header")[0];
this.collapsible.push(this.$el.find(".content"));this.icon=this.$el.find(".header > .arrow");this.render();}});return a;});
define("chart/widgetFramework/composed/settlementBatchWidget/settlementBatchWidgetMediator2",["jqueryExtended","lodash","d3","chart/widgetFramework/core/BasicMediator","util/ObjectSuper","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/core/constants/DataConstants","util/Functional","chartutil/cssutils"],function(a,j,l,i,g,h,f,c,k){var b=false;
var e=false;var d=function(m){var n;n=i(m,true);var o=g(n);n.init=function(){o.init();if(window.console&&console.log){console.log("### settlementBatchWidgetMediator2::init:: ");
}var p=new Date();this.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];
this.currentYear=p.getFullYear();this.currentMonth=p.getMonth();this.currentDay=p.getDate();};n.onNotifiedFormatter=function(r,q){o.onNotifiedFormatter(r,q);
var p=r.changeObject.data;if(p){if(a(".chart-month")&&p.month){a(".chart-month").text(p.month);}if(a(".total-month-currency")&&p.currencySymbol){a(".total-month-currency").html(p.currencySymbol);
}if(a(".total-month-value")&&p.total){a(".total-month-value").text(p.total);}if(a("#settlement_overview .ca-handle")){a("#settlement_overview .ca-handle").append([this.monthNames[this.currentMonth],this.currentYear].join(" "));
}}var s=a(".settlement-batch-reformat");s.each(function(){var u=a(this).text();var t=l.format(",.2f");a(this).text(t(u));
});};n.mediatorReady=function(){var p=(this.currentMonth<10)?"0":"";o.mediatorReady();this.$el.trigger(f.TIME_INFO_SET,[(this.currentYear+"-"+p+(this.currentMonth+1)+"-01")]);
};n.getInstance=function(){return this;};n.init();m.ready();return n;};return d;});define("chart/widgetFramework/composed/funnel/funnelChart",["jquery","underscore","d3","hogan","util/Functional","chartutil/d3utils","util/ObjectSuper","chart/widgetFramework/chartTypes/barChart"],function(b,f,h,d,a,i,e,c){var g=function(p,j,n,l){var m;
var o={};var k=f.defaults(o,p);m=c(k,j);var q=e(m);m.init=function(){q.init();this.stripLabel="spacer";};m.calibrateXScale=function(){if(a.falsy(this.data)){return;
}var u=f.find(this.data,function(A){return A.journaltypecode.toLowerCase()==="received";});var r=f.find(this.data,function(A){return A.journaltypecode.toLowerCase()==="abandoned";
});var x=u.count;if(r){x+=r.count;}var y=f.pluck(this.data,this.options.xAttr);y=f.map(y,function(A){if(f.isArray(A)){return f.pluck(A,"value");
}return A;});y=f.flatten(y);var w=h.min(y);var v=(w<-1)?w:0;y.push(x);var z=f.pluck(this.data,"start");z=f.map(z,function(A){if(f.isArray(A)){return f.pluck(A,"value");
}return A;});z=f.flatten(z);var s=h.min(z);var t=Math.min(s,v);this.scales[this.options.xAttr].domain([t,h.max(y)]);if(this.options.niceScaleX){this.scales[this.options.xAttr].nice();
}};m.renderData=function(){if(a.falsy(this.data)){this.hideCharts("no data to display");return;}var s=this,u=this.scales[this.options.xAttr];
var r=this.barUtils.containerBarsHorizontal(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),this.barPositioningFn,true);
var t=r.bars;t.update.select("rect").transition().duration(500).delay(function(v){return(v.main.toLowerCase()==="true")?750:1250;
}).ease("cubic-in-out").attr("x",function(w){var v=w[s.options.xAttr];if(v<0&&w.journaltypecode.indexOf("spacer")===-1){return u(v);
}return u(w.start);}).attr("width",function(A){var x=0,v=1,z,y=A[s.options.xAttr];if(y>0){z=(u(A.start)+(u(A.end)-u(A.start)))-u(A.start);
x=Math.max(z,v);}else{if(y<0){if(A.journaltypecode.indexOf("spacer")===-1){z=u(A.start)-u(y);x=Math.max(z,v);}}}return x;
});t.enter.append("rect").attr("class",function(v){return i.getJoinAttrNoSpaces.call(s,v,"-");}).attr("height",this.barSize).attr("width",0).transition().duration(500).delay(function(v){return(v.main.toLowerCase()==="true")?750:1250;
}).ease("cubic-in-out").attr("x",function(w){var v=w[s.options.xAttr];if(v<0&&w.journaltypecode.indexOf("spacer")===-1){return u(v);
}return u(w.start);}).attr("width",function(A){var x=0,v=1,z,y=A[s.options.xAttr];if(y>0){z=(u(A.start)+(u(A.end)-u(A.start)))-u(A.start);
x=Math.max(z,v);}else{if(y<0){if(A.journaltypecode.indexOf("spacer")===-1){z=u(A.start)-u(y);x=Math.max(z,v);}}}return x;
});t.exit.select("rect").transition().duration(500).attr("width",0).style("opacity",0).remove();};return m;};return g;});
define("chart/widgetFramework/composed/retryreport/formatters/acquirerBarDataFormatter",["jqueryExtended","underscore","d3","chartutil/numberutils","chart/widgetFramework/core/constants/DataConstants"],function(f,c,d,a,e){function b(k,h,j,m){var i={};
i.data=k;i.options=h;i.formattedData={};i.comparator=null;i.reverseDirection=false;i.sortKey="retriesCount";i.timeline=j;
i.id=m;i.formatData=function(){var o;if(this.data&&this.options.variation==="original"){o=this.data.originalBarData;}else{if(this.data&&this.options.variation==="retry"){o=this.data.retryBarData;
}else{o={};}}if(o.length===0){return[];}var n;if(typeof this.chosenAcquirer!=="undefined"){n=this.chosenAcquirer;}this.formattedData=l(o,n);
i.countTotals(this.formattedData);if(this.sortKey){this.reverseDirection=!this.reverseDirection;this.sortData(this.sortKey,true);
}return{chartData:this.formattedData};};var l=function(q,n){var p=[],o;c.each(q,function(u){var t=+u.retriescount>0?+u.success/+u.retriescount*100:0,s=100-t;
p.push({acquirer:u.acquirer,responseCode:g(u.response),retriesCount:+u.retriescount,successCount:+u.success,successRate:[{name:"success",value:t,startX:0,endX:t},{name:"non-success",value:s,startX:t,endX:100}],successRateLabel:t,successEurAmount:+u.successfuleuramount/100,total:100});
});p=d.nest().key(function(s){return s.acquirer;}).entries(p);var r=c.pluck(p,"key");r=r.sort();if(c.findIndex(p,{key:n})===-1){n=r[0];
}o=p[c.findIndex(p,{key:n})].values;return o;};i.countTotals=function(q){var n=d.format(",.0f");var p=d.format(".1f");var o={retriesCount:0,successCount:0,successEurAmount:0};
c.each(q,function(r){o.retriesCount+=r.retriesCount;o.successCount+=r.successCount;o.successEurAmount+=r.successEurAmount;
});o.successRate=o.retriesCount>0?o.successCount/o.retriesCount*100:0;a.animateValue(f("#"+i.options.variation+"RetriesVol"),o.retriesCount,n);
a.animateValue(f("#"+i.options.variation+"SuccessVol"),o.successCount,n);a.animateValue(f("#"+i.options.variation+"SuccessRate span"),o.successRate,p);
a.animateValue(f("#"+i.options.variation+"SuccessAmt span"),o.successEurAmount,n);};var g=function(o){var n=o.toLowerCase();
n=n.charAt(0).toUpperCase()+n.slice(1);return n.replace(/_/g," ");};i.sortData=function(n,p){this.sortKey=n;this.reverseDirection=!this.reverseDirection;
var o=c.sortBy(this.formattedData,n);if(this.reverseDirection){o.reverse();}this.formattedData=o;if(p===true){return;}this.$el.trigger(e.FORMATTER_INFORM_WIDGET,{type:e.SORTED_DATA,data:{chartData:this.formattedData}});
};i.compareFunction=function(n){return n[this.sortKey];};i.getData=function(){return(this.data)?this.data:this.formatData();
};i.setRawData=function(n){this.data=n;};i.retrieveData=function(n){return this.data[n];};return i;}return b;});define("chart/widgetFramework/composed/mainConversion/sessionsFigures",["jquery","underscore","d3","hogan","util/Functional","chartutil/d3utils","util/ObjectSuper","chart/widgetFramework/core/drivers/basicChartDriver"],function(b,f,h,d,a,i,e,c){var g=function(p,j,n,l){var m;
var o={};var k=f.defaults(o,p);m=c(k,j);var q=e(m);m.init=function(){q.init();this.totalTxt=this.$el.find("#actualTotalText");
};m.feedData=function(t){this.data=t.formattedData;var s=this;var r=f.filter(this.data,function(u){return u[s.options.joinAttr].toLowerCase()==="hpp";
});this.totalTransactions=r[0].count;};m.renderData=function(){if(b(".world-button").length>1){return;}var r=h.format("0,000");
var s=r(this.totalTransactions);b("#worldVolumeTotalText").html("Total Sessions : <b>"+s+"</b>");};return m;};return g;});
define("chart/widgetFramework/composed/transactionsDashboard/views/labelledBarChart",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/core/mixins/formats","chart/widgetFramework/chartTypes/barChart"],function(c,h,k,b,e,a,f,j,g,i){function d(q,l,o){var n;
var p={};var m=h.defaults(p,q);n=i(m,l,o);var r=f(n);n.renderData=function(){r.renderData();if(a.falsy(this.data)){this.hideCharts("no data to display");
return;}};n.addLabels=function(){var u=this.barUtils.bars;var s=this.barUtils.transitionTime;var v=this.barUtils.delayTime;
var t=a.notFalsy(n.options.prefix)?n.options.prefix:"";u.update.select(".bar-label").text(function(w){return w[n.options.label];
}).style("opacity",0).transition().duration(s).delay(v).attr("y",function(w){return Math.floor(n.barSize/2);}).style("opacity",1);
u.enter.append("text").attr("class","bar-label").attr("x",-8).attr("y",function(w){return Math.floor(n.barSize/2);}).attr("dy",".35em").style("text-anchor","end").style("opacity",0).text(function(w){return w[n.options.label];
}).transition().duration(s).delay(v).style("opacity",1);u.exit.select(".bar-label").transition().duration(s).style("opacity",0).remove();
if(t!==""){n.prefix(u,s,v,t,n.options.label);}};n.prefix=function(x,s,z,w,t){var y=0,u=1,v=6;x.bar[0].forEach(function(B){var A=!isNaN(Math.round(B.__data__[t]))?Math.round(B.__data__[t]).toString().length:B.__data__[t].length;
if(A>y){y=A;}});u=Math.ceil(y*6.5);x.update.selectAll(".bar-label-prefix").transition().duration(s).delay(2*z).attr("x",-u-v);
x.enter.append("text").attr("class","bar-label-prefix").attr("x",-u-v).attr("y","1.0em").style("text-anchor","end").style("opacity",0).text(w).transition().duration(s).delay(z).style("opacity",1);
x.exit.selectAll(".bar-label-prefix").transition().duration(s).style("opacity",0).remove();};return n;}return d;});define("chartutil/backbone/CollectionUtils",["jquery","underscore","backbone"],function(c,b,d){d.Collection.prototype.sumOf=function(e){return b.reduceRight(this.models,function(f,g){return f+g.get(e);
},0);};var a={};a.cloneModels=function(h,g){var f=(typeof g!=="undefined")?g:false;var e=b.map(h.models,function(j){return j.clone();
});if(f){var i=new d.Collection(e);return i;}else{return e;}};return a;});define("chart/widgetFramework/composed/harpViewer/sessionsAggRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","util/ObjectSuper","chart/widgetFramework/chartTypes/rollover"],function(g,b,e,c,f,d,h){var a=function(o,i,m,k){var l;
var n={};var j=b.defaults(n,o);l=h(j,i);var p=d(l);l.setTooltipsOnElements=function(){p.setTooltipsOnElements(true);};l.enhanceTooltipData=function(r){var q=e.format("0,000"),s=e.format(".1f");
r.dateTT=e.time.format("%m/%Y")(r.date);r.txTT=q(r.tx);r.abandonedTT=q(r.tx-r.auths);r.authorisationsTT=q(r.auths);r.authPercTT=s(r.authRate)+"%";
};l.getYScale=function(){var r=b.pluck(this.data,this.options.joinAttr);var q=e.scale.ordinal().rangeBands([0,this.height],this.options.barPadding).domain(r);
return q;};return l;};return a;});define("chart/widgetFramework/composed/transactionsDashboard/views/monthlyAuthRateStack",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/chartTypes/stackedBar"],function(d,h,k,c,e,b,f,j,g,i){function a(q,l,o){var n;
var p={};var m=h.defaults(p,q);n=i(m,l,o);var r=f(n);n.renderData=function(){r.renderData();var s=(this.timeline.getGranularity()==="month")?this.chartHeight+150:50;
this.$el.trigger(g.CHART_TO_VIEW_EVENT,{type:"monthlyAuthRateChartHeight",data:s});};n.addLabels=function(){var t=this.barUtils.bars;
var s=this.barUtils.transitionTime;var u=this.barUtils.delayTime;t.update.select(".bar-label").text(function(v){return v[n.options.label];
}).style("opacity",0).transition().duration(s).delay(u).attr("y",function(v){return Math.floor(n.barSize/2);}).style("opacity",1);
t.enter.append("text").attr("class","bar-label").attr("x",-8).attr("y",function(v){return Math.floor(n.barSize/2);}).attr("dy",".35em").style("text-anchor","end").style("opacity",0).text(function(v){return v[n.options.label];
}).transition().duration(s).delay(2*u).style("opacity",1);t.exit.select(".bar-label").transition().duration(s).style("opacity",0).remove();
};return n;}return a;});define("chart/widgetFramework/composed/demo/DemoMediator2",["jqueryExtended","lodash","chart/widgetFramework/core/BasicMediator","util/ObjectSuper","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/core/constants/DataConstants","util/Functional","chartutil/cssutils"],function(a,j,i,g,h,f,c,k){var b=false;
var e=false;var d=function(l){var m;m=i(l,true);var n=g(m);m.init=function(){n.init();this.actionCommanderExclusionArray=["actioncommander","dataformatter","viewcreator","timeline"];
};m.getAdditionalDOMElements=function(){n.getAdditionalDOMElements();};m.getWidgets=function(){n.getWidgets();};m.onNotifiedFetcher=function(p,o){n.onNotifiedFetcher(p,o);
};m.onNotifiedFormatter=function(p,o){n.onNotifiedFormatter(p,o);};m.onNotifiedViewCreator=function(r,p){n.onNotifiedViewCreator(r,p);
var o=r.changeObject;var q=o.type;};m.getInstance=function(){return this;};m.init();l.ready();return m;};return d;});define("chart/widgetFramework/composed/harpViewer/HarpViewerMediator",["jqueryExtended","lodash","d3","chart/widgetFramework/core/BasicMediator","util/ObjectSuper","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/core/constants/DataConstants","util/Functional","chartutil/cssutils","chartutil/d3utils"],function(a,j,m,i,g,h,e,c,k,l){var b=false;
var d=false;var f=function(n){var o;o=i(n,true);var p=g(o);o.init=function(){p.init();this.actionCommanderExclusionArray=["actioncommander","timeline"];
};o.getAdditionalDOMElements=function(){p.getAdditionalDOMElements();this.snapshotInstances=[];this.timelineInstances=[];
this.$allSnapshots=this.$el.find("[data-widget*=Snapshot]");this.$allTimelines=this.$el.find("[data-widget*=Timeline]");this.totalDomElements+=this.$allTimelines.length+this.$allSnapshots.length;
};o.getWidgets=function(){p.getWidgets();this.getWidgetInstances(this.$allTimelines,this.timelineInstances,"Timelines");this.getWidgetInstances(this.$allSnapshots,this.snapshotInstances,"Snapshots");
};o.onNotifiedFetcher=function(r,q){p.onNotifiedFetcher(r,q);};o.onNotifiedFormatter=function(s,z){p.onNotifiedFormatter(s,z);
if(z==="harpDataFormatter"){if(s.changeObject.type===e.DATA_FORMATTED){var u,q=null,y=this.$el.find("#harpTreePicker"),A=s.changeObject.data.chartData.keyValArr[0].treeId;
j.each(s.changeObject.data.chartData.keyValArr,function(K){u+='<option value="'+K.treeId+'">'+K.key+"</option>";if(K.treeId===y.val()&&K.treeId!==A){q=K.treeId;
}});y.html(u);if(q){y.val(q);}}}if(z==="harpAggregateDataFormatter"){if(s.changeObject.type===e.SORTED_DATA){var r=this.$sortButtonRef.find(".arrow")[0];
var H=this.getInstanceById("#harpAggregateDataFormatter");var x=H.getSortDirection();var C=(x)?180:0;var G=(x)?0.5:0;var F=(x)?0.5:0;
k.rotateElement(r,C,G,F);}}if(z==="harpBaselineDataFormatter"){var E=s.changeObject.data.chartData;var B=m.format("n");var w=m.format(".1%");
var J=l.getCollectionSum(E,"total");var v=l.getCollectionSum(E,"authorisations");var D=(v/J)||0;var t=a(".baseline.title").find("h2");
var I='<span class="csr-col nine a"><b>Totals:</b></span>';I+='<span class="csr-col five a left">Received: <b>'+B(J)+"</b></span>";
I+='<span class="csr-col five a left">Authorised: <b>'+B(v)+"</b></span>";I+='<span class="csr-col five a left">Auth Rate: <b>'+w(D)+"</b></span>";
t.html(I);}};o.onNotifiedViewCreator=function(v,t){p.onNotifiedViewCreator(v,t);var s=v.changeObject;var u=s.type;if(t==="harpInfo"&&(u===h.CHART_FIRST_RENDER||u===h.CHART_UPDATED)){var q=o.$el.find(".harp-info-text").height();
q+=70;a("#authRateInfoPanel").css({top:q+"px"});}if(t==="baselineChartWidget"&&(u===h.CHART_FIRST_RENDER||u===h.CHART_UPDATED)){var r=j.pluck(s.data.data[0][s.data.nestedAttr],s.data.options.yAttr);
var w=m.max(r);if(w>100){this.$el.find("#typeZoomBtn").trigger("click");}else{this.$el.find("#typeTotalBtn").trigger("click");
}}};o.getInstance=function(){return this;};o.onLoadData=function(q){this.reportStartDate=q[0];this.reportEndDate=q[1];o.$el.trigger("hideCharts","");
};o.sortData=function(r,q,s){this.$sortButtonRef=q;};o.downloadReport=function(){var t=this.$el.find("#harpTreePicker").val();
var s={reportCode:"optimization_explorer_download",harpTreeId:encodeURI(t),reportstartdate:this.reportStartDate,reportenddate:this.reportEndDate,format:"CSV",formHash:adyen.formHash};
var r="generate.shtml?"+a.param(s);var q=document.getElementById("downloadLinkEl");q.href=r;q.target="_self";q.click();};
o.makeTransitionToBaseline=function(u){var q=a("#contentbg");this.tranDiv=a(".tran-div");var s=a("#baselineChart");if(s.length===0){return;
}var t=s.offset();if(!this.tranDiv.length){var r=document.createElement("div");a(r).addClass("tran-div");this.tranDiv=a(q[0].appendChild(r));
}this.tranDiv.stop();this.tranDiv.css({top:(a(u.card).offset().top-u.height+15)+"px",left:a(u.card).offset().left+"px",opacity:0.7,width:u.width*u.zoom.scale(),height:u.height*u.zoom.scale(),display:"block"});
this.tranDiv.animate({opacity:0,left:t.left,top:t.top,width:"1100px",height:"450px"},750,"swing",function(){a(this).css("display","none");
});};o.onTxDownloadClick=function(s){var t={harpNodeId:s,paymentState:"Received",sampleSize:1000,sampleStartDate:this.reportStartDate,sampleEndDate:this.reportEndDate,formHash:adyen.formHash};
var r="optimizationexplorer/samples.shtml?"+a.param(t);var q=document.getElementById("downloadLinkEl");q.href=r;q.target="_blank";
q.click();};o.enableZoomButtons=function(w){var r=w;var v=r.who;var t=r.enable;var s=["#harpZoomIn","#harpZoomOut"];var q=this.$el.find(s[0]);
var u=this.$el.find(s[1]);switch(v){case"zoomIn":q.prop("disabled",!t);break;case"zoomOut":u.prop("disabled",!t);break;default:q.prop("disabled",false);
u.prop("disabled",false);break;}};o.init();n.ready();return o;};return f;});define("chart/widgetFramework/composed/ecpReport/ecpLineChart",["jquery","underscore","d3","hogan","util/Functional","chartutil/d3utils","chart/widgetFramework/core/mixins/formats","chartutil/stringutils","util/ObjectSuper","chart/widgetFramework/chartTypes/lineChart","chart/widgetFramework/core/constants/DataConstants"],function(d,h,k,e,a,l,c,b,g,i,f){var j=function(p,s,v,u){var r;
var q=100;var m=true;var n={delay:q};var w=h.defaults(n,p);r=i(w,s,v);var o=g(r);r.renderTickDelay=q*1.5;r.feedData=function(y){if(a.falsy(y)){if(m){m=false;
var A=a.notFalsy(this.options.nestedAttr)?this.options.nestedAttr:"lineValues";this.setNestedAttr(A,true);}return;}this.configData=y.config||{};
if(this.timeline){this.configData.granularity=this.timeline.getGranularity();}var x=h.filter(y.chartData,function(B){return B.programName===r.options.dataSubset;
});this.mainDataObj=x[0];if(!a.existy(this.mainDataObj)){this.setNestedAttr("lineValues",true);return f.HALT_RENDER_PROCESS;
}this.data=this.masterData=[{name:r.options.dataSubset,lineValues:this.mainDataObj.history}];this.setNestedAttr(this.data,true);
var z=this.data[0].lineValues;this.crossedThreshold=false;this.chartVariation="count";if(this.$el[0].className.indexOf("tx")>-1){this.crossedThreshold=t(this.mainDataObj,this.chartVariation,z);
}else{this.chartVariation="rate";this.crossedThreshold=t(this.mainDataObj,"rate",z);}};var t=function(y,B,z){var x=y[B+"Threshold"];
var A=h.filter(z,function(C){return C[B]>x;});if(A.length){return true;}return false;};r.renderYAxis=function(){o.renderYAxis();
setTimeout(function(){var x=r.yAxesHolders[r.dimensionsYArray[0]];r.actualTicks=l.getActualTickValues(x);},this.renderTickDelay);
};r.renderData=function(){o.renderData();setTimeout(function(){if(r.crossedThreshold){var B=r.scales[r.options.yAttr];var E=r.mainDataObj[r.chartVariation+"Threshold"];
var J=B.ticks();var z=h.max(J);var I=h.max(r.actualTicks);var L=Math.max(z,I);var A=E;var D=[{start:A,lineType:"excess-line"}];
var M=r.chartGroup.selectAll(".area-line").data(D,function(N){return N.lineType;});var y=M.enter().insert("g",function(N){return r.$el.find(".line-holder")[0];
}).attr("class",function(N){return"area-line";}).append("line").attr("class",function(N){return N.lineType;}).attr("x1",0).attr("x2",0);
var C=M.transition().delay(1300).duration(500).select("line").attr("x2",r.width).attr("y1",function(N){return B(N.start)-B(L);
}).attr("y2",function(N){return B(N.start)-B(L);});}else{var K=r.chartGroup.selectAll(".area-line");K.remove();}var H=(r.chartVariation==="count")?".tx-line-chart":".rates-line-chart";
var x=H+" .line";var F=r.chartGroup.select(x);F.classed("excess",r.crossedThreshold);x=H+" circle";var G=r.chartGroup.selectAll(x);
G.classed("excess",r.crossedThreshold);},this.renderTickDelay);};return r;};return j;});define("chart/widgetFramework/composed/settlementBatchOverview/settlementBatchYearRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/chartTypes/rollover","chartutil/d3utils"],function(c,h,j,a,e,g,f,d,i){var b=function(q,k,o,m){var n;
var p={};var l=h.defaults(p,q);n=d(l,k);var r=f(n);n.init=function(){r.init();this.barUtils.barClassStr="bar rollover settle-year-rollover";
};n.feedData=function(s){this.data=s.monthData;};n.renderData=function(){var s=this;r.renderData();this.barUtils.bars.enter.on("mouseover",function(t){s.$el.trigger(g.CHART_TO_VIEW_EVENT,{type:"requestMonthData",data:{bdate:t.dateString,monthNum:t.monthNum,monthData:t.monthData}});
});};n.enhanceTooltipData=function(s){s.payoutTT=i.formatAmount(s.payout,s.currency);};return n;};return b;});define("chart/widgetFramework/composed/harpReportBuilderV2/harpGraphBuilderNodes",["jquery","underscore","d3","backbone","hogan","util/Functional","chart/widgetFramework/chartTypes/treeLayout","harp/views/charts/authRatesImprBar","util/Number","Constants","chart/widgetFramework/core/constants/UIConstants","chartutil/svgutils","util/ObjectSuper","text!chart/widgetFramework/composed/harpReportBuilderV2/templates/dimensionsTemplate.html"],function(f,m,o,l,h,d,e,a,g,b,k,n,i,j){var c=function(t,p,q,r){t.templateStyle="html";
var s=e(t,p,null,r);var u=i(s);s.init=function(){u.init();this.dialogShown=false;};s.feedData=function(v){if(v){this.data=v;
}else{return;}};s.configureOrientation=function(v){var w=this;this.orientation=v;if(this.orientation==="vertical"){this.depth=225;
this.vertOffset=30;this.horizOffset=450;this.siblingSeparationVal=1.05;this.nonSiblingSeparationVal=1.3;this.$el.removeClass("dimension-vertical").addClass("dimension-horizontal");
}else{this.depth=250;this.vertOffset=200;this.horizOffset=0;this.siblingSeparationVal=1;this.nonSiblingSeparationVal=1;this.$el.addClass("dimension-vertical").removeClass("dimension-horizontal");
}};s.hideCharts=function(){u.hideCharts("No Tree Has Been Selected");};s.renderData=function(){var v=(typeof this.collapseNodes!=="undefined")?this.collapseNodes:false;
if(m.isEmpty(this.data)){return;}u.renderData(false);};s.createCard=function(C){var z=this;var v=7,y=4;var x=this.cardPadding;
var w=x+y;var B=z.cardWidth,A=0;return function(N){var F=o.format("0,000")(N.total);var I=w+(F.length*v);var P=(z.cardWidth-x-v);
var M=o.format(".2f")(N.percentTotal);var L=M.indexOf(".00");if(L>-1){M=M.substring(0,L);}var K=P-(y+(M.length*v));var O=String(N.authPercent).length;
var J=w+(O*v);B=(z.orientation==="vertical")?z.cardWidth/2-10:z.cardWidth;A=(z.orientation==="vertical")?z.cardHeight+10:z.cardHeight/2+12;
var Q={cardWidth:B,cardHeight:z.cardHeight,halfCardHeight:A,headerWidth:z.cardWidth-4,headerHeight:z.headerHeight,cardPadding:x,headerText:N.dimensionText,iconXPos:(z.cardWidth-x*2)+3,lineWidth:(z.cardWidth-2),txTitleXPos:I,txValueXPos:x,txValue:F,parentNodeId:N.parentNodeId,percTxTitleXPos:P,percTxValueXPos:K,percTxValue:M,eurValueXPos:x+10,eurValue:N.eurAmount,authTitleXPos:J,authValueXPos:x,authValue:N.authPercent,allData:N.allData,explanationRights:(f("#explanation_permission").length>0)};
if(typeof(Q.allData.possibleNewDimensions)!=="undefined"){for(var H=Q.allData.possibleNewDimensions.dimensions.length;H>0;
H--){Q.allData.possibleNewDimensions.dimensions[H-1].values.sort(function(T,S){return T.name.localeCompare(S.name);});}}var E=z.template.render(Q);
var G;if(z.templateStyle==="html"){G=document.createElement("div");}else{G=document.createElementNS("http://www.w3.org/2000/svg","g");
}f(G).attr("class","harpnode");if(z.templateStyle==="html"){var R=z.createNodeEnterFn(C);var D=R(N);f(G).css("left",D[0]+"px");
f(G).css("top",D[1]+"px");}else{f(G).attr("transform",z.createNodeEnterFn(C));}G.innerHTML=E;if(G.childNodes.length<1){n.innerHTMLShim(G,E);
}f(G).trigger(b.EV_CONTENT_MERGED);return G;};};s.updateTree=function(v){u.updateTree(v);setTimeout(function(){s.$el.trigger(k.CHART_TO_VIEW_EVENT,{type:k.CHART_RENDERED,data:s.data});
},100);};s.showDestroyDimensionDialog=function(v){if(!this.dialogShown){var w=f("#dialogWindow_"+v.id).show();w.prependTo(f("#harp-dialog-window"));
f("#harp-dialog-overlay").show();f("#schedulingWindow").hide();f(".explanationWindow").hide();}else{f("#deleteSplit_"+v.id).click();
f(".explanationWindow").hide();}};s.showExplanationDialog=function(v){f(".explanationWindow").hide();f(".deleteDimensionDialog").hide();
var w=f("#editExplanationWindow_"+v.id).show();w.prependTo(f("#harp-dialog-window"));f("#harp-dialog-overlay").show();f("#schedulingWindow").hide();
};s.deleteNodeChildren=function(z){var w=m.first(z.nodes).parentNodeId;f("#dialogWindow_"+w).hide();var x=f("#hn_"+w);if(x.find(".hn-container .dimension-selector").length){return;
}z.nodeId=w;z.possibleNewDimensions=m.findWhere(z.possibleNewDimensions,{nodeId:w.toString()});var F=z.possibleNewDimensions.dimensions;
for(var G=0;G<F.length;G++){var y=F[G];var v=[];var E=y.values;for(var C=0;C<E.length;C++){v.push({index:C,name:E[C].value});
}y.values=v;y.title=y.name;if(E.length){y.title=E[0].dimensionTitle;}}var D=h.compile(j);z.possibleNewDimensions.dimensions.sort(function(I,H){return I.name.localeCompare(H.name);
});for(var B=z.possibleNewDimensions.dimensions.length;B>0;B--){z.possibleNewDimensions.dimensions[B-1].values.sort(function(I,H){return I.name.localeCompare(H.name);
});}var A=D.render(z);x.find(".pg-node-extension").html(A);};s.findNode=function(z,A){var w=this;if(z.harpNodeId===A){return z;
}var y=z.children;if(y){for(var x=0;x<y.length;x++){var B=y[x];var v=w.findNode(B,A);if(v){return v;}}}};s.deleteDimensionNode=function(){f("#harp-dialog-overlay").hide();
};return s;};return c;});define("chart/widgetFramework/composed/cardAcquirerAuthorizationReport/percentageBrushBarChart",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/chartTypes/stackedBar"],function(c,i,k,b,f,a,g,j,h,d){function e(q,l,o){var n;
var p={};var m=i.defaults(p,q);n=d(m,l,o);var s=g(n);var r=false;n.init=function(){s.init();n.maxRowsForBrush=10;this.barUtils.delayStackedTime=0;
n.oldSelected=0;var t=n.el.id;t=t.replace("composed/cardAcquirerAuthorizationReport/","");n.IDname=t.replace("RateBarChart","");
};n.initRender=function(){s.initRender();setTimeout(function(){if(!r&&n.options.ranked){n.chartGroup.classed("barchart-ranked",true);
}r=true;},100);n.textScale=k.scale.linear().domain([8,50]).range([11,5]).clamp(true);var t=n.mainGroup.append("defs");t.append("clipPath").attr("id","clip-bars-"+n.IDname).append("rect").attr("x",-n.options.margin.left).attr("width",n.options.width-n.options.margin.right).attr("height",n.options.height-n.options.margin.top-n.options.margin.bottom);
t.append("clipPath").attr("id","clip-y-axis-"+n.IDname).append("rect").attr("clipPathUnits","objectBoundingBox").attr("x","-100%").attr("width","100%").attr("height",((n.options.height-n.options.margin.top-n.options.margin.bottom)/(n.options.height)*100)+"%");
};n.render=function(){n.showCharts();if(a.notFalsy(this.data)){n.doBrush=n.data.length>n.maxRowsForBrush;}n.barUtils.transitionTime=(n.doBrush)?0:500;
n.barUtils.delayTime=0;var u=this.$el.width();if(!n.doBrush&&a.notFalsy(this.data)){n.height=(n.data.length*30);}else{n.height=n.options.height-(n.options.margin.top+n.options.margin.bottom);
}var t=n.height+n.options.margin.top+n.options.margin.bottom;n.topSVG.attr("width",u+"px").attr("height",t+"px");k.select("#"+n.$el[0].id).transition().duration(500).style("height",t+"px");
if(n.doBrush){n.chartGroup.attr("clip-path","url(#clip-bars-"+n.IDname+")").style("clip-path","url(#clip-bars-"+n.IDname+")");
n.axisGroup.select(".y.axis").attr("clip-path","url(#clip-y-axis-"+n.IDname+")").style("clip-path","url(#clip-y-axis-"+n.IDname+")");
}else{n.scales[n.options.yAttr].rangeBands([n.height,0],n.options.barPadding);n.axisGroup.selectAll(".y.axis text").style("font-size",null);
}this.update();};n.renderData=function(){s.renderData();if(a.falsy(this.data)){return;}var t=k.format(",.2f");var u=this.barUtils.bars;
u.update.select(".bar-label").attr("y",this.barSize/2).attr("dy","0.35em").text(function(v){return t(v.authorizationRate)+"%";
}).style("opacity",1);u.enter.append("text").attr("class","bar-label").attr("x",-8).attr("y",this.barSize/2).attr("dy","0.35em").style("text-anchor","end").text(function(v){return t(v.authorizationRate)+"%";
}).style("opacity",1);u.exit.select(".bar-label").remove();};n.updateScale=function(t){n.scales[n.options.yAttr].rangeBands(t.newScale,n.options.barPadding);
if(t.numSelected!==n.oldSelected){n.axisGroup.selectAll(".y.axis text").style("font-size",n.textScale(t.numSelected));n.chartGroup.selectAll(".bar-label").style("font-size",n.textScale(t.numSelected));
}n.oldSelected=t.numSelected;n.update();};n.setBandSizes=function(){if(n.doBrush){n.barSize=n.vertBarSize=n.scales[n.options.yAttr].rangeBand();
n.bandSize=n.barSize*(1+n.options.barPadding);}else{s.setBandSizes();}};return n;}return e;});define("chart/widgetFramework/composed/transactionsDashboard/views/txLine",["jquery","underscore","chart/widgetFramework/core/mixins/formats","util/ObjectSuper","chartutil/stringutils","d3","chart/widgetFramework/core/constants/UIConstants","util/Functional","chart/widgetFramework/chartTypes/lineChart_buttonToggle"],function(b,i,g,h,f,j,d,e,a){function c(q,k,n){var p="Default Line Name";
var m;var o={};var l=i.defaults(o,q);m=a(l,k,n);var r=h(m);m.granularity="hour";m.setGranularity=function(s){this.granularity=s;
};m.formatXAxis=function(){this.formatTimeXAxis(this.options.xAttr);};m.formatTimeXAxis=function(u){var s=this.axes[u],t=this.granularity;
if(t==="hour"){s.ticks(j.time[t],1).tickFormat(function(y,w){var x=j.time.format("%H");var v=y.getHours();if(v%6!==0){return"";
}if(v===0){x=j.time.format("%b %d");}return x(y);});}else{if(t==="minute"){s.ticks(j.time[t],1).tickFormat(function(y,w){var x=j.time.format("%M");
var v=y.getMinutes();if(v%15!==0){return"";}if(v===0){x=j.time.format("%H:%M");}return x(y);});}}};m.createRemovedItemButton=function(s){r.createRemovedItemButton(s);
this.$el.trigger(d.CHART_TO_VIEW_EVENT,{type:"lineChart_lineRemoved",data:s});if(this.removedObjectsArr.length===this.masterData.length){this.$el.trigger(d.CHART_TO_VIEW_EVENT,{type:"lineChart_allLinesRemoved",data:{}});
}};m.restoreRemovedItem=function(s){r.restoreRemovedItem(s);this.$el.trigger(d.CHART_TO_VIEW_EVENT,{type:"lineChart_lineRestored",data:s});
};m.getLabelName=function(u){var s=this.options.lineDataProp||this.options.joinAttr||"";var t=u[s];if(!t){t=p;}return t;};
return m;}return c;});define("chart/widgetFramework/composed/retryreport/formatters/allRetriesBarDataFormatter",["jqueryExtended","underscore","d3","chartutil/numberutils","chart/widgetFramework/core/constants/DataConstants"],function(f,c,d,a,e){function b(k,h,j,m){var i={};
i.data=k;i.options=h;i.formattedData={};i.comparator=null;i.reverseDirection=false;i.sortKey="retriesCount";i.timeline=j;
i.id=m;i.formatData=function(){var n=(this.data&&this.data.allRetriesBarData)?this.data.allRetriesBarData:{};this.formattedData=l(n);
i.countTotals(this.formattedData);if(this.sortKey){this.reverseDirection=!this.reverseDirection;this.sortData(this.sortKey,true);
}return{chartData:this.formattedData};};i.countTotals=function(q){var n=d.format(",.0f");var p=d.format(".1f");var o={retriesCount:0,successCount:0,successEurAmount:0};
c.each(q,function(r){o.retriesCount+=r.retriesCount;o.successCount+=r.successCount;o.successEurAmount+=r.successEurAmount;
});o.successRate=o.retriesCount>0?o.successCount/o.retriesCount*100:0;a.animateValue(f("#allRetriesVol"),o.retriesCount,n);
a.animateValue(f("#allSuccessVol"),o.successCount,n);a.animateValue(f("#allSuccessRate span"),o.successRate,p);a.animateValue(f("#allSuccessAmt span"),o.successEurAmount,n);
};var l=function(o){var n=[];c.each(o,function(r){var q=+r.retriescount>0?+r.success/+r.retriescount*100:0,p=100-q;n.push({responseCode:g(r.response),retriesCount:+r.retriescount,successCount:+r.success,successRate:[{name:"success",value:q,startX:0,endX:q},{name:"non-success",value:p,startX:q,endX:100}],successRateLabel:q,successEurAmount:+r.successfuleuramount/100,total:100});
});return n;};var g=function(o){var n=o.toLowerCase();n=n.charAt(0).toUpperCase()+n.slice(1);return n.replace(/_/g," ");};
i.sortData=function(n,p){this.sortKey=n;this.reverseDirection=!this.reverseDirection;var o=c.sortBy(this.formattedData,n);
if(this.reverseDirection){o.reverse();}this.formattedData=o;if(p===true){return;}this.$el.trigger(e.FORMATTER_INFORM_WIDGET,{type:e.SORTED_DATA,data:{chartData:this.formattedData}});
};i.compareFunction=function(n){return n[this.sortKey];};i.getData=function(){return(this.data)?this.data:this.formatData();
};i.setRawData=function(n){this.data=n;};i.retrieveData=function(n){return this.data[n];};return i;}return b;});define("chart/widgetFramework/composed/settlementBatchWidget/settlementBatchWidgetRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","util/ObjectSuper","chart/widgetFramework/chartTypes/rollover"],function(g,b,e,c,f,d,h){var a=function(o,i,j,l){var m;
var n={};var k=b.defaults(n,o);m=h(k);var p=d(m);m.el=i;m.init=function(){p.init();};m.feedData=function(q){if(typeof q!=="undefined"){if(typeof q.batches!=="undefined"){this.data=q.batches;
}}};m.enhanceTooltipData=function(r){var q=r.payout;r.payoutTT=e.format(",.2f")(q);};return m;};return a;});define("chart/widgetFramework/composed/retryreport/formatters/allRetriesSankeyDataFormatter",["jqueryExtended","underscore","d3"],function(d,b,c){function a(h,e,g,i){var f={};
f.data=h;f.options=e;f.formattedData={};f.comparator=null;f.reverseDirection=false;f.sortKey=null;f.timeline=g;f.id=i;f.formatData=function(){var j=(this.data&&this.data.allRetriesSankeyData)?this.data.allRetriesSankeyData:{};
this.formattedData=f.parse(j);return{chartData:this.formattedData};};f.parse=function(k){var j={nodes:[],links:[],nodeNames:[]};
k.forEach(function(l){j.nodes.push({name:l.source});j.nodes.push({name:l.target});j.links.push({source:l.source,target:l.target,value:+l.value,type:l.type});
});j.nodes=c.keys(c.nest().key(function(l){return l.name;}).map(j.nodes));j.nodeNames=j.nodes.slice();j.maxRetry=1;j.nodeNames.forEach(function(m){var l=parseFloat(/[^_]*$/.exec(m)[0]);
if(l>j.maxRetry){j.maxRetry=l;}});j.nodeNames=c.keys(c.nest().key(function(l){return l.replace(/_.$/,"");}).map(j.nodeNames));
j.links.forEach(function(m,l){j.links[l].source=j.nodes.indexOf(j.links[l].source);j.links[l].target=j.nodes.indexOf(j.links[l].target);
});j.nodes.forEach(function(m,l){j.nodes[l]={name:m};});return j;};f.sortData=function(j){};f.compareFunction=function(j){return j[this.sortKey];
};f.getData=function(){return(this.data)?this.data:this.formatData();};f.setRawData=function(j){this.data=j;};f.retrieveData=function(j){return this.data[j];
};return f;}return a;});define("chart/widgetFramework/composed/shopperDnaBeta/shopperDnaBetaActions",["lodash"],function(a){var b=["#shopperDnaBetaTimeline","#shopperDnaBetaForce","#shopperdnaLegend","#shopperdnaVmTable"];
var c={actions:[{source:"#mediator",event:"widgetAppStartup",target:"#dataFetcher",callMethod:"widgetAppStartup"},{target:"#shopperDnaBetaForce",callMethod:"renderSelection",event:"createSelection",source:a.without(b,"#shopperDnaBetaForce")},{target:"#shopperDnaBetaTimeline",callMethod:"renderSelection",event:"createSelection",source:a.without(b,"#shopperDnaBetaTimeline")},{target:"#shopperdnaVmTable",callMethod:"renderSelection",event:"createSelection",source:a.without(b,"#shopperdnaVmTable")},{target:"#shopperdnaLegend",callMethod:"renderSelection",event:"createSelection",source:a.without(b,"#shopperdnaLegend")},{target:"#shopperdnaLegend",callMethod:"renderTemporarySelection",event:"createTemporarySelection",source:["#shopperDnaBetaForce"]}]};
return c;});define("chart/widgetFramework/composed/cardAcquirerAuthorizationReport/rollovers/groupedBarRollover",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/chartTypes/axisRollover"],function(c,i,j,a,f,h,g,e,d){function b(o,k){var m;
var n={};var l=i.defaults(n,o);m=d(l,k);var p=g(m);m.setTooltipsOnElements=function(){p.setTooltipsOnElements(true);};m.positionTooltip=function(u,w,t,v,q,r,x){var s=u.top+t-10-q;
var y=((u.left+w)-v)+(r/2)+80;return{top:s,left:y};};m.enhanceTooltipData=function(r){var q=j.format(",.2f");r.authorizedRateTT=q(r.authorizationRate);
r.authorizedCountShareTT=q(r.authorizedCountShare);var t=j.format(",.0f");r.authorizedCountTT=t(r.authorizedCount);var s=j.format(",.0f");
r.authorizedEurAmountTT=s(r.authorizedEurAmount);};return m;}return b;});define("chart/widgetFramework/composed/posOverview/posOverviewMediator",["jqueryExtended","d3","lodash","chart/widgetFramework/core/BasicMediator","util/ObjectSuper","chartutil/numberutils","chartutil/cssutils","util/Number"],function(a,i,f,e,d,g,h,b){function c(j){var k;
k=e(j,true);var l=d(k);k.init=function(){l.init();this.actionCommanderExclusionArray=["actioncommander","timeline"];};k.getAdditionalDOMElements=function(){l.getAdditionalDOMElements();
this.timelineInstances=[];this.$allTimelines=j.__$node.find("[data-widget*=Timeline]");this.totalDomElements+=this.$allTimelines.length;
};k.getWidgets=function(){l.getWidgets();this.getWidgetInstances(this.$allTimelines,this.timelineInstances,"Timelines");};
k.onNotifiedFetcher=function(u,B){var A="insert_card",I="swipe_card",p="contactless",H="other",q=new Date(k.timelineInstances[0].timeline.getDates()[0]),G=new Date(k.timelineInstances[0].timeline.getDates()[1]),F=new Date("01/09/2017"),D={5:A,95:A,2:I,90:I,7:p,91:p};
if(q.getTime()>F.getTime()){a("#refund-info-popup").addClass("pg-hidden");a(".ca-chart-stat.ca-chart-stat__refunded").removeClass("ca-faded-held");
}else{a("#refund-info-popup").removeClass("pg-hidden");if(G.getTime()>F.getTime()){a(".ca-chart-stat.ca-chart-stat__refunded").removeClass("ca-faded-held");
}else{a(".ca-chart-stat.ca-chart-stat__refunded").addClass("ca-faded-held");}}if(B==="activePaymentMethodsFetcher"){var E,w=this.$el.find("#paymentMethod"),x=false;
E='<option value="">All Payment Methods</option>';f.each(u.changeObject.data,function(L){if(k.storedPaymentMethod&&k.storedPaymentMethod===L){x=true;
}E+='<option value="'+L+'">'+L+"</option>";});w.html(E);if(this.storedPaymentMethod&&x){a("#paymentMethod").val(this.storedPaymentMethod);
}}else{if(B==="fetcher"&&typeof(u.changeObject.data.dailyPOSStats)!=="undefined"){var C=[0,0,0,0,0,0];for(var t=0;t<C.length;
t++){a("[data-id='top-stat-"+t+"']").html(C[t]+" %");}var v=u.changeObject.data.totals.authorisedEurQuantity,z=u.changeObject.data.totals.refusedEurQuantity,y=u.changeObject.data.totals.refusedByAcquirerEurQuantity,s=u.changeObject.data.totals.cancelledEurQuantity,m=u.changeObject.data.totals.refundAuthorisedEurQuantity,r=u.changeObject.data.totals.errorEurQuantity,K={insert_card:0,swipe_card:0,contactless:0,other:100};
var J=function(N,L){var M=N.toString(),P=i.format(",.0f"),O;while(M.length<3){M="0"+M;}if(M.length>8){O=b.roundToThousands(M.slice(0,M.length-2));
}else{O=P(M/100);}a("[data-id="+L+"]").html(O+" EUR");};J(v,"totalAuth");J(z,"totalRefused");J(y,"totalRefusedByAcq");J(s,"totalCancelled");
J(m,"totalRefunded");J(r,"totalError");a("[data-id='terminalCount']").html(u.changeObject.data.terminalsCount);for(var o in u.changeObject.data.posEntryModePercentages){var n=parseInt(o);
if(isNaN(n)){continue;}if(typeof(D[n])!=="undefined"){K[D[n]]=+parseFloat(K[D[n]]+u.changeObject.data.posEntryModePercentages[o]).toFixed(2);
K.other=+parseFloat(K.other-u.changeObject.data.posEntryModePercentages[o]).toFixed(2);}}f.each(K,function(M,L){a("[data-id=top-stat-"+L+"]").html(M+" %");
});u.changeObject.data=u.changeObject.data.dailyPOSStats;}}};k.onNotifiedFormatter=function(p,n){l.onNotifiedFormatter(p,n);
var o=p.changeObject.type;var m=p.changeObject.data;};k.onNotifiedViewCreator=function(n,m){l.onNotifiedViewCreator(n,m);
};k.onNotifiedViewCreator=function(n,m){l.onNotifiedViewCreator(n,m);f.each(this.actionCommanderInstances,function(p){var o=f.cloneDeep(p.events);
p.unbindEvents(o);p.setUpEvents(o);});};k.getInstance=function(){return this;};k.sortData=function(n,m){this.$sortButtonRef=m;
};k.init();j.ready();return k;}return c;});define("chart/widgetFramework/composed/settlementBatchOverview/settlementMonthBatchFormatter",["jqueryExtended","underscore","d3","chartutil/d3utils"],function(e,a,c,b){function d(g,f){this.data=g;
}d.prototype.formatData=function(){a.each(this.data.batches,function(f){if(f.payout>0){f.payoutTT=b.formatAmount(f.payout,f.currency);
}});return this.data;};d.prototype.sortData=function(f){this.sortKey=f;this.reverseDirection=!this.reverseDirection;var g=a.sortBy(this.fullMonthData,f);
if(this.reverseDirection){g.reverse();}this.fullMonthData=g;return this.fullMonthData;};d.prototype.compareFunction=function(f){return f[this.sortKey];
};d.prototype.getData=function(){return(this.data)?this.data:this.formatData();};d.prototype.setRawData=function(f){this.data=f;
};d.prototype.setOptions=function(f){this.options=f;};return d;});(function(){Date.prototype.getWeek=function(e){var d=(typeof e!=="undefined")?e:false;var a=new Date(this.getTime());a.setHours(0,0,0,0);
a.setDate(a.getDate()+1);a.setDate(a.getDate()+3-(a.getDay()+6)%7);var c=new Date(a.getFullYear(),0,4);var b=1+Math.round(((a.getTime()-c.getTime())/86400000-3+(c.getDay()+6)%7)/7);
if(d){b=Date.padded2(b);}return b;};Date.padded2=function(a){var b=parseInt(a,10);if(a<10){b="0"+b;}return b;};Date.prototype.getPaddedMinutes=function(){return Date.padded2(this.getMinutes());
};Date.prototype.toFormattedString=function(b){var a;var c=this.getFullYear()+"-"+Date.padded2(this.getMonth()+1)+"-"+Date.padded2(this.getDate());
if(b){a=Date.padded2(this.getHours());c+=" "+a+":"+this.getPaddedMinutes();}return c;};Date.prototype.toFormattedTimeString=function(b){var a;
var c=this.getFullYear()+"-"+Date.padded2(this.getMonth()+1)+"-"+Date.padded2(this.getDate());a=Date.padded2(this.getHours());
c+="T"+a+":"+this.getPaddedMinutes();c+=":00";if(b){c+=".000Z";}return c;};Date.parseFormattedString=function(b){var c="([0-9]{4})(-([0-9]{1,2})(-([0-9]{1,2})( ([0-9]{1,2}):([0-9]{2})?)?)?)?";
var f=b.match(new RegExp(c,"i"));if(f===null){return Date.parse(b);}var e=0;var a=new Date(f[1],0,1);if(f[3]){a.setMonth(f[3]-1);
}if(f[5]){a.setDate(f[5]);}if(f[7]){a.setHours(f[7]);}if(f[8]){a.setMinutes(f[8]);}if(f[0]){a.setSeconds(f[0]);}if(f[2]){a.setMilliseconds(Number("0."+f[2]));
}if(f[4]){e=(Number(f[6]))+Number(f[8]);e=((f[5]=="-")?1:-1);}return a;};}());define("chartutil/dateUtils",["jquery","d3","util/Console"],function(e,i,b){var c=b.getLog("chartutil/dateUtils");
var f=60000;var a=3600000;var g=86400000;var h=g*7;var d={};d.__DAYS_SHORT=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];d.__MONTHS_SHORT=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
d.__FWD="fwd";d.__BACK="back";d.getNumDays=function(l,k){if(typeof l==="undefined"||typeof k==="undefined"){c.error("DATE NOT SPECIFIED in getNumDays()");
}var j=(l-k)/g;return(j<0)?j*-1:j;};d.getDSTAdjustment=function(l,k){var n=l.getTimezoneOffset();var m=k.getTimezoneOffset();
var j=0;if(l>k){j=(m-n);}else{j=(n-m);}return j;};d.getNumHours=function(m,k){if(typeof m==="undefined"||typeof k==="undefined"){c.error("DATE NOT SPECIFIED in getNumHours()");
}var j=d.getDSTAdjustment(m,k);var l=(m-k)/a;return(l<0)?(l*-1)+j:l+j;};d.getNumMinutes=function(l,k,n){if(typeof l==="undefined"||typeof k==="undefined"){c.error("DATE NOT SPECIFIED in getNumMinutes()");
}var j=(n===true)?0:d.getDSTAdjustment(l,k);var m=(l-k)/f;return(m<0)?(m*-1)+j:m+j;};d.getDateOfISOWeek=function(j,k,l){var n=new Date(k,0,1),m=n.getTimezoneOffset();
n.setDate(n.getDate()+4-(n.getDay()||7));n.setTime(n.getTime()+h*(j+(k===n.getFullYear()?-1:0)));n.setTime(n.getTime()+(n.getTimezoneOffset()-m)*60*1000);
n.setDate(n.getDate()-4);if(l&&window.console&&c.log){c.log("### dateUtils::getDateOfISOWeek:: week:",j," =",n);}return n;
};d.roundToMinute=function(k,l){var j=(typeof l!=="undefined")?l:false;var m=i.time.minute.floor(k);return m;};d.roundToHour=function(k,l){var j=(typeof l!=="undefined")?l:false;
var n=k.getMinutes();var m=k;if(j){m=new Date(k.getFullYear(),k.getMonth(),k.getDate(),k.getHours(),k.getMinutes()-n);}else{m.setHours(m.getMinutes()-n);
}return m;};d.roundToDay=function(k,l){var j=(typeof l!=="undefined")?l:false;var n=k.getHours();var m=k;if(j){m=new Date(k.getFullYear(),k.getMonth(),k.getDate(),k.getHours()-n);
}else{m.setHours(m.getHours()-n);}return m;};d.roundToWeek=function(k,l){var j=(typeof l!=="undefined")?l:false;var n=k.getDay();
var m=k;if(j){m=new Date(k.getFullYear(),k.getMonth(),k.getDate()-n);}else{m.setDate(m.getDate()-n);}return m;};d.trueRoundToWeek=function(k,l){var j=(typeof l!=="undefined")?l:false;
var n=k.getDay();var m=k;if(j){if(n<3){m=new Date(k.getFullYear(),k.getMonth(),k.getDate()-n);}else{m=new Date(k.getFullYear(),k.getMonth(),k.getDate()+(7-n));
}}else{if(n<3){m.setDate(m.getDate()-n);}else{m.setDate(m.getDate()+(7-n));}}return m;};d.roundToMonth=function(k,l){var j=(typeof l!=="undefined")?l:false;
var n=k.getDate()-1;var m=k;if(j){m=new Date(k.getFullYear(),k.getMonth(),k.getDate()-n);}else{m.setDate(m.getDate()-n);}return m;
};d.convertToUTC=function(j){return new Date(j.toUTCString());};d.convertToOffset=function(j,m){var k=d.convertToUTC(j);var l=m*60*1000;
k.setTime(k.getTime()+l);return k;};d.adjustTime=function(k,m){var l=k.getTime();var j=new Date();j.setTime(l+m);return j;
};d.getSummerDSTDate=function(j){var k=Math.ceil(31-((((5*j.getFullYear())/4)+4)%7));return k;};d.getAmsterdamDSTSummerBoundary=function(k){var l=Math.ceil(31-((((5*k.getFullYear())/4)+4)%7));
var j=Date.UTC(k.getFullYear(),2,l,1,0);return j;};d.getWinterDSTDate=function(k){var j=Math.ceil(31-((((5*k.getFullYear())/4)+1)%7));
return j;};d.getAmsterdamDSTWinterBoundary=function(j){var k=Math.ceil(31-((((5*j.getFullYear())/4)+1)%7));winterTime=Date.UTC(j.getFullYear(),9,k,1,0);
return winterTime;};d.isWinterDSTBoundary=function(j,k){var l=d.getWinterDSTDate(j);if(window.console&&c.log&&k){c.log("\n### DETECTING WINTER DST BOUNDARY dstDate=",l);
c.log("### DETECTING DST BOUNDARY startDate.getUTCMonth()=",j.getUTCMonth());c.log("### DETECTING DST BOUNDARY startDate.getUTCDate()=",j.getUTCDate());
c.log("### DETECTING DST BOUNDARY startDate.getUTCHours()=",j.getUTCHours());}if(j.getUTCMonth()===9&&j.getUTCDate()===l&&j.getUTCHours()===0){if(window.console&&c.log&&k){c.log("### DETECTED WINTER DST BOUNDARY DATE!!!!!!!!\n");
}return true;}if(window.console&&c.log&&k){c.log("### NOT A BOUNDARY DATE!!!!!!!!\n");}return false;};d.isSummerDSTBoundary=function(j,k){var l=d.getSummerDSTDate(j);
if(window.console&&c.log&&k){c.log("\n### DETECTING SUMMER DST BOUNDARY dstDate=",l);c.log("### DETECTING DST BOUNDARY startDate.getUTCMonth()=",j.getUTCMonth());
c.log("### DETECTING DST BOUNDARY startDate.getUTCDate()=",j.getUTCDate());c.log("### DETECTING DST BOUNDARY startDate.getUTCHours()=",j.getUTCHours());
}if(j.getUTCMonth()===2&&j.getUTCDate()===l&&j.getUTCHours()===0){if(window.console&&c.log&&k){c.log("### DETECTED SUMMER DST BOUNDARY DATE!!!!!!!!\n");
}return true;}else{if(window.console&&c.log&&k){c.log("### NOT A BOUNDARY DATE!!!!!!!!\n");}return false;}};d.sameTzOffset=function(l,k,m){var j=l.getTimezoneOffset();
var n=k.getTimezoneOffset();if(window.console&&c.log&&m){c.log("\n### sameTzOffset::startTz=",j);c.log("### sameTzOffset::endTz=",n,"\n");
}if(j===n){return true;}return false;};d.getTzOffsetDiff=function(l,k,m){var j=l.getTimezoneOffset();var o=k.getTimezoneOffset();
var n=o-j;if(window.console&&c.log&&m){c.log("\n### DateUtils::getTzOffsetDiff::startTz=",j);c.log("### DateUtils::getTzOffsetDiff::endTz=",o);
c.log("### DateUtils::getTzOffsetDiff::diff=",n,"\n");}return n;};d.getAmsterdamDSTOffset=function(l,n,m){var k=d.getAmsterdamDSTSummerBoundary(l);
var j=d.getAmsterdamDSTWinterBoundary(l);if(l.getTime()>k&&l.getTime()<j){return 120;}return 60;};d.getAmsterdamDSTOffset_minusTZ=function(l,n){if(window.console&&c.log&&n){c.log("###");
c.log("### getAmsterdamDSTOffset_minusTZ:: date =",l);c.log("### utc str=",l.toUTCString());}var k=d.getAmsterdamDSTSummerBoundary(l);
var j=d.getAmsterdamDSTWinterBoundary(l);var m=l.getTime();if(window.console&&c.log&&n){c.log("### orig millis = ",m);c.log("### utc millis = ",(m+(l.getTimezoneOffset()*60000)));
}m=m-(l.getTimezoneOffset()*60000);if(window.console&&c.log&&n){c.log("### final millis = ",m);c.log("### millis as date = ",new Date(m));
c.log("### millis as utc date = ",new Date(m).toUTCString());c.log("### summerTime = ",k);c.log("### winterTime = ",j);c.log("### end getAmsterdamDSTOffset_minusTZ");
}if(m>k&&m<j){return -120;}return -60;};d.getAmsterdamDSTOffsetTime=function(q,j,l){if(window.console&&c.log&&l){c.log("\n\n### getAmsterdamDSTOffsetTime:: date =",q);
c.log("### utc str=",q.toUTCString());}var p=(typeof j!=="undefined")?j:false;var r=d.getAmsterdamDSTSummerBoundary(q);var m=d.getAmsterdamDSTWinterBoundary(q);
var n=q.getTime();var o=n+(q.getTimezoneOffset()*60000);if(window.console&&c.log&&l){c.log("### utcMillis   = ",o);c.log("### localMillis = ",n);
}var k=o;if(p===true){k=n;}if(window.console&&c.log&&l){c.log("### compareMillis as date = ",new Date(k).toUTCString());c.log("### end getAmsterdamDSTOffsetTime\n");
}if(k>=r&&k<m){return -120;}return -60;};d.timezoneShiftDate=function(v,j,o,m,q,n){var u,s,l,k,p,t;var r=(j===d.__FWD)?1:-1;
u=v.getTimezoneOffset();s=u-o;s*=r;l=new Date(v.getTime());k=(l.getTime()+(l.getTimezoneOffset()*60000));p=l.getTimezoneOffset();
if(window.console&&c.log&&q<n){c.log("\n## timezoneShiftDate:: now=",l,"offset=",p);c.log("### formatting ",m," date.utc=",v.toUTCString());
}l.setTime(k-((l.getTimezoneOffset()+s)*60000));if(window.console&&c.log&&q<n){c.log("### now -1=",l,"offset=",l.getTimezoneOffset());
c.log("### re-assessed amsOffset = ",d.getAmsterdamDSTOffset_minusTZ(l));}if(l.getTimezoneOffset()!==p){t=l.getTimezoneOffset()-p;
t*=r;if(window.console&&c.log&&q<n){c.log("### -----------------------------------reappliedOffset=",t);}k=(l.getTime()+(l.getTimezoneOffset()*60000));
l.setTime(k-((l.getTimezoneOffset()-t)*60000));if(window.console&&c.log&&q<n){c.log("### nowagain=",l,"offset=",l.getTimezoneOffset());
}}if(window.console&&c.log&&q<n){c.log("### formatting localOffset=",u);c.log("### formatting amsOffset=",o);c.log("### formatting applied offset=",s);
c.log("### formatting direction=",r);c.log("### end timezoneShiftDate \n");}return l;};d.timezoneShiftPseudoDate=function(B,s,j,l){if(window.console&&c.log&&l){c.log("\n### timezoneShiftPseudoDate:");
c.log(j," ### pDate=",B,"offset=",B.getTimezoneOffset());c.log(j," ### date utc = ",B.toUTCString());c.log(j," ### pAmsOffset = ",s);
}var o=d.getUTCValues(B);o.utcHours=parseInt(o.hours,10);var q=parseInt(o.hours,10)-(s/60);if(q>23){q-=24;}q=Date.padded2(q);
o.hours=q;var w=B.getTime()+(B.getTimezoneOffset()*60000);var A=B.getTimezoneOffset()-s;var v=w-((B.getTimezoneOffset()-A)*60000);
var u=new Date(v);var z=u.getFullYear();var n=u.getMonth();var t=u.getDate();var x=d.__DAYS_SHORT[u.getDay()];var r=d.__MONTHS_SHORT[n];
o.date=(o.date!==t)?t:o.date;o.month=(o.month!==n)?n:o.month;o.year=(o.year!==z)?z:o.year;o.namedDay=(o.namedDay!==x)?x:o.namedDay;
o.namedMonth=(o.namedMonth!==r)?r:o.namedMonth;if(window.console&&c.log&&l){c.log(j," ### psDateObj=",o);c.log(j," ### amsDate=",u);
c.log(j," ### amsDate day,date,y= ",x," ",t," ",z);}var p=" ";var k=o.namedDay+p+o.namedMonth+p+o.date+p+o.year+p+o.hours+":"+o.minutes;
if(window.console&&c.log&&l){c.log(j," ### pseudoDateStr=",k);}return o;};d.getUTCValues=function(q,t){var m=(typeof t!=="undefined")?t:false;
var j=q.toUTCString();var s=j.split(" ");var p=q.getUTCMonth();if(m){p+=1;}var k=s[0];k=k.substring(0,k.length-1);var o=s[2];
var l=q.toString().split(" ");var n=l[5]+" "+l[6];var r={};r.year=q.getUTCFullYear();r.month=p;r.date=q.getUTCDate();r.hours=Date.padded2(q.getUTCHours());
r.minutes=Date.padded2(q.getUTCMinutes());r.seconds="00";r.namedDay=k;r.namedMonth=o;r.tz=n;return r;};d.formatPseudoDate=function(z,w){w=w+"";
var A="";var p=0;var t="";var l="";var u=z.year+"";var k=z.month;var q=z.namedMonth;var s=z.date;var j=z.namedDay;var x=z.hours;
var r=z.minutes;var o=z.seconds;var n=z.tz;var v={};v.y="'"+u.substring(2,4);v.yyyy=u;v.yy=u.substring(2,4);v.m=k;v.mm=Date.padded2(k);
v.N=q;v.d=s;v.dd=Date.padded2(s);v.D=j;v.H=x;v.M=r;v.S=o;v.T=n;while(p<w.length){t=w.charAt(p);l="";while((w.charAt(p)==t)&&(p<w.length)){l+=w.charAt(p++);
}if(v[l]!=null){A=A+v[l];}else{A=A+l;}}return A;};d.convertUTCTimestampToAMSDate=function(l){var k=new Date(l);var m=d.convertToUTC(k);
var j=d.getAmsterdamDSTOffset(m);k=d.convertToOffset(k,j);return k;};return d;});define("chart/widgetFramework/composed/ecpReport/ecpFormatter",["jqueryExtended","underscore","d3","chartutil/dateUtils_CET","chartutil/d3utils","chart/widgetFramework/core/constants/DataConstants"],function(a,k,l,d,m,h){function f(p,n,o){this.data=p;
this.options=n;this.formattedData={};this.comparator=this.compareFunction;this.reverseDirection=false;this.sortKey=null;this.timeline=o;
}f.prototype.formatData=function(){var o=b(this.data.ecpData);var p=e(o);var n=g(p);this.formattedData=n;if(this.sortKey){this.reverseDirection=!this.reverseDirection;
this.sortData(this.sortKey,true);}this.formattedData=i(this.formattedData);if(this.timeline){this.granularity=this.timeline.getGranularity();
}j(this.formattedData,this.timeline.getDates(),this.granularity);if(window.console&&console.log){console.log("### ecpFormatter::formatData:: this.formattedData=",this.formattedData);
}return{chartData:this.formattedData};};var j=function(p,o,n){var q=function(){return{count:0,rate:0,settledCount:0,countStartDate:null,countEndDate:null,settledCountStartDate:null,settledCountEndDate:null};
};k.each(p,function(s){var v=s.history;var r=k.last(v).date;var u=[o[0],r];var t=m.fillTimeScaleBucketsFromTemplate(u,n,v,q);
s.history=t;});};var c=function(r,p,o){var q=(p<o)?p:o;var n=(p>o)?p:o;return(r-q)/(n-q);};var b=function(o){var n=1.1;k.each(o,function(z){var y=z.currentCount;
var v=z.currentRate;var t=k.max(z.history,function(C){return C.count;});var B=k.max(z.history,function(C){return C.rate;});
var w=k.max([y,t.count]);var A=z.countThreshold;var x=k.max([v,B.rate]);var q=z.rateThreshold;var u,p;if(w<=A){if(x<=q){z.rateLimit=q*n;
}else{z.rateLimit=x*n;}u=c(q,0,z.rateLimit);z.countLimit=A/u;}else{if(x<=q){z.countLimit=w*n;p=c(A,0,z.countLimit);z.rateLimit=q/p;
}else{var s=w/A;var r=x/q;if(s>r){z.countLimit=w*n;p=c(A,0,z.countLimit);z.rateLimit=q/p;}else{z.rateLimit=x*n;u=c(q,0,z.rateLimit);
z.countLimit=A/u;}}}});return o;};var e=function(n){k.each(n,function(r){var o=[];var q={barType:"count",count:r.currentCount,threshold:r.countThreshold};
var p={barType:"rate",rate:r.currentRate,threshold:r.rateThreshold};o.push(q);o.push(p);r.barData=o;});return n;};var g=function(n){k.each(n,function(o){var p=[];
var r={areaType:"to-threshold",start:0,width:o.countThreshold};var q={areaType:"from-threshold",start:o.countThreshold,width:o.countLimit-o.countThreshold};
p.push(r);p.push(q);o.areaData=p;});return n;};var i=function(n){var o=k.chain(n).map(function(p){return p.history;}).flatten().each(function(q){q.dateStr=q.date;
var p=new Date(q.dateStr);q.date=d.roundToDay(p);q.name=q.dateStr;}).value();return n;};f.prototype.sortData=function(n,p){this.sortKey=n;
this.reverseDirection=!this.reverseDirection;var o=k.sortBy(this.formattedData,n);if(this.reverseDirection){o.reverse();}this.formattedData=o;
if(p===true){return;}this.$el.trigger(h.FORMATTER_INFORM_WIDGET,{type:h.SORTED_DATA,data:this.formattedData});};f.prototype.compareFunction=function(n){return n[this.sortKey];
};f.prototype.getData=function(){return(this.data)?this.data:this.formatData();};f.prototype.setRawData=function(n){this.data=n;
};f.prototype.retrieveData=function(n){return this.data[n];};return f;});define("chart/widgetFramework/composed/demo/stackedDataFormatter",["jqueryExtended","underscore","d3","chartutil/dateUtils_CET","chart/widgetFramework/core/constants/DataConstants","chartutil/d3utils"],function(g,b,d,f,e,c){var a=function(k,h,j,m){var i={};
i.data=k;i.options=h;i.formattedData={};i.comparator=null;i.reverseDirection=false;i.sortKey=null;i.timeline=j;i.id=m;i.formatData=function(){this.formattedData=l(this.data);
if(this.sortKey){this.reverseDirection=!this.reverseDirection;this.sortData(this.sortKey,true);}if(window.console&&console.log){console.log("### stackedDataFD::"+this.id+" formatData:: this.formattedData=",this.formattedData);
}return{chartData:this.formattedData};};var l=function(n){b.each(n,function(p){p.dateStr=p.date;var o=new Date(p.dateStr);
p.date=f.trueRoundToDay(o);});return n;};i.calculateMetaData=function(n){b.each(n,function(p){p.dateStr=p.date;var o=new Date(p.dateStr);
p.date=f.trueRoundToDay(o);p.rates=[{name:"authorized",value:p.authorisedEurQuantity,startY:0,endY:p.authorisedEurQuantity},{name:"refused",value:p.cancelledEurQuantity,startY:p.authorisedEurQuantity,endY:p.authorisedEurQuantity+p.cancelledEurQuantity}];
});return n;};i.sortData=function(n,p){this.sortKey=n;this.reverseDirection=!this.reverseDirection;var o=b.sortBy(this.formattedData,n);
if(this.reverseDirection){o.reverse();}this.formattedData=o;if(p===true){return;}this.$el.trigger(e.FORMATTER_INFORM_WIDGET,{type:e.SORTED_DATA,data:{chartData:this.formattedData}});
};i.compareFunction=function(n){return n[this.sortKey];};i.getData=function(){return(this.data)?this.data:this.formatData();
};i.setRawData=function(n){this.data=n;};i.retrieveData=function(n){return this.data[n];};return i;};return a;});define("chartlib/polymorphQ",["jquery","underscore","backbone","d3","chartlib/chartbase","chartutil/d3utils","chartlib/models/chartConfig","chartlib/mixins/charts/vertical","chartlib/mixins/charts/horizontal","chartlib/mixins/scales","chartlib/mixins/axes","chartlib/mixins/tooltip","chartlib/constants/chart","chartlib/constants/colours","chartlib/events/appstateevents","chartlib/polymorph"],function(f,k,j,p,b,q,a,c,h,m,o,i,e,l,g,d){var n=d.extend({defaults:{barPadding:0.1,margin:{top:10,right:10,bottom:20,left:50},niceScales:false,drawTickToChartSize:false,centerTicks:true},initialize:function(){this._super(arguments);
this.configureListeners();return this;},configureListeners:function(){if(this.collection){this.stopListening(this.collection,"reset",this.render);
this.stopListening(this.options.chartConfig,"change",this.reconfigureChart);}j.on(g.RENDER_CHARTS,this.render);},renderData:function(){var r=this.options.chartConfig;
switch(r.get("type")){case e.types.BAR:if(r.get("direction")===e.directions.VERTICAL){k.extend(c.renderBars).apply(this,arguments);
}else{k.extend(h.renderBars).apply(this,arguments);}if(this.options.tooltip){k.extend(i.renderBars).apply(this,arguments);
}break;case e.types.LINE:if(r.get("direction")===e.directions.VERTICAL){k.extend(c.renderLine).apply(this,arguments);}else{k.extend(h.renderLine).apply(this,arguments);
}if(this.options.tooltip){k.extend(i.renderLines).apply(this,arguments);}break;case e.types.STACKED:if(r.get("direction")===e.directions.VERTICAL){k.extend(c.renderStackedBars).apply(this,arguments);
}else{k.extend(h.renderStackedBars).apply(this,arguments);}if(this.options.tooltip){k.extend(i.renderBars).apply(this,arguments);
}break;case e.types.MULTIBAR:if(r.get("direction")===e.directions.VERTICAL){k.extend(c.renderMultiBars).apply(this,arguments);
}else{k.extend(h.renderMultiBars).apply(this,arguments);}if(this.options.tooltip){k.extend(i.renderBars).apply(this,arguments);
}break;case e.types.MULTILINE:if(r.get("direction")===e.directions.VERTICAL){k.extend(c.renderMultiLines).apply(this,arguments);
}else{k.extend(h.renderMultiLines).apply(this,arguments);}if(this.options.tooltip){k.extend(i.renderLines).apply(this,arguments);
}break;case e.types.ENHANCED_MULTILINE:if(r.get("direction")===e.directions.VERTICAL){}else{Object.create(h).renderEnhancedMultiLines.apply(this,arguments);
}if(this.options.tooltip){k.extend(i.renderDots).apply(this,arguments);}break;}}});return n;},function(a){if(window.console&&console.log){console.log("APP JS ERROR =",a);
}});define("chartlib/stackedbarchart",["jquery","underscore","chartlib/barchart","d3"],function(e,a,d,c){var b=d.extend({calibrateXScale:function(){},formatXAxis:function(){var f=this.axes.x;
f.ticks(5).tickFormat(function(h,g){return(g>0)?c.format(".1s")(h*100):c.format(".0%")(h);});},renderXAxis:function(){var f=this.axes.x;
if(this.options.barHeight!==null){f.tickSize(-this.height);}this.svg.select(".x.axis").transition().duration(500).delay(1000).ease("exp-in-out").attr("transform","translate(0,"+this.height+")").call(f);
},renderData:function(l){var j=this,h=this.scales.x,m=this.scales.y;var g=(typeof l!=="undefined")?l:true;if(g===true){j.collection.models.forEach(function(o){var n=0;
e.each(o.get(j.options.xNestAttr),function(p,q){if(o.get("pmName")){q.pmName=o.get("pmName");}q.startX=o.get("total")>0?n/o.get("total"):0;
q.width=o.get("total")>0?Math.max(0,q.value)/o.get("total"):0;n+=Math.max(0,q.value);});});}var k=this.svg.selectAll(".bar").data(this.collection.models,this.joinData);
k.enter().append("g").attr("class","bar").attr("transform",function(n){return"translate(0,"+m(j.getY(n))+")";});k.transition().duration(500).attr("transform",function(n){return"translate(0,"+m(j.getY(n))+")";
});var f=k.selectAll("rect").data(function(n){return n.get(j.options.xNestAttr);},function(n){return n.name;});f.enter().append("rect").attr("class",function(n){return"stack "+n.name;
}).attr("height",m.rangeBand()).attr("x",function(n){return h(n.startX);}).attr("width",0).transition().duration(500).delay(function(o,n){return 500+(n*500);
}).attr("width",function(n){return h(n.width);});if(this.options.tooltip){k.classed("active",true);f.on("mouseover",function(n){j.showTooltip(n,this,false);
}).on("mouseout",function(n){j.hideTooltip();});}f.transition().duration(500).delay(function(o,n){return 500+(n*500);}).attr("x",function(n){return h(n.startX);
}).attr("height",m.rangeBand()).attr("width",function(n){return h(n.width);});f.exit().remove();var i=k.exit().transition();
i.attr("transform",function(n){return"translate(0,"+j.height+")";}).select("rect").attr("height",0);i.remove();},showTooltip:function(l,h,m){this._super(l,h,m);
if(typeof window.SVGElement==="undefined"){var f=e(h)[0].raphaelNode[0];var g=e(f).offset().top;var k=this.$el.offset().left+(this.width/2)-125;
var j=20;var i=e(".d3-tip");i.css({left:(k+10)+"px",top:(g-j)+"px"});if(Number(i[0].clientWidth)<250){i.css("width","250px");
}}}});return b;});define("chart/widgetFramework/composed/harpReportBuilder/HarpBuilderMediator2",["jqueryExtended","lodash","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/core/constants/DataConstants","util/ObjectSuper","chart/widgetFramework/core/BasicMediator","Constants","util/Functional"],function(a,i,g,e,f,h,b,c){var d=function(j){var l;
l=h(j,true);var m=f(l);l.init=function(){m.init();this.dialogShown=false;this.actionCommanderExclusionArray=["actioncommander","dataformatter","timeline"];
};l.getAdditionalDOMElements=function(){m.getAdditionalDOMElements();this.snapshotInstances=[];this.$allSnapshots=this.$el.find("[data-widget*=Snapshot]");
this.totalDomElements+=this.$allSnapshots.length;};l.getWidgets=function(){m.getWidgets();this.getWidgetInstances(this.$allSnapshots,this.snapshotInstances,"Snapshot");
};l.onNotifiedFetcher=function(o,n){m.onNotifiedFetcher(o,n);if(o.changeObject.type===e.NEW_DATA_AVAILABLE&&i.has(o.changeObject.data,"descriptionExists")){if(o.changeObject.data.descriptionExists){a(".pg-observed-input").addClass("pg-input-error").siblings("button").removeClass("rename-button--available").addClass("rename-button--unavailable");
}else{a(".pg-observed-input").removeClass("pg-input-error").siblings("button").removeClass("rename-button--unavailable").addClass("rename-button--available");
a(".pg-observed-button").trigger("clickConfirmed");}}else{if(o.changeObject.type===e.NEW_DATA_AVAILABLE&&i.has(o.changeObject.data,"action")){var p=o.changeObject.data;
this.action=p.action;this.updateUI(p);this.updateSchedulingUi(p);}}};l.onNotifiedFormatter=function(o,n){m.onNotifiedFormatter(o,n);
};l.onNotifiedViewCreator=function(o,n){m.onNotifiedViewCreator(o,n);a("[id^=valueSelectorCarrier]").on("mousewheel",function(){event.stopPropagation();
});if(this.action==="New Split"||this.action==="New Tree"){a(".dimension-selector, .icon-times").removeClass("inactive").addClass("active");
}if(this.action==="Under Schedule"){a(".dimension-selector, .icon-times").addClass("deactivate-scheduling");}this.$el.trigger(b.EV_CONTENT_MERGED);
if(o.changeObject.type===g.CHART_RENDERED){i.each(this.actionCommanderInstances,function(q){var p=i.cloneDeep(q.actions);
var r=p.splice(20);q.unbindEvents(r);q.setUpEvents(r);});}};l.updateUI=function(q){if(q.action==="New Tree"){a("#harpTreePicker").append('<option value ="'+q.treeId+'">'+q.treeName+"</option>");
a("#treeName").val(q.treeName);a("#step2_toggle,#step3_toggle").css({"pointer-events":"all"});a("#step2_toggle").slideDown();
a(".dimension-selector, .icon-times").removeClass("inactive").addClass("active");}if(q.action==="Get Tree"){a(".dimension-selector, .icon-times").removeClass("active").addClass("inactive");
a("#step2_toggle,#step3_toggle").css({"pointer-events":"all"});if(q.pspVisibleOnly===true){a("#permission_switch_container").removeClass("switch-off").addClass("switch-on");
}a("#treeName").val(q.treeName);}if(q.action==="Delete Tree"){a("path, .link, .harpnode").remove();a("#harpTreePicker option[value='"+q.treeId+"']").remove();
a("#harpTreePicker").val("-1");a("#step2_toggle, #step3_toggle").css({"pointer-events":"none"});}if(q.action==="Update Tree"){var o=q.treeName;
var p=q.treeId;if(q.isTemplate){a("#harpTemplatePicker").append('<option value ="'+p+'">'+o+"</option>");a("#message").text("Template Named "+o+" has been created!").fadeIn(1000).delay(1000).fadeOut(2000);
}else{if(q.treeName!==a("#treeName").val()){a("#message").text("Tree has been succesfully renamed to: "+o).fadeIn(1000).delay(1000).fadeOut(2000);
}else{a("#message").text("Psp Visibility for this tree has changed to: "+((a("#permissionSwitch").attr("checked"))?"true":"false")).fadeIn("slow").delay("1000").fadeOut("slow");
}a(".tree-header").text(o);a("#treeName").val(o);a("#edit_controller").slideUp();a("#harpTreePicker option[value='"+q.treeId+"']").text(o);
}}if(q.action==="New Split"){var n=a("#hn_"+q.parentNodeId);n.find(".dimension-selector").remove();n.find(".hn-container").append('<i id="showDeleteSplitDialog_'+q.parentNodeId+'" class="icon-times active"></i>');
a(".dimension-selector").removeClass("inactive").addClass("active");}if(q.action==="Delete Nodechildren"){this.$el.trigger("deleteNodeChildren",{data:q});
}if(q.action==="Update Node"){a("#harp-dialog-overlay").hide();i.each(q.nodes,function(r){if(r.explanation){a("#textAreaExplanation_"+r.harpNodeId).text(r.explanation);
a("#nodeExplanation_"+r.harpNodeId).text("Edit Explanation");}});}};l.updateSchedulingUi=function(p){var n=new Date();if(i.has(p,"action")&&p.action==="Schedule Report"){n.setTime(p.schedulingDate);
var o=n.toFormattedString("yyyy-mm-dd").split(" ")[0];a("#schedule_msg").text("Scheduling Report starting from "+o);a("#datepickStart").val(o).text(o);
a(".harp-edit-button").removeClass("harp-enabled").addClass("harp-disabled").attr("disabled",true);a(".availability-message").show();
a(".dimension-selector, .icon-times").addClass("deactivate-scheduling");a("#showSchedulingDialog").attr("disabled",true);
a("#harp-dialog-overlay").hide();return;}if(p.scheduling&&p.scheduling.status==="no data"){n=k(p.scheduling);a("#schedule_msg").text("Not Scheduled");
a(".harp-edit-button").removeClass("harp-disabled").addClass("harp-enabled").attr("disabled",false);a(".availability-message").hide();
a("#showSchedulingDialog").attr("disabled",false);a("#datepickStart").val(n).text(n);return;}if(p.scheduling&&p.scheduling.status==="runnning"){n=k(p.scheduling);
a("#schedule_msg").text("Scheduling Report starting from "+n);a(".harp-edit-button").removeClass("harp-enabled").addClass("harp-disabled").attr("disabled",true);
this.action="Under Schedule";}if(p.scheduling&&p.scheduling.status==="completed"){n=k(p.scheduling);a("#schedule_msg").text("This report is already scheduled containg data from: "+n);
a(".dimension-selector, .icon-times").removeClass("deactivate-scheduling").addClass("active");a("#showSchedulingDialog").attr("disabled",false);
}};function k(o){var n=new Date();if(o.status==="no data"){n.setTime((new Date()).setDate((new Date()).getDate()-2));}else{n.setTime(o.firstDataStartDate);
}return n.toFormattedString("yyyy-mm-dd").split(" ")[0];}l.forceRebindGlobal=function(){i.each(this.actionCommanderInstances,function(o){var n=i.cloneDeep(o.events);
var p=n.splice(20);o.unbindEvents(p);o.setUpEvents(p);});};l.forceRebindTargeted=function(n){var o=[];i.each(n,function(p){o.push(p.source);
});i.each(this.actionCommanderInstances,function(t){var p=i.cloneDeep(t.events);var u=[];for(var s=p.length;s>0;s--){var r=p[s-1];
if(o.indexOf(r.source)!==-1){var q=o.indexOf(r.source);if(r.source===n[q].source&&n[q].eventType===r.event){u.push(r);}}}t.unbindEvents(u);
t.setUpEvents(u);});};l.showNotification=function(o){window.clearTimeout(window.errormessage);var p=o.message;var n=o.containerClass;
var q="<div class='csr-notification-message-2 error'> <ul><li><i class='icon-exclamation-triangle'></i>"+p+"</li></ul></div>";
var r=a("#message");r.html(q);r.addClass(n);r.fadeIn("fast",function(){window.errormessage=setTimeout(function(){r.fadeOut("slow",function(){r.html("");
r.removeClass(n);});},2000);});};l.getInstance=function(){return this;};l.init();j.ready();return l;};return d;});define("chart/widgetFramework/composed/chargebackReport/formatters/cfnLineFormatter",["underscore","chart/widgetFramework/core/constants/DataConstants"],function(b,c){var a=function(g,d,f,h){var e={};
e.data=g;e.options=d;e.formattedData={};e.comparator=null;e.reverseDirection=false;e.sortKey=null;e.timeline=f;e.id=h;e.dataType="count";
e.formatData=function(){var j={};var i=this.calculateMetaData(this.data);if(window.console&&console.log){console.log("### cfnLineFormatter::formatData:: formattedData=",i);
}return{config:j,chartData:i};};e.calculateMetaData=function(k){var j=[];var i=[];var l,m;b.each(k,function(q){var n=+q.authorisedEurAmount/100;
var p=+q.chargebackEurAmount/100;var o=+q.fraudNotificationsEurAmount/100;if(e.dataType==="count"){l=(q.chargebackCount>0)?(q.chargebackCount/(q.authorisedCount)*100):0;
j.push({date:q.date,value:l});m=(q.fraudNotificationsCount>0)?(q.fraudNotificationsCount/(q.authorisedCount)*100):0;i.push({date:q.date,value:m});
}else{l=(p>0)?(p/n)*100:0;j.push({date:q.date,value:l});m=(o>0)?(o/n)*100:0;i.push({date:q.date,value:m});}});return{cfnLineData:[{name:"Chargeback",lineValues:j},{name:"Notifications of fraud",lineValues:i}]};
};e.reformatData=function(i){this.dataType=i;var j=this.formatData();this.$el.trigger(c.FORMATTER_INFORM_WIDGET,{type:c.REFORMATTED_DATA,data:j});
};e.setRawData=function(i){this.data=i;};return e;};return a;});define("chart/widgetFramework/components/basicTooltip",["jquery","underscore","hogan"],function(e,b,a){var c=null;var d=function(f,h){var g={};
g.init=function(){this.name=f.name;if(!c){var i="position:absolute; display:none;";if(f.sticky!==true){i+="pointer-events:none;";
}c=this.$container=e("<div id='chartRolloverHolder' class='widget-tooltip' style='"+i+"'></div>");h.append(this.$container);
}else{this.$container=c;}require(["text!chart/widgetFramework/"+f.template],function(j){g.template=a.compile(j);});};g.render=function(i,j){if(!this.template){return;
}var k=this.template.render(j);this.$container.html(k);if(i){i.opacity=1;this.$container.stop(true);this.$container.animate(i,100,"linear");
}return this.$container;};g.hide=function(){this.$container.stop();this.$container.fadeTo(150,0);};g.show=function(){this.$container.stop();
this.$container.fadeTo(200,1);};g.setPosition=function(i){this.$container.css(i);this.hide();};g.init();return g;};return d;
});define("chart/widgetFramework/composed/transactionsDashboard/formatters/granularAuthsLineFormatter",["jqueryExtended","underscore","d3","chartutil/dateUtils_CET","chart/widgetFramework/core/constants/DataConstants","timeline/util/timelineConstants","chartutil/d3utils"],function(h,c,e,g,f,a,d){function b(l,i,k,m){var j={};
j.data=l;j.options=i;j.formattedData={};j.comparator=null;j.reverseDirection=false;j.sortKey=null;j.timeline=k;j.id=m;j.granularity="month";
j.rollingAvg7LineData=null;j.rollingAvg30LineData=null;j.currentRollingAvgType="avg7";j.formatData=function(){var n=this.calculateMetaData(this.data);
this.formattedData=n.formattedData;this.rollingAvg7LineData=n.rollingAvg7LineData;this.rollingAvg30LineData=n.rollingAvg30LineData;
if(window.console&&console.log){console.log("### granularAuthsLineFormatter::formatData:: this.formattedData=",this.formattedData);
}return{config:{},chartData:c.cloneDeep(this.formattedData),extraData:{authRateOverHundred:n.authRateOverHundred}};};j.calculateMetaData=function(v){var s=[];
var L=[];var H=[];var w=[];var A,E,y,t,o,z;var K=false;var n=a.__TODAY;var r=this.timeline.timelineData.getValue("timeCollectionMode");
if(r==="latest"&&this.granularity==="day"){var u=new Date();var x=u.getFullYear();var J=u.getMonth();var I=u.getDate();n=new Date(x,J,I);
}c.each(v,function(M){A=M.authRate;E=A*100;if(M.date>=n){E=null;}if(E&&E>100){K=true;}z=(E)?M.dateStr:"";s.push({date:M.date,value:E,namex:z});
y=(M.rollingAverage7)?M.rollingAverage7*100:null;if(M.date>=n){y=null;}z=(y)?M.dateStr:"";L.push({date:M.date,value:y,namex:z});
t=(M.rollingAverage30)?M.rollingAverage30*100:null;if(M.date>=n){t=null;}z=(t)?M.dateStr:"";H.push({date:M.date,value:t,namex:z});
switch(j.granularity){case"month":o=e.time.format("%B %Y")(M.date);break;case"week":o="wk "+M.date.getWeek(true)+" - "+M.date.getFullYear();
break;case"day":o=g.getUserFriendlyDate(M.dateStr)+" "+M.date.getFullYear();break;}w.push({date:M.date,dateStr:M.dateStr,formattedTimespan:o,authRate:(E)?E:null,rollingAvg7:(y)?y:0,rollingAvg30:(t)?t:0});
});var B=false;var p=L.length;if(p>=9&&this.granularity==="day"){for(var G=0;G<p;G++){if(L[G].value!==null){B=true;break;
}}}if(!B){L=[];c.each(w,function(M){M.rollingAvg7=null;});}var C=false;var q=H.length;if(q>=32&&this.granularity==="day"){for(var D=0;
D<q;D++){if(H[D].value!==null){C=true;break;}}}if(!C){H=[];c.each(w,function(M){M.rollingAvg30=null;});}var F=(this.currentRollingAvgType==="avg7")?L:H;
return{rollingAvg7LineData:L,rollingAvg30LineData:H,formattedData:{authRateLineData:[{namex:"Auth rate",lineValues:s},{namex:"Rolling average",lineValues:F}],authRateRolloverData:w},authRateOverHundred:K};
};j.setGranularity=function(n){this.granularity=n;};j.setRollingAverageData=function(n){this.currentRollingAvgType=n;this.formattedData.authRateLineData[1].lineValues=(n==="avg7")?this.rollingAvg7LineData:this.rollingAvg30LineData;
this.$el.trigger(f.FORMATTER_INFORM_WIDGET,{type:f.REFORMATTED_DATA,data:{config:{},chartData:c.cloneDeep(this.formattedData)}});
};j.sortData=function(n,p){this.sortKey=n;this.reverseDirection=!this.reverseDirection;var o=c.sortBy(this.formattedData,n);
if(this.reverseDirection){o.reverse();}this.formattedData=o;if(p===true){return;}this.$el.trigger(f.FORMATTER_INFORM_WIDGET,{type:f.SORTED_DATA,data:{chartData:this.formattedData}});
};j.compareFunction=function(n){return n[this.sortKey];};j.getData=function(){return(this.data)?this.data:this.formatData();
};j.setRawData=function(n){this.data=n;};j.retrieveData=function(n){return this.data[n];};j.setOptions=function(n){this.options=n;
};return j;}return b;});define("chartlib/bulletChart",["jquery","underscore","backbone","chartlib/basicChart","d3"],function(d,b,f,a,c){var e=a.extend({defaults:{minAttr:"lower",maxAttr:"upper",rangeAttr:"stddev",measureAttr:"delta",markerAttr:"average",margin:{top:20,left:15,bottom:20,right:15}},initialize:function(){b.bindAll(this,"renderBackground","renderRange","renderMeasure");
this.collection=new f.Collection();this._super(arguments);},calibrateXScale:function(){var g=this.options;this.scales.x.domain([0,this._getDatumValue(this.model,g.markerAttr)*2]);
},setXAxis:function(){var g=c.scale.linear().domain([-1,1]).range([0,this.width]);this.axes.x=c.svg.axis().scale(g).orient("bottom").ticks(2).tickSize(-this.height).tickFormat(c.format("1%"));
},renderData:function(){this.renderBackground();this.renderRange();this.renderMarker();this.renderMeasure();},renderBackground:function(){var g=this.svg.selectAll(".bullet.full").data([this.model],this.joinData);
var i=g.enter().append("g").attr("class","bullet full").append("rect");var h=g.select("rect").attr("height",this.height).attr("width",this.width);
g.exit().remove();},renderRange:function(){var o=this.options,m=this.scales.x,h=this._getDatumValue(this.model,o.minAttr),l=this._getDatumValue(this.model,o.maxAttr),i=this._getDatumValue(this.model,o.rangeAttr),p=this._getDatumValue(this.model,o.markerAttr),n=m(i*2);
var k=this.svg.selectAll(".bullet.range").data([this.model],this.joinData);var j=k.enter().append("g").attr("class","bullet range").append("rect").attr("width",0).attr("height",this.height);
var g=k.select("rect").transition().duration(500).delay(500).ease("cubic-in-out").attr("width",n).attr("x",function(){return m(p)-(n/2);
});k.exit().remove();},renderMeasure:function(){var m=this,q=this.options,o=this.scales.x,j=this._getDatumValue(this.model,q.minAttr),n=this._getDatumValue(this.model,q.maxAttr),g=this._getDatumValue(this.model,q.measureAttr),r=this._getDatumValue(this.model,q.markerAttr),h=Math.abs((g/100)*(this.width/2)),p=10;
var l=this.svg.selectAll(".bullet.measure").data([this.model],this.joinData);var k=l.enter().append("g").attr("class",function(){var s="bullet measure";
if(m.model.below_stddev===true){return s+" red";}if(m.model.above_stddev===true){return s+" green";}return s;}).append("rect").attr("x",o(r)).attr("y",(m.height-p)/2).attr("width",0).attr("height",p);
var i=l.select("rect").transition().duration(500).delay(500).ease("cubic-in-out").attr("x",function(){if(g>0){return o(r);
}else{return o(r)-(h);}}).attr("width",h);l.exit().remove();},renderMarker:function(){var m=this,j=this.options,g=this.scales.x,i=this._getDatumValue(this.model,j.markerAttr);
var h=this.svg.selectAll(".bullet.marker").data([this.model],this.joinData);var l=h.enter().append("g").attr("class","bullet marker").append("line");
var k=h.select("line").attr("x1",g(i)).attr("y1",0).attr("x2",g(i)).attr("y2",m.height);h.exit().remove();},renderTooltipContent:function(h,i){var g=this;
this.tip.html(function(j){return"<strong>"+h+"</strong> ";});this.tip.direction("n");this.tip.offset([-10,0]);},setYScale:function(){},calibrateYScale:function(){},setYAxis:function(){},formatYAxis:function(){},renderYAxis:function(){}});
return e;},function(a){if(window.console&&console.log){console.log("APP JS ERROR =",a);}});define("chart/widgetFramework/composed/harpViewer/baselineRatesChart2",["jquery","underscore","d3","hogan","chartutil/d3utils","chartutil/stringutils","chart/widgetFramework/core/mixins/widgetScales","chart/widgetFramework/core/mixins/formats","util/Functional","chart/widgetFramework/chartTypes/lineChart","util/ObjectSuper"],function(d,g,k,e,l,b,j,c,a,i,f){var h=function(s,m,q,o){var p;
var r={};var n=g.defaults(r,s);p=i(n,m);var t=f(p);p.renderTickDelay=550;p.init=function(){t.init();g.bindAll(this,"chartTypeSelected");
this.chartType="total";};p.feedData=function(u){this.configData=u.config||{};this.extraData=u.extraData||{};this.tempData={lines:[{name:"baseline",lineValues:u.chartData}]};
this.data=this.tempData.lines;this.isModeChange=false;this.setNestedAttr(this.data,true);this.options.joinAttr="name";};p.chartTypeSelected=function(u){var v=u[0];
if(v===this.chartType){return;}this.chartType=v;this.isModeChange=true;this.render();};p.formatXAxis=function(u){this.baselineFormatTimeXAxis(this.options.xAttr);
};p.baselineFormatTimeXAxis=function(y){var w=this,v=this.axes[y],x=this.configData.granularity,z="wk ",u=this.scales[y].ticks(k.time[x],1).length;
if(u>40){x="month";}v.ticks(k.time[x],1).tickFormat(function(C,A){var B;if(A>0){B=w.granularityFormats[x];}else{if(u>25&&x==="day"){B=w.granularityFormats[x];
}else{B=w.granularityFormats[x+"_start"];}}return B(C);});};p.calibrateYScale=function(){var u=this;g.each(this.dimensionsYArray,function(x){if(x==="authRate"){var w=u.data[0][u.nestedAttr].filter(function(y){return y.utcdate.getTime()<=u.configData.lastModelDate.getTime();
});w=g.pluck(w,u.options.yAttr);switch(u.chartType){case"zoom":u.scales[x].domain([k.min(w),k.max(w)]).nice();break;default:u.scales[x].domain([0,100]);
break;}}else{var v=u.calibrateYScaleFns[x];v.apply(u);}});};p.renderYAxis=function(){t.renderYAxis();setTimeout(function(){c.lastTickFormat(p,p.options.yAxisIsPercent);
},p.renderTickDelay);};p.xAccessor=function(y){var u=this.scales[this.options.xAttr],w=this.options.centerPoints,v=this;if(w){return function(x){return u(v.getXAttrVal(x))+(((v.width/2)-u(v.getXAttrVal(x)))/v.maxLinePoints);
};}else{return function(x){return u(v.getXAttrVal(x));};}};p.yAccessor=function(v){var w=this.scales[this.options.yAttr],u=this;
return function(x){return w(u.getYAttrVal(x));};};p.getLineData=function(w){var u=this;var v=w[u.nestedAttr].filter(function(x){return x.utcdate.getTime()<=u.configData.lastModelDate.getTime();
});return v;};p.renderData=function(){t.renderData();var y=this,v=500,w="avg-baseline",z="averageRate";var B=function(C){var D=y.scales[y.options.yAttr];
return function(E){return D(E[z]);};};var x=function(D){var C=D[y.nestedAttr].filter(function(E){return(a.existy(E[z])&&E.utcdate.getTime()<=y.configData.lastModelDate.getTime());
});return C;};var u=this.chartGroup.selectAll("."+w).data(this.getData(),this.getPrimaryDataJoin());var A=u.enter().append("g").attr("class",function(D){var C=b.lowerCaseReplaceSpace(D[y.options.joinAttr],"-");
if(C.length){return w+" "+C;}else{return w;}}).append("path").attr("class","line");u.select(".line").attr("d",function(C){return p.lineUtils.lineCreator("L","linear",x(C),y.xAccessor(C),B(C),"enter",k.select(this));
}).transition().duration(v).ease("exp-in-out").style("opacity",1).attr("d",function(C){return p.lineUtils.lineCreator("L","linear",x(C),y.xAccessor(C),B(C),"update");
});};return p;};return h;});define("chart/widgetFramework/composed/harpViewer/BaselineDataFormatter",["jqueryExtended","underscore","d3","chartutil/dateUtils_CET","chartutil/d3utils"],function(h,d,f,g,e){function a(k,i,j){this.data=k;
this.options=i;this.timeline=j;this.formattedData={};this.sortKey="date";this.reverseDirection=false;this.movingAverageNum=7;
this.movingAverageDirection="backward";this.granularity="day";}a.prototype.formatData=function(){this.intervalFormat=f.time[this.granularity];
this.dateExtent=d.clone(this.timeline.getDates());this.dateExtent[1]=f.time[this.granularity].utc.offset(this.dateExtent[1],-1);
var j=this.data.baselineStats;var k=c(j);if(this.sortKey){this.reverseDirection=!this.reverseDirection;k=this.sortData(this.sortKey,k);
}this.bucketFillData(k);this.baselineData.forEach(function(m){var l=0;h.each(m.rates,function(n,o){o.startY=l;o.endY=(l+o.value);
l+=o.value;});});var i={};i.intervalFormat=this.intervalFormat;i.dateExtent=this.dateExtent;i.lastModelDate=this.lastModelDate;
i.granularity=this.granularity;this.parsedData={config:i,chartData:this.baselineData};return this.parsedData;};function c(i){var j=[];
d.each(i,function(l){var k=b(l);j.push(k);});return j;}function b(j){var i={};i.name="merchant";i.timestamp=(j.millisecondsutc)?j.millisecondsutc:j.day;
i.date=new Date(i.timestamp);i.date=g.trueRoundToDay(i.date);i.utcdate=g.convertToUTC(new Date(i.timestamp));i.authorisations=j.auths;
i.total=j.total;i.authRate=(j.auths/j.total)*100;i.rates=[{name:"authorised",value:j.auths},{name:"abandoned",value:(j.auths<=j.total)?(j.total-j.auths):0}];
return i;}a.prototype.bucketFillData=function(i){var k=d.last(i);if(typeof(k)!=="undefined"){this.lastModelDate=k.utcdate;
}else{this.lastModelDate=this.dateExtent[0];}var j=e.fillTimeScaleBucketsNonBackbone(this.dateExtent,this.granularity,i);
this.baselineData=j;this.calculateMovingAverages();};a.prototype.calculateMovingAverages=function(){var i=this;d.each(this.baselineData,function(n,j){var o;
if(i.movingAverageDirection==="forward"){o=(j+1)+i.movingAverageNum;}else{o=(j+1)-i.movingAverageNum;}var l,m,k;if((i.movingAverageDirection==="forward"&&o<i.length)||(i.movingAverageDirection==="backward"&&o>-1)){if(i.movingAverageDirection==="forward"){l=i.baselineData.slice(j+1,o);
}else{l=i.baselineData.slice(o,j+1);}m=d.reduceRight(l,function(p,q){return p+q.total;},0);k=d.reduceRight(l,function(p,q){return p+q.authorisations;
},0);n.averageTotal=m/i.movingAverageNum;n.averageRate=(k/m)*100||0;}});};a.prototype.sortData=function(i,k){this.sortKey=i;
this.reverseDirection=!this.reverseDirection;var j=d.sortBy(k,i);if(this.reverseDirection){j.reverse();}return j;};a.prototype.getData=function(){return(this.parsedData)?this.parsedData:this.formatData();
};a.prototype.setRawData=function(i){this.data=i;};a.prototype.setOptions=function(i){this.options=i;};return a;});define("chart/widgetFramework/composed/harpViewer/nodeInfoPanel",["jquery","underscore","d3","hogan","util/Functional","chartutil/stringutils","chart/widgetFramework/core/constants/WidgetConstants","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/drivers/baseView"],function(c,j,k,g,a,b,f,i,h,d){var e=function(r,l,p,n){var o;
var q={};var m=j.defaults(r,q);o=d(m,l);var s=h(o);o.init=function(){s.init();this.template=g.compile(n);};o.feedData=function(t){this.data=t;
};o.renderData=function(){var t=this.template.render({desc:this.data.description,title:this.data.descriptionTitle});this.$el.html(t);
this.infoShow();};o.infoShow=function(v){var t=this.$el.find("#removeBtn");var u=(t.length)?t:c("#subcontent");this.$el.fadeTo(500,1,function(){});
};o.infoHide=function(v){var t=v.data.infoPanel;var u=v.data.closeElement;var w=t.is(":hover");if(w){return;}u.off("click");
t.fadeTo(250,0);};return o;};return e;});define("chart/widgetFramework/composed/shopperdna/manualReviewMediator",["jqueryExtended","lodash","chart/widgetFramework/core/BasicMediator","util/ObjectSuper"],function(e,a,c,d){function b(f){var g=c(f,true);
var h=d(g);g.init=function(){h.init();this.actionCommanderExclusionArray=["actioncommander"];g.$el.trigger("updateState","Loading ShopperDNA Network.");
};g.retryCount=0;g.retryFetching=function(){if(g.retryCount<2){g.$el.trigger("widgetAppStartup");g.retryCount++;}else{g.$el.trigger("updateState","Loading ShopperDNA network failed. Please refresh to try again.");
g.$el.trigger("hideCharts");}};g.onNotifiedViewCreator=function(j,i){h.onNotifiedViewCreator(j,i);if(i==="shopperdnaLegend"&&j.changeObject.type==="chartFirstRender"){e("#shopperdnaLegend").height(e("#shopperdnaLegend").height());
}};g.init();f.ready();return g;}return b;});define("chart/widgetFramework/composed/manualReview/formatters/manualReviewFormatter",["jqueryExtended","lodash","d3"],function(d,a,b){function c(g,f){if(adyen&&adyen.config&&adyen.config.devl){g=adyen.config.dummyData;
}if(!g.match(/\n/)){g=g.replace(/\s+([\d,])/gi,"\n$1");}var e=b.csv.parse(g);this.data=this.formatToShopperDnaData(e);this.options=f;
this.formattedData={};this.styles=f.styles;this.statusCollection=this.styles.status;}c.prototype.formatData=function(){var e=this.getHierarchies();
var f=this.getMatrix(e);var h=this.getLinkingIdentifiersMap(this.data);var g=this.getCardMap(this.data);this.formattedData={hierarchies:e,matrix:f,linkingIdentifiersMap:h,cardMapping:g,data:this.data,styles:this.styles};
return this.formattedData;};c.prototype.setRawData=function(e){this.data=e;};c.prototype.formatToShopperDnaData=function(e){return a.chain(e).map(function(f){var g=f.Status||"";
if(g.indexOf("Refunded")>-1){g="Refunded";}else{if(g.indexOf("Settle")>-1){g="Settled";}}return{pspreference:f["PSP Reference"]||"",laststatus:g,eventidentifiers:{"HashedCardNumber.value":f["Card Number Summary"]||"","ShopperEmail.email":f["Shopper Email"]||"","ShopperReference.text":f["Shopper Reference"]||"","IPAddress.ip":f["Shopper IP"]||"",pspref:(adyen.config.pspref===f["PSP Reference"])?f["PSP Reference"]||"":""},eventmetrics:{"Amount.euramount":+f["EUR Amount"]*100||"","BIN.value":f["Card Number Summary"].substring(0,6),"CardNumberSummary.value":f["Card Number Summary"].substring(f["Card Number Summary"].length-4)},journals:[{journaltype:g}]};
}).value();};c.prototype.getCardMap=function(h){var g=[],f,e;a.each(h,function(i){f=i.eventmetrics["BIN.value"]+"***"+i.eventmetrics["CardNumberSummary.value"];
e=i.eventidentifiers["HashedCardNumber.value"];if(!g[e]){g[e]=f;}});return g;};c.prototype.setOptions=function(e){this.options=e;
};c.prototype.getLinkingIdentifiersMap=function(f){var e=this;var g={};a.each(f,function(m,i){var h=m.eventidentifiers;if(h){for(var n in h){if(h.hasOwnProperty(n)){var j=n;
var k=h[n];if(a.isObject(k)){k=e.parseObject(k,"|");}if(g[j]){if(g[j][k]){g[j][k].push(i);}else{g[j][k]=[i];}}else{var l=[i];
g[j]={};g[j][k]=l;}}}}});return g;};c.prototype.getHierarchies=function(){var f=this;var i=[],e={name:"",children:[]};var g=e.children=a.chain(f.data).map(function(j){return a.keys(j.eventidentifiers);
}).flatten().unique().filter(function(j){return j!=="Status";}).map(function(j){return{name:j,children:[],key:j,parent:e};
}).value();a.each(g,function(k){var j=a.find(f.styles.identifierStyles,function(l){return l.type===k.name;});k.textName=j.textName;
k.children=a.chain(f.data).groupBy(function(m){var l=k.name;var n=m.eventidentifiers[l];if(a.isObject(n)){n=f.parseObject(n,"|");
}return n;}).map(function(m,n){var l={key:n,name:n,parent:k,childNodes:m};i.push(l);return l;}).filter(function(l){return l.name!=="";
}).value();});a.each(g,function(j){a.each(j.children,function(l){if(l.childNodes){var k=[];a.each(l.childNodes,function(n){var o=[];
for(var m in n.eventidentifiers){if(n.eventidentifiers.hasOwnProperty(m)){var p=n.eventidentifiers[m];if(a.isObject(p)){p=f.parseObject(p,"|");
}o.push(p);}}a.each(o,function(q){var r=a.findWhere(i,{name:q});if(typeof r!=="undefined"&&r.name!==""){k.push({childNode:r});
}});});l.childNodes=a.unique(k,false,function(m){return m.childNode.name;});}});});g=g.sort(h);function h(k,j){if(k.key<j.key){return -1;
}else{if(k.key>j.key){return 1;}else{return 0;}}}a.each(g,function(l){if(l.name==="ShopperEmail.email"){l.children.sort(function(n,m){var j=n.key.substr(n.key.indexOf("@")+1);
var q=m.key.substr(m.key.indexOf("@")+1);var p=n.key.substr(0,n.key.indexOf("@"));var o=m.key.substr(0,m.key.indexOf("@"));
if(j<q){return -1;}if(j>q){return 1;}if(p<o){return -1;}if(p>o){return 1;}return 0;});}else{if(l.name==="IPAddress.ip"){l.children.sort(function(m,j){var o=m.key.split(".");
var n=j.key.split(".");if(+o[0]<+n[0]){return -1;}if(+o[0]>+n[0]){return 1;}if(+o[1]<+n[1]){return -1;}if(+o[1]>+n[1]){return 1;
}if(+o[2]<+n[2]){return -1;}if(+o[2]>+n[2]){return 1;}if(+o[3]<+n[3]){return -1;}if(+o[3]>+n[3]){return 1;}return 0;});}else{l.children.sort(function(n,m){var j=n.key.toLowerCase(),o=m.key.toLowerCase();
return j<o?-1:j>o?1:0;});}}for(var k=0;k<l.children.length;k++){l.children[k].order=k;}});return e;};c.prototype.getMatrix=function(e){var h=b.map();
var g=b.map();var f=[],j=0;var i=e.children;i.forEach(function(k){if(!g.has(k.name)){h.set(j,k.name);g.set(k.name,j++);k.matrixIndex=j;
}});i.forEach(function(o){var m=g.get(o.name),n=f[m];if(!n){n=f[m]=[];for(var l=-1;++l<j;){n[l]=0;}}var k=a.filter(o.children,function(p){return p.name!=="";
});n[g.get(o.name)]=k.length;});return f;};c.prototype.parseObject=function(l,k){var j=[];for(var g in l){if(l.hasOwnProperty(g)){j=j.concat(l[g]);
}}var h="["+k+"]";var f=new RegExp(h,"g");for(var e=0;e<j.length;e++){j[e]=j[e].replace(f,"");}j.reverse();return j.join(" "+k+" ");
};return c;});define("chart/widgetFramework/composed/riskReport/riskReportMediator",["jqueryExtended","d3","lodash","chart/widgetFramework/core/BasicMediator","util/ObjectSuper","chartutil/numberutils","chartutil/domUtils","chart/widgetFramework/composed/riskReport/constants/riskConstants","chart/widgetFramework/core/constants/UIConstants"],function(a,n,j,i,g,k,b,d,h){var m=adyen.config||{};
var c=false;var f=false;var e=false;var l=function(o){var p;p=i(o,true);var q=g(p);p.showChargebackLineFlag=true;p.init=function(){q.init();
this.actionCommanderExclusionArray=["actioncommander","timeline"];m.chargebackRowVis="tt-row-no-visible";};p.getAdditionalDOMElements=function(){q.getAdditionalDOMElements();
this.timelineInstances=[];this.$allTimelines=this.$el.find("[data-widget*=Timeline]");this.totalDomElements+=this.$allTimelines.length;
this.snapshotInstances=[];this.$allSnapshots=this.$el.find("[data-widget*=Snapshot]");this.totalDomElements+=this.$allSnapshots.length;
};p.getWidgets=function(){q.getWidgets();this.getWidgetInstances(this.$allTimelines,this.timelineInstances,"Timelines");this.getWidgetInstances(this.$allSnapshots,this.snapshotInstances,"Snapshots");
};p.onNotifiedFetcher=function(t,s){q.onNotifiedFetcher(t,s);if(s==="issuerCountriesFetcher"){var x,w=this.$el.find("#issuerCountry"),r=false;
x='<option value="">-- all Issuer Countries --</option>';j.each(t.changeObject.data,function(z){if(!z){return;}if(j.isObject(z)){if(p.storedIssuerCountry&&p.storedIssuerCountry===z.countryCode){r=true;
}x+='<option value="'+z.countryCode+'">'+z.countryName+"</option>";}else{if(p.storedIssuerCountry&&p.storedIssuerCountry===z){r=true;
}x+='<option value="'+z+'">'+z+"</option>";}});w.html(x);if(this.storedIssuerCountry&&r){a("#issuerCountry").val(this.storedIssuerCountry);
}}if(s==="activePaymentMethodsFetcher"){var y,u=this.$el.find("#paymentMethod"),v=false;y='<option value="">-- all Payment Methods --</option>';
j.each(t.changeObject.data,function(z){if(p.storedPaymentMethod&&p.storedPaymentMethod===z){v=true;}y+='<option value="'+z+'">'+z+"</option>";
});u.html(y);if(this.storedPaymentMethod&&v){a("#paymentMethod").val(this.storedPaymentMethod);}}};p.onNotifiedFormatter=function(s,x){q.onNotifiedFormatter(s,x);
if(x==="receivedTxCountStackedFormatter"){var y=0,t=0,v=0,u=0,r=0,z=n.format(",.2f"),w=n.format(",.0f");j.each(s.changeObject.data.chartData,function(A){v+=(A[d.RECEIVED_TX_TOTAL]);
u+=A[d.RECEIVED_TX_GPM_TOTAL];r+=A[d.RECEIVED_TX_REVPRO_TOTAL];});if(v>0){y=(u/v)*100;t=(r/v)*100;}if(a("#issuerCountry").val()!==""){a(".total-volume").fadeTo(1000,0);
}else{a(".total-volume").fadeTo(500,1);k.animateValue(a("#avgGuaranteed"),y,z);k.animateValue(a("#avgRevPro"),t,z);k.animateValue(a("#totalReceived"),v,w);
k.animateValue(a("#totalGuaranteed"),u,w);k.animateValue(a("#totalRevPro"),r,w);}}if(x==="lineFormatter"){this.lineFormatterRolloverData=s.changeObject.data.chartData.refusalAndChargebackRolloverData;
this.checkFormatterCallbacks();}if(x==="chargebackRateLineFormatter"){if(s.changeObject.data.chartData){this.chargebackLineFormatterData=s.changeObject.data.chartData[0].lineValues;
this.checkFormatterCallbacks();}}};p.checkFormatterCallbacks=function(t){if(this.lineFormatterRolloverData&&this.chargebackLineFormatterData){for(var s=0,r=this.lineFormatterRolloverData.length;
s<r;s++){var u=this.lineFormatterRolloverData[s];var v=this.chargebackLineFormatterData[s];if(u.dateStr===v.name){u.chargebackPercent=v.value;
}}if(!this.showChargebackLineFlag){this.feedDataToRefusalChargebacksLineRollover();}}};p.feedDataToRefusalChargebacksLineRollover=function(){var r=this.getInstanceById("#chargebackLineChartWidget");
var s=this.getInstanceById("#refusalChargebacksLineRollover");r.chart.renderXAxis();s.chart.feedData({config:{},chartData:{refusalAndChargebackRolloverData:this.lineFormatterRolloverData}});
s.chart.render();if(this.chargebackLineVisible){a(".thin-bar.two").css("display","inline");}else{a(".thin-bar.two").css("display","none");
}};p.onNotifiedViewCreator=function(t,r){q.onNotifiedViewCreator(t,r);var s=t.changeObject.type;if(r==="riskChecksStacked"&&(s===h.CHART_INITIALISED||s===h.CHART_UPDATED)){a("#riskChecksSpinner").hide();
a(".risk-check-element").stop();a(".risk-check-element").fadeTo(1000,1);a(".risk-checks-sort-holder").css("pointer-events","auto");
}if(r==="refusalRateLine"&&s===h.CHART_FIRST_RENDER){this.refusalRatesLineChartRendered=true;this.checkViewCallbacks();}if(r==="refusalChargebacksLineRollover"&&s===h.CHART_FIRST_RENDER){this.refusalChargebacksLineRolloverRendered=true;
this.checkViewCallbacks();}};p.checkViewCallbacks=function(){if(this.refusalRatesLineChartRendered&&this.refusalChargebacksLineRolloverRendered){var r=a("#refusalRateLine").height();
p.$el.trigger("setRolloverHeight",{state:"hidden",height:r});}};p.onTimeData=function(){this.lineFormatterRolloverData=null;
this.chargebackLineFormatterData=null;a("#riskChecksSpinner").show();a(".risk-check-element").stop();a(".risk-check-element").fadeTo(500,0);
a(".risk-checks-sort-holder").css("pointer-events","none");if(a("#issuerCountry").val()!==""){this.storedIssuerCountry=a("#issuerCountry").val();
}else{this.storedIssuerCountry=null;}if(a("#paymentMethod").val()!==""){this.storedPaymentMethod=a("#paymentMethod").val();
}else{this.storedPaymentMethod=null;}};p.toggleChargebackRate=function(){var s=a("#chargeback-rate-toggle");var t=a("#chargebackContent");
var u="Compare with chargeback rate";var r="Hide chargeback rate";t.slideToggle();a(".chargeback-panel h2").fadeToggle();
if(s.text()===u){this.chargebackLineVisible=true;if(this.showChargebackLineFlag){this.feedDataToRefusalChargebacksLineRollover();
this.showChargebackLineFlag=false;}a(".thin-bar.two").css("display","inline");s.text(r);m.chargebackRowVis="tt-row-visible";
p.$el.trigger("setRolloverHeight",{state:"shown"});}else{this.chargebackLineVisible=false;a(".thin-bar.two").css("display","none");
s.text(u);m.chargebackRowVis="tt-row-no-visible";p.$el.trigger("setRolloverHeight",{state:"hidden",height:a("#refusalRateLine").height()});
}};p.takeRiskChecksSnapshot=function(){var u=b.cloneNode(".risk-checks-legend-holder","riskChecksLegend");var t=["riskReport/css/widgetReport.css"];
b.applyStylesAsInline(u,t);var s=b.nodeToString(u);var r=this.getInstanceById("snapshotRiskCheck",this.snapshotInstances);
r.setHtmlStr(s);r.takeSnapshot();};p.takeFraudScoreStackSnapshot=function(){var u=b.cloneNode(".legend-wrapper","fraudScoreStackLegend");
document.body.appendChild(u);var t=["riskReport/css/widgetReport.css"];b.applyStylesAsInline(u,t);var s=b.nodeToString(u);
var r=this.getInstanceById("snapshotFraudScoreStack",this.snapshotInstances);r.setHtmlStr(s);r.takeSnapshot();};p.getInstance=function(){return this;
};p.init();o.ready();return p;};return l;});define("chart/widgetFramework/core/ActionCommander",["jqueryExtended","lodash","util/Console","util/Analytics"],function(e,c,b,a){function d(f){var h="color:red;font-size:1em";
var g={};g.init=function(){g.parameters=g.getParameters(f);g.$node=g.$el=f.getNode();g.widgetInstances=[];g.actions=(g.parameters.actions||[]);
g.actionsFilePromise=new e.Deferred();if(g.parameters.actionsFile){g.getActions(g.parameters.actionsFile);}else{g.actionsFilePromise.resolve();
}};g.getParameters=function(i){var j=i.getNode().data();return{actions:j.actions,actionsFile:j.actionsfile};};g.getActions=function(i){g.$node.widget().then(function(){require([i],function(j){g.actions=g.actions.concat(j.actions);
g.actionsFilePromise.resolve();},function(j){b.log("VizComp:: Formatter widget error: ",j);});});};g.pushAllInstances=function(i){c.each(i,function(j){g.widgetInstances.push(j);
j.ac=g;});g.setUpEventsPromise=new e.Deferred();g.actionsFilePromise.done(function(){g.setUpEvents();});return g.setUpEventsPromise;
};g.setUpEvents=function(i){var j=(i||g.actions);c.each(j,function(l){if(c.isArray(l.source)){var k=l.source;c.each(k,function(m){g.setUpEvent(l,m);
});}else{g.setUpEvent(l);}});g.setUpEventsPromise.resolve();};g.setUpEvent=function(k,j){j=(typeof j==="undefined")?k.source:j;
var l=(j.indexOf("#")>-1)?j.substring(1):j;var i=c.findWhere(g.widgetInstances,{id:l});if(i){g.bindSourceEvent(i.$el,k);}else{if(e(j).length>0){g.bindSourceEvent(e(j),k);
}else{try{if(e("#"+j).length>0){g.bindSourceEvent(e("#"+j),k);}}catch(m){}}}};g.bindSourceEvent=function(j,i){j.on(i.event,i.lazySelector,function(n,m){if(i.target||i.callMethod||i.toggle){g.bindTargetEvent(i,m,e(this),n);
var l=i.toggle;if(l&&(l.length>0)){g.toggleButtons(e(this),l,g.actions);}}else{if(i.track){var k=i.track;a.trackEvent(k.category,k.action,k.name,k.weight);
}}});};g.bindTargetEvent=function(j,n,m,i){var k=g.getEventData(j,n,m);var q=j.callMethod;var l=[];var p;if(j.target){if(c.isArray(j.target)){c.each(j.target,function(r){p=(r.indexOf("#")>-1)?r.substring(1):r;
var s=c.findWhere(g.widgetInstances,{id:p});if(!c.includes(l,s)){l.push(s);}});c.each(l,function(r){g.executeCallMethod(r,k,q,m,j.event,i);
});}else{p=(j.target.indexOf("#")>-1)?j.target.substring(1):j.target;var o=c.findWhere(g.widgetInstances,{id:p});g.executeCallMethod(o,k,q,m,j.event,i);
}}else{if(q&&c.isFunction(q)){g.executeCallMethod(null,k,q,m,j.event,i);}}};g.getEventData=function(l,k,j){var i=l.getterMethod;
if(l.data){return l.data;}if(i&&typeof i==="function"){return i.call(g,j,k);}else{if(i){return i;}}if(i&&typeof(j[i])==="function"){return j[i](k);
}if(k){return(k.data||k);}return null;};g.executeCallMethod=function(j,o,i,l,k,n){if(j&&i){var m=j.getInstance();if(m&&typeof m[i]==="function"){m[i].apply(m,[o,l,k]);
}}else{if(typeof i==="function"){i(o,l,n);}else{if(window.console&&b.log){b.log("%c\n################",h);b.warn('%c### ActionCommander::executeCallMethod:: No target can be found on which to execute a function called "'+i+'". Check your actions file - you are probably setting something as a target that is not currently present in the DOM',h);
b.log("%c################",h);}}}};g.unbindEvents=function(i){i=(i||g.actions);c.each(i,function(k){var j=c.findWhere(g.widgetInstances,{id:k.source});
if(j){j.$el.unbind(k.event);}else{if(e(k.source).length>0){e(k.source).unbind(k.event);}else{try{if(e("#"+k.source).length>0){e("#"+k.source).unbind(k.event);
}}catch(l){}}}});};g.toggleButtons=function(m,l,n){var k,j,i;c.each(n,function(o){if(c.isArray(o.source)){i=o.toggle;c.each(o.source,function(p){if(p.indexOf("#")>-1||p.indexOf(".")===0){k=p;
}else{k=("#"+p);}j=e(k);if(j&&(i===l)){j.removeClass("active");}});}else{if(o.source.indexOf("#")>-1||o.source.indexOf(".")===0){k=o.source;
}else{k=("#"+o.source);}j=e(k);i=o.toggle;if(j&&(i===l)){j.removeClass("active");}}});m.addClass("active");};g.init();f.ready();
return g;}return d;});define("chart/widgetFramework/composed/shopperdna/shopperDnaActions",["jquery","lodash"],function(d,a){var b=["#shopperdnaLegend","#shopperdnaBundle","#shopperdnaVmTable","#shopperdnaForce","#shopperDnaBetaTimeline"];
var c={actions:[{source:"#shopperdnaMediator",event:"widgetAppStartup",target:"#shopperdnaData",callMethod:"widgetAppStartup"},{source:"#shopperdnaData",event:"fetchDataError",target:"#shopperdnaMediator",callMethod:"retryFetching"},{source:"#shopperdnaMediator",event:"updateState",callMethod:function(e){d("#shopperdnaState").html(e);
}},{source:"#shopperdnaMediator",event:"hideCharts",callMethod:function(){d("#chartToggles").hide();d("#shopperdnaLegend").hide();
d("#shopperdnaBundle").hide();d("#shopperdnaForce").hide();}},{source:"#forceToggle",event:"click",track:{category:"ShopperDNA",action:"show force layout"}},{source:["#shopperdnaBundle","#shopperdnaForce"],event:"createTemporarySelection",target:"#shopperdnaLegend",callMethod:"renderTemporarySelection"},{target:"#shopperdnaLegend",callMethod:"renderSelection",event:"createSelection",source:a.without(b,"#shopperdnaLegend")},{target:"#shopperdnaBundle",callMethod:"renderSelection",event:"createSelection",source:a.without(b,"#shopperdnaBundle")},{target:"#shopperdnaVmTable",callMethod:"renderSelection",event:"createSelection",source:a.without(b,"#shopperdnaVmTable")},{target:"#shopperdnaForce",callMethod:"renderSelection",event:"createSelection",source:a.without(b,"#shopperdnaForce")},{target:"#shopperDnaBetaTimeline",callMethod:"renderSelection",event:"createSelection",source:a.without(b,"#shopperDnaBetaTimeline")},{source:"#clearButton",event:"click",target:b,getterMethod:function(){return{selection:[]};
},callMethod:"renderSelection"}]};return c;});define("chart/widgetFramework/core/ViewCreatorUpdateable",["jqueryExtended","json","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/core/constants/UIConstants","underscore","util/Functional","chart/widgetFramework/core/drivers/observableCode","chart/widgetFramework/core/uiComponentsFetcher","chartutil/domUtils"],function(a,o,k,m,p,g,b,c,l){var e=false;
var n="color:blue;font-size:1em";var d=false;var i="color:green;font-size:1em";var j=false;var f=false;var h=function(q){var r={};
b(r,"viewCreator");r.init=function(){p.bindAll(this,"onNotifiedDataFormatted");this.$el=q.getNode();this.id=this.$el.attr("id");
if(!this.id){this.id=this.$el.attr("data-id");}var y=this.parameters=this.getParameters(q);this.chartOptions=this.parameters.options||{};
q.getNode()[0].__view=this;var v=this.$el.find('[data-widget="chart/widgetFramework/core/AxisComponentUpdateable"]');this.reconfigureAxesStr="";
if(v.length===2){this.reconfigureAxesStr="xy";}else{if(v.length===1){var u=o.parse(a(v[0]).attr("data-options"));this.reconfigureAxesStr=u.orientation;
}}if(this.reconfigureAxesStr.length===0){if(window.console&&console.log){console.warn("### ViewCreatorUpdateable::init:: YOU ARE USING AN 'UPDATEABLE' CHART TYPE WITHOUT ANY UPDATEABLE AXES - IS THIS CORRECT? ");
}}if(window.console&&console.log&&e){console.log("%c\n################",n);console.log("%c### INIT STAGE :: VizComp::"+this.id+":: INIT",n);
console.log("%c################",n);}var A=y.formatterName;var s=a("#"+A);s.widget().then(function(B){r.Formatter=B.instance;
if(window.console&&console.log&&f){console.log("### ViewCreator2:: registering observer on formatter:: ");}r.Formatter.registerObserver(r.onNotifiedDataFormatted,false,r.id);
},function(){if(window.console&&console.warn){console.warn("VizComp:: Error loading dataFormatter",arguments);}});var w=y.timeline;
var x=(w&&w.indexOf("#")===-1)?a("#"+w):a(w);if(x.length){if(window.console&&console.log&&f){console.log("### ViewCreator2::init:: getting timeline promise----");
}x.widget().then(function(B){var C=B.instance;C.renderPromise.done(function(){r.timeline=C.timeline;});},function(){if(window.console&&console.warn){console.warn("VizComp:: Error loading timelineObject",arguments);
}});}this.chartStore={};var t=this.parameters.options.type;var z=(this.parameters.options.template||"defaultTemplate")+".html";
r.resolvedRequire=false;r.hasData=false;this.currentChartType="noChartnoChartnoChart";if(g.notFalsy(t)){r.requireChartType(t,z);
}};r.requireChartType=function(y,w){if(window.console&&console.log&&e){console.log("### ViewCreatorUpdateable::requireChartType:: pChartType=",y);
console.log("### ViewCreatorUpdateable::requireChartType:: this.chartStore[this.currentChartType]=",this.chartStore[this.currentChartType]);
}var x,t,v=y.substring(y.lastIndexOf("/")+1);if(!this.chartStore[v]){x="."+this.currentChartType;t=this.$el.find(x);t.css("display","none");
this.resolvedRequire=false;require(["chart/widgetFramework/"+y,"text!chart/widgetFramework/"+w],function(z,A){if(window.console&&console.log&&e){console.log("%c\n################",n);
console.log("%c### INIT STAGE :: VizComp::"+r.id+"::REQUIRE Chart= "+y,n);console.log("%c### INIT STAGE :: VizComp::"+r.id+"::REQUIRE Template= "+w,n);
console.log("%c################",n);}r.chart=null;r.currentChartType=v;r.ChartRef=z;r.TemplateRef=A;r.resolvedRequire=true;
r.checkReady("require");if(r.requirePromise){r.requirePromise.resolve();}},function(z){if(window.console&&console.log){console.log("VizComp:: widget Require error: ",z);
}});}else{x="."+this.currentChartType;t=this.$el.find(x);t.css("display","none");this.currentChartType=v;var u="."+this.currentChartType;
var s=this.$el.find(u);s.css("display","inline");this.chart=this.chartStore[v];r.checkReady("require");if(r.requirePromise){this.requirePromise.resolve();
}}};r.invalidateData=function(){this.hasData=false;};r.getRequirePromise=function(){this.requirePromise=new a.Deferred();
return this.requirePromise;};r.checkReady=function(s){if(this.resolvedRequire&&this.hasData){this.createChart();}};r.onNotifiedDataFormatted=function(t,s){switch(t.changeObject.type){case k.DATA_FORMATTED:case k.RETRIEVED_DATA:case k.SORTED_DATA:case k.REFORMATTED_DATA:case k.NEW_DATA_AVAILABLE:if(g.falsy(t.changeObject.silentFormat)){this.data=t.changeObject.data;
this.hasData=true;this.checkReady("data");}break;}};r.createChart=function(){var s;if(!g.existy(this.chart)){var t=g.existy(this.timeline)?this.timeline:null;
this.chart=new this.ChartRef(this.chartOptions,this.$el[0],t,this.TemplateRef);this.chart.chartType=this.currentChartType;
this.chartStore[this.currentChartType]=this.chart;this.chart.init(this.chartOptions,this.$el[0]);s=this.chart.feedData(this.data);
this.$el.on(m.CHART_TO_VIEW_EVENT,p.bind(this.onChartToWidgetEvent,this));this.setProperty("changeObject",{type:m.CHART_INITIALISED,data:this.chart});
this.chart.initRender();this.chart.topSVG.classed("bounds",true);if(s!==k.HALT_RENDER_PROCESS){this.chart.render();}this.setProperty("changeObject",{type:m.CHART_FIRST_RENDER,data:this.chart});
var u=c(this.chartOptions,this.$el[0],function(y){for(var x=0;x<y.length;x++){if(y[x]&&y[x].type==="tooltip"){var w=y[x].module;
var v=y[x].options;r.chart.setupTooltip(w,v);}}});l.removeDataAtrributes(this.$el,["options"]);}else{s=this.chart.feedData(this.data);
if(this.reconfigureAxesStr.length>0){this.chart.createOptions(this.chartOptions);this.chart.createDimensionStorageObjects(this.reconfigureAxesStr);
this.setProperty("changeObject",{type:m.CHART_UPDATED,data:this.chart});this.chart.reset();}if(s!==k.HALT_RENDER_PROCESS){this.chart.render();
if(typeof this.chart.setTooltipsOnElements==="function"){this.chart.setTooltipsOnElements();}}}};r.getInstance=function(){return this.chart;
};r.onChartToWidgetEvent=function(t,s){if(window.console&&console.log&&j){console.log("\n################ ");console.log("### ViewCreator::"+this.id+" onChartEvent:: e=",t);
console.log("### ViewCreator::"+this.id+" onChartEvent:: pData=",s);console.log("################ ");}this.$el.trigger(s.type,s);
this.setProperty("changeObject",s);};r.getParameters=function(s){var v=s.getNode().data();var t;if(p.keys(v).length){t=v;
}else{s.parameters.options=a.parseJSON(s.parameters.options);t=s.parameters;}var u={};if(p.keys(t).length){u.formatterName=t.formatter;
u.options=t.options;if(!g.existy(u.options.margin)){u.options.margin={};}u.timeline=t.timeline;}else{throw"The parameters are not well defined"+t;
}return u;};r.init();if(window.console&&console.log&&f){console.log("\n### ViewCreator2::constructor:: calling pWidgetApi.ready()");
}q.ready();return r;};return h;});define("chart/widgetFramework/composed/retryreport/allRetriesSankey",["jquery","underscore","d3","hogan","util/Functional","chart/widgetFramework/core/constants/WidgetConstants","chart/widgetFramework/core/constants/UIConstants","chartutil/domUtils","util/ObjectSuper","chart/widgetFramework/chartTypes/rollover","chart/widgetFramework/composed/retryreport/drivers/sankey-minimal-overlap"],function(b,h,l,d,a,c,g,e,f,i,k){function j(q,m){var o;
var p={};var n=h.defaults(p,q);o=i(n,m);var r=f(o);o.initRender=function(){r.initRender();this.$el.find(".chartbase-svg").css("background-color","#ffffff");
};o.setBandSizes=function(){};o.renderData=function(){if(a.falsy(this.data.nodes)){l.select("#allRetriesSankeyPanel").style("display","none");
return;}else{l.select("#allRetriesSankeyPanel").style("display",null);}var u=document.getElementById("pspCheck");if(u!==null){this.hideCharts("no overall retry flow chart available on PSP level - please select a company or merchant");
return;}var F=this.options.width-this.options.margin.left-this.options.margin.right,C=this.options.height-this.options.margin.top-this.options.margin.bottom,D=this.chartGroup;
var z=l.format(",.0f"),J="tx";o.format=function(S){return z(S)+" "+J;};o.sankey=k().nodeWidth(10).nodePadding(30).size([F,C]);
o.path=this.sankey.link();var R=[{titleText:"Original acquirers",xLoc:-6,anchor:"end"},{titleText:"Retry acquirers",xLoc:F*0.5,anchor:"middle"},{titleText:"Final result",xLoc:F+32+o.sankey.nodeWidth(),anchor:"middle"}];
if(typeof o.titleWrapper==="undefined"){o.titleWrapper=D.append("g").attr("class","titleWrapper");}o.titleWrapper.selectAll(".sectionTitles").data(R).enter().append("text").attr("class","sectionTitles").attr("x",function(S){return S.xLoc;
}).attr("y",-25).attr("text-anchor",function(S){return S.anchor;}).text(function(S){return S.titleText;});if(typeof o.subtitleWrapper==="undefined"){o.subtitleWrapper=D.append("g").attr("class","subtitleWrapper");
}if(typeof o.linkWrapper==="undefined"){o.linkWrapper=D.append("g").attr("class","linkWrapper");}if(typeof o.nodeWrapper==="undefined"){o.nodeWrapper=D.append("g").attr("class","nodeWrapper");
}o.sankey.nodes(o.data.nodes).links(o.data.links).layout(32);var P=this.data.maxRetry;var x=l.select(".subtitleWrapper").selectAll(".acquirerStepGroup").data(l.range(1,P));
x.transition().duration(750).attr("transform",function(S){return"translate("+(S/P*F+6+o.sankey.nodeWidth())+","+(C+50)+")";
});var M=x.enter().append("g").attr("class","acquirerStepGroup").attr("transform",function(S){return"translate("+(S/P*F+6+o.sankey.nodeWidth())+","+(C+50)+")";
}).style("opacity",0);M.transition().duration(750).style("opacity",1);x.exit().transition().duration(750).style("opacity",0.000001).remove();
M.append("text").attr("class","acquirerHeader").text("Retry step");M.append("text").attr("class","acquirerStep").attr("y",18).text(function(S){return S;
});var s=this.data.nodeNames;var B=s.filter(function(S){return/^Adyen/.test(S);});B.sort();var L=[];if(B.length>0){var I=l.scale.linear().range(["#004E00","#007100","#1C9516","#6AB466","#A1D3A1"].reverse()).domain(l.range(0,1,1/(5-1)).concat(1));
var t=l.scale.ordinal().domain(B).range(l.range(0,1,1/(B.length-1)).concat(1));B.forEach(function(T,S){L[S]=I(t(T));});}var w=s.filter(function(S){return !(/^Adyen/.test(S));
});w.sort();var Q=[];if(w.length>0){var O=l.scale.linear().range(["#02324C","#0D4F74","#2D6E98","#508EB6","#75AFCE"].reverse()).domain(l.range(0,1,1/(5-1)).concat(1));
var H=l.scale.ordinal().domain(w).range(l.range(0,1,1/(w.length-1)).concat(1));w.forEach(function(T,S){Q[S]=O(H(T));});}var K=l.scale.ordinal().domain(["Success","Refused"].concat(B,w)).range(["#4FAA5D","#823333"].concat(L,Q));
var y=this.linkWrapper.selectAll(".link").data(this.data.links,function(S){return S.source.name+S.target.name+S.type;});y.style("fill-opacity",function(S){if(S.target.name==="Success"||S.target.name==="Refused"){if(S.type==="success"){S.fill_opacity=0.15;
}else{S.fill_opacity=0.05;}}else{if(S.type==="success"){S.fill_opacity=0.4;}else{S.fill_opacity=0.2;}}return S.fill_opacity;
}).transition().duration(750).attr("d",o.path);var N=y.enter().append("path").attr("class",function(S){return"link "+S.type+" "+S.target.name.replace(/\s+/g,"_");
}).attr("d",o.path).style("fill-opacity",function(S){if(S.target.name==="Success"||S.target.name==="Refused"){if(S.type==="success"){S.fill_opacity=0.15;
}else{S.fill_opacity=0.05;}}else{if(S.type==="success"){S.fill_opacity=0.4;}else{S.fill_opacity=0.2;}}return S.fill_opacity;
}).style("opacity",0).on("mouseover",function(T){var S=l.select(this);if(T.type==="success"){S.style("fill-opacity",0.8);
}else{S.style("fill-opacity",0.4);}}).on("mouseout",function(){l.selectAll(".link").style("fill-opacity",function(S){return S.fill_opacity;
});});N.transition().duration(750).style("opacity",1);y.exit().transition().duration(750).style("opacity",0.000001).remove();
y.sort(function(T,S){return S.dy-T.dy;});var G=o.nodeWrapper.selectAll(".node").data(this.data.nodes,function(S){return S.name;
});G.transition().duration(750).attr("transform",function(S){return"translate("+S.x+","+S.y+")";});var A=G.enter().append("g").attr("class",function(S){return"node "+S.name.replace(/\s+/g,"_");
}).attr("transform",function(S){return"translate("+S.x+","+S.y+")";}).style("opacity",0).call(l.behavior.drag().origin(function(S){return S;
}).on("dragstart",function(){this.parentNode.appendChild(this);}).on("drag",o.dragmove));A.transition().duration(750).style("opacity",1);
G.exit().transition().duration(750).style("opacity",0.000001).remove();G.select(".nodeRects").transition().duration(750).attr("height",function(S){return S.dy+2;
}).style("fill",function(S){S.color=K.domain().indexOf(S.name.replace(/_.$/,""))>-1?K(S.name.replace(/_.$/,"")):"#a5a5a5";
return S.color;});A.append("rect").attr("class","nodeRects").attr("height",function(S){return S.dy+2;}).attr("width",o.sankey.nodeWidth()).attr("y",-1).style("fill",function(S){S.color=K.domain().indexOf(S.name.replace(/_.$/,""))>-1?K(S.name.replace(/_.$/,"")):"#a5a5a5";
return S.color;}).style("stroke","white");var E=G.select(".nodeLabelGroup").transition().duration(750).attr("transform",function(T){var S;
if(T.x===0){S=-6;}else{if(T.x>0&&T.x<(F-o.sankey.nodeWidth())){S=6+o.sankey.nodeWidth();}else{S=40+o.sankey.nodeWidth();}}return"translate("+S+","+(T.dy/2)+")";
}).style("text-anchor",function(S){if(S.x===0){return"end";}else{if(S.x>0&&S.x<(F-o.sankey.nodeWidth())){return"start";}else{return"middle";
}}});E.select(".value").text(function(S){return o.format(S.value);});var v=A.append("g").attr("class","nodeLabelGroup").attr("transform",function(T){var S;
if(T.x===0){S=-6;}else{if(T.x>0&&T.x<(F-o.sankey.nodeWidth())){S=6+o.sankey.nodeWidth();}else{S=40+o.sankey.nodeWidth();}}return"translate("+S+","+(T.dy/2)+")";
}).style("text-anchor",function(S){if(S.x===0){return"end";}else{if(S.x>0&&S.x<(F-o.sankey.nodeWidth())){return"start";}else{return"middle";
}}});v.filter(function(S){return S.name==="Refused"||S.name==="Success";}).append("rect").attr("class","labelBox").attr("width",70).attr("x",-35).attr("height",40).attr("y",-20).style("fill",function(S){S.color=K(S.name);
return S.color;});v.append("text").attr("class","label").attr("dy","-0.2em").text(function(S){return S.name.replace(/_.$/,"");
});v.append("text").attr("class","value").attr("dy","1.0em").text(function(S){return o.format(S.value);});};o.dragmove=function(t){var s=o.options.height-o.options.margin.top-o.options.margin.bottom;
l.select(this).attr("transform","translate("+t.x+","+(t.y=Math.max(0,Math.min(s-t.dy,l.event.y)))+")");o.sankey.relayout();
l.selectAll(".link").attr("d",o.path);};o.setTooltipsOnElements=function(){r.setTooltipsOnElements(true);};o.enhanceTooltipData=function(s){var t=l.format(",.0f");
s.valueTT=t(s.value);s.sourceName=s.source.name.replace(/_.$/,"");s.targetName=s.target.name.replace(/_.$/,"");};o.positionTooltip=function(t,v,y,s,x){var w=t.top+y-x-5;
var u=((t.left+v)-s)+(t.width/2);return{top:w,left:u};};o.hideCharts=function(s){this.$el.find(".no-data-text").remove();
var u=a.existy(s)?s:"no data to display";var w=this.height/2;var v=this.width/2;var t=b('<div class="no-data-text"><text style="color: #ccc; font-size: 14px; position: relative; top:'+w+"px; left:"+v+'px;">'+u+"</text></div>");
this.$el.not(this.$el.has(".no-data-text")).prepend(t);this.$el.children().not(".no-data-text").hide();t.show();};return o;
}return j;});define("chart/widgetFramework/composed/revenueAccelerate/RevOpBaselineDataFormatter",["jqueryExtended","underscore","d3","chartutil/dateUtils_CET","chartutil/d3utils"],function(h,d,f,g,e){function a(k,i,j){this.data=k;
this.options=i;this.formattedData={};this.timeline=j;this.sortKey="date";this.reverseDirection=false;this.movingAverageNum=7;
this.movingAverageDirection="backward";this.granularity="day";}a.prototype.formatData=function(){this.intervalFormat=f.time[this.granularity];
this.dateExtent=this.timeline.getDates();this.dateExtent[1]=f.time[this.granularity].utc.offset(this.dateExtent[1],-1);var j=this.data["default"].rows;
var k=c(j);if(this.sortKey){this.reverseDirection=!this.reverseDirection;k=this.sortData(this.sortKey,k);}this.baselineData=this.bucketFillData(k);
this.baselineData.forEach(function(m){var l=0;h.each(m.rates,function(n,o){o.startY=l;o.endY=(l+o.value);l+=o.value;});});
var i={};i.lastModelDate=this.lastModelDate;i.granularity=this.granularity;this.parsedData={config:i,chartData:this.baselineData};
if(window.console&&console.log){console.log("### BaselineDataFD::formatData:: PARSEDDATA=",this.parsedData);}return this.parsedData;
};function c(i){var j=[];d.each(i,function(l){var k=b(l);j.push(k);});return j;}function b(m){var j={};var l=m.total-m.auths;
var k=m.auths/m.total;j.name="merchant";j.timestamp=m.millisecondsutc;var i=new Date(j.timestamp);var n=g.getAmsterdamDSTOffsetTime(i,true);
j.date=g.timezoneShiftDate(i,g.__BACK,n,"startDate",0,0);j.date=g.trueRoundToDay(j.date);j.authorisations=m.auths;j.total=m.total;
j.refused=l;j.authRate=k;j.rates=[{name:"authorised",value:m.auths},{name:"refused",value:l}];return j;}a.prototype.bucketFillData=function(i){var l=d.last(i);
if(typeof(l)!=="undefined"){this.lastModelDate=l.date;}else{this.lastModelDate=this.dateExtent[0];}var k=function(){return{authorisations:0,total:0,refused:0,authRate:0,averageRate:null,averageTotal:null,rates:[]};
};var j=e.fillTimeScaleBucketsFromTemplate(this.dateExtent,this.granularity,i,k);return j;};a.prototype.sortData=function(i,k){this.sortKey=i;
this.reverseDirection=!this.reverseDirection;var j=d.sortBy(k,i);if(this.reverseDirection){j.reverse();}return j;};a.prototype.getData=function(){return(this.parsedData)?this.parsedData:this.formatData();
};a.prototype.setRawData=function(i){this.data=i;};a.prototype.setOptions=function(i){this.options=i;};return a;});define("chart/widgetFramework/composed/demo/barDataFormatter",["jqueryExtended","underscore","d3","chartutil/dateUtils_CET","chart/widgetFramework/core/constants/DataConstants","chartutil/d3utils"],function(g,b,d,f,e,c){var a=function(k,h,j,m){var i={};
i.data=k;i.options=h;i.formattedData={};i.comparator=null;i.reverseDirection=false;i.sortKey=null;i.timeline=j;i.id=m;i.formatData=function(){this.formattedData=l(this.data);
if(this.sortKey){this.reverseDirection=!this.reverseDirection;this.sortData(this.sortKey,true);}if(window.console&&console.log){console.log("### barDataFD::"+this.id+" formatData:: this.formattedData=",this.formattedData);
}return{chartData:this.formattedData};};var l=function(n){b.each(n,function(p){p.dateStr=p.date;var o=new Date(p.dateStr);
p.date=f.roundToDay(o);});return n;};i.sortData=function(n,p){this.sortKey=n;this.reverseDirection=!this.reverseDirection;
var o=b.sortBy(this.formattedData,n);if(this.reverseDirection){o.reverse();}this.formattedData=o;if(p===true){return;}this.$el.trigger(e.FORMATTER_INFORM_WIDGET,{type:e.SORTED_DATA,data:{chartData:this.formattedData}});
};i.compareFunction=function(n){return n[this.sortKey];};i.getData=function(){return(this.data)?this.data:this.formatData();
};i.setRawData=function(n){this.data=n;};i.retrieveData=function(n){return this.data[n];};return i;};return a;});define("chart/widgetFramework/composed/chargebackReport/countryBarChart",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/chartTypes/barChart"],function(c,i,k,b,f,a,g,j,h,e){function d(q,l,o){var n;
var p={};var m=i.defaults(p,q);n=e(m,l,o);var s=g(n);var r=false;n.init=function(){s.init();n.maxRowsForBrush=(this.options.numBars&&this.options.numBars>0)?this.options.numBars:10;
};n.initRender=function(){s.initRender();setTimeout(function(){if(!r&&n.options.ranked){n.chartGroup.classed("barchart-ranked",true);
}r=true;},100);n.textScale=k.scale.linear().domain([8,50]).range([11,5]).clamp(true);var t=n.mainGroup.append("defs");t.append("clipPath").attr("id","clip-bars-country").append("rect").attr("width",n.options.width-n.options.margin.left-n.options.margin.right).attr("height",n.options.height-n.options.margin.top-n.options.margin.bottom);
t.append("clipPath").attr("id","clip-y-axis-country").append("rect").attr("clipPathUnits","objectBoundingBox").attr("x","-100%").attr("width","100%").attr("height",((n.options.height-n.options.margin.top-n.options.margin.bottom)/(n.options.height)*100)+"%");
};n.render=function(){n.showCharts();n.doBrush=n.data.length>n.maxRowsForBrush;n.barUtils.transitionTime=n.doBrush?0:500;
n.barUtils.delayTime=n.doBrush?0:500;var u=this.$el.width();n.height=n.options.height-(n.options.margin.top+n.options.margin.bottom);
var t=n.height+n.options.margin.top+n.options.margin.bottom;n.topSVG.attr("width",u+"px").attr("height",t+"px");k.select("#"+n.$el[0].id).transition().duration(500).style("height",t+"px");
if(n.doBrush){n.chartGroup.attr("clip-path","url(#clip-bars-country)").style("clip-path","url(#clip-bars-country)");n.axisGroup.select(".y.axis").attr("clip-path","url(#clip-y-axis-country)").style("clip-path","url(#clip-y-axis-country)");
}else{n.scales[n.options.yAttr].rangeBands([n.height,0],n.options.barPadding);n.axisGroup.selectAll(".y.axis text").style("font-size",null);
}this.update();};n.scrolling=function(){var t=n.options.variation==="horizontal"?k.event.deltaY:k.event.deltaX;this.$el.trigger(h.CHART_TO_VIEW_EVENT,{type:"countryBarChartScroll",data:t});
};n.updateScale=function(t){n.scales[n.options.yAttr].rangeBands(t.newScale,n.options.barPadding);n.axisGroup.selectAll(".y.axis text").style("font-size",n.textScale(t.numSelected));
var u=k.max(n.data,function(v){return t.selected.indexOf(v[n.options.yAttr])>-1?v[n.options.xAttr]:0;});this.maxXScale=u;
n.update();};n.setBandSizes=function(){if(n.doBrush){n.barSize=n.vertBarSize=n.scales[n.options.yAttr].rangeBand();n.bandSize=n.barSize*(1+n.options.barPadding);
}else{s.setBandSizes();}};return n;}return d;});define("chart/widgetFramework/composed/riskReport/rollovers/refusalRateChargebackLineRollover",["jqueryExtended","underscore","d3","chart/widgetFramework/core/mixins/widgetScales","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/WidgetConstants","util/ObjectSuper","chart/widgetFramework/chartTypes/rollover","chart/widgetFramework/core/constants/DataConstants"],function(c,i,m,j,b,f,d,g,h,e){var l=adyen.config||{};
var a=0;var k=function(t,n,r,p){var q;var s={};var o=i.defaults(s,t);q=h(o,n);var u=g(q);q.thinBarWidth=3;q.init=function(){u.init();
this.barUtils.setBarSelectorStr(".bar.refusal-rate-line-rollover");if(a===0){a=this.$el.height();}};q.resizeRollover=function(w){var x=this.$el.width();
var v;if(w.state==="hidden"){v=w.height;}else{v=a;}this.$el.height(v);this.topSVG.attr("width",x+"px").attr("height",v+"px");
u.update();};q.renderData=function(){var v=this.options.centerBars;this.barUtils.chartWidth=this.width;this.barUtils.chartHeight=this.height;
var w;w=this.barUtils.barPosition(v,this.bandSize,this.getXScale(),this.options.joinAttr);this.barUtils.containerBarsVertical(this.chartGroup,this.getData(),this.getPrimaryDataJoin(),w,true).fullBarVertical(this.thinBarWidth,"thin-bar one",null,200).fullBarVertical(this.thinBarWidth,"thin-bar two",null,140).fullBarVertical(this.barSize,"dateStr");
};q.tooltipOnMouseoverAction=function(w,v){this.sharedMouseAction(v,0.25,1);};q.tooltipOnMouseoutAction=function(w,v){this.sharedMouseAction(v,0,0);
};q.sharedMouseAction=function(D,B,E){var x=D.find(".dateStr");var A=x.attr("data-id");var C=D.find(".thin-bar");m.selectAll(C).style("opacity",B);
var y=D.find(".thin-bar.two");m.select(y[0]).attr("transform","translate("+(-(this.thinBarWidth/2))+",300)");var z=["chargeback","refused-by-revenueprotect","refused-by-bank"],w,v;
i.each(z,function(F){if(F==="chargeback"){w="#chargebackLineChartWidget ."+F+' .line-holder-dot[data-id*="'+A+'"]';}else{w="#refusalRateLine ."+F+' .line-holder-dot[data-id*="'+A+'"]';
}v=m.select(w).style("fill-opacity",E).style("stroke-opacity",E);});};q.positionTooltip=function(z,B,y,A,v,w,C){var x=z.top+y-v;
var D=((z.left+B+10)-A)+(w/2);return{top:x,left:D};};q.enhanceTooltipData=function(x){var w=m.format(".2f");var v=m.format("0,000");
x.refusedBankTT=w(x.refusedByBankPercent);x.refusedRevProTT=w(x.refusedByRevProPercent);x.chargebacksTT=w(x.chargebackPercent);
x.chargebackVisClassTT=l.chargebackRowVis;x.refusedByBankCountTT=v(x.refusedByBankCount);x.refusedByBankAmountTT=v(x.refusedByBankAmount);
x.refusedByRevProCountTT=v(x.refusedByRiskCount);x.refusedByRevProAmountTT=v(x.refusedByRiskAmount);};return q;};return k;
});define("chart/widgetFramework/composed/cardAcquirerAuthorizationReport/rollovers/groupedBarRolloverBIN",["jqueryExtended","underscore","d3","util/Functional","chartutil/domUtils","chart/widgetFramework/core/constants/UIConstants","util/ObjectSuper","chart/widgetFramework/core/constants/DataConstants","chart/widgetFramework/chartTypes/axisRollover"],function(c,i,j,a,f,h,g,e,d){function b(o,k){var m;
var n={};var l=i.defaults(n,o);m=d(l,k);var p=g(m);m.init=function(){p.init();if(typeof this.options.allowScrolling==="undefined"){this.options.allowScrolling=false;
}m.firstBrushPass=true;};m.initRender=function(){p.initRender();m.mainGroup.append("defs").append("clipPath").attr("id","clip-bars-rollover").append("rect").attr("width",m.options.width-m.options.margin.left-m.options.margin.right).attr("height",m.options.height-m.options.margin.top-m.options.margin.bottom);
};m.render=function(){m.doBrush=m.data.length>10;var r=this.$el.width();if(!m.doBrush){this.height=(this.data.length*30);
}else{this.height=this.options.height-(this.options.margin.top+this.options.margin.bottom);}var q=this.height+this.options.margin.top+this.options.margin.bottom;
this.topSVG.attr("width",r+"px").attr("height",q+"px");j.select("#"+this.$el[0].id).transition().duration(500).style("height",q+"px");
if(this.options.allowScrolling&&m.doBrush&&m.firstBrushPass){var s=j.behavior.zoom().on("zoom",null);this.mainGroup.call(s).on("wheel.zoom",function(){m.scrolling();
}).on("mousedown.zoom",null).on("touchstart.zoom",null).on("touchmove.zoom",null).on("touchend.zoom",null);m.firstBrushPass=false;
}if(m.doBrush){m.chartGroup.attr("clip-path","url(#clip-bars-rollover)").style("clip-path","url(#clip-bars-rollover)");}else{m.scales[m.options.yAttr].rangeBands([m.height,0],m.options.barPadding);
}this.update();};m.updateScale=function(q){m.scales[m.options.yAttr].rangeBands(q.newScale,m.options.barPadding);m.update();
};m.setBandSizes=function(){if(m.doBrush){this.barSize=m.scales[m.options.yAttr].rangeBand();this.bandSize=this.barSize*(1+m.options.barPadding);
}else{p.setBandSizes();}};m.scrolling=function(){var q=m.options.variation==="horizontal"?j.event.deltaY:j.event.deltaX;this.$el.trigger(h.CHART_TO_VIEW_EVENT,{type:"groupedBarChartScroll",data:q});
};m.setTooltipsOnElements=function(){p.setTooltipsOnElements(true);};m.positionTooltip=function(u,w,t,v,q,r,x){var s=u.top+t-10-q;
var y=((u.left+w)-v)+(r/2)+80;return{top:s,left:y};};m.enhanceTooltipData=function(r){function s(v,u){return v.authorizationRate<u.authorizationRate;
}r.acquirerValues.sort(s);var q=j.format(",.2f");var t=j.format(",.0f");i.each(r.acquirerValues,function(u){u.authorizedRateTT=q(u.authorizationRate);
u.authorizedCountShareTT=q(u.authorizedCountShare);u.authorizedCountTT=t(u.authorizedCount);});};m.postRender=function(r){var s=this.extraData.colors;
for(var q in s){if(s.hasOwnProperty(q)){j.selectAll(".bin-bar-tooltip .legend-"+q+".legend-circle").style("background",s[q]);
}}};return m;}return b;});define("chart/widgetFramework/composed/settlementBatchOverview/settlementBatchFormatterYear",["jqueryExtended","underscore","d3","chartutil/d3utils"],function(e,a,c,b){function d(g,f){this.data=g;
this.options=f;}d.prototype.formatData=function(){var k=this;this.currentYear=this.data.year;this.fullMonthData=[];var f=["January","February","March","April","May","June","July","August","September","October","November","December"];
var l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var h=c.time.format("%Y-%m-01");var p=c.time.format("%Y/%m/%d");
var n=c.time.format("%Y-%m-%d");var j=0;var m;var i=[];var o=[];var g;a.each(this.data.months,function(v){var r=0;var s={};
var q=(v.year)?v.year:k.currentYear;s.date=new Date(q,v.monthOneIndexed-1);s.dateString=h(s.date);s.monthStr=l[v.monthOneIndexed-1];
s.monthNum=v.monthOneIndexed-1;s.year=q;var u=[];a.each(v.batches,function(w,x){if(x===0){m=w.fee.unit;}w.payout=Number(w.realMoneyPayout.quantity);
r+=w.payout;j+=Number(w.depositCorrection.quantity);var y=n;if(w.closeDate.indexOf("/")>-1){y=p;}w.date=y.parse(w.closeDate);
w.dateString=w.closeDate;w.month=f[w.date.getMonth()];w.batchId=w.batchId;w.detailsUrl=w.detailsUrl;w.currency=w.fee.unit;
w.hasBatch=true;w.depoCorrection=b.formatAmountStringsAllowed(w.depositCorrection.quantity,w.fee.unit);w.invCorrection=b.formatAmountStringsAllowed(w.invoiceDeduction.quantity,w.fee.unit);
if(typeof w.internalPayout!=="undefined"&&Number(w.internalPayout.quantity)!==0){w.balTransfer=b.formatAmountStringsAllowed(w.internalPayout.quantity,w.fee.unit);
}else{w.balTransfer="";}if(w.closeDate!==w.closeDateLocal){w.localTime=adyen.tz.userTimeZoneCode;}o.push(w);if(typeof g!=="undefined"&&g.dateString===w.dateString){k.prepMultipleBatchesDay(w,v,x);
}u.push(w);g=w;});s.payout=r;s.payoutYaxis=r/100;s.currency=m;k.fullMonthData.push(s);i.push(s);if(u.length){var t=k.getBucketFilledMonthBatches(u);
k.formatMultipleBatchesDay(t);s.monthData={tableData:u,batches:t,depoTotal:b.formatAmount(j,k.firstBatch.currency),total:b.formatAmount(r,k.firstBatch.currency),currency:k.firstBatch.currency,month:f[k.firstBatch.date.getMonth()]};
}});if(this.fullMonthData.length===0){return this.getEmptyData();}return{allTableBatches:o,monthData:this.fullMonthData,currency:m,yearTotal:k.getYearTotal(m),year:a.first(this.fullMonthData).year};
};d.prototype.getBucketFilledMonthBatches=function(j){this.firstBatch=a.first(j);var i=[];var h=new Date(this.firstBatch.date.getFullYear(),this.firstBatch.date.getMonth(),1);
var g=new Date(this.firstBatch.date.getFullYear(),this.firstBatch.date.getMonth()+1,0);var f=b.fillTimeScaleBucketsNonBackbone([h,g],"day",j);
a.each(f,function(k){k=a.defaults(k,{hasBatch:false,payout:0});k.payoutYaxis=k.payout/100;i.push(a.omit(k,["authRate","authorisations","averageRate","averageTotal","rates","total","utcdate"]));
});return i;};d.prototype.prepMultipleBatchesDay=function(f,h,g){f.isMultipleBatchesDay=true;h.batches[g-1].isMultipleBatchesDay=true;
f.multipleBatchesTotal=h.batches[g-1].payout+f.payout;h.batches[g-1].multipleBatchesTotal=h.batches[g-1].payout+f.payout;
f.multipleBatchesIds=h.batches[g-1].sequenceNumber+", "+f.sequenceNumber;h.batches[g-1].multipleBatchesIds=h.batches[g-1].sequenceNumber+", "+f.sequenceNumber;
};d.prototype.formatMultipleBatchesDay=function(f){a.each(f,function(g,h){if(typeof g.isMultipleBatchesDay!=="undefined"&&g.isMultipleBatchesDay){f[h].payout=g.multipleBatchesTotal;
f[h].payoutYaxis=g.multipleBatchesTotal/100;f[h].sequenceNumber=g.multipleBatchesIds;}});};d.prototype.getYearTotal=function(f){return b.formatAmount(a.reduce(this.fullMonthData,function(g,h){return g+h.payout;
},0),f);};d.prototype.getEmptyData=function(){return{monthData:[],currency:"-",yearTotal:"-",year:"-"};};d.prototype.sortData=function(f){this.sortKey=f;
this.reverseDirection=!this.reverseDirection;var g=a.sortBy(this.fullMonthData,f);if(this.reverseDirection){g.reverse();}this.fullMonthData=g;
return this.fullMonthData;};d.prototype.compareFunction=function(f){return f[this.sortKey];};d.prototype.getData=function(){return(this.data)?this.data:this.formatData();
};d.prototype.setRawData=function(f){this.data=f;};d.prototype.setOptions=function(f){this.options=f;};return d;});define("chart/widgetFramework/composed/chargebackReport/countryBrushBarChart",["jquery","underscore","d3","chart/widgetFramework/core/mixins/formats","hogan","util/Functional","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/core/constants/UIConstants","chart/widgetFramework/chartTypes/brushableBarChart"],function(d,i,k,c,e,b,f,j,h,g){function a(q,l,o){var n;
var p={};var m=i.defaults(q,p);n=g(m,l,o);var r=f(n);n.init=function(){r.init();};n.initRender=function(){r.initRender();
};n.renderData=function(){r.renderData();if(n.data.length<=this.options.numBars){k.select("#countryBrushExplanation").style("display","none");
}else{k.select("#countryBrushExplanation").style("display","inline");}};n.sortData=function(s){r.sortData(s);};return n;}return a;
});define("chart/widgetFramework/composed/transactionsDashboard/formatters/txHeatmapFormatter",["jqueryExtended","underscore","d3","chartutil/dateUtils_CET","chart/widgetFramework/core/constants/DataConstants","timeline/util/timelineConstants","chartutil/d3utils"],function(h,c,e,g,f,a,d){function b(l,i,k,m){var j={};
j.data=l;j.options=i;j.formattedData={};j.comparator=null;j.reverseDirection=false;j.sortKey=null;j.timeline=k;j.id=m;j.granularity="hour";
j.formatData=function(){var n={};if(this.data){n=this.data;}this.formattedData=this.calculateMetaData(n);return{config:{},chartData:this.formattedData};
};j.calculateMetaData=function(r){var n=[];c.each(r,function(z){var A=z.date.getDay();var t=z.date.getHours();var y=z.receivedCount;
var u=e.time.format("%a")(z.date).substring(0,2);var w=g.getUserFriendlyDate(z.dateStr,false,"%A %B %e");var s=e.time.format("%H")(z.date);
var x=s+":59";var v=s+":00 - "+x;n.push({day:A,hour:t,count:y,dayName:u,niceDate:w,niceTime:v});});var q=[];for(var p=0;p<24;
p++){var o=c.filter(n,function(s){return s.hour===p;});q.push(o);}return c.flatten(q);};j.sortData=function(n,p){this.sortKey=n;
this.reverseDirection=!this.reverseDirection;var o=c.sortBy(this.formattedData,n);if(this.reverseDirection){o.reverse();}this.formattedData=o;
if(p===true){return;}this.$el.trigger(f.FORMATTER_INFORM_WIDGET,{type:f.SORTED_DATA,data:{chartData:this.formattedData}});
};j.compareFunction=function(n){return n[this.sortKey];};j.getData=function(){return(this.data)?this.data:this.formatData();
};j.setRawData=function(n){this.data=n;};j.retrieveData=function(n){return this.data[n];};j.setOptions=function(n){this.options=n;
};return j;}return b;});define("chart/widgetFramework/composed/chargebackReport/chargebackMediator",["jqueryExtended","d3","lodash","chart/widgetFramework/core/BasicMediator","util/ObjectSuper","chartutil/numberutils","chart/widgetFramework/core/constants/UIConstants","chartutil/cssutils"],function(a,i,f,e,c,g,d,h){function b(j){var k;
k=e(j,true);var l=c(k);k.init=function(){l.init();k.rankedChartID="Count";this.$sortButtonRefCountry=a("#countryCountTitle");
this.$sortButtonRefPaymentMethod=a("#paymentMethodCountTitle");this.$sortButtonRefAcquirer=a("#acquirerCountTitle");this.actionCommanderExclusionArray=["actioncommander","timeline"];
};k.getAdditionalDOMElements=function(){l.getAdditionalDOMElements();this.timelineInstances=[];this.$allTimelines=j.__$node.find("[data-widget*=Timeline]");
this.totalDomElements+=this.$allTimelines.length;};k.getWidgets=function(){l.getWidgets();this.getWidgetInstances(this.$allTimelines,this.timelineInstances,"Timelines");
};k.onNotifiedFetcher=function(o,n){l.onNotifiedFetcher(o,n);if(n==="issuerCountriesFetcher"){var s,r=this.$el.find("#issuerCountry"),m=false;
s='<option value="">-- all Issuer Countries --</option>';f.each(o.changeObject.data,function(u){if(!u){return;}if(f.isObject(u)){if(k.storedIssuerCountry&&k.storedIssuerCountry===u.countryCode){m=true;
}s+='<option value="'+u.countryCode+'">'+u.countryName+"</option>";}else{if(k.storedIssuerCountry&&k.storedIssuerCountry===u){m=true;
}s+='<option value="'+u+'">'+u+"</option>";}});r.html(s);if(this.storedIssuerCountry&&m){a("#issuerCountry").val(this.storedIssuerCountry);
}}if(n==="activePaymentMethodsFetcher"){var t,p=this.$el.find("#paymentMethod"),q=false;t='<option value="">-- all Payment Methods --</option>';
f.each(o.changeObject.data,function(u){if(k.storedPaymentMethod&&k.storedPaymentMethod===u){q=true;}t+='<option value="'+u+'">'+u+"</option>";
});p.html(t);if(this.storedPaymentMethod&&q){a("#paymentMethod").val(this.storedPaymentMethod);}}};k.onNotifiedFormatter=function(p,o){l.onNotifiedFormatter(p,o);
if(o==="masterFormatter"&&p.changeObject.data){k.renderTotals(p.changeObject.data);}var q,t,r,s,n,m;if(o==="countryBarFormatter"){this.$el.find(".country-grouped-bar-chart .chart-elements-holder").each(function(){i.select(a(this)[0]).classed("barchart-ranked",false);
});i.selectAll("#country"+k.rankedChartID+"BarChart .chart-elements-holder").classed("barchart-ranked",true);q=this.getInstanceById("#countryBarFormatter");
t=q.getSortDirection();r=this.$sortButtonRefCountry.find(".arrow")[0];s=(t)?180:0;n=(t)?-0.5:0.5;m=(t)?1:-0.5;h.rotateElement2(r,s,n,m);
}if(o==="acquirerBarFormatter"){this.$el.find(".acquirer-grouped-bar-chart .chart-elements-holder").each(function(){i.select(a(this)[0]).classed("barchart-ranked",false);
});i.selectAll("#acquirer"+k.rankedChartID+"BarChart .chart-elements-holder").classed("barchart-ranked",true);q=this.getInstanceById("#acquirerBarFormatter");
t=q.getSortDirection();r=this.$sortButtonRefAcquirer.find(".arrow")[0];s=(t)?180:0;n=(t)?-0.5:0.5;m=(t)?1:-0.5;h.rotateElement2(r,s,n,m);
}if(o==="paymentMethodBarFormatter"){this.$el.find(".paymentMethod-grouped-bar-chart .chart-elements-holder").each(function(){i.select(a(this)[0]).classed("barchart-ranked",false);
});i.selectAll("#paymentMethod"+k.rankedChartID+"BarChart .chart-elements-holder").classed("barchart-ranked",true);q=this.getInstanceById("#paymentMethodBarFormatter");
t=q.getSortDirection();r=this.$sortButtonRefPaymentMethod.find(".arrow")[0];s=(t)?180:0;n=(t)?-0.5:0.5;m=(t)?1:-0.5;h.rotateElement2(r,s,n,m);
}};k.onNotifiedViewCreator=function(q,o){l.onNotifiedViewCreator(q,o);var n=q.changeObject;var p=n.type;var m;if(o==="countryRateBarChart"){if(p===d.CHART_FIRST_RENDER||p===d.CHART_UPDATED){m=this.getInstanceById("countryBrushBarChart",this.chartInstances).getInstance();
if(m){m.startBrush();}}}if(o==="paymentMethodRateBarChart"){if(p===d.CHART_FIRST_RENDER||p===d.CHART_UPDATED){m=this.getInstanceById("paymentMethodBrushBarChart",this.chartInstances).getInstance();
if(m){m.startBrush();}}}};k.renderTotals=function(o){var m=i.format(",.0f");var p=i.format(".2f");var n={chargebackVol:0,chargebackAmt:0,avgChargebackAmt:0,chargebackRate:0,authVol:0};
f.each(o,function(q){n.chargebackVol+=q.chargebackCount;n.chargebackAmt+=q.chargebackEurAmount/100;n.authVol+=q.authorisedCount;
});n.avgChargebackAmt=(n.chargebackAmt>0||n.chargebackVol>0)?n.chargebackAmt/n.chargebackVol:0;n.chargebackRate=(n.chargebackVol>0||n.authVol>0)?(n.chargebackVol/n.authVol)*100:0;
g.animateValue(a("#chargebackVol span"),n.chargebackVol,m);g.animateValue(a("#chargebackAmt span"),n.chargebackAmt,m);g.animateValue(a("#avgChargebackAmt span"),n.avgChargebackAmt,p);
g.animateValue(a("#chargebackRate span"),n.chargebackRate,p);};k.onTimeData=function(){if(a("#issuerCountry").val()!==""){this.storedIssuerCountry=a("#issuerCountry").val();
}else{this.storedIssuerCountry=null;}if(a("#paymentMethod").val()!==""){this.storedPaymentMethod=a("#paymentMethod").val();
}else{this.storedPaymentMethod=null;}};k.reformatData=function(n){var m=this.$el.find("#countryBarCountAmountSpan");m.text(n);
var o=this.$el.find("#paymentMethodCountAmountSpan");o.text(n);};k.reformatDataChargebacksNof=function(o){var m="#"+o.source+"TitleText";
var n=this.$el.find(m);if(o.type==="chargebacks"){n.text("Chargebacks");}else{n.text("Notifications of fraud");}};k.getInstance=function(){return this;
};k.sortData=function(n,m){if(n==="chargebackCount"){k.rankedChartID="Count";}else{if(n==="chargebackEurAmount"){k.rankedChartID="Amount";
}else{if(n==="chargebackRate"){k.rankedChartID="Rate";}}}if(m.attr("id").indexOf("country")>-1){this.$sortButtonRefCountry=m;
}else{if(m.attr("id").indexOf("paymentMethod")>-1){this.$sortButtonRefPaymentMethod=m;}else{if(m.attr("id").indexOf("acquirer")>-1){this.$sortButtonRefAcquirer=m;
}}}};k.init();j.ready();return k;}return b;});